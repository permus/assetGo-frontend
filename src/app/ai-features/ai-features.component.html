<div class="ai-features-container">
  <!-- Header Section -->
  <div class="header-section">
    <h1 class="main-title">AI-Powered Features</h1>
    <p class="main-description">Transform your asset management with cutting-edge AI technology. Automate identification, predict maintenance needs, and optimize operations with intelligent insights.</p>
  </div>

  <!-- Tabs Navigation -->
  <div class="tabs-container">
    <div class="tabs-nav">
      <button
        *ngFor="let tab of tabs"
        [class.active]="activeTab === tab.id"
        (click)="setActiveTab(tab.id)"
        class="tab-button">
        <svg class="tab-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path [attr.d]="getTabIcon(tab.icon)"></path>
        </svg>
        <span class="tab-label">{{ tab.label }}</span>
      </button>
    </div>
  </div>

  <!-- Tab Content -->
  <div class="tab-content">
    <!-- Image Recognition Tab -->
    <div *ngIf="activeTab === 'image-recognition'" class="tab-panel">
      <div class="section-header">
        <h2 class="section-title">AI Image Recognition</h2>
        <p class="section-description">Upload asset images for automatic identification, condition assessment, and intelligent data extraction.</p>
      </div>

      <!-- Asset Image Upload Section -->
      <div class="upload-section">
        <div class="upload-area" (click)="triggerFileInput()" (dragover)="onDragOver($event)" (drop)="onDrop($event)">
          <!-- Upload Placeholder (when no files) -->
          <div class="upload-placeholder" *ngIf="selectedFiles.length === 0">
            <div class="upload-icon">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"></path>
                <circle cx="12" cy="13" r="3"></circle>
            </svg>
          </div>
            <h3 class="upload-title">Upload Asset Image</h3>
            <p class="upload-text">Drag & drop your image here, or click to browse</p>
            <p class="upload-hint">PNG, JPG, JPEG up to 10MB ‚Ä¢ High-quality, well-lit images recommended</p>
        </div>

            <!-- Single Image Preview -->
            <div class="single-image-preview" *ngIf="selectedFiles.length > 0">
              <div class="preview-item">
                <img [src]="getFilePreview(selectedFiles[0])" [alt]="selectedFiles[0].name" class="preview-image">
                <div class="preview-overlay">
                  <button class="remove-preview" (click)="removeFile(0)" title="Remove image">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M18 6L6 18M6 6L18 18"></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            <input #fileInput type="file" accept="image/png,image/jpeg,image/jpg" (change)="onFileSelected($event)" style="display: none;">
          </div>

        <!-- Action Buttons -->
        <div class="upload-actions">
          <button class="btn-secondary" (click)="triggerFileInput()" [disabled]="isAnalyzing">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15M17 8L12 3M12 3L7 8M12 3V15"></path>
            </svg>
            Upload Images
          </button>
          <button class="btn-primary" (click)="analyzeImages()" [disabled]="!selectedFiles.length || isAnalyzing">
            <svg *ngIf="!isAnalyzing" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V15M17 8L12 3M12 3L7 8M12 3V15"></path>
            </svg>
            <svg *ngIf="isAnalyzing" class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12a9 9 0 11-6.219-8.56"></path>
            </svg>
            {{ isAnalyzing ? 'Analyzing...' : 'Analyze Image' }}
          </button>
              </div>

        <!-- Loading Overlay -->
        <div class="loading-overlay" *ngIf="isAnalyzing">
          <div class="loading-content">
            <div class="loading-animation">
              <div class="ai-brain">
                <div class="brain-pulse"></div>
                <div class="brain-pulse delay-1"></div>
                <div class="brain-pulse delay-2"></div>
              </div>
            </div>
            <h3>AI is Analyzing Your Image</h3>
            <p class="loading-description">Our advanced AI is examining your asset image to identify its type, condition, and provide intelligent recommendations.</p>
            <div class="loading-steps">
              <div class="step active">
                <div class="step-icon">üîç</div>
                <span>Scanning image details</span>
              </div>
              <div class="step">
                <div class="step-icon">ü§ñ</div>
                <span>AI processing</span>
              </div>
              <div class="step">
                <div class="step-icon">üìä</div>
                <span>Generating results</span>
              </div>
              </div>
            <div class="loading-tip">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                <path d="M12 17h.01"></path>
              </svg>
              <span>This usually takes 10-30 seconds</span>
            </div>
          </div>
        </div>

        <!-- Error Message -->
        <div class="error-message" *ngIf="errorMessage">
          <p>{{ errorMessage }}</p>
        </div>

        <!-- Recognition Results -->
        <div class="recognition-results" *ngIf="analysisResult">
          <!-- Results Header -->
          <div class="results-header">
            <div class="header-content">
              <div class="header-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M9 12l2 2 4-4"></path>
                  <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"></path>
                  <path d="M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"></path>
                  <path d="M13 12h3a2 2 0 0 1 2 2v1"></path>
                  <path d="M13 12H9"></path>
                  <path d="M9 12H6a2 2 0 0 0-2 2v1"></path>
                </svg>
              </div>
              <div class="header-text">
                <h3>AI Recognition Complete</h3>
                <p>Your asset has been successfully analyzed</p>
              </div>
            </div>
          </div>

          <!-- Main Results Card -->
          <div class="results-card">
            <div class="card-header">
              <div class="asset-type">
                <div class="type-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                    <line x1="8" y1="21" x2="16" y2="21"></line>
                    <line x1="12" y1="17" x2="12" y2="21"></line>
                  </svg>
                </div>
                <div class="type-info">
                  <h4>{{ analysisResult.assetType }}</h4>
                  <span class="confidence-badge confidence-{{ getConfidenceLevel(analysisResult.confidence) }}">
                    {{ analysisResult.confidence }}% Confidence
                  </span>
                </div>
              </div>
            </div>

            <div class="card-content">
              <div class="details-grid">
                <div class="detail-item" *ngIf="analysisResult.manufacturer">
                  <div class="detail-label">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                    Manufacturer
                  </div>
                  <div class="detail-value">{{ analysisResult.manufacturer }}</div>
                </div>

                <div class="detail-item" *ngIf="analysisResult.model">
                  <div class="detail-label">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                      <line x1="8" y1="21" x2="16" y2="21"></line>
                      <line x1="12" y1="17" x2="12" y2="21"></line>
                    </svg>
                    Model
                  </div>
                  <div class="detail-value">{{ analysisResult.model }}</div>
                </div>

                <div class="detail-item" *ngIf="analysisResult.serialNumber">
                  <div class="detail-label">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                      <polyline points="22,6 12,13 2,6"></polyline>
                    </svg>
                    Serial Number
                  </div>
                  <div class="detail-value">{{ analysisResult.serialNumber }}</div>
                </div>

                <div class="detail-item" *ngIf="analysisResult.assetTag">
                  <div class="detail-label">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                      <line x1="7" y1="7" x2="7.01" y2="7"></line>
                    </svg>
                    Asset Tag
                  </div>
                  <div class="detail-value">{{ analysisResult.assetTag }}</div>
                </div>

                <div class="detail-item condition-item" *ngIf="analysisResult.condition">
                  <div class="detail-label">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                      <polyline points="22,4 12,14.01 9,11.01"></polyline>
                    </svg>
                    Condition
                  </div>
                  <div class="detail-value condition-badge condition-{{ analysisResult.condition.toLowerCase() }}">
                    {{ analysisResult.condition }}
                  </div>
                </div>
              </div>

              <div class="description" *ngIf="analysisResult.evidence?.notes">
                <div class="description-content">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14,2 14,8 20,8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                  </svg>
                  <p>{{ analysisResult.evidence.notes }}</p>
            </div>
          </div>
        </div>
      </div>

          <!-- Recommendations Card -->
          <div class="recommendations-card" *ngIf="analysisResult.recommendations && analysisResult.recommendations.length > 0">
            <div class="card-header">
              <div class="header-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                  <line x1="12" y1="9" x2="12" y2="13"></line>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
              </div>
              <div class="header-text">
                <h4>AI Recommendations</h4>
                <p>Based on the analysis, here are our suggestions</p>
              </div>
            </div>
            <div class="recommendations-list">
              <div class="recommendation-item" *ngFor="let rec of analysisResult.recommendations">
                <div class="rec-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20,6 9,17 4,12"></polyline>
                  </svg>
                </div>
                <span>{{ rec }}</span>
              </div>
            </div>
          </div>

          <!-- Feedback Section -->
          <div class="feedback-card" *ngIf="!feedbackSubmitted">
            <div class="card-header">
              <div class="header-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
              </div>
              <div class="header-text">
                <h4>Help Improve AI Recognition</h4>
                <p>Was this recognition accurate? Your feedback helps improve our AI.</p>
              </div>
            </div>

            <div class="feedback-content">
              <div class="feedback-options">
                <button
                  class="feedback-btn accurate"
                  [class.selected]="feedbackType === 'accurate'"
                  (click)="selectFeedback('accurate')">
                  <div class="btn-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M14 9V5a3 3 0 0 0-6 0v4"></path>
                      <rect x="2" y="9" width="20" height="11" rx="2" ry="2"></rect>
                      <path d="M7 13h10"></path>
                    </svg>
                  </div>
                  <div class="btn-text">
                    <span class="btn-title">Accurate</span>
                    <span class="btn-subtitle">Recognition was correct</span>
                  </div>
                </button>

                <button
                  class="feedback-btn needs-correction"
                  [class.selected]="feedbackType === 'needs_correction'"
                  (click)="selectFeedback('needs_correction')">
                  <div class="btn-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0z"></path>
                    </svg>
                  </div>
                  <div class="btn-text">
                    <span class="btn-title">Needs Correction</span>
                    <span class="btn-subtitle">Something was wrong</span>
                  </div>
                </button>
              </div>

              <div class="correction-section" *ngIf="feedbackType === 'needs_correction'">
                <div class="section-header">
                  <h5>What needs to be corrected?</h5>
                  <p>Please specify what was incorrect in the recognition</p>
                </div>
                <div class="corrections-list">
                  <div class="correction-item" *ngFor="let correction of corrections; let i = index">
                    <input
                      type="text"
                      [(ngModel)]="correction.value"
                      placeholder="Enter correction..."
                      class="correction-input">
                    <button
                      type="button"
                      class="remove-correction"
                      (click)="removeCorrection(i)">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                      </svg>
                    </button>
                  </div>
                  <button
                    type="button"
                    class="add-correction"
                    (click)="addCorrection()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Correction
                  </button>
                </div>
              </div>

              <div class="feedback-actions" *ngIf="feedbackType">
                <button
                  class="btn-secondary"
                  (click)="cancelFeedback()">
                  Cancel
                </button>
                <button
                  class="btn-primary"
                  [disabled]="isSubmittingFeedback"
                  (click)="submitFeedback()">
                  <svg *ngIf="isSubmittingFeedback" class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12a9 9 0 11-6.219-8.56"></path>
                  </svg>
                  {{ isSubmittingFeedback ? 'Submitting...' : 'Submit Feedback' }}
                </button>
              </div>
            </div>
          </div>

          <!-- Feedback Success -->
          <div class="success-card" *ngIf="feedbackSubmitted">
            <div class="success-content">
              <div class="success-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22,4 12,14.01 9,11.01"></polyline>
                </svg>
              </div>
              <h4>Thank You!</h4>
              <p>Your feedback has been submitted and will help improve our AI recognition.</p>
            </div>
          </div>

          <!-- Create Asset Button -->
          <div class="create-asset-section">
            <button class="create-asset-btn" (click)="openCreateAssetModal()">
              <div class="btn-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14,2 14,8 20,8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10,9 9,9 8,9"></polyline>
                </svg>
              </div>
              <div class="btn-text">
                <span class="btn-title">Create Asset Record</span>
                <span class="btn-subtitle">Save this recognition as a new asset</span>
              </div>
            </button>
          </div>
        </div>
      </div>

      <!-- Supported Asset Types Section -->
      <div class="supported-assets-section">
        <div class="section-header">
          <h3 class="section-title">Supported Asset Types</h3>
          <p class="section-description">Our AI can recognize and analyze various types of industrial equipment and assets with high accuracy.</p>
        </div>

        <div class="asset-types-grid">
          <div class="asset-type-card" *ngFor="let assetType of assetTypes">
            <div class="asset-icon-wrapper">
            <div class="asset-type-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path [attr.d]="getAssetTypeIcon(assetType.icon)"></path>
              </svg>
            </div>
            </div>
            <div class="asset-type-info">
            <span class="asset-type-name">{{ assetType.name }}</span>
              <span class="asset-type-status">Supported</span>
            </div>
          </div>
        </div>
      </div>

    <!-- Analytics Loading Overlay -->
    <div class="loading-overlay" *ngIf="isAnalyzingAssets">
      <div class="loading-content">
        <div class="loading-spinner">
          <svg class="animate-spin" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-6.219-8.56"></path>
          </svg>
        </div>
        <h3>Analyzing Portfolio...</h3>
        <p>Our AI is analyzing your asset portfolio to provide comprehensive insights and recommendations.</p>
      </div>
    </div>
  </div>

    <!-- Predictive Maintenance Tab -->
    <div *ngIf="activeTab === 'predictive-maintenance'" class="tab-panel">
      <app-predictive-maintenance></app-predictive-maintenance>
    </div>

    <!-- Natural Language Tab -->
    <div *ngIf="activeTab === 'natural-language'" class="tab-panel">
      <app-natural-language></app-natural-language>
    </div>

    <!-- AI Recommendations Tab -->
    <div *ngIf="activeTab === 'recommendations'" class="tab-panel">
      <app-ai-recommendations></app-ai-recommendations>
    </div>

    <!-- AI Analytics Tab -->
    <div *ngIf="activeTab === 'analytics'" class="tab-panel">
      <app-ai-analytics></app-ai-analytics>
    </div>



    <!-- Old Analytics Tab - Removed -->
    <div *ngIf="false" class="tab-panel">
      <div class="section-header">
        <h2 class="section-title">AI Asset Analytics</h2>
        <p class="section-description">Get comprehensive insights into your asset portfolio with AI-powered analysis.</p>
      </div>

      <!-- Asset Selection Section -->
      <div class="analytics-section">
        <div class="section-header">
          <h3>Asset Portfolio</h3>
          <div class="section-actions">
            <button class="btn-secondary" (click)="addSampleAssets()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14M5 12h14"></path>
              </svg>
              Add Sample Assets
            </button>
            <button class="btn-secondary" (click)="clearSelectedAssets()" [disabled]="selectedAssets.length === 0">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
              </svg>
              Clear All
            </button>
          </div>
        </div>

        <!-- Selected Assets List -->
        <div class="selected-assets" *ngIf="selectedAssets.length > 0">
          <div class="asset-card" *ngFor="let asset of selectedAssets">
            <div class="asset-info">
              <h4>{{ asset.name }}</h4>
              <p class="asset-details">{{ asset.type }} ‚Ä¢ {{ asset.manufacturer }} {{ asset.model }}</p>
              <p class="asset-meta">Age: {{ asset.age }} years ‚Ä¢ Condition: {{ asset.condition }} ‚Ä¢ Value: ${{ asset.value | number }}</p>
            </div>
            <div class="asset-status">
              <span class="status-badge" [ngClass]="asset.condition.toLowerCase()">{{ asset.condition }}</span>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="selectedAssets.length === 0">
          <svg class="empty-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <h3>No Assets Selected</h3>
          <p>Add assets to your portfolio to get AI-powered analytics and insights.</p>
        </div>

        <!-- Image Upload Section -->
        <div class="image-upload-section" *ngIf="selectedAssets.length > 0">
          <h4>Asset Images (Optional)</h4>
          <p class="section-description">Upload images of your assets for enhanced analysis. Maximum 5 images.</p>

          <div class="image-upload-area">
            <input
              type="file"
              #analyticsFileInput
              (change)="onAnalyticsFileSelected($event)"
              accept="image/*"
              multiple
              [disabled]="analyticsImages.length >= 5"
              class="file-input">

            <div class="upload-prompt" (click)="analyticsFileInput.click()">
              <svg class="upload-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17,8 12,3 7,8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
              </svg>
              <p>Click to upload images or drag and drop</p>
              <span class="upload-limit">{{ analyticsImages.length }}/5 images</span>
            </div>
          </div>

          <!-- Image Previews -->
          <div class="image-previews" *ngIf="analyticsImages.length > 0">
            <div class="preview-item" *ngFor="let image of analyticsImages; let i = index">
              <img [src]="image" [alt]="'Asset image ' + (i + 1)">
              <button class="remove-image" (click)="removeAnalyticsImage(i)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 6L6 18M6 6L18 18"></path>
                </svg>
              </button>
            </div>
          </div>

          <div class="image-actions" *ngIf="analyticsImages.length > 0">
            <button class="btn-secondary" (click)="clearAnalyticsImages()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
              </svg>
              Clear All Images
            </button>
          </div>
        </div>

        <!-- Analysis Button -->
        <div class="analysis-actions" *ngIf="selectedAssets.length > 0">
          <button
            class="btn-primary"
            (click)="analyzeAssets()"
            [disabled]="isAnalyzingAssets">
            <svg *ngIf="!isAnalyzingAssets" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 19c-5 0-7-2-7-5V6c0-3 2-5 7-5s7 2 7 5v8c0 3-2 5-7 5zM15 13l3 3-3 3"></path>
            </svg>
            <svg *ngIf="isAnalyzingAssets" class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12a9 9 0 11-6.219-8.56"></path>
            </svg>
            {{ isAnalyzingAssets ? 'Analyzing...' : 'Analyze Portfolio' }}
          </button>
        </div>
      </div>

      <!-- Analytics Results -->
      <div class="analytics-results" *ngIf="analyticsResult">
        <div class="results-header">
          <h3>Analytics Results</h3>
        </div>

        <!-- Health Score -->
        <div class="health-score-section">
          <h4>Overall Health Score</h4>
          <div class="health-score-display">
            <div class="score-circle" [ngClass]="getHealthScoreClass(analyticsResult.healthScore)">
              <span class="score-value">{{ analyticsResult.healthScore }}</span>
              <span class="score-label">/ 100</span>
            </div>
            <div class="score-description">
              <p>Portfolio Health Assessment</p>
              <span class="score-status" [ngClass]="getHealthScoreClass(analyticsResult.healthScore)">
                {{ analyticsResult.healthScore >= 80 ? 'Excellent' : analyticsResult.healthScore >= 60 ? 'Good' : analyticsResult.healthScore >= 40 ? 'Fair' : 'Poor' }}
              </span>
            </div>
          </div>
        </div>

        <!-- Risk Assets -->
        <div class="risk-assets-section" *ngIf="analyticsResult.riskAssets.length > 0">
          <h4>High-Risk Assets</h4>
          <div class="risk-assets-list">
            <div class="risk-asset-card" *ngFor="let asset of analyticsResult.riskAssets">
              <div class="risk-info">
                <h5>{{ asset.name }}</h5>
                <p class="risk-reason">{{ asset.reason }}</p>
              </div>
              <div class="risk-meta">
                <span class="risk-level" [ngClass]="getRiskLevelClass(asset.riskLevel)">{{ asset.riskLevel }}</span>
                <span class="confidence">{{ asset.confidence }}% confidence</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Performance Insights -->
        <div class="insights-section" *ngIf="analyticsResult.insights.length > 0">
          <h4>Performance Insights</h4>
          <div class="insights-list">
            <div class="insight-card" *ngFor="let insight of analyticsResult.insights">
              <div class="insight-header">
                <h5>{{ insight.title }}</h5>
                <span class="impact-badge" [ngClass]="getImpactClass(insight.impact)">{{ insight.impact }}</span>
              </div>
              <p class="insight-description">{{ insight.description }}</p>
              <div class="insight-action">
                <strong>Action:</strong> {{ insight.action }}
              </div>
            </div>
          </div>
        </div>

        <!-- Cost Optimizations -->
        <div class="optimizations-section" *ngIf="analyticsResult.optimizations.length > 0">
          <h4>Cost Optimization Opportunities</h4>
          <div class="optimizations-list">
            <div class="optimization-card" *ngFor="let opt of analyticsResult.optimizations">
              <div class="optimization-header">
                <h5>{{ opt.title }}</h5>
                <div class="savings-info">
                  <span class="savings-amount">AED {{ opt.estimatedSavings | number }}</span>
                  <span class="payback-period">{{ opt.paybackPeriod }} payback</span>
                </div>
              </div>
              <p class="optimization-description">{{ opt.description }}</p>
              <div class="optimization-confidence">
                <span class="confidence-label">Confidence:</span>
                <span class="confidence-value">{{ opt.confidence }}%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Error Message -->
      <div class="error-message" *ngIf="errorMessage">
        <p>{{ errorMessage }}</p>
      </div>
    </div>

  <!-- Create Asset Record Modal -->
  <div class="create-asset-modal" *ngIf="showCreateAssetModal">
    <div class="modal-overlay" (click)="closeCreateAssetModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">
          <div class="title-icon">
            <svg class="modal-icon" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14,2 14,8 20,8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10,9 9,9 8,9"></polyline>
            </svg>
          </div>
          <div class="title-content">
            <h2>Create Asset Record</h2>
            <p>Add a new asset to your inventory with detailed information</p>
          </div>
        </div>
        <button class="close-modal" (click)="closeCreateAssetModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6L18 18"></path>
          </svg>
        </button>
      </div>

      <div class="modal-body">
        <p class="modal-subtitle">Complete the asset details based on AI recognition</p>

        <form class="asset-form">
          <div class="form-container">
            <div class="form-column">
              <div class="form-row">
                <div class="form-group" [class.error]="hasFieldError('name')">
                  <label>Asset Name <span class="required">*</span></label>
                  <input
                    type="text"
                    [(ngModel)]="assetForm.name"
                    name="name"
                    placeholder="Enter asset name"
                    [class.error-input]="hasFieldError('name')">
                  <div class="field-error" *ngIf="hasFieldError('name')">
                    {{ getFieldError('name') }}
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group" [class.error]="hasFieldError('model')">
                  <label>Model</label>
                  <input
                    type="text"
                    [(ngModel)]="assetForm.model"
                    name="model"
                    placeholder="Enter model"
                    [class.error-input]="hasFieldError('model')">
                  <div class="field-error" *ngIf="hasFieldError('model')">
                    {{ getFieldError('model') }}
                  </div>
                </div>
              </div>

              <div class="form-row full-width">
                <div class="form-group" [class.error]="hasFieldError('description')">
                  <label>Description</label>
                  <textarea
                    [(ngModel)]="assetForm.description"
                    name="description"
                    placeholder="Enter description"
                    [class.error-input]="hasFieldError('description')"></textarea>
                  <div class="field-error" *ngIf="hasFieldError('description')">
                    {{ getFieldError('description') }}
                  </div>
                </div>
              </div>
            </div>

            <div class="form-column">
              <div class="form-row">
                <div class="form-group" [class.error]="hasFieldError('manufacturer')">
                  <label>Manufacturer</label>
                  <input
                    type="text"
                    [(ngModel)]="assetForm.manufacturer"
                    name="manufacturer"
                    placeholder="Enter manufacturer"
                    [class.error-input]="hasFieldError('manufacturer')">
                  <div class="field-error" *ngIf="hasFieldError('manufacturer')">
                    {{ getFieldError('manufacturer') }}
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group" [class.error]="hasFieldError('serialNumber')">
                  <label>Serial Number</label>
                  <input
                    type="text"
                    [(ngModel)]="assetForm.serialNumber"
                    name="serialNumber"
                    placeholder="Enter serial number"
                    [class.error-input]="hasFieldError('serialNumber')">
                  <div class="field-error" *ngIf="hasFieldError('serialNumber')">
                    {{ getFieldError('serialNumber') }}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row full-width">
            <div class="form-group" [class.error]="hasFieldError('location')">
              <label>Asset Location <span class="required">*</span></label>

              <div class="relative generic-dropdown" (click)="$event.stopPropagation()">
                <button
                  type="button"
                  (click)="toggleLocationDropdown()"
                  class="dropdown-button"
                  [class.error]="hasFieldError('location')"
                  [class.active]="showLocationDropdown"
                  [disabled]="loadingLocations">
                  <div class="dropdown-content">
                    <span *ngIf="!selectedLocation" class="placeholder">
                      {{ loadingLocations ? 'Loading locations...' : 'Select a location' }}
                    </span>

                    <div *ngIf="selectedLocation" class="selected-item">
                      <div class="item-icon">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                      </div>
                      <span class="selected-text">{{ selectedLocation.name }}</span>
                    </div>

                    <svg class="dropdown-arrow" [class.rotated]="showLocationDropdown" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                  </div>
                </button>

                <div *ngIf="showLocationDropdown" class="dropdown-menu">
                  <div class="dropdown-header">Select location</div>

                  <button
                    *ngFor="let location of locations"
                    type="button"
                    (click)="selectLocation(location)"
                    class="dropdown-item"
                    [class.selected]="selectedLocation?.id === location.id">
                    <div class="item-content">
                      <div class="item-icon">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                      </div>
                      <div class="item-details">
                        <div class="item-name">{{ location.name }}</div>
                        <div class="item-description">{{ getLocationDescription(location) }}</div>
                      </div>
                    </div>
                  </button>
                </div>
              </div>

              <div class="field-error" *ngIf="hasFieldError('location')">
                {{ getFieldError('location') }}
              </div>
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeCreateAssetModal()" [disabled]="isCreatingAsset">
          Cancel
        </button>
        <button
          class="btn-primary"
          (click)="createAsset()"
          [disabled]="isCreatingAsset || !assetForm.name.trim()">
          <svg *ngIf="!isCreatingAsset" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <svg *ngIf="isCreatingAsset" class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-6.219-8.56"></path>
          </svg>
          {{ isCreatingAsset ? 'Creating...' : 'Create Asset' }}
        </button>
      </div>
    </div>
  </div>
</div>
</div>
