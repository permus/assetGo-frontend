<div class="min-h-screen bg-gray-50 text-gray-900 p-6">
  <h1 class="text-xl font-semibold mb-2">Maintenance History</h1>
  <p class="text-sm text-gray-500 mb-6">Track completed maintenance activities and their outcomes</p>

  <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 metrics-grid">
    <div class="metric-card info">
      <div class="metric-header">
        <div class="title">Total Activities</div>
        <div class="badge">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
               stroke="currentColor" class="size-5">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"/>
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.867 19.125h.008v.008h-.008v-.008Z"/>
          </svg>

        </div>
      </div>
      <div class="value">{{ stats.totalActivities }}</div>
      <div class="hint"><a class="link" href="javascript:void(0)">Items completed</a></div>
    </div>
    <div class="metric-card success">
      <div class="metric-header">
        <div class="title">Preventive</div>
        <div class="badge">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
               stroke="currentColor" class="size-5 text-green-600">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"/>
          </svg>

        </div>
      </div>
      <div class="value">{{ stats.preventive }}</div>
      <div class="hint text-green-600">{{ stats.preventivePercentage }}% of total</div>
    </div>
    <div class="metric-card warning">
      <div class="metric-header">
        <div class="title">Total Cost</div>
        <div class="badge">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
               stroke="currentColor" class="size-5">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
          </svg>
        </div>
      </div>
      <div class="value">{{ formatCurrency(stats.totalCost) }}</div>
      <div class="hint text-orange-600">Year to date</div>
    </div>
    <div class="metric-card danger">
      <div class="metric-header">
        <div class="title">Avg Duration</div>
        <div class="badge">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
               class="size-5 text-red-600">
            <line x1="10" x2="14" y1="2" y2="2"/>
            <line x1="12" x2="15" y1="14" y2="11"/>
            <circle cx="12" cy="14" r="8"/>
          </svg>
        </div>
      </div>
      <div class="value">{{ formatDuration(stats.avgDuration) }}</div>
      <div class="hint text-red-600">Per activity</div>
    </div>
  </div>

  <div class="search-row mb-4">
    <div class="form-row">
      <div class="form-group">
        <label>Search maintenance history</label>
        <input type="text"
               class="w-full pl-10 pr-4 py-2 border-2 transition-all duration-300 ease-in-out border-blue-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent placeholder-gray-400"
               [(ngModel)]="search" placeholder="Search by plan, status..." (input)="apply()"/>
      </div>
    </div>
    <div class="pill-group">
      <button class="pill" [class.active]="filter==='all'" (click)="filter='all'; apply()">All</button>
      <button class="pill" [class.active]="filter==='preventive'" (click)="filter='preventive'; apply()">Preventive
      </button>
      <button class="pill" [class.active]="filter==='predictive'" (click)="filter='predictive'; apply()">Predictive
      </button>
      <button class="pill" [class.active]="filter==='condition_based'" (click)="filter='condition_based'; apply()">Condition Based
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="text-center py-20">Loading...</div>
  <div *ngIf="!loading && filtered.length===0"
       class="text-center py-20 text-gray-500 bg-white border border-gray-200 rounded-xl">
    <div class="mb-4 flex items-center justify-center">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
           class="size-10">
        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
        <path d="M3 3v5h5"/>
        <path d="M12 7v5l4 2"/>
      </svg>
    </div>
    <div class="text-lg font-medium">No maintenance history found</div>
    <div class="text-sm text-gray-500">Maintenance activities will appear here as they are completed.</div>
  </div>

  <div *ngIf="!loading && filtered.length>0" class="bg-white border border-gray-200 rounded-xl">
    <div class="divide-y divide-gray-200">
      <div class="px-6 py-4" *ngFor="let h of filtered">
        <div class="flex items-center justify-between">
          <div>
            <div class="font-medium text-gray-900">Plan #{{ h.maintenance_plan_id }} {{h.plan_name}}</div>
            <div class="text-xs text-gray-500">Completed â€¢ {{h.updated_at | date:'medium'}}</div>
          </div>
          <div class="text-sm text-gray-700">Priority: {{ h.priority.name || h.priority_id || '-' }}</div>
        </div>
      </div>
    </div>
  </div>
</div>


