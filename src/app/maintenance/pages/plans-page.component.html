<div class="plans-page">
  <div class="section-header">
    <div>
      <h3>Maintenance Plans</h3>
      <p>Create and manage preventive maintenance templates</p>
    </div>
    <div class="actions">
      <button class="btn btn-primary" (click)="openDialog()">+ Create Plan</button>
    </div>
  </div>

  <!-- Summary Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
    <!-- Total Assets -->
    <div class="rounded-xl bg-blue-50 border border-blue-100 p-6 flex flex-col justify-between shadow-sm transition-all hover:shadow-md">
      <div class="flex items-center justify-between mb-2">
        <span class="text-base font-medium text-gray-700">Total Plans</span>
        <span class="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center">
          <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
          </svg>
        </span>
      </div>
      <div class="text-3xl font-bold text-gray-900">{{ store.totalPlans() }}</div>
    </div>
    <!-- Active Assets -->
    <div class="rounded-xl bg-green-50 border border-green-100 p-6 flex flex-col justify-between shadow-sm transition-all hover:shadow-md">
      <div class="flex items-center justify-between mb-2">
        <span class="text-base font-medium text-gray-700">Active Plans</span>
        <span class="w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center">
          <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="2" fill="none" />
            <circle cx="12" cy="12" r="4" fill="currentColor" class="text-green-400" />
          </svg>
        </span>
      </div>
      <div class="text-3xl font-bold text-gray-900">{{store.meta()?.active_plans_count ?? store.activePlans()}}</div>
    </div>
    <!-- Maintenance -->
    <div class="rounded-xl bg-orange-50 border border-orange-100 p-6 flex flex-col justify-between shadow-sm transition-all hover:shadow-md">
      <div class="flex items-center justify-between mb-2">
        <span class="text-base font-medium text-gray-700">Scheduled Items</span>
        <span class="w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center">
          <svg class="w-6 h-6 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-1.5a2.5 2.5 0 11-3.536 3.536l-7.5 7.5a2 2 0 102.828 2.828l7.5-7.5a2.5 2.5 0 013.536-3.536z" />
          </svg>
        </span>
      </div>
      <div class="text-3xl font-bold text-gray-900">{{store.scheduledItems()}}</div>
    </div>
    <!-- Total Value -->
    <div class="rounded-xl bg-red-50 border border-red-100 p-6 flex flex-col justify-between shadow-sm transition-all hover:shadow-md">
      <div class="flex items-center justify-between mb-2">
        <span class="text-base font-medium text-gray-700">Critical Plans</span>
        <span class="w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center">
          <svg class="w-6 h-6 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
          </svg>
        </span>
      </div>
      <div class="text-3xl font-bold text-gray-900">{{store.criticalPlans()}}</div>
    </div>
  </div>

  <div *ngIf="store.loading()" class="skeletons">
    <app-plan-card-skeleton *ngFor="let i of [0,1,2]"></app-plan-card-skeleton>
  </div>

  <div *ngIf="!store.loading() && store.totalPlans()===0" class="empty-state">
    <div class="icon"></div>
    <div class="title">No maintenance plans found</div>
    <div class="subtitle">Create your first maintenance plan to get started with preventive maintenance.</div>
    <button class="btn btn-primary" (click)="openDialog()">+ Create Your First Plan</button>
  </div>

  <div *ngIf="!store.loading() && store.totalPlans()>0" class="cards-grid">
    <div class="plan-card" *ngFor="let p of store.plans()">
      <div class="card-title">{{p.name}}</div>
      <div class="card-subtitle">Type: {{p.plan_type}} · Priority: {{p.priority_id || '-'}} · Active: {{p.is_active? 'Yes':'No'}}</div>
      <div class="card-meta">Scheduled: {{p.scheduled_count || 0}}</div>
    </div>
  </div>

  <app-plan-dialog [isOpen]="isDialogOpen" (closed)="isDialogOpen=false" (created)="onCreated()"></app-plan-dialog>
</div>



