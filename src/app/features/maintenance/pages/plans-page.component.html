<div class="plans-page">
  <div class="section-header">
    <div>
      <h3>Maintenance Plans</h3>
      <p>Create and manage preventive maintenance templates</p>
    </div>
    <div class="actions">
      <button class="btn">Bulk Schedule</button>
      <button class="btn btn-primary" (click)="openDialog()">+ Create Plan</button>
    </div>
  </div>

  <div class="metrics-grid">
    <div class="metric-card">
      <div class="label">Total Plans</div>
      <div class="value">{{store.totalPlans()}}</div>
      <div class="icon gear"></div>
    </div>
    <div class="metric-card">
      <div class="label">Active Plans</div>
      <div class="value success">{{store.meta()?.active_plans_count ?? store.activePlans()}}</div>
      <div class="icon check"></div>
    </div>
    <div class="metric-card">
      <div class="label">Scheduled Items</div>
      <div class="value">{{store.scheduledItems()}}</div>
      <div class="icon calendar"></div>
    </div>
    <div class="metric-card">
      <div class="label">Critical Plans</div>
      <div class="value danger">{{store.criticalPlans()}}</div>
      <div class="icon alert"></div>
    </div>
  </div>

  <div *ngIf="store.loading()" class="skeletons">
    <app-plan-card-skeleton *ngFor="let i of [0,1,2]"></app-plan-card-skeleton>
  </div>

  <div *ngIf="!store.loading() && store.totalPlans()===0" class="empty-state">
    <div class="icon"></div>
    <div class="title">No maintenance plans found</div>
    <div class="subtitle">Create your first maintenance plan to get started with preventive maintenance.</div>
    <button class="btn btn-primary" (click)="openDialog()">+ Create Your First Plan</button>
  </div>

  <div *ngIf="!store.loading() && store.totalPlans()>0" class="cards-grid">
    <div class="plan-card" *ngFor="let p of store.plans()">
      <div class="card-title">{{p.name}}</div>
      <div class="card-subtitle">Type: {{p.plan_type}} · Priority: {{p.priority_id || '-'}} · Active: {{p.is_active? 'Yes':'No'}}</div>
      <div class="card-meta">Scheduled: {{p.scheduled_count || 0}}</div>
    </div>
  </div>

  <app-plan-dialog [isOpen]="isDialogOpen" (closed)="isDialogOpen=false" (created)="onCreated()"></app-plan-dialog>
</div>



