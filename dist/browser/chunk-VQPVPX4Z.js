import{a as te}from"./chunk-5S6YH7S2.js";import{a as V}from"./chunk-GVXPQDBC.js";import{B as R,b as G,c as q,e as U,f as Y,g as J,i as K,j as Q,k as X,w as Z,x as ee}from"./chunk-UQACUQIP.js";import{a as $}from"./chunk-MEXLA3FU.js";import{a as N,b as B}from"./chunk-YGU4T3V7.js";import{k as D,l as T,x as E}from"./chunk-HV2J6S7U.js";import{Gb as n,Hb as i,Ib as f,Mb as b,Pb as u,Qb as c,Y as I,Ya as s,ba as W,bb as w,bc as l,cc as O,dc as h,gc as P,hc as v,ia as z,ic as x,ja as g,ka as m,kb as k,la as C,ma as M,pb as _,ta as H,wb as p,yb as j,za as y}from"./chunk-RHVXZUNF.js";import{a as A,b as F}from"./chunk-EQDQRRRY.js";var S=class r{constructor(t){this.http=t}base=`${$.apiUrl}/sla`;listDefinitions(t){let e=new N;return t&&Object.keys(t).forEach(a=>{t[a]!==void 0&&t[a]!==null&&(e=e.set(a,String(t[a])))}),this.http.get(`${this.base}/definitions`,{params:e})}getDefinition(t){return this.http.get(`${this.base}/definitions/${t}`)}createDefinition(t){return this.http.post(`${this.base}/definitions`,t)}updateDefinition(t,e){return this.http.put(`${this.base}/definitions/${t}`,e)}deleteDefinition(t){return this.http.delete(`${this.base}/definitions/${t}`)}toggleActive(t){return this.http.patch(`${this.base}/definitions/${t}/toggle-active`,{})}static \u0275fac=function(e){return new(e||r)(W(B))};static \u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"})};function se(r,t){if(r&1){let e=b();n(0,"button",41),u("click",function(){let o=g(e).$implicit,d=c(3);return m(d.selectAppliesTo(o.value))}),l(1),i()}if(r&2){let e=t.$implicit;s(),h(" ",e.label," ")}}function ce(r,t){if(r&1&&(n(0,"div",39),_(1,se,2,1,"button",40),i()),r&2){let e=c(2);s(),p("ngForOf",e.appliesToOptions)}}function de(r,t){if(r&1){let e=b();n(0,"button",41),u("click",function(){let o=g(e).$implicit,d=c(3);return m(d.selectPriority(o.value))}),l(1),i()}if(r&2){let e=t.$implicit;s(),h(" ",e.label," ")}}function ge(r,t){if(r&1){let e=b();n(0,"div",39)(1,"button",41),u("click",function(){g(e);let o=c(2);return m(o.selectPriority(null))}),l(2," None "),i(),_(3,de,2,1,"button",40),i()}if(r&2){let e=c(2);s(3),p("ngForOf",e.priorityOptions)}}function me(r,t){if(r&1){let e=b();n(0,"label",42)(1,"input",43),u("change",function(){let o=g(e).$implicit,d=c(2);return m(d.toggleWorkingDay(o.value))}),i(),n(2,"span"),l(3),i()()}if(r&2){let e=t.$implicit,a=c(2);s(),p("checked",a.isWorkingDaySelected(e.value)),s(2),O(e.label)}}function pe(r,t){r&1&&(n(0,"span"),l(1,"Saving..."),i())}function ue(r,t){if(r&1&&(n(0,"span"),l(1),i()),r&2){let e=c(2);s(),h("",e.editMode?"Update":"Create"," SLA Rule")}}function _e(r,t){if(r&1){let e=b();n(0,"div",1),u("click",function(){g(e);let o=c();return m(o.close())}),n(1,"div",2),u("click",function(o){return g(e),m(o.stopPropagation())}),n(2,"div",3)(3,"div")(4,"h2",4),l(5),i(),n(6,"p",5),l(7,"Define service level agreement rules for work orders and maintenance tasks."),i()(),n(8,"button",6),u("click",function(){g(e);let o=c();return m(o.close())}),C(),n(9,"svg",7),f(10,"line",8)(11,"line",9),i()()(),M(),n(12,"div",10)(13,"form",11),u("ngSubmit",function(){g(e);let o=c();return m(o.submit())}),n(14,"div",12)(15,"h3",13),l(16,"Basic Information"),i(),n(17,"div",14)(18,"label",15),l(19,"SLA Rule Name"),i(),n(20,"input",16),x("ngModelChange",function(o){g(e);let d=c();return v(d.model.name,o)||(d.model.name=o),m(o)}),i()(),n(21,"div",14)(22,"label",15),l(23,"Description"),i(),n(24,"textarea",17),x("ngModelChange",function(o){g(e);let d=c();return v(d.model.description,o)||(d.model.description=o),m(o)}),i()()(),n(25,"div",12)(26,"h3",13),l(27,"Applies To"),i(),n(28,"div",18)(29,"div",14)(30,"label",15),l(31,"Applies To"),i(),n(32,"div",19)(33,"button",20),u("click",function(){g(e);let o=c();return m(o.showAppliesToDropdown=!o.showAppliesToDropdown)}),l(34),C(),n(35,"svg",21),f(36,"polyline",22),i()(),_(37,ce,2,1,"div",23),i()(),M(),n(38,"div",14)(39,"label",15),l(40,"Priority Level (Optional)"),i(),n(41,"div",19)(42,"button",20),u("click",function(){g(e);let o=c();return m(o.showPriorityDropdown=!o.showPriorityDropdown)}),l(43),C(),n(44,"svg",21),f(45,"polyline",22),i()(),_(46,ge,4,1,"div",23),i()()(),M(),n(47,"div",14)(48,"label",15),l(49,"Category (Optional)"),i(),n(50,"input",24),x("ngModelChange",function(o){g(e);let d=c();return v(d.model.category,o)||(d.model.category=o),m(o)}),i()()(),n(51,"div",12)(52,"h3",13),l(53,"Time Thresholds"),i(),n(54,"div",18)(55,"div",14)(56,"label",15),l(57,"Response Time (hours)"),i(),n(58,"input",25),x("ngModelChange",function(o){g(e);let d=c();return v(d.model.responseTimeHours,o)||(d.model.responseTimeHours=o),m(o)}),i()(),n(59,"div",14)(60,"label",15),l(61,"Containment Time (hours)"),i(),n(62,"input",26),x("ngModelChange",function(o){g(e);let d=c();return v(d.model.containmentTimeHours,o)||(d.model.containmentTimeHours=o),m(o)}),i()(),n(63,"div",14)(64,"label",15),l(65,"Completion Time (hours)"),i(),n(66,"input",27),x("ngModelChange",function(o){g(e);let d=c();return v(d.model.completionTimeHours,o)||(d.model.completionTimeHours=o),m(o)}),i()()()(),n(67,"div",12)(68,"h3",13),l(69,"Working Schedule"),i(),n(70,"div",14)(71,"div",28)(72,"div")(73,"label",15),l(74,"Business Hours Only"),i(),n(75,"p",29),l(76,"SLA timers will pause outside business hours"),i()(),n(77,"label",30)(78,"input",31),x("ngModelChange",function(o){g(e);let d=c();return v(d.model.businessHoursOnly,o)||(d.model.businessHoursOnly=o),m(o)}),i(),f(79,"span",32),i()()(),n(80,"div",14)(81,"label",15),l(82,"Working Days"),i(),n(83,"div",33),_(84,me,4,2,"label",34),i()()(),n(85,"div",35)(86,"button",36),u("click",function(){g(e);let o=c();return m(o.close())}),l(87,"Cancel"),i(),n(88,"button",37),_(89,pe,2,0,"span",38)(90,ue,2,1,"span",38),i()()()()()()}if(r&2){let e=c();s(5),h("",e.editMode?"Edit":"Create"," SLA Rule"),s(15),P("ngModel",e.model.name),s(4),P("ngModel",e.model.description),s(10),h(" ",e.getAppliesToLabel()," "),s(3),p("ngIf",e.showAppliesToDropdown),s(6),h(" ",e.getPriorityLabel()," "),s(3),p("ngIf",e.showPriorityDropdown),s(4),P("ngModel",e.model.category),s(8),P("ngModel",e.model.responseTimeHours),s(4),P("ngModel",e.model.containmentTimeHours),s(4),P("ngModel",e.model.completionTimeHours),s(12),P("ngModel",e.model.businessHoursOnly),s(6),p("ngForOf",e.workingDaysOptions),s(4),p("disabled",e.loading),s(),p("ngIf",e.loading),s(),p("ngIf",!e.loading)}}var L=class r{constructor(t,e){this.slaService=t;this.toast=e}isOpen=!1;editMode=!1;definition=null;closed=new H;saved=new H;loading=!1;submitted=!1;model={name:"",description:"",appliesTo:"work_orders",priorityLevel:null,category:"",responseTimeHours:4,containmentTimeHours:null,completionTimeHours:24,businessHoursOnly:!1,workingDays:["monday","tuesday","wednesday","thursday","friday"],isActive:!0};showAppliesToDropdown=!1;showPriorityDropdown=!1;appliesToOptions=[{value:"work_orders",label:"Work Orders"},{value:"maintenance",label:"Maintenance Tasks"},{value:"both",label:"Both"}];priorityOptions=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"},{value:"ppm",label:"PPM"}];workingDaysOptions=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}];ngOnInit(){this.editMode&&this.definition&&this.loadDefinition()}ngOnChanges(t){t.definition&&this.editMode&&this.definition&&this.loadDefinition()}loadDefinition(){this.definition&&(this.model={name:this.definition.name,description:this.definition.description||"",appliesTo:this.definition.appliesTo,priorityLevel:this.definition.priorityLevel||null,category:this.definition.category||"",responseTimeHours:this.definition.responseTimeHours,containmentTimeHours:this.definition.containmentTimeHours||null,completionTimeHours:this.definition.completionTimeHours,businessHoursOnly:this.definition.businessHoursOnly,workingDays:[...this.definition.workingDays||[]],isActive:this.definition.isActive})}close(){this.isOpen=!1,this.submitted=!1,this.resetForm(),this.closed.emit()}resetForm(){this.model={name:"",description:"",appliesTo:"work_orders",priorityLevel:null,category:"",responseTimeHours:4,containmentTimeHours:null,completionTimeHours:24,businessHoursOnly:!1,workingDays:["monday","tuesday","wednesday","thursday","friday"],isActive:!0},this.showAppliesToDropdown=!1,this.showPriorityDropdown=!1}toggleWorkingDay(t){let e=this.model.workingDays?.indexOf(t);e===void 0||e===-1?this.model.workingDays=[...this.model.workingDays||[],t]:this.model.workingDays=this.model.workingDays?.filter(a=>a!==t)}isWorkingDaySelected(t){return this.model.workingDays?.includes(t)||!1}getAppliesToLabel(){return this.appliesToOptions.find(t=>t.value===this.model.appliesTo)?.label||"Select"}getPriorityLabel(){return this.model.priorityLevel?this.priorityOptions.find(t=>t.value===this.model.priorityLevel)?.label||"":"Select priority level"}selectAppliesTo(t){this.model.appliesTo=t,this.showAppliesToDropdown=!1}selectPriority(t){this.model.priorityLevel=t,this.showPriorityDropdown=!1}submit(){if(this.submitted=!0,!this.model.name||!this.model.appliesTo||!this.model.responseTimeHours||!this.model.completionTimeHours||!this.model.workingDays?.length)return;this.loading=!0;let t={name:this.model.name,description:this.model.description||null,applies_to:this.model.appliesTo,priority_level:this.model.priorityLevel||null,category:this.model.category||null,response_time_hours:this.model.responseTimeHours,containment_time_hours:this.model.containmentTimeHours||null,completion_time_hours:this.model.completionTimeHours,business_hours_only:this.model.businessHoursOnly||!1,working_days:this.model.workingDays,is_active:this.model.isActive!==!1};(this.editMode&&this.definition?.id?this.slaService.updateDefinition(this.definition.id,t):this.slaService.createDefinition(t)).subscribe({next:a=>{a.success&&(this.toast.success(`SLA rule ${this.editMode?"updated":"created"} successfully`),this.close(),this.saved.emit()),this.loading=!1},error:a=>{console.error("Failed to save SLA definition:",a),this.toast.error(a.error?.message||`Failed to ${this.editMode?"update":"create"} SLA rule`),this.loading=!1}})}static \u0275fac=function(e){return new(e||r)(w(S),w(V))};static \u0275cmp=k({type:r,selectors:[["app-sla-rule-form-dialog"]],inputs:{isOpen:"isOpen",editMode:"editMode",definition:"definition"},outputs:{closed:"closed",saved:"saved"},features:[z],decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"modal-subtitle"],["type","button",1,"close-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-section"],[1,"section-title"],[1,"form-group"],[1,"form-label"],["type","text","name","name","placeholder","e.g., Critical Equipment Response","required","",1,"form-input",3,"ngModelChange","ngModel"],["name","description","placeholder","Optional description of this SLA rule","rows","3",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"form-row"],[1,"dropdown-container"],["type","button",1,"dropdown-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["points","6 9 12 15 18 9"],["class","dropdown-menu",4,"ngIf"],["type","text","name","category","placeholder","e.g., HVAC, Electrical, Plumbing",1,"form-input",3,"ngModelChange","ngModel"],["type","number","name","responseTimeHours","step","0.01","min","0.01","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","number","name","containmentTimeHours","step","0.01","min","0.01","placeholder","Optional",1,"form-input",3,"ngModelChange","ngModel"],["type","number","name","completionTimeHours","step","0.01","min","0.01","required","",1,"form-input",3,"ngModelChange","ngModel"],[1,"toggle-group"],[1,"form-hint"],[1,"toggle-switch"],["type","checkbox","name","businessHoursOnly",3,"ngModelChange","ngModel"],[1,"slider"],[1,"working-days-grid"],["class","checkbox-label",4,"ngFor","ngForOf"],[1,"modal-actions"],["type","button",1,"btn-cancel",3,"click"],["type","submit",1,"btn-submit",3,"disabled"],[4,"ngIf"],[1,"dropdown-menu"],["type","button","class","dropdown-item",3,"click",4,"ngFor","ngForOf"],["type","button",1,"dropdown-item",3,"click"],[1,"checkbox-label"],["type","checkbox",3,"change","checked"]],template:function(e,a){e&1&&_(0,_e,91,16,"div",0),e&2&&p("ngIf",a.isOpen)},dependencies:[E,D,T,R,Q,q,X,G,U,Y,ee,Z,K,J],styles:['.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:.75rem;width:100%;max-width:600px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 25px -5px #0000001a}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:1.5rem;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0 0 .25rem;color:#1f2937}.modal-header[_ngcontent-%COMP%]   .modal-subtitle[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.25rem;color:#6b7280;display:flex;align-items:center;justify-content:center}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#1f2937}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem}.form-section[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin:0 0 1rem;color:#1f2937}.form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.5rem}.form-group[_ngcontent-%COMP%]   .form-hint[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin:.25rem 0 0}.form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]{width:100%;padding:.625rem .75rem;border:1px solid #d1d5db;border-radius:.5rem;font-size:.875rem;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]{resize:vertical}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.dropdown-container[_ngcontent-%COMP%]{position:relative}.dropdown-container[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]{width:100%;padding:.625rem .75rem;border:1px solid #d1d5db;border-radius:.5rem;background:#fff;font-size:.875rem;text-align:left;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:border-color .2s}.dropdown-container[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;margin-top:.25rem;background:#fff;border:1px solid #d1d5db;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;z-index:10;max-height:200px;overflow-y:auto}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{width:100%;padding:.625rem .75rem;background:none;border:none;text-align:left;cursor:pointer;font-size:.875rem;color:#374151;transition:background-color .2s}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:first-child{border-radius:.5rem .5rem 0 0}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:last-child{border-radius:0 0 .5rem .5rem}.toggle-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:44px;height:24px}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2563eb}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.working-days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem;margin-top:.5rem}.working-days-grid[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.875rem;color:#374151}.working-days-grid[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid #e5e7eb}.modal-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{padding:.625rem 1.25rem;background:#fff;border:1px solid #d1d5db;border-radius:.5rem;font-weight:500;color:#374151;cursor:pointer;transition:all .2s}.modal-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.modal-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{padding:.625rem 1.25rem;background-color:#2563eb;color:#fff;border:none;border-radius:.5rem;font-weight:500;cursor:pointer;transition:background-color .2s}.modal-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8}.modal-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}']})};function fe(r,t){if(r&1&&(n(0,"p",45),l(1),i()),r&2){let e=c().$implicit;s(),O(e.description)}}function Ce(r,t){if(r&1){let e=b();n(0,"div",46)(1,"button",47),u("click",function(){g(e);let o=c().$implicit,d=c(2);return d.openEditDialog(o),m(d.closeMenu(o.id))}),C(),n(2,"svg",5),f(3,"path",48)(4,"path",49),i(),l(5," Edit "),i(),M(),n(6,"button",50),u("click",function(){g(e);let o=c().$implicit,d=c(2);return d.deleteDefinition(o),m(d.closeMenu(o.id))}),C(),n(7,"svg",5),f(8,"polyline",51)(9,"path",52),i(),l(10," Delete "),i()()}}function he(r,t){if(r&1&&(n(0,"span",53),l(1),i()),r&2){let e=c().$implicit,a=c(2);j("critical",e.priorityLevel==="critical"),s(),h(" ",a.getPriorityLabel(e.priorityLevel).toUpperCase()," ")}}function Me(r,t){if(r&1&&(n(0,"div",37),C(),n(1,"svg",5),f(2,"circle",38)(3,"polyline",39),i(),M(),n(4,"span"),l(5),i()()),r&2){let e=c().$implicit;s(5),h("Containment: ",e.containmentTimeHours,"h")}}function be(r,t){if(r&1){let e=b();n(0,"div",14)(1,"div",15)(2,"div",16)(3,"h3",17),l(4),i(),_(5,fe,2,1,"p",18),i(),n(6,"div",19)(7,"div",20)(8,"span",21),l(9,"Active"),i(),n(10,"label",22)(11,"input",23),u("change",function(){let o=g(e).$implicit,d=c(2);return m(d.toggleActive(o))}),i(),f(12,"span",24),i()(),n(13,"div",25)(14,"button",26),u("click",function(){let o=g(e).$implicit,d=c(2);return m(d.toggleMenu(o.id))})("clickOutside",function(){let o=g(e).$implicit,d=c(2);return m(d.closeMenu(o.id))}),C(),n(15,"svg",27),f(16,"circle",28)(17,"circle",29)(18,"circle",30),i()(),_(19,Ce,11,0,"div",31),i()()(),M(),n(20,"div",32)(21,"div",33)(22,"span",34),l(23),i(),_(24,he,2,3,"span",35),i(),n(25,"div",36)(26,"div",37),C(),n(27,"svg",5),f(28,"circle",38)(29,"polyline",39),i(),M(),n(30,"span"),l(31),i()(),_(32,Me,6,1,"div",40),n(33,"div",37),C(),n(34,"svg",5),f(35,"circle",38)(36,"polyline",39),i(),M(),n(37,"span"),l(38),i()()(),n(39,"div",41)(40,"div",42)(41,"span",43),l(42,"Business hours:"),i(),n(43,"span",44),l(44),i()(),n(45,"div",42)(46,"span",43),l(47,"Working days:"),i(),n(48,"span",44),l(49),i()()()()()}if(r&2){let e=t.$implicit,a=c(2);s(4),O(e.name),s(),p("ngIf",e.description),s(6),p("checked",e.isActive),s(8),p("ngIf",a.menuOpen()[e.id]),s(4),O(a.getAppliesToLabel(e.appliesTo)),s(),p("ngIf",e.priorityLevel),s(7),h("Response: ",e.responseTimeHours,"h"),s(),p("ngIf",e.containmentTimeHours),s(6),h("Completion: ",e.completionTimeHours,"h"),s(6),O(e.businessHoursOnly?"Yes":"No"),s(5),O(a.formatWorkingDays(e.workingDays))}}function Oe(r,t){r&1&&(n(0,"div",54)(1,"p"),l(2,"No SLA definitions found. Create your first SLA rule to get started."),i()())}function Pe(r,t){if(r&1&&(n(0,"div",11),_(1,be,50,11,"div",12)(2,Oe,3,0,"div",13),i()),r&2){let e=c();s(),p("ngForOf",e.definitions()),s(),p("ngIf",e.definitions().length===0)}}function ve(r,t){r&1&&(n(0,"div",55)(1,"p"),l(2,"Loading SLA definitions..."),i()())}function xe(r,t){if(r&1){let e=b();n(0,"app-sla-rule-form-dialog",56),u("closed",function(){g(e);let o=c();return m(o.onDialogClosed())})("saved",function(){g(e);let o=c();return m(o.onSaved())}),i()}if(r&2){let e=c();p("isOpen",e.isDialogOpen())("editMode",e.editMode())("definition",e.definitionToEdit())}}var oe=class r{constructor(t,e){this.slaService=t;this.toast=e}definitions=y([]);loading=y(!1);isDialogOpen=y(!1);editMode=y(!1);definitionToEdit=y(null);menuOpen=y({});ngOnInit(){this.loadDefinitions()}loadDefinitions(){this.loading.set(!0),this.slaService.listDefinitions().subscribe({next:t=>{t.success&&this.definitions.set(t.data.definitions),this.loading.set(!1)},error:t=>{console.error("Failed to load SLA definitions:",t),this.toast.error("Failed to load SLA definitions"),this.loading.set(!1)}})}openCreateDialog(){this.editMode.set(!1),this.definitionToEdit.set(null),this.isDialogOpen.set(!0)}openEditDialog(t){this.editMode.set(!0),this.definitionToEdit.set(t),this.isDialogOpen.set(!0)}onDialogClosed(){this.isDialogOpen.set(!1),this.editMode.set(!1),this.definitionToEdit.set(null)}onSaved(){this.onDialogClosed(),this.loadDefinitions()}toggleMenu(t){this.menuOpen.update(e=>F(A({},e),{[t]:!e[t]}))}closeMenu(t){this.menuOpen.update(e=>F(A({},e),{[t]:!1}))}toggleActive(t){t.id&&this.slaService.toggleActive(t.id).subscribe({next:e=>{e.success&&(this.loadDefinitions(),this.toast.success(`SLA rule ${e.data.isActive?"activated":"deactivated"} successfully`))},error:e=>{console.error("Failed to toggle SLA definition:",e),this.toast.error("Failed to toggle SLA definition")}})}deleteDefinition(t){t.id&&confirm(`Are you sure you want to delete "${t.name}"?`)&&this.slaService.deleteDefinition(t.id).subscribe({next:e=>{e.success&&(this.loadDefinitions(),this.toast.success("SLA rule deleted successfully"),this.closeMenu(t.id))},error:e=>{console.error("Failed to delete SLA definition:",e),this.toast.error("Failed to delete SLA definition")}})}getAppliesToLabel(t){return{work_orders:"Work Orders",maintenance:"Maintenance",both:"Both"}[t]||t}getPriorityLabel(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}formatWorkingDays(t){return t.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(", ")}static \u0275fac=function(e){return new(e||r)(w(S),w(V))};static \u0275cmp=k({type:r,selectors:[["app-sla-rules-page"]],decls:15,vars:3,consts:[[1,"sla-rules-page"],[1,"header-section"],[1,"section-title"],[1,"section-subtitle"],["type","button",1,"btn-create",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","M12 5v14"],["class","definitions-list",4,"ngIf"],["class","loading-state",4,"ngIf"],[3,"isOpen","editMode","definition","closed","saved",4,"ngIf"],[1,"definitions-list"],["class","sla-card",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"sla-card"],[1,"card-header"],[1,"card-title-section"],[1,"card-title"],["class","card-description",4,"ngIf"],[1,"card-actions"],[1,"active-toggle"],[1,"toggle-label"],[1,"toggle-switch"],["type","checkbox",3,"change","checked"],[1,"slider"],[1,"menu-container"],["type","button",1,"menu-button",3,"click","clickOutside"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","1"],["cx","12","cy","5","r","1"],["cx","12","cy","19","r","1"],["class","dropdown-menu",4,"ngIf"],[1,"card-body"],[1,"badges"],[1,"badge","applies-to"],["class","badge priority",3,"critical",4,"ngIf"],[1,"time-details"],[1,"time-item"],["cx","12","cy","12","r","10"],["points","12 6 12 12 16 14"],["class","time-item",4,"ngIf"],[1,"schedule-details"],[1,"schedule-item"],[1,"label"],[1,"value"],[1,"card-description"],[1,"dropdown-menu"],["type","button",1,"menu-item",3,"click"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["type","button",1,"menu-item","delete",3,"click"],["points","3 6 5 6 21 6"],["d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"],[1,"badge","priority"],[1,"empty-state"],[1,"loading-state"],[3,"closed","saved","isOpen","editMode","definition"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),l(4,"SLA Definitions"),i(),n(5,"p",3),l(6,"Configure SLA rules and thresholds."),i()(),n(7,"button",4),u("click",function(){return a.openCreateDialog()}),C(),n(8,"svg",5),f(9,"path",6)(10,"path",7),i(),l(11," Create SLA Rule "),i()(),_(12,Pe,3,2,"div",8)(13,ve,3,0,"div",9),i(),_(14,xe,1,3,"app-sla-rule-form-dialog",10)),e&2&&(s(12),p("ngIf",!a.loading()),s(),p("ngIf",a.loading()),s(),p("ngIf",a.isDialogOpen()))},dependencies:[E,D,T,R,L,te],styles:['.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:2rem}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0 0 .25rem;color:#1f2937}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .btn-create[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.625rem 1.25rem;background-color:#2563eb;color:#fff;border:none;border-radius:.5rem;font-weight:500;cursor:pointer;transition:background-color .2s}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .btn-create[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.sla-rules-page[_ngcontent-%COMP%]   .definitions-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:1.5rem;box-shadow:0 1px 3px #0000001a}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-title-section[_ngcontent-%COMP%]{flex:1}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-title-section[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin:0 0 .25rem;color:#1f2937}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-title-section[_ngcontent-%COMP%]   .card-description[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:44px;height:24px}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2563eb}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]{position:relative}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.25rem;color:#6b7280;display:flex;align-items:center;justify-content:center}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]:hover{color:#1f2937}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;margin-top:.5rem;background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;z-index:10;min-width:150px}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;width:100%;padding:.625rem 1rem;background:none;border:none;text-align:left;cursor:pointer;font-size:.875rem;color:#374151;transition:background-color .2s}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item.delete[_ngcontent-%COMP%]{color:#dc2626}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item.delete[_ngcontent-%COMP%]:hover{background-color:#fee2e2}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:9999px;font-size:.75rem;font-weight:500}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge.applies-to[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge.priority[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge.priority.critical[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .time-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .time-details[_ngcontent-%COMP%]   .time-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:#374151}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .time-details[_ngcontent-%COMP%]   .time-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#6b7280}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;font-size:.875rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]   .schedule-item[_ngcontent-%COMP%]{display:flex;gap:.5rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]   .schedule-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#6b7280}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]   .schedule-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#374151;font-weight:500}.sla-rules-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%], .sla-rules-page[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#6b7280}']})};export{oe as SlaRulesPageComponent};
