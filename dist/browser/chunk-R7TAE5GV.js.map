{
  "version": 3,
  "sources": ["src/app/core/validators/password.validator.ts"],
  "sourcesContent": ["import { AbstractControl, ValidationErrors, ValidatorFn } from '@angular/forms';\r\n\r\nexport interface PasswordStrength {\r\n  score: number; // 0-4\r\n  level: 'weak' | 'medium' | 'strong' | 'very-strong';\r\n  feedback: string[];\r\n  color: string;\r\n  percentage: number;\r\n}\r\n\r\nexport class PasswordValidator {\r\n  /**\r\n   * Custom validator for password complexity\r\n   * Requires: min 8 chars, 1 uppercase, 1 lowercase, 1 number\r\n   */\r\n  static strong(): ValidatorFn {\r\n    return (control: AbstractControl): ValidationErrors | null => {\r\n      const value = control.value;\r\n\r\n      if (!value) {\r\n        return null;\r\n      }\r\n\r\n      const hasMinLength = value.length >= 8;\r\n      const hasUpperCase = /[A-Z]/.test(value);\r\n      const hasLowerCase = /[a-z]/.test(value);\r\n      const hasNumber = /\\d/.test(value);\r\n\r\n      const passwordValid = hasMinLength && hasUpperCase && hasLowerCase && hasNumber;\r\n\r\n      if (!passwordValid) {\r\n        const errors: any = {};\r\n        if (!hasMinLength) errors.minLength = true;\r\n        if (!hasUpperCase) errors.uppercase = true;\r\n        if (!hasLowerCase) errors.lowercase = true;\r\n        if (!hasNumber) errors.number = true;\r\n        \r\n        return { passwordStrength: errors };\r\n      }\r\n\r\n      return null;\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Calculate password strength\r\n   */\r\n  static calculateStrength(password: string): PasswordStrength {\r\n    if (!password) {\r\n      return {\r\n        score: 0,\r\n        level: 'weak',\r\n        feedback: ['Enter a password'],\r\n        color: 'red',\r\n        percentage: 0\r\n      };\r\n    }\r\n\r\n    let score = 0;\r\n    const feedback: string[] = [];\r\n\r\n    // Length check\r\n    if (password.length >= 8) {\r\n      score++;\r\n    } else {\r\n      feedback.push('At least 8 characters');\r\n    }\r\n\r\n    // Uppercase check\r\n    if (/[A-Z]/.test(password)) {\r\n      score++;\r\n    } else {\r\n      feedback.push('One uppercase letter');\r\n    }\r\n\r\n    // Lowercase check\r\n    if (/[a-z]/.test(password)) {\r\n      score++;\r\n    } else {\r\n      feedback.push('One lowercase letter');\r\n    }\r\n\r\n    // Number check\r\n    if (/\\d/.test(password)) {\r\n      score++;\r\n    } else {\r\n      feedback.push('One number');\r\n    }\r\n\r\n    // Special character bonus\r\n    if (/[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]/.test(password)) {\r\n      score++;\r\n    }\r\n\r\n    // Determine level and color\r\n    let level: 'weak' | 'medium' | 'strong' | 'very-strong' = 'weak';\r\n    let color = 'red';\r\n    let percentage = 0;\r\n\r\n    if (score >= 5) {\r\n      level = 'very-strong';\r\n      color = 'green';\r\n      percentage = 100;\r\n    } else if (score >= 4) {\r\n      level = 'strong';\r\n      color = 'green';\r\n      percentage = 80;\r\n    } else if (score >= 3) {\r\n      level = 'medium';\r\n      color = 'yellow';\r\n      percentage = 60;\r\n    } else if (score >= 2) {\r\n      level = 'weak';\r\n      color = 'orange';\r\n      percentage = 40;\r\n    } else {\r\n      level = 'weak';\r\n      color = 'red';\r\n      percentage = 20;\r\n    }\r\n\r\n    return {\r\n      score,\r\n      level,\r\n      feedback: feedback.length > 0 ? feedback : ['Password looks good!'],\r\n      color,\r\n      percentage\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if password meets minimum requirements\r\n   */\r\n  static meetsRequirements(password: string): {\r\n    minLength: boolean;\r\n    hasUpperCase: boolean;\r\n    hasLowerCase: boolean;\r\n    hasNumber: boolean;\r\n    allMet: boolean;\r\n  } {\r\n    return {\r\n      minLength: password.length >= 8,\r\n      hasUpperCase: /[A-Z]/.test(password),\r\n      hasLowerCase: /[a-z]/.test(password),\r\n      hasNumber: /\\d/.test(password),\r\n      allMet: password.length >= 8 && /[A-Z]/.test(password) && /[a-z]/.test(password) && /\\d/.test(password)\r\n    };\r\n  }\r\n}\r\n\r\n"],
  "mappings": ";AAUM,IAAO,oBAAP,MAAwB;;;;;EAK5B,OAAO,SAAM;AACX,WAAO,CAAC,YAAqD;AAC3D,YAAM,QAAQ,QAAQ;AAEtB,UAAI,CAAC,OAAO;AACV,eAAO;MACT;AAEA,YAAM,eAAe,MAAM,UAAU;AACrC,YAAM,eAAe,QAAQ,KAAK,KAAK;AACvC,YAAM,eAAe,QAAQ,KAAK,KAAK;AACvC,YAAM,YAAY,KAAK,KAAK,KAAK;AAEjC,YAAM,gBAAgB,gBAAgB,gBAAgB,gBAAgB;AAEtE,UAAI,CAAC,eAAe;AAClB,cAAM,SAAc,CAAA;AACpB,YAAI,CAAC;AAAc,iBAAO,YAAY;AACtC,YAAI,CAAC;AAAc,iBAAO,YAAY;AACtC,YAAI,CAAC;AAAc,iBAAO,YAAY;AACtC,YAAI,CAAC;AAAW,iBAAO,SAAS;AAEhC,eAAO,EAAE,kBAAkB,OAAM;MACnC;AAEA,aAAO;IACT;EACF;;;;EAKA,OAAO,kBAAkB,UAAgB;AACvC,QAAI,CAAC,UAAU;AACb,aAAO;QACL,OAAO;QACP,OAAO;QACP,UAAU,CAAC,kBAAkB;QAC7B,OAAO;QACP,YAAY;;IAEhB;AAEA,QAAI,QAAQ;AACZ,UAAM,WAAqB,CAAA;AAG3B,QAAI,SAAS,UAAU,GAAG;AACxB;IACF,OAAO;AACL,eAAS,KAAK,uBAAuB;IACvC;AAGA,QAAI,QAAQ,KAAK,QAAQ,GAAG;AAC1B;IACF,OAAO;AACL,eAAS,KAAK,sBAAsB;IACtC;AAGA,QAAI,QAAQ,KAAK,QAAQ,GAAG;AAC1B;IACF,OAAO;AACL,eAAS,KAAK,sBAAsB;IACtC;AAGA,QAAI,KAAK,KAAK,QAAQ,GAAG;AACvB;IACF,OAAO;AACL,eAAS,KAAK,YAAY;IAC5B;AAGA,QAAI,wCAAwC,KAAK,QAAQ,GAAG;AAC1D;IACF;AAGA,QAAI,QAAsD;AAC1D,QAAI,QAAQ;AACZ,QAAI,aAAa;AAEjB,QAAI,SAAS,GAAG;AACd,cAAQ;AACR,cAAQ;AACR,mBAAa;IACf,WAAW,SAAS,GAAG;AACrB,cAAQ;AACR,cAAQ;AACR,mBAAa;IACf,WAAW,SAAS,GAAG;AACrB,cAAQ;AACR,cAAQ;AACR,mBAAa;IACf,WAAW,SAAS,GAAG;AACrB,cAAQ;AACR,cAAQ;AACR,mBAAa;IACf,OAAO;AACL,cAAQ;AACR,cAAQ;AACR,mBAAa;IACf;AAEA,WAAO;MACL;MACA;MACA,UAAU,SAAS,SAAS,IAAI,WAAW,CAAC,sBAAsB;MAClE;MACA;;EAEJ;;;;EAKA,OAAO,kBAAkB,UAAgB;AAOvC,WAAO;MACL,WAAW,SAAS,UAAU;MAC9B,cAAc,QAAQ,KAAK,QAAQ;MACnC,cAAc,QAAQ,KAAK,QAAQ;MACnC,WAAW,KAAK,KAAK,QAAQ;MAC7B,QAAQ,SAAS,UAAU,KAAK,QAAQ,KAAK,QAAQ,KAAK,QAAQ,KAAK,QAAQ,KAAK,KAAK,KAAK,QAAQ;;EAE1G;;",
  "names": []
}
