import{a as mi}from"./chunk-5S6YH7S2.js";import{a as z}from"./chunk-INY3Z7OU.js";import"./chunk-GGQ7LRWG.js";import{c as $,d as P,f as k,g as V}from"./chunk-C5P3YSZX.js";import{A as _e,B as Ke,C as K,c as te,d as Q,e as ie,f as ce,h as ii,i as ni,j as de,k as oi,n as ri,o as me,p as ai,q as si,r as pe,s as ue,t as he,u as ge,v as li,w as ci,x as di}from"./chunk-UQACUQIP.js";import"./chunk-MEXLA3FU.js";import{d as ei,f as Ye,g as ti,j as ke}from"./chunk-4LZAODCJ.js";import{b as Ze}from"./chunk-YGU4T3V7.js";import{A as Jt,a as Ne,h as Kt,k as W,l as N,p as Xt,x as j}from"./chunk-HV2J6S7U.js";import{$a as He,B as Nt,C as jt,Cb as De,Da as Gt,E as zt,Gb as i,H as Ue,Hb as r,Ib as p,Jb as oe,K as Ae,Kb as re,Kc as Yt,Lb as vt,Mb as S,Pb as _,Qb as m,T as D,Tb as qt,Va as H,Wb as Se,Xa as $t,Xb as Me,Y as J,Ya as s,Yb as Ee,Z as ae,a as we,ab as ft,ac as xt,bb as L,bc as l,c as ht,ca as A,cc as C,dc as w,ec as G,f as T,fa as Bt,fc as Wt,gc as yt,hc as bt,ia as se,ic as wt,j as gt,ja as f,ka as v,kb as R,la as h,lb as le,ma as x,mb as We,mc as Qe,nc as Qt,pa as qe,pb as g,ta as F,ua as Fe,ub as Ut,vb as Ce,vc as Zt,wb as d,wc as Ct,ya as Ie,yb as E,za as _t,zb as O}from"./chunk-RHVXZUNF.js";import{a as ee,b as $e,f as q}from"./chunk-EQDQRRRY.js";var fe=class n{isLoaded=!1;loadPromise=null;constructor(){}loadGoogleMaps(){return q(this,null,function*(){return this.isLoaded?Promise.resolve():this.loadPromise?this.loadPromise:(this.loadPromise=new Promise((t,e)=>{if(typeof window.google<"u"&&window.google.maps){this.isLoaded=!0,t();return}let o=document.querySelector('script[src*="maps.googleapis.com"]');if(o){o.addEventListener("load",()=>{this.isLoaded=!0,t()}),o.addEventListener("error",e);return}let a=()=>{typeof window.google<"u"&&window.google.maps?(this.isLoaded=!0,t()):setTimeout(a,100)};a()}),this.loadPromise)})}initializeAutocomplete(a,c){return q(this,arguments,function*(t,e,o={}){yield this.loadGoogleMaps();let b=ee(ee({},{types:["geocode"],fields:["formatted_address","place_id","geometry","address_components"]}),o),y=new window.google.maps.places.Autocomplete(t,b);return y.addListener("place_changed",()=>{let M=y.getPlace();M&&M.formatted_address&&e({formatted_address:M.formatted_address,place_id:M.place_id,geometry:M.geometry,address_components:M.address_components})}),y})}searchPlaces(o){return q(this,arguments,function*(t,e={}){return yield this.loadGoogleMaps(),new Promise((a,c)=>{let u=new window.google.maps.places.PlacesService(document.createElement("div")),b=ee({query:t,fields:["formatted_address","place_id","geometry"]},e);u.textSearch(b,(y,M)=>{M===window.google.maps.places.PlacesServiceStatus.OK?a(y||[]):c(new Error(`Places search failed: ${M}`))})})})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})};var Gi=["addressInput"];function $i(n,t){n&1&&(i(0,"div",53)(1,"p",54),l(2,"Location Hierarchy:"),r(),i(3,"div",55)(4,"div")(5,"strong"),l(6,"Level 0:"),r(),l(7," Communities, Campuses, Buildings"),r(),i(8,"div")(9,"strong"),l(10,"Level 1:"),r(),l(11," Buildings, Floors"),r(),i(12,"div")(13,"strong"),l(14,"Level 2+:"),r(),l(15," Rooms, Areas, Amenities"),r()(),i(16,"p",56),l(17,"Available types: 16 options including Community, Campus, and Buildings"),r()())}function Ui(n,t){if(n&1&&(i(0,"div",57)(1,"div",5)(2,"div",58),p(3,"img",59),r(),i(4,"div",60)(5,"p",61),l(6,"Parent Location:"),r(),i(7,"p",62),l(8),r(),i(9,"p",63),l(10),r()()()()),n&2){let e=m(2);s(3),d("src",e.parentLocation.type.icon,H)("alt",e.parentLocation.type.name),s(5),G("",e.parentLocation.name," (",e.parentLocation.type.name,")"),s(2),w("Creating Level ",e.parentLocation.hierarchy_level+1," location")}}function qi(n,t){n&1&&(i(0,"p",64),l(1," Location name is required and must be at least 2 characters "),r())}function Wi(n,t){n&1&&(i(0,"p",64),l(1," Location code is required "),r())}function Qi(n,t){if(n&1&&(i(0,"p",64),l(1),r()),n&2){let e=m(2);s(),w(" ",e.errorMessage," ")}}function Zi(n,t){n&1&&(i(0,"div",73)(1,"div",74),h(),i(2,"svg",75),p(3,"path",76),r(),l(4," Drag the marker or click on the map to adjust the location "),r(),x(),p(5,"div",77),r())}function Yi(n,t){if(n&1){let e=S();i(0,"div",29)(1,"label",65),l(2," Address "),i(3,"span",31),l(4,"*"),r()(),i(5,"div",66),h(),i(6,"svg",67),p(7,"path",8)(8,"path",9),r(),x(),i(9,"input",68,0),_("blur",function(){f(e);let a=m(2);return v(a.onAddressChanged())}),r()(),i(11,"p",69),h(),i(12,"svg",70),p(13,"path",71),r(),l(14," Address suggestions powered by Google Places "),r(),g(15,Zi,6,0,"div",72),r()}if(n&2){let e=m(2);s(15),d("ngIf",e.showMap)}}function Ki(n,t){n&1&&(i(0,"p",64),l(1," Address is required "),r())}function Xi(n,t){if(n&1&&(i(0,"div",29)(1,"label",78),l(2," Manual Address "),i(3,"span",31),l(4,"*"),r()(),i(5,"textarea",79),l(6,"              "),r(),g(7,Ki,2,0,"p",33),r()),n&2){let e,o,a=m(2);s(5),E("border-red-300",((e=a.locationForm.get("address"))==null?null:e.invalid)&&((e=a.locationForm.get("address"))==null?null:e.touched)),s(2),d("ngIf",((o=a.locationForm.get("address"))==null?null:o.invalid)&&((o=a.locationForm.get("address"))==null?null:o.touched))}}function Ji(n,t){if(n&1){let e=S();i(0,"div",80),_("click",function(){let a=f(e).$implicit,c=m(2);return v(c.selectLocationType(a))}),i(1,"div",81)(2,"div",82),p(3,"img",83),r(),i(4,"div",84),l(5),r(),i(6,"div",85),l(7),r()()()}if(n&2){let e=t.$implicit,o=m(2);O(o.selectedTypeId===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),s(3),d("src",e.icon,H)("alt",e.name),s(2),C(e.name),s(2),C(o.getTypeDescription(e))}}function en(n,t){if(n&1){let e=S();i(0,"div",81)(1,"button",86),_("click",function(){f(e);let a=m(2);return v(a.toggleShowAllTypes())}),h(),i(2,"svg",87),p(3,"path",88),r(),x(),i(4,"span"),l(5),r()()()}if(n&2){let e=m(2);s(5),C(e.showAllTypes?"Show Less":e.locationTypes.length-6+" More Types")}}function tn(n,t){if(n&1&&(i(0,"div",89)(1,"p",90),l(2),r()()),n&2){let e=m(2);s(2),C(e.errorMessage)}}function nn(n,t){n&1&&(i(0,"span"),l(1,"Create Location"),r())}function on(n,t){n&1&&(i(0,"span",91),h(),i(1,"svg",92),p(2,"circle",93)(3,"path",94),r(),x(),i(4,"span"),l(5,"Creating..."),r()())}function rn(n,t){if(n&1){let e=S();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6),h(),i(5,"svg",7),p(6,"path",8)(7,"path",9),r()(),x(),i(8,"h2",10),l(9,"Add New Location"),r()(),i(10,"button",11),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),h(),i(11,"svg",12),p(12,"path",13),r()()(),x(),i(13,"div",14)(14,"div",15)(15,"div",16),h(),i(16,"svg",17),p(17,"path",18),r()(),x(),i(18,"h3",19),l(19),r(),i(20,"p",20),l(21),r(),g(22,$i,18,0,"div",21)(23,Ui,11,5,"div",22),r(),i(24,"form",23),_("ngSubmit",function(){f(e);let a=m();return v(a.onSubmit())}),i(25,"div",24)(26,"div",25),h(),i(27,"svg",26),p(28,"path",27),r(),x(),i(29,"h4",28),l(30,"Basic Information"),r()(),i(31,"div",29)(32,"label",30),l(33," Location Name "),i(34,"span",31),l(35,"*"),r()(),p(36,"input",32),g(37,qi,2,0,"p",33),r(),i(38,"div",29)(39,"label",34),l(40," Location Code "),i(41,"span",31),l(42,"*"),r()(),p(43,"input",35),g(44,Wi,2,0,"p",33)(45,Qi,2,1,"p",33),r(),i(46,"div",29)(47,"label",36),l(48,"Description"),r(),p(49,"textarea",37),r(),i(50,"div",29)(51,"div",25),h(),i(52,"svg",26),p(53,"path",8)(54,"path",9),r(),x(),i(55,"h4",28),l(56,"Address & Location"),r()(),i(57,"div",29)(58,"label",38),l(59," Location Address Type "),r(),i(60,"select",39),_("change",function(){f(e);let a=m();return v(a.onAddressTypeChange())}),i(61,"option",40),l(62,"GPS Address (with Map)"),r(),i(63,"option",41),l(64,"Manual Free Text"),r()()(),g(65,Yi,16,1,"div",42)(66,Xi,8,3,"div",42),r()(),i(67,"div",24)(68,"div",25),h(),i(69,"svg",26),p(70,"path",43),r(),x(),i(71,"h4",28),l(72,"Location Type"),r()(),i(73,"div",44),g(74,Ji,8,6,"div",45),r(),g(75,en,6,1,"div",46),r(),g(76,tn,3,1,"div",47),i(77,"div",48)(78,"button",49),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),l(79," Close "),r(),i(80,"button",50),g(81,nn,2,0,"span",51)(82,on,6,0,"span",52),r()()()()()()}if(n&2){let e,o,a,c,u,b,y=m();d("@backdropAnimation",void 0),s(),d("@modalAnimation",void 0),s(18),w(" ",y.parentLocation?"Add New Sub-location":"Add New Location"," "),s(2),w(" ",y.parentLocation?"Create a new sub-location under "+y.parentLocation.name:"Create a new top-level location"," "),s(),d("ngIf",!y.parentLocation),s(),d("ngIf",y.parentLocation),s(),d("formGroup",y.locationForm),s(12),E("border-red-300",((e=y.locationForm.get("name"))==null?null:e.invalid)&&((e=y.locationForm.get("name"))==null?null:e.touched)),s(),d("ngIf",((o=y.locationForm.get("name"))==null?null:o.invalid)&&((o=y.locationForm.get("name"))==null?null:o.touched)),s(6),E("border-red-300",((a=y.locationForm.get("location_code"))==null?null:a.invalid)&&((a=y.locationForm.get("location_code"))==null?null:a.touched)),s(),d("ngIf",((c=y.locationForm.get("location_code"))==null?null:c.invalid)&&((c=y.locationForm.get("location_code"))==null?null:c.touched)),s(),d("ngIf",y.errorMessage&&y.errorMessage.includes("location code")),s(20),d("ngIf",((u=y.locationForm.get("address_type"))==null?null:u.value)==="gps"),s(),d("ngIf",((b=y.locationForm.get("address_type"))==null?null:b.value)==="manual"),s(8),d("ngForOf",y.getDisplayedTypes()),s(),d("ngIf",y.locationTypes.length>6),s(),d("ngIf",y.errorMessage),s(4),d("disabled",y.locationForm.invalid||y.isLoading),s(),d("ngIf",!y.isLoading),s(),d("ngIf",y.isLoading)}}var Pe=class n{constructor(t,e,o,a){this.fb=t;this.locationService=e;this.googlePlacesService=o;this.http=a;this.locationForm=this.fb.group({name:["",[Q.required,Q.minLength(2)]],location_code:["",[Q.required]],description:[""],address_type:["gps"],address:[""],location_type_id:[null,Q.required]})}isOpen=!1;parentLocation=null;closeModal=new F;locationCreated=new F;addressInput;locationForm;locationTypes=[];selectedTypeId=null;isLoading=!1;errorMessage="";showAllTypes=!1;autocomplete;addressType="gps";showMap=!1;map;marker;geocoder;ngOnInit(){this.loadLocationTypes(),this.addressType=this.locationForm.get("address_type")?.value||"gps"}ngAfterViewInit(){this.locationForm.get("address_type")?.value==="gps"&&this.initializeAutocomplete()}ngOnChanges(t){t.isOpen&&this.isOpen&&!t.isOpen.firstChange&&(this.resetForm(),this.locationForm.get("address_type")?.value==="gps"&&setTimeout(()=>{this.initializeAutocomplete()},200))}loadLocationTypes(){let t=this.parentLocation?this.parentLocation.hierarchy_level+1:0;this.locationService.getLocationTypes(t).subscribe({next:e=>{e.success&&(this.locationTypes=e.data.types)},error:e=>{console.error("Error loading location types:",e)}})}getDisplayedTypes(){return this.showAllTypes?this.locationTypes:this.locationTypes.slice(0,6)}selectLocationType(t){this.selectedTypeId=t.id,this.locationForm.patchValue({location_type_id:t.id})}getTypeDescription(t){return t.description||`${t.category}`}getTypeIcon(t){return`assets/icons/${t.icon}.svg`}onSubmit(){if(this.locationForm.valid&&!this.isLoading){this.isLoading=!0,this.errorMessage="";let t=$e(ee({},this.locationForm.value),{parent_id:this.parentLocation?this.parentLocation.id:null});this.locationService.createLocation(t).subscribe({next:e=>{e.success?(this.locationCreated.emit(e.data.location),this.closeModalHandler()):this.errorMessage=e.message||"Failed to create location",this.isLoading=!1},error:e=>{this.errorMessage=e.error?.message||"An error occurred while creating the location",this.isLoading=!1}})}}initializeAutocomplete(){return q(this,null,function*(){setTimeout(()=>q(this,null,function*(){if(this.addressInput?.nativeElement&&this.isOpen)try{this.autocomplete&&(this.autocomplete=null),this.autocomplete=yield this.googlePlacesService.initializeAutocomplete(this.addressInput.nativeElement,t=>{if(this.locationForm.patchValue({address:t.formatted_address}),t.geometry&&t.geometry.location){let e=t.geometry.location.lat(),o=t.geometry.location.lng();this.showMap=!0,setTimeout(()=>this.showMapOnCoords(e,o),100)}},{types:["geocode"]})}catch(t){console.error("Failed to initialize Google Places Autocomplete:",t)}}),300)})}closeModalHandler(){this.autocomplete&&(this.autocomplete=null),this.cleanupMap(),this.isOpen=!1,this.closeModal.emit()}cleanupMap(){if(this.marker&&typeof google<"u"&&google.maps){try{google.maps.event.clearInstanceListeners(this.marker),this.marker.setMap(null)}catch(e){console.warn("Error cleaning up marker:",e)}this.marker=void 0}if(this.map&&typeof google<"u"&&google.maps){try{google.maps.event.clearInstanceListeners(this.map)}catch(e){console.warn("Error cleaning up map:",e)}this.map=void 0}let t=document.getElementById("location-map");t&&(t.innerHTML=""),this.geocoder=void 0,this.showMap=!1}toggleShowAllTypes(){this.showAllTypes=!this.showAllTypes}resetForm(){this.locationForm.reset({name:"",location_code:"",description:"",address_type:"gps",address:"",location_type_id:null}),this.selectedTypeId=null,this.errorMessage="",this.showAllTypes=!1,this.isLoading=!1,this.addressType="gps",this.cleanupMap(),this.autocomplete&&(this.autocomplete=null)}onAddressChanged(){if(this.locationForm.get("address_type")?.value==="gps"){let e=this.locationForm.get("address")?.value;e&&e.trim().length>0?this.geocodeAddress():(this.showMap=!1,this.map&&(this.map=void 0,this.marker=void 0))}}geocodeAddress(){let t=this.locationForm.get("address")?.value;if(t){if(typeof google>"u"||!google.maps){console.warn("Google Maps not loaded yet");return}this.geocoder||(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({address:t},(e,o)=>{if(o==="OK"&&e&&e.length>0){let a=e[0].geometry.location,c=a.lat(),u=a.lng();this.showMap=!0,setTimeout(()=>this.showMapOnCoords(c,u),100)}})}}showMapOnCoords(t,e){let o=document.getElementById("location-map");if(!o){console.warn("Map element not found");return}if(typeof google>"u"||!google.maps){console.warn("Google Maps not loaded yet");return}if(o.offsetWidth===0||o.offsetHeight===0){console.warn("Map element has no dimensions");return}this.map?this.map.setCenter({lat:t,lng:e}):this.map=new google.maps.Map(o,{center:{lat:t,lng:e},zoom:15,mapTypeId:"roadmap",mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),this.marker?this.marker.setPosition({lat:t,lng:e}):(this.marker=new google.maps.Marker({position:{lat:t,lng:e},map:this.map,title:this.locationForm.get("name")?.value||"Location",draggable:!0}),this.marker.addListener("dragend",()=>{let a=this.marker.getPosition();a&&this.reverseGeocode(a.lat(),a.lng())}),this.map.addListener("click",a=>{let c=a.latLng;this.marker.setPosition(c),this.reverseGeocode(c.lat(),c.lng())}))}reverseGeocode(t,e){this.geocoder||(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({location:{lat:t,lng:e}},(o,a)=>{if(a==="OK"&&o&&o.length>0){let c=o[0].formatted_address;this.locationForm.patchValue({address:c})}})}static \u0275fac=function(e){return new(e||n)(L(_e),L(z),L(fe),L(Ze))};static \u0275cmp=R({type:n,selectors:[["app-add-location-modal"]],viewQuery:function(e,o){if(e&1&&Se(Gi,5),e&2){let a;Me(a=Ee())&&(o.addressInput=a.first)}},inputs:{isOpen:"isOpen",parentLocation:"parentLocation"},outputs:{closeModal:"closeModal",locationCreated:"locationCreated"},features:[se],decls:1,vars:1,consts:[["addressInput",""],["class","fixed inset-0 bg-[#00000085] flex items-center justify-center p-4 animate-fade-in","style","z-index: 1000;",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","p-4","animate-fade-in",2,"z-index","1000"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"text-center","mb-8"],[1,"w-16","h-16","bg-blue-50","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","text-sm"],["class","mt-4 p-4 bg-blue-50 rounded-lg",4,"ngIf"],["class","mt-4 p-4 bg-green-50 rounded-lg",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-8"],[1,"flex","items-center","space-x-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-lg","font-semibold","text-gray-900"],[1,"mb-4"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["id","name","type","text","formControlName","name","placeholder","Enter location name",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400"],["class","mt-1 text-sm text-red-600",4,"ngIf"],["for","location_code",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","location_code","type","text","formControlName","location_code","placeholder","Enter location code (e.g., BL-001)",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400"],["for","description",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","description","formControlName","description","rows","3","placeholder","Brief description of this location",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400","resize-none"],["for","address_type",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","address_type","formControlName","address_type",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white",3,"change"],["value","gps"],["value","manual"],["class","mb-4",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],["class","border-2 rounded-lg p-4 cursor-pointer transition-all hover:shadow-sm",3,"class","click",4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],["class","mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],[1,"flex","items-center","justify-end","pt-6","gap-3","border-t","border-gray-200"],["type","button",1,"px-6","py-2","text-gray-600","height-[40px]","border","border-gray-200","rounded-lg","hover:border-gray-300","hover:text-gray-800","font-medium","transition-colors",3,"click"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","font-medium","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],[1,"mt-4","p-4","bg-blue-50","rounded-lg"],[1,"text-sm","font-medium","text-blue-900","mb-2"],[1,"text-xs","text-blue-700","space-y-1"],[1,"text-xs","text-blue-600","mt-2"],[1,"mt-4","p-4","bg-green-50","rounded-lg"],[1,"w-10","h-10","bg-green-100","rounded-lg","flex","items-center","justify-center"],[1,"w-6","h-6",3,"src","alt"],[1,"text-left"],[1,"text-sm","font-medium","text-green-900"],[1,"text-sm","text-green-700"],[1,"text-xs","text-green-600"],[1,"mt-1","text-sm","text-red-600"],["for","address",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","w-4","h-4","text-gray-400"],["id","address","type","text","formControlName","address","placeholder","Start typing address...","autocomplete","off",1,"w-full","pl-10","pr-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400",3,"blur"],[1,"text-xs","text-gray-500","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[1,"text-xs","text-gray-600","mb-2","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16l-4-4m0 0l4-4m-4 4h18"],["id","location-map",2,"height","300px","width","100%","border-radius","0.5rem","border","1px solid #e5e7eb"],["for","manual_address",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","manual_address","formControlName","address","rows","4","placeholder","Enter address manually",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400","resize-none"],[1,"border-2","rounded-lg","p-4","cursor-pointer","transition-all","hover:shadow-sm",3,"click"],[1,"text-center"],[1,"mb-2","flex","justify-center"],[1,"w-8","h-8","text-gray-600",3,"src","alt"],[1,"font-medium","text-gray-900","mb-1"],[1,"text-xs","text-gray-500"],["type","button",1,"flex","items-center","space-x-2","mx-auto","px-4","py-2","text-sm","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-600","text-sm"],[1,"flex","items-center","space-x-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,o){e&1&&g(0,rn,83,22,"div",1),e&2&&d("ngIf",o.isOpen)},dependencies:[j,W,N,K,de,he,ge,te,ue,ie,ce,me,pe],styles:[".modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.location-type-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.location-type-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.location-type-card.selected[_ngcontent-%COMP%]{transform:translateY(-1px);box-shadow:0 4px 12px #3b82f633}.type-icon[_ngcontent-%COMP%]{font-size:2rem;line-height:1}.form-input[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.form-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #3b82f61a}.form-input.error[_ngcontent-%COMP%]{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.hierarchy-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#eff6ff,#dbeafe)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.location-type-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-container[_ngcontent-%COMP%]{margin:1rem;max-height:calc(100vh - 2rem)}}"],data:{animation:[$("backdropAnimation",[V(":enter",[k({opacity:0}),P("150ms ease-out",k({opacity:1}))]),V(":leave",[P("150ms ease-in",k({opacity:0}))])]),$("modalAnimation",[V(":enter",[k({opacity:0,transform:"scale(0.7) translateY(-50px)"}),P("200ms ease-out",k({opacity:1,transform:"scale(1) translateY(0)"}))]),V(":leave",[P("150ms ease-in",k({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};var an=["addressInput"];function sn(n,t){if(n&1&&(i(0,"div",46)(1,"p",47),l(2),r()()),n&2){let e=m(2);s(2),C(e.errorMessage)}}function ln(n,t){n&1&&(i(0,"p",48),l(1," Location name is required and must be at least 2 characters "),r())}function cn(n,t){n&1&&(i(0,"p",48),l(1," Location code is required "),r())}function dn(n,t){if(n&1&&(i(0,"p",48),l(1),r()),n&2){let e=m(2);s(),w(" ",e.errorMessage," ")}}function mn(n,t){n&1&&(i(0,"div",57)(1,"div",58),h(),i(2,"svg",59),p(3,"path",60),r(),l(4," Drag the marker or click on the map to adjust the location "),r(),x(),p(5,"div",61),r())}function pn(n,t){if(n&1){let e=S();i(0,"div",21)(1,"label",49),l(2," Address "),i(3,"span",23),l(4,"*"),r()(),i(5,"div",50),h(),i(6,"svg",51),p(7,"path",30)(8,"path",31),r(),x(),i(9,"input",52,0),_("blur",function(){f(e);let a=m(2);return v(a.onAddressChanged())}),r()(),i(11,"p",53),h(),i(12,"svg",54),p(13,"path",55),r(),l(14," Address suggestions powered by Google Places "),r(),g(15,mn,6,0,"div",56),r()}if(n&2){let e=m(2);s(15),d("ngIf",e.showMap)}}function un(n,t){n&1&&(i(0,"p",48),l(1," Address is required "),r())}function hn(n,t){if(n&1&&(i(0,"div",21)(1,"label",62),l(2," Manual Address "),i(3,"span",23),l(4,"*"),r()(),i(5,"textarea",63),l(6,"              "),r(),g(7,un,2,0,"p",25),r()),n&2){let e,o,a=m(2);s(5),E("border-red-300",((e=a.editForm.get("address"))==null?null:e.invalid)&&((e=a.editForm.get("address"))==null?null:e.touched)),s(2),d("ngIf",((o=a.editForm.get("address"))==null?null:o.invalid)&&((o=a.editForm.get("address"))==null?null:o.touched))}}function gn(n,t){if(n&1&&(i(0,"div",64)(1,"div",5)(2,"div",6),p(3,"img",65),r(),i(4,"div")(5,"div",66),l(6),r(),i(7,"div",67),l(8,"Current location type"),r()()()()),n&2){let e=m(2);s(3),d("src",e.location.type.icon,H)("alt",e.location.type.name),s(3),C(e.location.type.name)}}function _n(n,t){if(n&1){let e=S();i(0,"div",68),_("click",function(){let a=f(e).$implicit,c=m(2);return v(c.selectLocationType(a))}),i(1,"div",69)(2,"div",70),p(3,"img",71),r(),i(4,"div",72),l(5),r(),i(6,"div",73),l(7),r()()()}if(n&2){let e=t.$implicit,o=m(2);O(o.selectedTypeId===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),s(3),d("src",e.icon,H)("alt",e.name),s(2),C(e.name),s(2),C(o.getTypeDescription(e))}}function fn(n,t){n&1&&(i(0,"span"),l(1,"Update Location"),r())}function vn(n,t){n&1&&(i(0,"span",74),h(),i(1,"svg",75),p(2,"circle",76)(3,"path",77),r(),x(),i(4,"span"),l(5,"Updating..."),r()())}function xn(n,t){if(n&1){let e=S();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6),h(),i(5,"svg",7),p(6,"path",8),r()(),x(),i(7,"h2",9),l(8,"Edit Location"),r()(),i(9,"button",10),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),h(),i(10,"svg",11),p(11,"path",12),r()()(),x(),i(12,"div",13),g(13,sn,3,1,"div",14),i(14,"form",15),_("ngSubmit",function(){f(e);let a=m();return v(a.onSubmit())}),i(15,"div",16)(16,"div",17),h(),i(17,"svg",18),p(18,"path",19),r(),x(),i(19,"h4",20),l(20,"Basic Information"),r()(),i(21,"div",21)(22,"label",22),l(23," Location Name "),i(24,"span",23),l(25,"*"),r()(),p(26,"input",24),g(27,ln,2,0,"p",25),r(),i(28,"div",21)(29,"label",26),l(30," Location Code "),i(31,"span",23),l(32,"*"),r()(),p(33,"input",27),g(34,cn,2,0,"p",25)(35,dn,2,1,"p",25),r(),i(36,"div",21)(37,"label",28),l(38,"Description"),r(),p(39,"textarea",29),r(),i(40,"div",21)(41,"div",17),h(),i(42,"svg",18),p(43,"path",30)(44,"path",31),r(),x(),i(45,"h4",20),l(46,"Address & Location"),r()(),i(47,"div",21)(48,"label",32),l(49," Location Address Type "),r(),i(50,"select",33),_("change",function(){f(e);let a=m();return v(a.onAddressTypeChange())}),i(51,"option",34),l(52,"GPS Address (with Map)"),r(),i(53,"option",35),l(54,"Manual Free Text"),r()()(),g(55,pn,16,1,"div",36)(56,hn,8,3,"div",36),r()(),i(57,"div",16)(58,"div",17),h(),i(59,"svg",18),p(60,"path",37),r(),x(),i(61,"h4",20),l(62,"Location Type"),r()(),g(63,gn,9,3,"div",38),i(64,"div",39),g(65,_n,8,6,"div",40),r()(),i(66,"div",41)(67,"button",42),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),l(68," Cancel "),r(),i(69,"button",43),g(70,fn,2,0,"span",44)(71,vn,6,0,"span",45),r()()()()()()}if(n&2){let e,o,a,c,u,b,y=m();d("@backdropAnimation",void 0),s(),d("@modalAnimation",void 0),s(12),d("ngIf",y.errorMessage),s(),d("formGroup",y.editForm),s(12),E("border-red-300",((e=y.editForm.get("name"))==null?null:e.invalid)&&((e=y.editForm.get("name"))==null?null:e.touched)),s(),d("ngIf",((o=y.editForm.get("name"))==null?null:o.invalid)&&((o=y.editForm.get("name"))==null?null:o.touched)),s(6),E("border-red-300",((a=y.editForm.get("location_code"))==null?null:a.invalid)&&((a=y.editForm.get("location_code"))==null?null:a.touched)),s(),d("ngIf",((c=y.editForm.get("location_code"))==null?null:c.invalid)&&((c=y.editForm.get("location_code"))==null?null:c.touched)),s(),d("ngIf",y.errorMessage&&y.errorMessage.includes("location code")),s(20),d("ngIf",((u=y.editForm.get("address_type"))==null?null:u.value)==="gps"),s(),d("ngIf",((b=y.editForm.get("address_type"))==null?null:b.value)==="manual"),s(7),d("ngIf",y.location),s(2),d("ngForOf",y.getDisplayedTypes()),s(4),d("disabled",y.editForm.invalid||y.loading),s(),d("ngIf",!y.loading),s(),d("ngIf",y.loading)}}var Ve=class n{constructor(t,e,o,a){this.fb=t;this.locationService=e;this.googlePlacesService=o;this.http=a;this.editForm=this.fb.group({name:["",[Q.required,Q.minLength(2)]],location_code:["",[Q.required]],description:[""],address_type:["gps"],address:[""],location_type_id:[null,Q.required]})}isOpen=!1;location=null;closeModal=new F;locationUpdated=new F;addressInput;editForm;locationTypes=[];selectedTypeId=null;loading=!1;errorMessage="";autocomplete;addressType="gps";showMap=!1;map;marker;geocoder;ngOnInit(){this.loadLocationTypes()}ngAfterViewInit(){this.isOpen&&this.editForm.get("address_type")?.value==="gps"&&this.initializeAutocomplete()}ngOnChanges(t){t.location&&this.location&&this.populateForm(),t.isOpen&&this.isOpen&&!t.isOpen.firstChange&&this.editForm.get("address_type")?.value==="gps"&&setTimeout(()=>{this.initializeAutocomplete()},200)}initializeAutocomplete(){return q(this,null,function*(){setTimeout(()=>q(this,null,function*(){if(this.addressInput?.nativeElement&&this.isOpen)try{this.autocomplete&&(this.autocomplete=null),this.autocomplete=yield this.googlePlacesService.initializeAutocomplete(this.addressInput.nativeElement,t=>{if(this.editForm.patchValue({address:t.formatted_address}),t.geometry&&t.geometry.location){let e=t.geometry.location.lat(),o=t.geometry.location.lng();this.showMap=!0,setTimeout(()=>this.showMapOnCoords(e,o),100)}},{types:["geocode"]})}catch(t){console.error("Failed to initialize Google Places Autocomplete:",t)}}),300)})}loadLocationTypes(){let t=this.location?.hierarchy_level;this.locationService.getLocationTypes(t).subscribe({next:e=>{e.success&&(this.locationTypes=e.data.types)},error:e=>{console.error("Error loading location types:",e)}})}populateForm(){if(this.location){let t=this.location.address_type||"gps";if(this.addressType=t,this.editForm.patchValue({name:this.location.name,location_code:this.location.location_code||"",description:this.location.description||"",address_type:t,address:this.location.address||"",location_type_id:this.location.location_type_id}),this.selectedTypeId=this.location?.location_type_id||null,t==="gps"){if(this.location&&this.location.latitude!==void 0&&this.location.longitude!==void 0){this.showMap=!0;let e=this.location.latitude,o=this.location.longitude;setTimeout(()=>this.showMapOnCoords(e,o),100)}else this.location&&this.location.address&&this.geocodeAddress();this.isOpen&&setTimeout(()=>{this.initializeAutocomplete()},200)}}}getDisplayedTypes(){return this.locationTypes.slice(0,6)}selectLocationType(t){this.selectedTypeId=t.id,this.editForm.patchValue({location_type_id:t.id})}getTypeDescription(t){return t.description||`${t.category}`}getTypeIcon(t){return`assets/icons/${t.icon}.svg`}onSubmit(){if(this.editForm.valid&&!this.loading&&this.location){this.loading=!0,this.errorMessage="";let t=ee({},this.editForm.value);this.locationService.updateLocation(this.location.id,t).subscribe({next:e=>{e.success?(this.locationUpdated.emit(e.data.location),this.closeModalHandler()):this.errorMessage=e.message||"Failed to update location",this.loading=!1},error:e=>{this.errorMessage=e.error?.message||"An error occurred while updating the location",this.loading=!1}})}}closeModalHandler(){this.autocomplete&&(this.autocomplete=null),this.cleanupMap(),this.isOpen=!1,this.closeModal.emit(),this.resetForm()}cleanupMap(){if(this.marker&&typeof google<"u"&&google.maps){try{google.maps.event.clearInstanceListeners(this.marker),this.marker.setMap(null)}catch(e){console.warn("Error cleaning up marker:",e)}this.marker=void 0}if(this.map&&typeof google<"u"&&google.maps){try{google.maps.event.clearInstanceListeners(this.map)}catch(e){console.warn("Error cleaning up map:",e)}this.map=void 0}let t=document.getElementById("edit-location-map");t&&(t.innerHTML=""),this.geocoder=void 0,this.showMap=!1}resetForm(){this.editForm.reset({name:"",location_code:"",description:"",address_type:"gps",address:"",location_type_id:null}),this.selectedTypeId=null,this.errorMessage="",this.addressType="gps",this.cleanupMap()}onAddressTypeChange(){let t=this.editForm.get("address_type")?.value;this.addressType=t,this.editForm.patchValue({address:""}),t==="manual"?(this.cleanupMap(),this.autocomplete&&(this.autocomplete=null)):t==="gps"&&setTimeout(()=>{this.initializeAutocomplete()},100)}onAddressChanged(){if(this.editForm.get("address_type")?.value==="gps"){let e=this.editForm.get("address")?.value;e&&e.trim().length>0?this.geocodeAddress():(this.showMap=!1,this.map&&(this.map=void 0,this.marker=void 0))}}geocodeAddress(){let t=this.editForm.get("address")?.value;if(t){if(typeof google>"u"||!google.maps){console.warn("Google Maps not loaded yet");return}this.geocoder||(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({address:t},(e,o)=>{if(o==="OK"&&e&&e.length>0){let a=e[0].geometry.location,c=a.lat(),u=a.lng();this.showMap=!0,setTimeout(()=>this.showMapOnCoords(c,u),100)}})}}showMapOnCoords(t,e){let o=document.getElementById("edit-location-map");if(!o){console.warn("Map element not found");return}if(typeof google>"u"||!google.maps){console.warn("Google Maps not loaded yet");return}if(o.offsetWidth===0||o.offsetHeight===0){console.warn("Map element has no dimensions");return}this.map?this.map.setCenter({lat:t,lng:e}):this.map=new google.maps.Map(o,{center:{lat:t,lng:e},zoom:15,mapTypeId:"roadmap",mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),this.marker?this.marker.setPosition({lat:t,lng:e}):(this.marker=new google.maps.Marker({position:{lat:t,lng:e},map:this.map,title:this.editForm.get("name")?.value||"Location",draggable:!0}),this.marker.addListener("dragend",()=>{let a=this.marker.getPosition();a&&this.reverseGeocode(a.lat(),a.lng())}),this.map.addListener("click",a=>{let c=a.latLng;this.marker.setPosition(c),this.reverseGeocode(c.lat(),c.lng())}))}reverseGeocode(t,e){this.geocoder||(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({location:{lat:t,lng:e}},(o,a)=>{if(a==="OK"&&o&&o.length>0){let c=o[0].formatted_address;this.editForm.patchValue({address:c})}})}static \u0275fac=function(e){return new(e||n)(L(_e),L(z),L(fe),L(Ze))};static \u0275cmp=R({type:n,selectors:[["app-edit-location-modal"]],viewQuery:function(e,o){if(e&1&&Se(an,5),e&2){let a;Me(a=Ee())&&(o.addressInput=a.first)}},inputs:{isOpen:"isOpen",location:"location"},outputs:{closeModal:"closeModal",locationUpdated:"locationUpdated"},features:[se],decls:1,vars:1,consts:[["addressInput",""],["class","fixed inset-0 bg-[#00000085] flex items-center justify-center p-4 animate-fade-in","style","z-index: 1000;",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","p-4","animate-fade-in",2,"z-index","1000"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],["class","mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-8"],[1,"flex","items-center","space-x-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-lg","font-semibold","text-gray-900"],[1,"mb-4"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["id","name","type","text","formControlName","name","placeholder","Enter location name","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400"],["class","mt-1 text-sm text-red-600",4,"ngIf"],["for","location_code",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","location_code","type","text","formControlName","location_code","placeholder","Enter location code (e.g., BL-001)","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400"],["for","description",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","description","formControlName","description","rows","3","placeholder","Brief description of this location",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400","resize-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],["for","address_type",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","address_type","formControlName","address_type",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white",3,"change"],["value","gps"],["value","manual"],["class","mb-4",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],["class","mb-4 p-4 bg-gray-50 rounded-lg",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],["class","border-2 rounded-lg p-4 cursor-pointer transition-all hover:shadow-sm",3,"class","click",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","pt-6","border-t","border-gray-200"],["type","button",1,"px-6","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors",3,"click"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","font-medium","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-600","text-sm"],[1,"mt-1","text-sm","text-red-600"],["for","address",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","w-4","h-4","text-gray-400"],["id","address","type","text","formControlName","address","placeholder","Start typing address...","autocomplete","off",1,"w-full","pl-10","pr-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400",3,"blur"],[1,"text-xs","text-gray-500","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[1,"text-xs","text-gray-600","mb-2","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16l-4-4m0 0l4-4m-4 4h18"],["id","edit-location-map",2,"height","300px","width","100%","border-radius","0.5rem","border","1px solid #e5e7eb"],["for","manual_address",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","manual_address","formControlName","address","rows","4","placeholder","Enter address manually",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400","resize-none"],[1,"mb-4","p-4","bg-gray-50","rounded-lg"],[1,"w-6","h-6",3,"src","alt"],[1,"font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"border-2","rounded-lg","p-4","cursor-pointer","transition-all","hover:shadow-sm",3,"click"],[1,"text-center"],[1,"mb-2","flex","justify-center"],[1,"w-8","h-8","text-gray-600",3,"src","alt"],[1,"font-medium","text-gray-900","mb-1"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","space-x-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,o){e&1&&g(0,xn,72,18,"div",1),e&2&&d("ngIf",o.isOpen)},dependencies:[j,W,N,K,de,he,ge,te,ue,ie,ce,di,me,pe],styles:[".modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.location-type-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.location-type-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.location-type-card.selected[_ngcontent-%COMP%]{transform:translateY(-1px);box-shadow:0 4px 12px #3b82f633}.type-icon[_ngcontent-%COMP%]{font-size:2rem;line-height:1}.form-input[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.form-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #3b82f61a}.form-input.error[_ngcontent-%COMP%]{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.current-type-display[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.location-type-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-container[_ngcontent-%COMP%]{margin:1rem;max-height:calc(100vh - 2rem)}}"],data:{animation:[$("backdropAnimation",[V(":enter",[k({opacity:0}),P("150ms ease-out",k({opacity:1}))]),V(":leave",[P("150ms ease-in",k({opacity:0}))])]),$("modalAnimation",[V(":enter",[k({opacity:0,transform:"scale(0.7) translateY(-50px)"}),P("200ms ease-out",k({opacity:1,transform:"scale(1) translateY(0)"}))]),V(":leave",[P("150ms ease-in",k({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};function yn(n,t){if(n&1&&(i(0,"div",34),l(1),r()),n&2){let e=m(3);s(),w(" \u26A0\uFE0F This location has ",e.location.children==null?null:e.location.children.length," child location(s) ")}}function bn(n,t){if(n&1&&(i(0,"div",27)(1,"div",4)(2,"div",28),p(3,"img",29),r(),i(4,"div",30)(5,"div",31),l(6),r(),i(7,"div",32),l(8),r(),g(9,yn,2,1,"div",33),r()()()),n&2){let e=m(2);s(3),d("src",e.location.type.icon,H)("alt",e.location.type.name),s(3),C(e.location.name),s(2),C(e.location.type.name),s(),d("ngIf",e.location.children==null?null:e.location.children.length)}}function wn(n,t){if(n&1&&(i(0,"div",35)(1,"p",36),l(2),r()()),n&2){let e=m(2);s(2),C(e.errorMessage)}}function Cn(n,t){n&1&&(i(0,"span"),l(1,"Delete Location"),r())}function Sn(n,t){n&1&&(i(0,"span",37),h(),i(1,"svg",38),p(2,"circle",39)(3,"path",40),r(),x(),i(4,"span"),l(5,"Deleting..."),r()())}function Mn(n,t){if(n&1){let e=S();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),h(),i(5,"svg",6),p(6,"path",7),r()(),x(),i(7,"h2",8),l(8,"Delete Location"),r()(),i(9,"button",9),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),h(),i(10,"svg",10),p(11,"path",11),r()()(),x(),i(12,"div",12)(13,"div",13)(14,"div",14),h(),i(15,"svg",15),p(16,"path",16),r()()(),x(),i(17,"div",17)(18,"h3",18),l(19,"Are you sure?"),r(),i(20,"p",19),l(21," You are about to delete the location "),i(22,"strong"),l(23),r(),l(24,". This action cannot be undone. "),r(),g(25,bn,10,5,"div",20),r(),g(26,wn,3,1,"div",21),i(27,"div",22)(28,"button",23),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),l(29," Cancel "),r(),i(30,"button",24),_("click",function(){f(e);let a=m();return v(a.confirmDelete())}),g(31,Cn,2,0,"span",25)(32,Sn,6,0,"span",26),r()()()()()}if(n&2){let e=m();d("@backdropAnimation",void 0),s(),d("@modalAnimation",void 0),s(22),w('"',e.location==null?null:e.location.name,'"'),s(2),d("ngIf",e.location),s(),d("ngIf",e.errorMessage),s(2),d("disabled",e.loading),s(2),d("disabled",e.loading),s(),d("ngIf",!e.loading),s(),d("ngIf",e.loading)}}var ye=class n{constructor(t){this.locationService=t}isOpen=!1;location=null;closeModal=new F;locationDeleted=new F;loading=!1;errorMessage="";confirmDelete(){!this.location||this.loading||(this.loading=!0,this.errorMessage="",this.locationService.deleteLocation(this.location.id).subscribe({next:t=>{t.success?(this.locationDeleted.emit(this.location),this.closeModalHandler()):this.errorMessage=t.message||"Failed to delete location",this.loading=!1},error:t=>{this.errorMessage=t.error?.message||"An error occurred while deleting the location",this.loading=!1}}))}closeModalHandler(){this.loading||(this.isOpen=!1,this.closeModal.emit(),this.resetModal())}resetModal(){this.errorMessage="",this.loading=!1}static \u0275fac=function(e){return new(e||n)(L(z))};static \u0275cmp=R({type:n,selectors:[["app-delete-confirmation-modal"]],inputs:{isOpen:"isOpen",location:"location"},outputs:{closeModal:"closeModal",locationDeleted:"locationDeleted"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-[#00000085] flex items-center justify-center p-4","style","z-index: 1000;",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","p-4",2,"z-index","1000"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-md","w-full"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-red-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"flex","justify-center","mb-4"],[1,"w-16","h-16","bg-red-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-center","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],["class","bg-gray-50 rounded-lg p-4 mb-4",4,"ngIf"],["class","mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],[1,"flex","items-center","justify-end","space-x-3"],[1,"px-6","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"px-6","py-2","bg-red-600","text-white","font-medium","rounded-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],[1,"bg-gray-50","rounded-lg","p-4","mb-4"],[1,"w-10","h-10","bg-orange-100","rounded-lg","flex","items-center","justify-center"],[1,"w-6","h-6",3,"src","alt"],[1,"text-left"],[1,"font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],["class","text-xs text-red-600 mt-1",4,"ngIf"],[1,"text-xs","text-red-600","mt-1"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-600","text-sm"],[1,"flex","items-center","space-x-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,o){e&1&&g(0,Mn,33,9,"div",0),e&2&&d("ngIf",o.isOpen)},dependencies:[j,N],styles:[".modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.warning-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.8}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{margin:1rem;max-height:calc(100vh - 2rem)}}"],data:{animation:[$("backdropAnimation",[V(":enter",[k({opacity:0}),P("150ms ease-out",k({opacity:1}))]),V(":leave",[P("150ms ease-in",k({opacity:0}))])]),$("modalAnimation",[V(":enter",[k({opacity:0,transform:"scale(0.7) translateY(-50px)"}),P("200ms ease-out",k({opacity:1,transform:"scale(1) translateY(0)"}))]),V(":leave",[P("150ms ease-in",k({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};var En=["addressInput"];function kn(n,t){if(n&1&&(i(0,"div",27)(1,"div",28),h(),i(2,"svg",29),p(3,"path",30),r(),x(),i(4,"span",31),l(5),r()()()),n&2){let e=m(2);s(5),w("Successfully created ",e.successCount," locations!")}}function Ln(n,t){if(n&1&&(i(0,"div",32)(1,"p",33),l(2),r()()),n&2){let e=m(2);s(2),C(e.errorMessage)}}function Tn(n,t){if(n&1&&(i(0,"option",55),l(1),r()),n&2){let e=t.$implicit;d("value",e.id),s(),C(e.name)}}function In(n,t){if(n&1){let e=S();i(0,"div",34)(1,"div",35)(2,"h3",36),l(3),r(),i(4,"div",28)(5,"button",37),_("click",function(){let a=f(e).index,c=m(2);return v(c.duplicateLocationRow(a))}),h(),i(6,"svg",8),p(7,"path",38),r()(),x(),i(8,"button",39),_("click",function(){let a=f(e).index,c=m(2);return v(c.removeLocationRow(a))}),h(),i(9,"svg",8),p(10,"path",40),r()()()(),x(),i(11,"div",41)(12,"div")(13,"label",42),l(14," Name "),i(15,"span",43),l(16,"*"),r()(),p(17,"input",44),r(),i(18,"div")(19,"label",42),l(20," Type "),i(21,"span",43),l(22,"*"),r()(),i(23,"div",45)(24,"select",46)(25,"option",47),l(26,"Select type"),r(),g(27,Tn,2,2,"option",48),r(),i(28,"div",49),h(),i(29,"svg",50),p(30,"path",51),r()()()()(),x(),i(31,"div",52)(32,"label",42),l(33,"Address"),r(),p(34,"input",53,0),r(),i(36,"div",52)(37,"label",42),l(38,"Description"),r(),p(39,"textarea",54),r()()}if(n&2){let e,o,a=t.$implicit,c=t.index,u=m(2);d("formGroupName",c),s(3),w("Location ",c+1,""),s(5),d("disabled",u.locationsArray.length<=1),s(9),E("border-red-300",((e=a.get("name"))==null?null:e.invalid)&&((e=a.get("name"))==null?null:e.touched)),s(7),E("border-red-300",((o=a.get("location_type_id"))==null?null:o.invalid)&&((o=a.get("location_type_id"))==null?null:o.touched)),s(3),d("ngForOf",u.locationTypes)}}function Dn(n,t){if(n&1&&(i(0,"span"),l(1),r()),n&2){let e=m(2);s(),w("Create ",e.getValidLocationsCount()," Locations")}}function Pn(n,t){n&1&&(i(0,"span",28),h(),i(1,"svg",56),p(2,"circle",57)(3,"path",58),r(),x(),i(4,"span"),l(5,"Creating..."),r()())}function Vn(n,t){if(n&1){let e=S();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"h2",5),l(5),r()(),i(6,"div",6)(7,"button",7),_("click",function(){f(e);let a=m();return v(a.addLocationRow())}),h(),i(8,"svg",8),p(9,"path",9),r(),x(),i(10,"span"),l(11,"Add Location"),r()(),i(12,"button",10),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),h(),i(13,"svg",11),p(14,"path",12),r()()()(),x(),i(15,"div",13),g(16,kn,6,1,"div",14)(17,Ln,3,1,"div",15),i(18,"div",16)(19,"form",17),_("ngSubmit",function(){f(e);let a=m();return v(a.onSubmit())}),i(20,"div",18),g(21,In,40,8,"div",19),r()()(),i(22,"div",20)(23,"div",21)(24,"span",22),l(25),r(),l(26," of "),i(27,"span",22),l(28),r(),l(29," locations ready "),r(),i(30,"div",6)(31,"button",23),_("click",function(){f(e);let a=m();return v(a.closeModalHandler())}),l(32," Cancel "),r(),i(33,"button",24),_("click",function(){f(e);let a=m();return v(a.onSubmit())}),g(34,Dn,2,1,"span",25)(35,Pn,6,0,"span",26),r()()()()()()}if(n&2){let e=m();d("@backdropAnimation",void 0),s(),d("@modalAnimation",void 0),s(4),w("Create up to 5 locations at once (",e.getTotalLocationsCount(),"/5)"),s(11),d("ngIf",e.successCount>0),s(),d("ngIf",e.errorMessage),s(2),d("formGroup",e.bulkForm),s(2),d("ngForOf",e.locationsArray.controls),s(4),C(e.getValidLocationsCount()),s(3),C(e.getTotalLocationsCount()),s(3),d("disabled",e.isLoading),s(2),d("disabled",e.bulkForm.invalid||e.isLoading||e.getValidLocationsCount()===0),s(),d("ngIf",!e.isLoading),s(),d("ngIf",e.isLoading)}}var Je=class n{constructor(t,e,o){this.fb=t;this.locationService=e;this.googlePlacesService=o;this.bulkForm=this.fb.group({locations:this.fb.array([])})}isOpen=!1;closeModal=new F;locationsCreated=new F;addressInputs;bulkForm;locationTypes=[];isLoading=!1;errorMessage="";successCount=0;autocompleteInstances=[];ngOnInit(){this.loadLocationTypes(),this.addLocationRow(),this.addLocationRow(),this.addLocationRow(),this.bulkForm.valueChanges.subscribe(()=>{this.locationsArray.updateValueAndValidity()})}ngAfterViewInit(){this.isOpen&&this.initializeAllAutocomplete()}get locationsArray(){return this.bulkForm.get("locations")}loadLocationTypes(){this.locationService.getLocationTypes(0).subscribe({next:t=>{t.success&&(this.locationTypes=t.data.types)},error:t=>{console.error("Error loading location types:",t)}})}createLocationFormGroup(){return this.fb.group({name:["",[Q.required,Q.minLength(2)]],description:[""],address:[""],location_type_id:[null,Q.required]})}addLocationRow(){this.locationsArray.length>=5||this.locationsArray.push(this.createLocationFormGroup())}initializeAllAutocomplete(){return q(this,null,function*(){setTimeout(()=>q(this,null,function*(){this.addressInputs&&this.addressInputs.forEach((t,e)=>q(this,null,function*(){if(t?.nativeElement)try{let o=yield this.googlePlacesService.initializeAutocomplete(t.nativeElement,a=>{let c=this.locationsArray.at(e);c&&c.patchValue({address:a.formatted_address})},{types:["geocode"]});this.autocompleteInstances[e]=o}catch(o){console.error("Failed to initialize Google Places Autocomplete:",o)}}))}),100)})}duplicateLocationRow(t){if(this.locationsArray.length>=5)return;let e=this.locationsArray.at(t);if(e){let o=this.createLocationFormGroup();o.patchValue(e.value),this.locationsArray.push(o)}setTimeout(()=>this.initializeAllAutocomplete(),100)}removeLocationRow(t){this.locationsArray.length>1&&this.locationsArray.removeAt(t)}getLocationTypeName(t){let e=this.locationTypes.find(o=>o.id===t);return e?e.name:"Unknown"}onSubmit(){if(this.bulkForm.valid&&!this.isLoading){this.isLoading=!0,this.errorMessage="",this.successCount=0;let t=this.locationsArray.value.map(e=>$e(ee({},e),{parent_id:null}));this.locationService.bulkCreateLocations(t).subscribe({next:e=>{e.success?(this.successCount=t.length,this.locationsCreated.emit(e.data.location?[e.data.location]:[]),setTimeout(()=>{this.closeModalHandler()},2e3)):this.errorMessage=e.message||"Failed to create locations",this.isLoading=!1},error:e=>{this.errorMessage=e.error?.message||"An error occurred while creating locations",this.isLoading=!1}})}}closeModalHandler(){this.isOpen=!1,this.closeModal.emit(),this.resetForm()}resetForm(){for(;this.locationsArray.length>0;)this.locationsArray.removeAt(0);this.addLocationRow(),this.addLocationRow(),this.addLocationRow(),this.errorMessage="",this.successCount=0}getValidLocationsCount(){return this.locationsArray.controls.filter(t=>{let e=t.get("name")?.value,o=t.get("location_type_id")?.value;return t.valid&&e&&e.trim().length>=2&&o}).length}getTotalLocationsCount(){return this.locationsArray.length}static \u0275fac=function(e){return new(e||n)(L(_e),L(z),L(fe))};static \u0275cmp=R({type:n,selectors:[["app-bulk-create-modal"]],viewQuery:function(e,o){if(e&1&&Se(En,5),e&2){let a;Me(a=Ee())&&(o.addressInputs=a)}},inputs:{isOpen:"isOpen"},outputs:{closeModal:"closeModal",locationsCreated:"locationsCreated"},decls:1,vars:1,consts:[["addressInput",""],["class","fixed inset-0 bg-[#00000085] flex items-center justify-center p-4 animate-fade-in","style","z-index: 1000;",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","p-4","animate-fade-in",2,"z-index","1000"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-4xl","w-full","max-h-[90vh]","overflow-hidden"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"flex","items-center","space-x-3"],["type","button",1,"flex","items-center","space-x-2","px-4","py-2","text-blue-600","hover:bg-blue-50","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","flex-col","h-full","max-h-[calc(90vh-140px)]"],["class","p-4 bg-green-50 border-b border-green-200",4,"ngIf"],["class","p-4 bg-red-50 border-b border-red-200",4,"ngIf"],[1,"flex-1","overflow-auto","p-6"],[3,"ngSubmit","formGroup"],["formArrayName","locations",1,"space-y-6"],["class","bg-white border border-gray-200 rounded-lg p-6 relative",3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","p-6","border-t","border-gray-200","bg-gray-50"],[1,"text-sm","text-gray-600"],[1,"font-medium"],["type","button",1,"px-6","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors","disabled:opacity-50",3,"click","disabled"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","font-medium","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],[1,"p-4","bg-green-50","border-b","border-green-200"],[1,"flex","items-center","space-x-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-green-800","font-medium"],[1,"p-4","bg-red-50","border-b","border-red-200"],[1,"text-red-600","text-sm"],[1,"bg-white","border","border-gray-200","rounded-lg","p-6","relative",3,"formGroupName"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-gray-900"],["type","button",1,"p-2","text-gray-400","hover:text-gray-600","hover:bg-gray-50","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],["type","button",1,"p-2","text-gray-400","hover:text-red-600","hover:bg-red-50","rounded-lg","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","text","formControlName","name","placeholder","Enter location name",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400"],[1,"relative"],["formControlName","location_type_id",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","appearance-none","bg-white"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-3","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"mt-6"],["type","text","formControlName","address","placeholder","Enter location address","autocomplete","off",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400"],["formControlName","description","rows","3","placeholder","Enter location description",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400","resize-none"],[3,"value"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,o){e&1&&g(0,Vn,36,13,"div",1),e&2&&d("ngIf",o.isOpen)},dependencies:[j,W,N,K,de,he,ge,te,ue,ie,ce,me,pe,ai,si],styles:[".modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.location-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.location-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000014;border-color:#e5e7eb}.form-input[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.form-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #3b82f61a}.form-input.error[_ngcontent-%COMP%]{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.card-header[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6;padding-bottom:1rem;margin-bottom:1.5rem}.action-button[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.action-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.05)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}select[_ngcontent-%COMP%]{background-image:none}select[_ngcontent-%COMP%]:focus{outline:none}.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ef4444!important}.ng-valid.ng-touched[_ngcontent-%COMP%]{border-color:#10b981}.success-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .3s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.location-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;box-shadow:0 1px 3px #0000001a}.location-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{margin:1rem;max-height:calc(100vh - 2rem)}.grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:1fr}.location-card[_ngcontent-%COMP%]{padding:1rem}}*[_ngcontent-%COMP%]{transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}[_ngcontent-%COMP%]::placeholder{color:#9ca3af;opacity:1}button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}button[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}"],data:{animation:[$("backdropAnimation",[V(":enter",[k({opacity:0}),P("150ms ease-out",k({opacity:1}))]),V(":leave",[P("150ms ease-in",k({opacity:0}))])]),$("modalAnimation",[V(":enter",[k({opacity:0,transform:"scale(0.7) translateY(-50px)"}),P("200ms ease-out",k({opacity:1,transform:"scale(1) translateY(0)"}))]),V(":leave",[P("150ms ease-in",k({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};var Mt;function On(){if(Mt==null){let n=typeof document<"u"?document.head:null;Mt=!!(n&&(n.createShadowRoot||n.attachShadow))}return Mt}function et(n){if(On()){let t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function je(n){return n.composedPath?n.composedPath()[0]:n.target}function pi(n){return n.buttons===0||n.detail===0}function ui(n){let t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}function Te(n){return n instanceof Ie?n.nativeElement:n}function be(n,t,e,o,a){let c=parseInt(Ct.major),u=parseInt(Ct.minor);return c>19||c===19&&u>0||c===0&&u===0?n.listen(t,e,o,a):(t.addEventListener(e,o,a),()=>{t.removeEventListener(e,o,a)})}var tt=new WeakMap,hi=(()=>{class n{_appRef;_injector=A(qe);_environmentInjector=A(Bt);load(e){let o=this._appRef=this._appRef||this._injector.get(Ut),a=tt.get(o);a||(a={loaders:new Set,refs:[]},tt.set(o,a),o.onDestroy(()=>{tt.get(o)?.refs.forEach(c=>c.destroy()),tt.delete(o)})),a.loaders.has(e)||(a.loaders.add(e),a.refs.push(Yt(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(o){return new(o||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Et;try{Et=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Et=!1}var gi=(()=>{class n{_platformId=A(Gt);isBrowser=this._platformId?Jt(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Et)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(o){return new(o||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var $n=20,_i=(()=>{class n{_platform=A(gi);_listeners;_viewportSize;_change=new T;_document=A(Ne,{optional:!0});constructor(){let e=A(Fe),o=A(He).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let a=c=>this._change.next(c);this._listeners=[o.listen("window","resize",a),o.listen("window","orientationchange",a)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:o,height:a}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+a,right:e.left+o,height:a,width:o}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,o=this._getWindow(),a=e.documentElement,c=a.getBoundingClientRect(),u=-c.top||e.body.scrollTop||o.scrollY||a.scrollTop||0,b=-c.left||e.body.scrollLeft||o.scrollX||a.scrollLeft||0;return{top:u,left:b}}change(e=$n){return e>0?this._change.pipe(zt(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(o){return new(o||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var fi=(()=>{class n{static \u0275fac=function(o){return new(o||n)};static \u0275mod=le({type:n});static \u0275inj=ae({})}return n})();function Di(n){let t=n.cloneNode(!0),e=t.querySelectorAll("[id]"),o=n.nodeName.toLowerCase();t.removeAttribute("id");for(let a=0;a<e.length;a++)e[a].removeAttribute("id");return o==="canvas"?yi(n,t):(o==="input"||o==="select"||o==="textarea")&&xi(n,t),vi("canvas",n,t,yi),vi("input, textarea, select",n,t,xi),t}function vi(n,t,e,o){let a=t.querySelectorAll(n);if(a.length){let c=e.querySelectorAll(n);for(let u=0;u<a.length;u++)o(a[u],c[u])}}var Un=0;function xi(n,t){t.type!=="file"&&(t.value=n.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${Un++}`)}function yi(n,t){let e=t.getContext("2d");if(e)try{e.drawImage(n,0,0)}catch{}}function Ot(n){let t=n.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function Tt(n,t,e){let{top:o,bottom:a,left:c,right:u}=n;return e>=o&&e<=a&&t>=c&&t<=u}function Ge(n,t,e){n.top+=t,n.bottom=n.top+n.height,n.left+=e,n.right=n.left+n.width}function bi(n,t,e,o){let{top:a,right:c,bottom:u,left:b,width:y,height:M}=n,I=y*t,Z=M*t;return o>a-Z&&o<u+Z&&e>b-I&&e<c+I}var it=class{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Ot(e)})})}handleScroll(t){let e=je(t),o=this.positions.get(e);if(!o)return null;let a=o.scrollPosition,c,u;if(e===this._document){let M=this.getViewportScrollPosition();c=M.top,u=M.left}else c=e.scrollTop,u=e.scrollLeft;let b=a.top-c,y=a.left-u;return this.positions.forEach((M,I)=>{M.clientRect&&e!==I&&e.contains(I)&&Ge(M.clientRect,b,y)}),a.top=c,a.left=u,{top:b,left:y}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function Pi(n,t){let e=n.rootNodes;if(e.length===1&&e[0].nodeType===t.ELEMENT_NODE)return e[0];let o=t.createElement("div");return e.forEach(a=>o.appendChild(a)),o}function Rt(n,t,e){for(let o in t)if(t.hasOwnProperty(o)){let a=t[o];a?n.setProperty(o,a,e?.has(o)?"important":""):n.removeProperty(o)}return n}function Oe(n,t){let e=t?"":"none";Rt(n.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function wi(n,t,e){Rt(n.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},e)}function nt(n,t){return t&&t!="none"?n+" "+t:n}function Ci(n,t){n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,n.style.transform=ot(t.left,t.top)}function ot(n,t){return`translate3d(${Math.round(n)}px, ${Math.round(t)}px, 0)`}function Si(n){let t=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*t}function qn(n){let t=getComputedStyle(n),e=kt(t,"transition-property"),o=e.find(b=>b==="transform"||b==="all");if(!o)return 0;let a=e.indexOf(o),c=kt(t,"transition-duration"),u=kt(t,"transition-delay");return Si(c[a])+Si(u[a])}function kt(n,t){return n.getPropertyValue(t).split(",").map(o=>o.trim())}var Wn=new Set(["position"]),It=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(t,e,o,a,c,u,b,y,M,I){this._document=t,this._rootElement=e,this._direction=o,this._initialDomRect=a,this._previewTemplate=c,this._previewClass=u,this._pickupPositionOnPage=b,this._initialTransform=y,this._zIndex=M,this._renderer=I}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),Mi(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return qn(this._preview)}addEventListener(t,e){return this._renderer.listen(this._preview,t,e)}_createPreview(){let t=this._previewTemplate,e=this._previewClass,o=t?t.template:null,a;if(o&&t){let c=t.matchSize?this._initialDomRect:null,u=t.viewContainer.createEmbeddedView(o,t.context);u.detectChanges(),a=Pi(u,this._document),this._previewEmbeddedView=u,t.matchSize?Ci(a,c):a.style.transform=ot(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else a=Di(this._rootElement),Ci(a,this._initialDomRect),this._initialTransform&&(a.style.transform=this._initialTransform);return Rt(a.style,{"pointer-events":"none",margin:Mi(a)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Wn),Oe(a,!1),a.classList.add("cdk-drag-preview"),a.setAttribute("popover","manual"),a.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(c=>a.classList.add(c)):a.classList.add(e)),a}};function Mi(n){return"showPopover"in n}var Qn={passive:!0},Ei={passive:!1},Zn={passive:!1,capture:!0},Yn=800,ki=new Set(["position"]),Dt=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_anchor;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=_t(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new T;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=we.EMPTY;_pointerUpSubscription=we.EMPTY;_scrollSubscription=we.EMPTY;_resizeSubscription=we.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Oe(e,t)))}_disabled=!1;beforeStarted=new T;started=new T;released=new T;ended=new T;entered=new T;exited=new T;dropped=new T;moved=this._moveEvents;data;constrainPosition;constructor(t,e,o,a,c,u,b){this._config=e,this._document=o,this._ngZone=a,this._viewportRuler=c,this._dragDropRegistry=u,this._renderer=b,this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new it(o),u.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(o=>Te(o)),this._handles.forEach(o=>Oe(o,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(o=>{this._handles.indexOf(o)>-1&&e.add(o)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let e=Te(t);return e!==this._rootElement&&(this._removeRootElementListeners(),this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[be(this._renderer,e,"mousedown",this._pointerDown,Ei),be(this._renderer,e,"touchstart",this._pointerDown,Qn),be(this._renderer,e,"dragstart",this._nativeDragStart,Ei)]),this._initialTransform=void 0,this._rootElement=e),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Te(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Oe(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Oe(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{let e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){let a=Math.abs(e.x-this._pickupPositionOnPage.x),c=Math.abs(e.y-this._pickupPositionOnPage.y);if(a+c>=this._config.dragStartThreshold){let b=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),y=this._dropContainer;if(!b){this._endDragSequence(t);return}(!y||!y.isDragging()&&!y.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();let o=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(o),this._dropContainer)this._updateActiveDropContainer(o,e);else{let a=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,c=this._activeTransform;c.x=o.x-a.x+this._passiveTransform.x,c.y=o.y-a.y+this._passiveTransform.y,this._applyRootElementTransform(c.x,c.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:o,event:t,distance:this._getDragDistance(o),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){ze(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),o=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=be(this._renderer,e,"selectstart",Kn,Zn)}),o){let a=this._rootElement,c=a.parentNode,u=this._placeholder=this._createPlaceholderElement(),b=this._anchor=this._anchor||this._document.createComment("");c.insertBefore(b,a),this._initialTransform=a.style.transform||"",this._preview=new It(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(c,e)),wi(a,!1,ki),this._document.body.appendChild(c.replaceChild(u,a)),this.started.next({source:this,event:t}),o.start(),this._initialContainer=o,this._initialIndex=o.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(o?o.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();let o=this.isDragging(),a=ze(e),c=!a&&e.button!==0,u=this._rootElement,b=je(e),y=!a&&this._lastTouchEventTime&&this._lastTouchEventTime+Yn>Date.now(),M=a?ui(e):pi(e);if(b&&b.draggable&&e.type==="mousedown"&&e.preventDefault(),o||c||y||M)return;if(this._handles.length){let ne=u.style;this._rootElementTapHighlight=ne.webkitTapHighlightColor||"",ne.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(ne=>this._updateOnScroll(ne)),this._boundaryElement&&(this._boundaryRect=Ot(this._boundaryElement));let I=this._previewTemplate;this._pickupPositionInElement=I&&I.template&&!I.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,e);let Z=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:Z.x,y:Z.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){wi(this._rootElement,!0,ki),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,o=e.getItemIndex(this),a=this._getPointerPositionOnPage(t),c=this._getDragDistance(a),u=e._isOverContainer(a.x,a.y);this.ended.next({source:this,distance:c,dropPoint:a,event:t}),this.dropped.next({item:this,currentIndex:o,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:u,distance:c,dropPoint:a,event:t}),e.drop(this,o,this._initialIndex,this._initialContainer,u,c,a,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:o,y:a}){let c=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!c&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(c=this._initialContainer),c&&c!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=c,this._dropContainer.enter(this,t,e,c===this._initialContainer&&c.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:c,currentIndex:c.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(o,a),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,e):this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(o=>{let a=b=>{(!b||this._preview&&je(b)===this._preview.element&&b.propertyName==="transform")&&(u(),o(),clearTimeout(c))},c=setTimeout(a,e*1.5),u=this._preview.addEventListener("transitionend",a)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,e=t?t.template:null,o;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),o=Pi(this._placeholderRef,this._document)):o=Di(this._rootElement),o.style.pointerEvents="none",o.classList.add("cdk-drag-placeholder"),o}_getPointerPositionInElement(t,e,o){let a=e===this._rootElement?null:e,c=a?a.getBoundingClientRect():t,u=ze(o)?o.targetTouches[0]:o,b=this._getViewportScrollPosition(),y=u.pageX-c.left-b.left,M=u.pageY-c.top-b.top;return{x:c.left-t.left+y,y:c.top-t.top+M}}_getPointerPositionOnPage(t){let e=this._getViewportScrollPosition(),o=ze(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,a=o.pageX-e.left,c=o.pageY-e.top;if(this._ownerSVGElement){let u=this._ownerSVGElement.getScreenCTM();if(u){let b=this._ownerSVGElement.createSVGPoint();return b.x=a,b.y=c,b.matrixTransform(u.inverse())}}return{x:a,y:c}}_getConstrainedPointerPosition(t){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:o,y:a}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||e==="x"?a=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(o=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:c,y:u}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,b=this._boundaryRect,{width:y,height:M}=this._getPreviewRect(),I=b.top+u,Z=b.bottom-(M-u),ne=b.left+c,pt=b.right-(y-c);o=Li(o,ne,pt),a=Li(a,I,Z)}return{x:o,y:a}}_updatePointerDirectionDelta(t){let{x:e,y:o}=t,a=this._pointerDirectionDelta,c=this._pointerPositionAtLastDirectionChange,u=Math.abs(e-c.x),b=Math.abs(o-c.y);return u>this._config.pointerDirectionChangeThreshold&&(a.x=e>c.x?1:-1,c.x=e),b>this._config.pointerDirectionChangeThreshold&&(a.y=o>c.y?1:-1,c.y=o),a}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Oe(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,e){let o=1/this.scale,a=ot(t*o,e*o),c=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=c.transform&&c.transform!="none"?c.transform:""),c.transform=nt(a,this._initialTransform)}_applyPreviewTransform(t,e){let o=this._previewTemplate?.template?void 0:this._initialTransform,a=ot(t,e);this._preview.setTransform(nt(a,o))}_getDragDistance(t){let e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(t===0&&e===0||this.isDragging()||!this._boundaryElement)return;let o=this._rootElement.getBoundingClientRect(),a=this._boundaryElement.getBoundingClientRect();if(a.width===0&&a.height===0||o.width===0&&o.height===0)return;let c=a.left-o.left,u=o.right-a.right,b=a.top-o.top,y=o.bottom-a.bottom;a.width>o.width?(c>0&&(t+=c),u>0&&(t-=u)):t=0,a.height>o.height?(b>0&&(e+=b),y>0&&(e-=y)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){let e=this.dragStartDelay;return typeof e=="number"?e:ze(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){let e=this._parentPositions.handleScroll(t);if(e){let o=je(t);this._boundaryRect&&o!==this._boundaryElement&&o.contains(this._boundaryElement)&&Ge(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=et(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){let o=this._previewContainer||"global";if(o==="parent")return t;if(o==="global"){let a=this._document;return e||a.fullscreenElement||a.webkitFullscreenElement||a.mozFullScreenElement||a.msFullscreenElement||a.body}return Te(o)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(e=>t.target&&(t.target===e||e.contains(t.target)))}};function Li(n,t,e){return Math.max(t,Math.min(e,n))}function ze(n){return n.type[0]==="t"}function Kn(n){n.preventDefault()}function Vi(n,t,e){let o=Ti(t,n.length-1),a=Ti(e,n.length-1);if(o===a)return;let c=n[o],u=a<o?-1:1;for(let b=o;b!==a;b+=u)n[b]=n[b+u];n[a]=c}function Ti(n,t){return Math.max(0,Math.min(t,n))}var rt=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,e,o,a){let c=this._itemPositions,u=this._getItemIndexFromPointerPosition(t,e,o,a);if(u===-1&&c.length>0)return null;let b=this.orientation==="horizontal",y=c.findIndex(Y=>Y.drag===t),M=c[u],I=c[y].clientRect,Z=M.clientRect,ne=y>u?1:-1,pt=this._getItemOffsetPx(I,Z,ne),Ni=this._getSiblingOffsetPx(y,c,ne),ji=c.slice();return Vi(c,y,u),c.forEach((Y,zi)=>{if(ji[zi]===Y)return;let At=Y.drag===t,ut=At?pt:Ni,Ft=At?t.getPlaceholderElement():Y.drag.getRootElement();Y.offset+=ut;let Ht=Math.round(Y.offset*(1/Y.drag.scale));b?(Ft.style.transform=nt(`translate3d(${Ht}px, 0, 0)`,Y.initialTransform),Ge(Y.clientRect,0,ut)):(Ft.style.transform=nt(`translate3d(0, ${Ht}px, 0)`,Y.initialTransform),Ge(Y.clientRect,ut,0))}),this._previousSwap.overlaps=Tt(Z,e,o),this._previousSwap.drag=M.drag,this._previousSwap.delta=b?a.x:a.y,{previousIndex:y,currentIndex:u}}enter(t,e,o,a){let c=a==null||a<0?this._getItemIndexFromPointerPosition(t,e,o):a,u=this._activeDraggables,b=u.indexOf(t),y=t.getPlaceholderElement(),M=u[c];if(M===t&&(M=u[c+1]),!M&&(c==null||c===-1||c<u.length-1)&&this._shouldEnterAsFirstChild(e,o)&&(M=u[0]),b>-1&&u.splice(b,1),M&&!this._dragDropRegistry.isDragging(M)){let I=M.getRootElement();I.parentElement.insertBefore(y,I),u.splice(c,0,t)}else this._element.appendChild(y),u.push(t);y.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let e=t.getRootElement();if(e){let o=this._itemPositions.find(a=>a.drag===t)?.initialTransform;e.style.transform=o||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(o=>o.drag===t)}updateOnScroll(t,e){this._itemPositions.forEach(({clientRect:o})=>{Ge(o,t,e)}),this._itemPositions.forEach(({drag:o})=>{this._dragDropRegistry.isDragging(o)&&o._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let o=e.getVisibleElement();return{drag:e,offset:0,initialTransform:o.style.transform||"",clientRect:Ot(o)}}).sort((e,o)=>t?e.clientRect.left-o.clientRect.left:e.clientRect.top-o.clientRect.top)}_getItemOffsetPx(t,e,o){let a=this.orientation==="horizontal",c=a?e.left-t.left:e.top-t.top;return o===-1&&(c+=a?e.width-t.width:e.height-t.height),c}_getSiblingOffsetPx(t,e,o){let a=this.orientation==="horizontal",c=e[t].clientRect,u=e[t+o*-1],b=c[a?"width":"height"]*o;if(u){let y=a?"left":"top",M=a?"right":"bottom";o===-1?b-=u.clientRect[y]-c[M]:b+=c[y]-u.clientRect[M]}return b}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;let o=this._itemPositions,a=this.orientation==="horizontal";if(o[0].drag!==this._activeDraggables[0]){let u=o[o.length-1].clientRect;return a?t>=u.right:e>=u.bottom}else{let u=o[0].clientRect;return a?t<=u.left:e<=u.top}}_getItemIndexFromPointerPosition(t,e,o,a){let c=this.orientation==="horizontal",u=this._itemPositions.findIndex(({drag:b,clientRect:y})=>{if(b===t)return!1;if(a){let M=c?a.x:a.y;if(b===this._previousSwap.drag&&this._previousSwap.overlaps&&M===this._previousSwap.delta)return!1}return c?e>=Math.floor(y.left)&&e<Math.floor(y.right):o>=Math.floor(y.top)&&o<Math.floor(y.bottom)});return u===-1||!this._sortPredicate(u,t)?-1:u}},Pt=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,e){this._document=t,this._dragDropRegistry=e}start(t){let e=this._element.childNodes;this._relatedNodes=[];for(let o=0;o<e.length;o++){let a=e[o];this._relatedNodes.push([a,a.nextSibling])}this.withItems(t)}sort(t,e,o,a){let c=this._getItemIndexFromPointerPosition(t,e,o),u=this._previousSwap;if(c===-1||this._activeItems[c]===t)return null;let b=this._activeItems[c];if(u.drag===b&&u.overlaps&&u.deltaX===a.x&&u.deltaY===a.y)return null;let y=this.getItemIndex(t),M=t.getPlaceholderElement(),I=b.getRootElement();c>y?I.after(M):I.before(M),Vi(this._activeItems,y,c);let Z=this._getRootNode().elementFromPoint(e,o);return u.deltaX=a.x,u.deltaY=a.y,u.drag=b,u.overlaps=I===Z||I.contains(Z),{previousIndex:y,currentIndex:c}}enter(t,e,o,a){let c=a==null||a<0?this._getItemIndexFromPointerPosition(t,e,o):a;c===-1&&(c=this._getClosestItemIndexToPointer(t,e,o));let u=this._activeItems[c],b=this._activeItems.indexOf(t);b>-1&&this._activeItems.splice(b,1),u&&!this._dragDropRegistry.isDragging(u)?(this._activeItems.splice(c,0,t),u.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,e=this._previousSwap;for(let o=this._relatedNodes.length-1;o>-1;o--){let[a,c]=this._relatedNodes[o];a.parentNode===t&&a.nextSibling!==c&&(c===null?t.appendChild(a):c.parentNode===t&&t.insertBefore(a,c))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,e,o){let a=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(o)),c=a?this._activeItems.findIndex(u=>{let b=u.getRootElement();return a===b||b.contains(a)}):-1;return c===-1||!this._sortPredicate(c,t)?-1:c}_getRootNode(){return this._rootNode||(this._rootNode=et(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,e,o){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let a=1/0,c=-1;for(let u=0;u<this._activeItems.length;u++){let b=this._activeItems[u];if(b!==t){let{x:y,y:M}=b.getRootElement().getBoundingClientRect(),I=Math.hypot(e-y,o-M);I<a&&(a=I,c=u)}}return c}},Ii=.05,Oi=.05,X=function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n}(X||{}),U=function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n}(U||{}),Vt=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis;autoScrollDisabled=!1;autoScrollStep=2;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new T;entered=new T;exited=new T;dropped=new T;sorted=new T;receivingStarted=new T;receivingStopped=new T;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=we.EMPTY;_verticalScrollDirection=X.NONE;_horizontalScrollDirection=U.NONE;_scrollNode;_stopScrollTimers=new T;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,e,o,a,c){this._dragDropRegistry=e,this._ngZone=a,this._viewportRuler=c;let u=this.element=Te(t);this._document=o,this.withOrientation("vertical").withElementContainer(u),e.registerDropContainer(this),this._parentPositions=new it(o)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,o,a){this._draggingStarted(),a==null&&this.sortingDisabled&&(a=this._draggables.indexOf(t)),this._sortStrategy.enter(t,e,o,a),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,o,a,c,u,b,y={}){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:o,container:this,previousContainer:a,isPointerOverContainer:c,distance:u,dropPoint:b,event:y})}withItems(t){let e=this._draggables;return this._draggables=t,t.forEach(o=>o._withDropContainer(this)),this.isDragging()&&(e.filter(a=>a.isDragging()).every(a=>t.indexOf(a)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof rt&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new Pt(this._document,this._dragDropRegistry);else{let e=new rt(this._dragDropRegistry);e.direction=this._direction,e.orientation=t,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,o)=>this.sortPredicate(e,o,this)),this}withScrollableParents(t){let e=this._container;return this._scrollableElements=t.indexOf(e)===-1?[e,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let e=Te(this.element),o=this._scrollableElements.indexOf(this._container),a=this._scrollableElements.indexOf(t);return o>-1&&this._scrollableElements.splice(o,1),a>-1&&this._scrollableElements.splice(a,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,o,a){if(this.sortingDisabled||!this._domRect||!bi(this._domRect,Ii,e,o))return;let c=this._sortStrategy.sort(t,e,o,a);c&&this.sorted.next({previousIndex:c.previousIndex,currentIndex:c.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let o,a=X.NONE,c=U.NONE;if(this._parentPositions.positions.forEach((u,b)=>{b===this._document||!u.clientRect||o||bi(u.clientRect,Ii,t,e)&&([a,c]=Xn(b,u.clientRect,this._direction,t,e),(a||c)&&(o=b))}),!a&&!c){let{width:u,height:b}=this._viewportRuler.getViewportSize(),y={width:u,height:b,top:0,right:u,bottom:b,left:0};a=Ri(y,e),c=Ai(y,t),o=window}o&&(a!==this._verticalScrollDirection||c!==this._horizontalScrollDirection||o!==this._scrollNode)&&(this._verticalScrollDirection=a,this._horizontalScrollDirection=c,this._scrollNode=o,(a||c)&&o?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Nt(0,gt).pipe(D(this._stopScrollTimers)).subscribe(()=>{let t=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===X.UP?t.scrollBy(0,-e):this._verticalScrollDirection===X.DOWN&&t.scrollBy(0,e),this._horizontalScrollDirection===U.LEFT?t.scrollBy(-e,0):this._horizontalScrollDirection===U.RIGHT&&t.scrollBy(e,0)})};_isOverContainer(t,e){return this._domRect!=null&&Tt(this._domRect,t,e)}_getSiblingContainerFromPosition(t,e,o){return this._siblings.find(a=>a._canReceive(t,e,o))}_canReceive(t,e,o){if(!this._domRect||!Tt(this._domRect,e,o)||!this.enterPredicate(t,this))return!1;let a=this._getShadowRoot().elementFromPoint(e,o);return a?a===this._container||this._container.contains(a):!1}_startReceiving(t,e){let o=this._activeSiblings;!o.has(t)&&e.every(a=>this.enterPredicate(a,this)||this._draggables.indexOf(a)>-1)&&(o.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:e}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(t);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=et(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}};function Ri(n,t){let{top:e,bottom:o,height:a}=n,c=a*Oi;return t>=e-c&&t<=e+c?X.UP:t>=o-c&&t<=o+c?X.DOWN:X.NONE}function Ai(n,t){let{left:e,right:o,width:a}=n,c=a*Oi;return t>=e-c&&t<=e+c?U.LEFT:t>=o-c&&t<=o+c?U.RIGHT:U.NONE}function Xn(n,t,e,o,a){let c=Ri(t,a),u=Ai(t,o),b=X.NONE,y=U.NONE;if(c){let M=n.scrollTop;c===X.UP?M>0&&(b=X.UP):n.scrollHeight-M>n.clientHeight&&(b=X.DOWN)}if(u){let M=n.scrollLeft;e==="rtl"?u===U.RIGHT?M<0&&(y=U.RIGHT):n.scrollWidth+M>n.clientWidth&&(y=U.LEFT):u===U.LEFT?M>0&&(y=U.LEFT):n.scrollWidth-M>n.clientWidth&&(y=U.RIGHT)}return[b,y]}var Be={capture:!0},Lt={passive:!1,capture:!0},Jn=(()=>{class n{static \u0275fac=function(o){return new(o||n)};static \u0275cmp=R({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(o,a){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return n})(),eo=(()=>{class n{_ngZone=A(Fe);_document=A(Ne);_styleLoader=A(hi);_renderer=A(He).createRenderer(null,null);_cleanupDocumentTouchmove;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=_t([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new T;pointerUp=new T;scroll=new T;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=be(this._renderer,this._document,"touchmove",this._persistentTouchmoveListener,Lt)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,o){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(Jn),this._activeDragInstances.update(a=>[...a,e]),this._activeDragInstances().length===1)){let a=o.type.startsWith("touch"),c=b=>this.pointerUp.next(b),u=[["scroll",b=>this.scroll.next(b),Be],["selectstart",this._preventDefaultWhileDragging,Lt]];a?u.push(["touchend",c,Be],["touchcancel",c,Be]):u.push(["mouseup",c,Be]),a||u.push(["mousemove",b=>this.pointerMove.next(b),Lt]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=u.map(([b,y,M])=>be(this._renderer,this._document,b,y,M))})}}stopDragging(e){this._activeDragInstances.update(o=>{let a=o.indexOf(e);return a>-1?(o.splice(a,1),[...o]):o}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let o=[this.scroll];return e&&e!==this._document&&o.push(new ht(a=>this._ngZone.runOutsideAngular(()=>{let c=be(this._renderer,e,"scroll",u=>{this._activeDragInstances().length&&a.next(u)},Be);return()=>{c()}}))),jt(...o)}registerDirectiveNode(e,o){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,o)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(o){return new(o||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),to={dragStartThreshold:5,pointerDirectionChangeThreshold:5},io=(()=>{class n{_document=A(Ne);_ngZone=A(Fe);_viewportRuler=A(_i);_dragDropRegistry=A(eo);_renderer=A(He).createRenderer(null,null);constructor(){}createDrag(e,o=to){return new Dt(e,o,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(e){return new Vt(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(o){return new(o||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Fi=(()=>{class n{static \u0275fac=function(o){return new(o||n)};static \u0275mod=le({type:n});static \u0275inj=ae({providers:[io],imports:[fi]})}return n})();function no(n,t){if(n&1){let e=S();i(0,"div",4)(1,"button",9),_("click",function(){f(e);let a=m();return v(a.moveSelectedToRoot())}),l(2),r(),i(3,"button",10),_("click",function(){f(e);let a=m();return v(a.deleteSelected())}),l(4),r(),i(5,"button",11),_("click",function(){f(e);let a=m();return v(a.clearSelection())}),l(6," Clear Selection "),r()()}if(n&2){let e=m();s(2),w(" Move to Root (",e.selectedNodes.size,") "),s(2),w(" Delete Selected (",e.selectedNodes.size,") ")}}function oo(n,t){n&1&&(i(0,"div",12)(1,"div",13)(2,"div",14),h(),i(3,"svg",15),p(4,"circle",16)(5,"path",17),r()(),x(),i(6,"h3",18),l(7,"Loading Hierarchy"),r(),i(8,"p",19),l(9,"Please wait while we fetch the location hierarchy..."),r()()())}function ro(n,t){if(n&1){let e=S();i(0,"div",20)(1,"div",21),h(),i(2,"svg",22),p(3,"path",23),r()(),x(),i(4,"h3",18),l(5,"Error Loading Hierarchy"),r(),i(6,"p",24),l(7),r(),i(8,"button",25),_("click",function(){f(e);let a=m();return v(a.loadHierarchy())}),l(9," Retry "),r()()}if(n&2){let e=m();s(7),C(e.error)}}function ao(n,t){if(n&1&&(i(0,"span",48),l(1),r()),n&2){let e=m().$implicit;s(),G(" ",e.children.length," sub-location",e.children.length!==1?"s":""," ")}}function so(n,t){if(n&1&&(i(0,"div",49)(1,"span",50),l(2),r()()),n&2){let e=m().$implicit,o=m(2);s(2),w(" ",o.getLevelText(e)," ")}}function lo(n,t){if(n&1&&(i(0,"span",48),l(1),r()),n&2){let e=m().$implicit;s(),G(" ",e.children.length," sub-location",e.children.length!==1?"s":""," ")}}function co(n,t){if(n&1&&(i(0,"span",50),l(1),r()),n&2){let e=m().$implicit,o=m(4);s(),w(" ",o.getLevelText(e)," ")}}function mo(n,t){if(n&1&&(i(0,"span",64),l(1),r()),n&2){let e=m().$implicit,o=m(6);s(),w(" ",o.getLevelText(e)," ")}}function po(n,t){if(n&1){let e=S();i(0,"div",61),_("click",function(a){let c=f(e).$implicit,u=m(6);return v(u.toggleNodeSelection(c,a))})("dragover",function(a){f(e);let c=m(6);return v(c.onDragOver(a))})("drop",function(a){let c=f(e).$implicit,u=m(6);return v(u.onDropOnNode(a,c))}),i(1,"div",35)(2,"div",4)(3,"div",36),_("dragstart",function(a){let c=f(e).$implicit,u=m(6);return v(u.onDragStart(a,c))})("dragend",function(a){f(e);let c=m(6);return v(c.onDragEnd(a))}),h(),i(4,"svg",37),p(5,"path",38),r()(),x(),i(6,"div"),h(),i(7,"svg",39),p(8,"path",40),r()(),x(),i(9,"div",41)(10,"div",4)(11,"span",55),l(12),r(),i(13,"span",62),l(14),r()(),i(15,"div",44),l(16),r()()(),g(17,mo,2,1,"span",63),r()()}if(n&2){let e=t.$implicit,o=m(6);E("ring-2",e.selected)("ring-blue-500",e.selected)("bg-blue-50",e.selected),s(6),O("w-6 h-6 bg-"+o.getNodeIconColor(e)+"-100 rounded flex items-center justify-center"),s(),O("w-3 h-3 text-"+o.getNodeIconColor(e)+"-600"),s(),Ce("d",o.getNodeIcon(e)),s(4),C(e.name),s(2),w(" ",(e.type==null?null:e.type.name)||"Floor"," "),s(2),w("",e.asset_count," assets"),s(),d("ngIf",!1)}}function uo(n,t){if(n&1&&(i(0,"div",59),g(1,po,18,15,"div",60),r()),n&2){let e=m().$implicit;s(),d("ngForOf",e.children)}}function ho(n,t){if(n&1){let e=S();i(0,"div",53),_("click",function(a){let c=f(e).$implicit,u=m(4);return v(u.toggleNodeSelection(c,a))})("dragover",function(a){f(e);let c=m(4);return v(c.onDragOver(a))})("drop",function(a){let c=f(e).$implicit,u=m(4);return v(u.onDropOnNode(a,c))}),i(1,"div",35)(2,"div",4)(3,"div",54),_("dragstart",function(a){let c=f(e).$implicit,u=m(4);return v(u.onDragStart(a,c))})("dragend",function(a){f(e);let c=m(4);return v(c.onDragEnd(a))}),h(),i(4,"svg",37),p(5,"path",38),r()(),x(),i(6,"div"),h(),i(7,"svg",39),p(8,"path",40),r()(),x(),i(9,"div",41)(10,"div",4)(11,"span",55),l(12),r(),i(13,"span",56),l(14),r()(),i(15,"div",44),l(16),g(17,lo,2,2,"span",45),r()()(),g(18,co,2,1,"span",57),r(),g(19,uo,2,1,"div",58),r()}if(n&2){let e=t.$implicit,o=m(4);E("ring-2",e.selected)("ring-blue-500",e.selected)("bg-blue-50",e.selected),s(6),O("w-8 h-8 bg-"+o.getNodeIconColor(e)+"-100 rounded flex items-center justify-center"),s(),O("w-4 h-4 text-"+o.getNodeIconColor(e)+"-600"),s(),Ce("d",o.getNodeIcon(e)),s(4),C(e.name),s(2),w(" ",(e.type==null?null:e.type.name)||"Residential Building"," "),s(2),w(" ",e.asset_count," assets "),s(),d("ngIf",e.children.length>0),s(),d("ngIf",!1),s(),d("ngIf",e.children.length>0)}}function go(n,t){if(n&1&&(i(0,"div",51),g(1,ho,20,17,"div",52),r()),n&2){let e=m().$implicit;s(),d("ngForOf",e.children)}}function _o(n,t){if(n&1){let e=S();i(0,"div",33)(1,"div",34),_("click",function(a){let c=f(e).$implicit,u=m(2);return v(u.toggleNodeSelection(c,a))})("dragover",function(a){f(e);let c=m(2);return v(c.onDragOver(a))})("drop",function(a){let c=f(e).$implicit,u=m(2);return v(u.onDropOnNode(a,c))}),i(2,"div",35)(3,"div",4)(4,"div",36),_("dragstart",function(a){let c=f(e).$implicit,u=m(2);return v(u.onDragStart(a,c))})("dragend",function(a){f(e);let c=m(2);return v(c.onDragEnd(a))}),h(),i(5,"svg",37),p(6,"path",38),r()(),x(),i(7,"div"),h(),i(8,"svg",39),p(9,"path",40),r()(),x(),i(10,"div",41)(11,"div",4)(12,"span",42),l(13),r(),i(14,"span",43),l(15),r()(),i(16,"div",44),l(17),g(18,ao,2,2,"span",45),r()()(),g(19,so,3,1,"div",46),r(),g(20,go,2,1,"div",47),r()()}if(n&2){let e=t.$implicit,o=m(2);s(),E("ring-2",e.selected)("ring-blue-500",e.selected)("bg-blue-50",e.selected),s(6),O("w-10 h-10 bg-"+o.getNodeIconColor(e)+"-100 rounded-lg flex items-center justify-center"),s(),O("w-5 h-5 text-"+o.getNodeIconColor(e)+"-600"),s(),Ce("d",o.getNodeIcon(e)),s(4),C(e.name),s(2),w(" ",(e.type==null?null:e.type.name)||"Community"," "),s(2),w(" ",e.asset_count," assets "),s(),d("ngIf",e.children.length>0),s(),d("ngIf",!1),s(),d("ngIf",e.children.length>0)}}function fo(n,t){n&1&&(i(0,"div",20)(1,"div",65),h(),i(2,"svg",66),p(3,"path",67),r()(),x(),i(4,"h3",18),l(5,"No hierarchy data"),r(),i(6,"p",19),l(7,"Create some locations to manage the hierarchy."),r()())}function vo(n,t){if(n&1){let e=S();i(0,"div",26)(1,"div",27),_("dragover",function(a){f(e);let c=m();return v(c.onDragOver(a))})("drop",function(a){f(e);let c=m();return v(c.onDropToRoot(a))}),i(2,"div",28),h(),i(3,"svg",29),p(4,"path",30),r(),x(),i(5,"span",31),l(6,"Root Level - Drop here to make location top-level"),r()()(),i(7,"div",26),g(8,_o,21,17,"div",32),r(),g(9,fo,8,0,"div",6),r()}if(n&2){let e=m();s(),E("border-blue-500",e.dropZoneActive)("bg-blue-50",e.dropZoneActive),s(7),d("ngForOf",e.hierarchyData),s(),d("ngIf",e.hierarchyData.length===0)}}var at=class n{constructor(t){this.locationService=t}destroy$=new T;hierarchyData=[];selectedNodes=new Set;loading=!1;error="";draggedNode=null;dropZoneActive=!1;showDeleteConfirmationModal=!1;selectedLocation=null;ngOnInit(){this.loadHierarchy()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadHierarchy(){this.loading=!0,this.error="",this.locationService.getHierarchy().pipe(D(this.destroy$)).subscribe({next:t=>{t.success?this.hierarchyData=this.transformHierarchyData(t.data.hierarchy):this.error="Failed to load hierarchy data",this.loading=!1},error:t=>{this.error=t.error?.message||"An error occurred while loading hierarchy",this.loading=!1}})}transformHierarchyData(t){return t.map(e=>({id:e.id,name:e.name,type:e.type,hierarchy_level:e.hierarchy_level||0,asset_count:e.asset_count||0,children:e.children?this.transformHierarchyData(e.children):[],parent_id:e.parent_id,selected:!1,expanded:!0}))}toggleNodeSelection(t,e){e.stopPropagation(),e.ctrlKey||e.metaKey?this.selectedNodes.has(t.id)?(this.selectedNodes.delete(t.id),t.selected=!1):(this.selectedNodes.add(t.id),t.selected=!0):(this.clearSelection(),this.selectedNodes.add(t.id),t.selected=!0)}clearSelection(){this.selectedNodes.clear(),this.updateSelectionState(this.hierarchyData,!1)}updateSelectionState(t,e){t.forEach(o=>{o.selected=e,o.children.length>0&&this.updateSelectionState(o.children,e)})}onDragStart(t,e){this.draggedNode=e,this.dropZoneActive=!0,t.dataTransfer.effectAllowed="move"}onDragEnd(t){this.draggedNode=null,this.dropZoneActive=!1}onDragOver(t){t.preventDefault(),t.dataTransfer.dropEffect="move"}onDropToRoot(t){t.preventDefault(),this.draggedNode&&this.moveToRoot(this.draggedNode),this.dropZoneActive=!1,this.draggedNode=null}onDropOnNode(t,e){t.preventDefault(),t.stopPropagation(),this.draggedNode&&this.draggedNode.id!==e.id&&this.moveToParent(this.draggedNode,e),this.dropZoneActive=!1,this.draggedNode=null}moveToRoot(t){this.removeNodeFromHierarchy(t),t.hierarchy_level=0,t.parent_id=void 0,this.hierarchyData.push(t),this.updateLocationHierarchy(t.id,null)}moveToParent(t,e){this.removeNodeFromHierarchy(t),t.hierarchy_level=e.hierarchy_level+1,t.parent_id=e.id,e.children.push(t),e.expanded=!0,this.updateLocationHierarchy(t.id,e.id)}removeNodeFromHierarchy(t){let e=this.hierarchyData.findIndex(o=>o.id===t.id);if(e!==-1){this.hierarchyData.splice(e,1);return}this.removeFromChildren(this.hierarchyData,t)}removeFromChildren(t,e){for(let o of t){let a=o.children.findIndex(c=>c.id===e.id);if(a!==-1)return o.children.splice(a,1),!0;if(this.removeFromChildren(o.children,e))return!0}return!1}updateLocationHierarchy(t,e){this.locationService.moveLocations([t],e).pipe(D(this.destroy$)).subscribe({next:o=>{o.success?console.log("Location moved successfully"):(console.error("Failed to move location:",o.message),this.loadHierarchy())},error:o=>{console.error("Error moving location:",o),this.loadHierarchy()}})}moveSelectedToRoot(){if(this.selectedNodes.size===0)return;let t=Array.from(this.selectedNodes);this.locationService.moveLocations(t,null).pipe(D(this.destroy$)).subscribe({next:e=>{e.success&&(this.loadHierarchy(),this.clearSelection())},error:e=>{console.error("Error moving locations:",e)}})}deleteSelected(){this.selectedNodes.size!==0&&this.selectedNodes.forEach(t=>{this.loadLocation(t)})}loadLocation(t){this.locationService.getLocation(t).pipe(D(this.destroy$)).subscribe({next:e=>{e.success&&(this.selectedLocation=e.data.location,this.showDeleteConfirmationModal=!0)}})}getNodeIcon(t){return t.hierarchy_level===0||t.hierarchy_level===1?"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4":"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"}getNodeIconColor(t){return t.hierarchy_level===0||t.hierarchy_level===1?"blue":"green"}getLevelText(t){return t.hierarchy_level===0?"Level 0":"Parent"}closeDeleteConfirmationModal(){this.showDeleteConfirmationModal=!1,this.selectedLocation=null}onLocationDeleted(){this.loadHierarchy(),this.closeDeleteConfirmationModal()}static \u0275fac=function(e){return new(e||n)(L(z))};static \u0275cmp=R({type:n,selectors:[["app-hierarchy-management"]],decls:12,vars:6,consts:[[1,"hierarchy-management"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"flex","items-center","space-x-3"],["class","flex items-center justify-center py-20",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-4",4,"ngIf"],[3,"closeModal","locationDeleted","isOpen","location"],[1,"px-4","py-2","text-blue-600","hover:bg-blue-50","rounded-lg","transition-colors","text-sm","font-medium",3,"click"],[1,"px-4","py-2","text-red-600","hover:bg-red-50","rounded-lg","transition-colors","text-sm","font-medium",3,"click"],[1,"px-4","py-2","text-gray-600","hover:bg-gray-100","rounded-lg","transition-colors","text-sm","font-medium",3,"click"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","rounded-full","mb-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-8","h-8","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500"],[1,"text-center","py-12"],[1,"w-16","h-16","bg-red-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-sm","text-gray-500","mb-4"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"space-y-4"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-8","text-center","transition-all",3,"dragover","drop"],[1,"flex","items-center","justify-center","space-x-2","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"font-medium"],["class","hierarchy-card",4,"ngFor","ngForOf"],[1,"hierarchy-card"],[1,"bg-white","border","border-gray-200","rounded-lg","p-4","transition-all","hover:shadow-sm",3,"click","dragover","drop"],[1,"flex","items-center","justify-between"],["draggable","true",1,"drag-handle","cursor-move","p-1","hover:bg-gray-100","rounded",3,"dragstart","dragend"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 8h16M4 16h16"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"flex-1"],[1,"font-semibold","text-gray-900"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-gray-100","text-gray-700"],[1,"text-sm","text-gray-500","mt-1"],["class","ml-4",4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],["class","mt-4 ml-7 space-y-3",4,"ngIf"],[1,"ml-4"],[1,"flex","items-center","space-x-2"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"mt-4","ml-7","space-y-3"],["class","bg-gray-50 rounded-lg p-3 transition-all hover:bg-gray-100",3,"ring-2","ring-blue-500","bg-blue-50","click","dragover","drop",4,"ngFor","ngForOf"],[1,"bg-gray-50","rounded-lg","p-3","transition-all","hover:bg-gray-100",3,"click","dragover","drop"],["draggable","true",1,"drag-handle","cursor-move","p-1","hover:bg-gray-200","rounded",3,"dragstart","dragend"],[1,"font-medium","text-gray-900"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-blue-100","text-blue-700"],["class","inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",4,"ngIf"],["class","mt-3 ml-7 space-y-2",4,"ngIf"],[1,"mt-3","ml-7","space-y-2"],["class","bg-white rounded border border-gray-100 p-3 transition-all hover:shadow-sm",3,"ring-2","ring-blue-500","bg-blue-50","click","dragover","drop",4,"ngFor","ngForOf"],[1,"bg-white","rounded","border","border-gray-100","p-3","transition-all","hover:shadow-sm",3,"click","dragover","drop"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-green-100","text-green-700"],["class","inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800",4,"ngIf"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-green-100","text-green-800"],[1,"w-16","h-16","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),l(4,"Hierarchy Management"),r(),i(5,"p",3),l(6," Drag and drop locations to reorganize your hierarchy. Hold Ctrl/Cmd and click to select multiple locations for bulk operations. "),r()(),g(7,no,7,2,"div",4),r(),g(8,oo,10,0,"div",5)(9,ro,10,1,"div",6)(10,vo,10,6,"div",7),r(),i(11,"app-delete-confirmation-modal",8),_("closeModal",function(){return o.closeDeleteConfirmationModal()})("locationDeleted",function(){return o.onLocationDeleted()}),r()),e&2&&(s(7),De(o.selectedNodes.size>0?7:-1),s(),d("ngIf",o.loading),s(),d("ngIf",o.error&&!o.loading),s(),d("ngIf",!o.loading&&!o.error),s(),d("isOpen",o.showDeleteConfirmationModal)("location",o.selectedLocation))},dependencies:[j,W,N,Fi,ye],styles:['.hierarchy-management[_ngcontent-%COMP%]   .hierarchy-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.hierarchy-management[_ngcontent-%COMP%]   .hierarchy-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.hierarchy-management[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{opacity:.6;transition:all .2s ease-in-out}.hierarchy-management[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]:hover{opacity:1;background-color:#f3f4f6}.hierarchy-management[_ngcontent-%COMP%]   .dragging[_ngcontent-%COMP%]{opacity:.5;transform:rotate(2deg)}.hierarchy-management[_ngcontent-%COMP%]   .drop-zone-active[_ngcontent-%COMP%]{border-color:#3b82f6!important;background-color:#eff6ff!important}.hierarchy-management[_ngcontent-%COMP%]   .drop-zone-active[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;border:2px dashed #3b82f6;border-radius:.5rem;pointer-events:none}.hierarchy-management[_ngcontent-%COMP%]   .drop-target[_ngcontent-%COMP%]{background-color:#eff6ff;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f633}.hierarchy-management[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:#eff6ff!important;border-color:#3b82f6!important;box-shadow:0 0 0 2px #3b82f633}.hierarchy-management[_ngcontent-%COMP%]   .level-0[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.hierarchy-management[_ngcontent-%COMP%]   .level-1[_ngcontent-%COMP%]{border-left:4px solid #10b981;margin-left:1rem}.hierarchy-management[_ngcontent-%COMP%]   .level-2[_ngcontent-%COMP%]{border-left:4px solid #f59e0b;margin-left:2rem}.hierarchy-management[_ngcontent-%COMP%]   .node-card[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.hierarchy-management[_ngcontent-%COMP%]   .node-card[_ngcontent-%COMP%]:hover{background-color:#f8fafc;border-color:#e2e8f0;box-shadow:0 1px 3px #0000001a}.hierarchy-management[_ngcontent-%COMP%]   .level-badge[_ngcontent-%COMP%]{font-weight:600;font-size:.75rem;padding:.25rem .5rem;border-radius:9999px}.hierarchy-management[_ngcontent-%COMP%]   .node-icon[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.hierarchy-management[_ngcontent-%COMP%]   .node-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.hierarchy-management[_ngcontent-%COMP%]   .multi-select-info[_ngcontent-%COMP%]{position:fixed;bottom:2rem;right:2rem;background:#1f2937;color:#fff;padding:.75rem 1rem;border-radius:.5rem;font-size:.875rem;z-index:50;box-shadow:0 10px 15px -3px #0000001a}.hierarchy-management[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.hierarchy-management[_ngcontent-%COMP%]   .hierarchy-card[_ngcontent-%COMP%]{margin:.5rem}.hierarchy-management[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{display:none}.hierarchy-management[_ngcontent-%COMP%]   .level-1[_ngcontent-%COMP%]{margin-left:.5rem}.hierarchy-management[_ngcontent-%COMP%]   .level-2[_ngcontent-%COMP%]{margin-left:1rem}}@media print{.hierarchy-management[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%], .hierarchy-management[_ngcontent-%COMP%]   .multi-select-info[_ngcontent-%COMP%]{display:none}}.hierarchy-management[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}.hierarchy-management[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.hierarchy-management[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.hierarchy-management[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.hierarchy-management[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;background:#fff;border:1px solid #e5e7eb}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.4;background:#f3f4f6;border:2px dashed #d1d5db}.cdk-drag-animating[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}']})};function xo(n,t){if(n&1&&(i(0,"div",13),p(1,"img",31),r()),n&2){let e=m(2);s(),d("src",e.location==null?null:e.location.quick_chart_qr_url,H)}}function yo(n,t){n&1&&p(0,"span",14)}function bo(n,t){if(n&1){let e=S();i(0,"div",1)(1,"div",2),_("clickOutside",function(){f(e);let a=m();return v(a.closeModalHandler())}),i(2,"div",3)(3,"div",4)(4,"h2",5),l(5),r()()(),i(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),h(),i(10,"svg",10),p(11,"path",11),r()(),l(12," Location QR Code "),r(),x(),i(13,"div",12),g(14,xo,2,1,"div",13)(15,yo,1,0,"span",14),r(),i(16,"div",15)(17,"div",16),l(18),r(),i(19,"div",17)(20,"div",18),l(21),r(),l(22),r(),i(23,"div",19),h(),i(24,"svg",20),p(25,"path",21)(26,"circle",22),r(),x(),i(27,"span",23),l(28),r()(),i(29,"div",24)(30,"button",25),_("click",function(){f(e);let a=m();return v(a.regenerateQr())}),h(),i(31,"svg",10),p(32,"path",11),r(),l(33," Regenerate "),r(),x(),i(34,"a",26),_("click",function(){f(e);let a=m();return v(a.downloadQr())}),h(),i(35,"svg",27),p(36,"path",28),r(),l(37," Download "),r(),x(),i(38,"button",25),_("click",function(){f(e);let a=m();return v(a.printLabel())}),h(),i(39,"svg",27),p(40,"path",29),r(),l(41," Print Label "),r()(),x(),i(42,"div",30),l(43,"Scan this QR code to quickly access location details and view assets "),r()()()()()()}if(n&2){let e=m();d("@backdropAnimation",void 0),s(),d("@modalAnimation",void 0),s(4),w("Generate QR Code for ",e.location==null?null:e.location.name,""),s(9),De(e.regenLoading?15:14),s(4),C(e.location==null?null:e.location.name),s(3),w(" ",e.location==null||e.location.type==null?null:e.location.type.name," "),s(),w(" ",e.location==null?null:e.location.hierarchy_level," "),s(6),C((e.location==null?null:e.location.address)||"N/A"),s(6),d("href",e.location==null?null:e.location.quick_chart_qr_url,H)("download",e.location==null?null:e.location.quick_chart_qr_url)}}var st=class n{constructor(t){this.locationService=t}isOpen=!1;location=null;closeModal=new F;loading=!1;regenLoading=!1;errorMessage;closeModalHandler(){this.loading||(this.isOpen=!1,this.closeModal.emit(),this.resetModal())}resetModal(){this.errorMessage="",this.loading=!1}regenerateQr(){this.regenLoading=!0,setTimeout(()=>{this.regenLoading=!1},500)}downloadQr(){}getLocationTypeById(t){}printLabel(){if(this.location?.quick_chart_qr_url){let t=window.open("","_blank");t&&(t.document.write(`
          <html>
         <head>
           <title>Print Label</title>
           <style>
             body {
               font-family: Arial, sans-serif;
               text-align: center;
               margin: 20px;
             }
             img {
               max-width: 100%;
               height: auto;
               margin: 10px 0;
             }
             .info {
               margin-top: 15px;
               font-size: 14px;

             }
             .info strong {
               display: inline-block;
              margin: 0 auto;
               width: 120px;
             }
           </style>
         </head>
         <body>
           <h1>${this.location.name}</h1>
           <img src="${this.location.quick_chart_qr_url}" alt="QR Code for ${this.location.name}">
           <p>Scan this QR code to access location details.</p>

           <div class="info text-center">
             <p><strong>Branch:</strong> ${this.location.name}</p>
             <p><strong>Location ID:</strong> ${this.location.id}</p>
             <p><strong>Type:</strong> ${this.location.type.name}</p>
             <p><strong>Address:</strong> ${this.location.address}</p>
           </div>

           <script>
             window.onload = function() {
               setTimeout(() => {
                 window.print();
                 window.close();
               }, 200);
             };
           <\/script>
         </body>
       </html>
       `),t.document.close())}else console.error("QR code URL is not available for printing.")}static \u0275fac=function(e){return new(e||n)(L(z))};static \u0275cmp=R({type:n,selectors:[["app-qr-view"]],inputs:{isOpen:"isOpen",location:"location"},outputs:{closeModal:"closeModal"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-[#00000085] flex items-center justify-center p-4","style","z-index: 1000;",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","p-4",2,"z-index","1000"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-xl","w-full",3,"clickOutside"],[1,"flex","items-center","justify-between","p-6","border-gray-200"],[1,"flex","items-center","space-x-3"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-6","pt-0"],[1,"p-6","border","border-gray-200","rounded-2xl"],[1,"flex","items-center","gap-2","font-semibold","mb-6","tracking-tight","text-lg"],[1,"p-2","text-gray-400","bg-gray-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"],[1,"flex","justify-center"],[1,"bg-white","p-4","rounded-lg","border","border-gray-200","shadow-sm"],[1,"border-t","border-blue-400","animate-spin","border-opacity-25","ml-2","w-12","h-12","rounded-full","inline-block"],[1,"space-y-2","mt-4","text-center"],[1,"font-medium","text-sm","text-foreground"],[1,"flex","items-center","justify-center","gap-2"],[1,"inline-flex","items-center","rounded-full","border","border-gray-200","px-2.5","py-0.5","font-semibold","transition-colors","text-xs"],[1,"flex","items-center","justify-center","gap-1","text-xs","text-gray-400"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"size-3"],["d","M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"],["cx","12","cy","10","r","3"],[1,"truncate","max-w-[200px]"],[1,"flex","gap-2","justify-center","my-4"],[1,"flex","gap-2","items-center","text-sm","font-medium","border","border-gray-200","rounded-lg","py-2","px-3","cursor-pointer","hover:bg-gray-100","transition-colors",3,"click"],["target","_blank",1,"flex","gap-2","items-center","text-sm","font-medium","border","border-gray-200","rounded-lg","py-2","px-3","cursor-pointer","hover:bg-gray-100","transition-colors",3,"click","href","download"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-4"],["stroke-linecap","round","stroke-linejoin","round","d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"],["stroke-linecap","round","stroke-linejoin","round","d","M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"],[1,"text-xs","text-gray-400","text-center","pt-2","border-t","border-gray-200"],["alt","qr code",1,"w-40","h-40",3,"src"]],template:function(e,o){e&1&&g(0,bo,44,10,"div",0),e&2&&d("ngIf",o.isOpen)},dependencies:[N,mi],encapsulation:2,data:{animation:[$("backdropAnimation",[V(":enter",[k({opacity:0}),P("150ms ease-out",k({opacity:1}))]),V(":leave",[P("150ms ease-in",k({opacity:0}))])]),$("modalAnimation",[V(":enter",[k({opacity:0,transform:"scale(0.7) translateY(-50px)"}),P("200ms ease-out",k({opacity:1,transform:"scale(1) translateY(0)"}))]),V(":leave",[P("150ms ease-in",k({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};var lt=class n{constructor(t,e){this.el=t;this.renderer=e}tooltipText="";tooltipPosition="top";tooltipElement=null;onMouseEnter(){this.tooltipText&&this.show()}onMouseLeave(){this.hide()}show(){this.tooltipElement=this.renderer.createElement("div"),this.renderer.addClass(this.tooltipElement,"custom-tooltip"),this.renderer.addClass(this.tooltipElement,`tooltip-${this.tooltipPosition}`);let t=this.renderer.createText(this.tooltipText);this.renderer.appendChild(this.tooltipElement,t),this.renderer.appendChild(document.body,this.tooltipElement),this.positionTooltip(),setTimeout(()=>{this.tooltipElement&&this.renderer.addClass(this.tooltipElement,"tooltip-show")},10)}hide(){this.tooltipElement&&(this.renderer.removeClass(this.tooltipElement,"tooltip-show"),setTimeout(()=>{this.tooltipElement&&(this.renderer.removeChild(document.body,this.tooltipElement),this.tooltipElement=null)},200))}positionTooltip(){if(!this.tooltipElement)return;let t=this.el.nativeElement.getBoundingClientRect(),e=this.tooltipElement.getBoundingClientRect(),o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,a=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,c=0,u=0;switch(this.tooltipPosition){case"top":c=t.top-e.height-8,u=t.left+(t.width-e.width)/2;break;case"bottom":c=t.bottom+8,u=t.left+(t.width-e.width)/2;break;case"left":c=t.top+(t.height-e.height)/2,u=t.left-e.width-8;break;case"right":c=t.top+(t.height-e.height)/2,u=t.right+8;break}this.renderer.setStyle(this.tooltipElement,"top",`${c+o}px`),this.renderer.setStyle(this.tooltipElement,"left",`${u+a}px`)}ngOnDestroy(){this.hide()}static \u0275fac=function(e){return new(e||n)(L(Ie),L(ft))};static \u0275dir=We({type:n,selectors:[["","appTooltip",""]],hostBindings:function(e,o){e&1&&_("mouseenter",function(){return o.onMouseEnter()})("mouseleave",function(){return o.onMouseLeave()})},inputs:{tooltipText:[0,"appTooltip","tooltipText"],tooltipPosition:"tooltipPosition"}})};function Co(n,t){n&1&&(h(),i(0,"svg",10),p(1,"path",26),r())}function So(n,t){n&1&&p(0,"div",27)}function Mo(n,t){if(n&1&&(i(0,"option",55),l(1),r()),n&2){let e=t.$implicit;d("value",e.id),s(),C(e.name)}}function Eo(n,t){if(n&1&&(i(0,"option",55),l(1),r()),n&2){let e=t.$implicit;d("value",e.value),s(),C(e.label)}}function ko(n,t){if(n&1){let e=S();i(0,"div",39)(1,"form",40),_("ngSubmit",function(){f(e);let a=m(2);return v(a.applyFilters())}),i(2,"div",41)(3,"div")(4,"label",42),l(5,"Location Type"),r(),i(6,"select",43)(7,"option",44),l(8,"All Types"),r(),g(9,Mo,2,2,"option",45),r()(),i(10,"div")(11,"label",42),l(12,"Hierarchy Level"),r(),i(13,"select",46),g(14,Eo,2,2,"option",45),r()(),i(15,"div")(16,"label",42),l(17,"Asset Count"),r(),i(18,"select",47)(19,"option",44),l(20,"Any Count"),r(),i(21,"option",48),l(22,"No Assets"),r(),i(23,"option",49),l(24,"1-10 Assets"),r(),i(25,"option",50),l(26,"11-50 Assets"),r(),i(27,"option",51),l(28,"51+ Assets"),r()()()(),i(29,"div",52)(30,"button",53),_("click",function(){f(e);let a=m(2);return v(a.clearFilters())}),l(31," Clear Filters "),r(),i(32,"button",54),l(33," Apply Filters "),r()()()()}if(n&2){let e=m(2);E("right-0",!e.isRtl())("left-0",e.isRtl()),s(),d("formGroup",e.filtersForm),s(8),d("ngForOf",e.locationTypes),s(5),d("ngForOf",e.hierarchyLevels)}}function Lo(n,t){if(n&1){let e=S();i(0,"div",28)(1,"div",2)(2,"form",29)(3,"div",30),h(),i(4,"svg",31),p(5,"path",32),r(),x(),p(6,"input",33),r()(),i(7,"div",30)(8,"button",34),_("click",function(){f(e);let a=m();return v(a.toggleFilters())}),h(),i(9,"svg",10),p(10,"path",35),r(),x(),i(11,"span"),l(12,"Filters"),r(),h(),i(13,"svg",36),p(14,"path",37),r()(),g(15,ko,34,7,"div",38),r()()()}if(n&2){let e=m();s(2),d("formGroup",e.searchForm),s(11),E("rotate-180",e.showFilters),s(2),d("ngIf",e.showFilters)}}function To(n,t){n&1&&(h(),i(0,"svg",74),p(1,"path",75),r())}function Io(n,t){if(n&1){let e=S();i(0,"button",72),_("click",function(){let a=f(e).$implicit,c=m(3);return c.onSortChange(a.value),v(c.showSortDropdown=!1)}),i(1,"span"),l(2),r(),g(3,To,2,0,"svg",73),r()}if(n&2){let e=t.$implicit,o=m(3);E("text-left",!o.isRtl())("text-right",o.isRtl())("bg-blue-50",o.currentSortBy===e.value),s(2),C(e.label),s(),d("ngIf",o.currentSortBy===e.value)}}function Do(n,t){if(n&1&&(i(0,"div",70),g(1,Io,4,8,"button",71),r()),n&2){let e=m(2);E("left-0",!e.isRtl())("right-0",e.isRtl()),s(),d("ngForOf",e.sortOptions)}}function Po(n,t){n&1&&(h(),i(0,"svg",76),p(1,"path",77),r())}function Vo(n,t){n&1&&(h(),i(0,"svg",76),p(1,"path",37),r())}function Oo(n,t){if(n&1){let e=S();i(0,"div",56)(1,"div",57)(2,"div",58),l(3),r(),i(4,"div",59)(5,"span",60),l(6,"Sort by:"),r(),i(7,"div",61)(8,"button",62),_("click",function(){f(e);let a=m();return v(a.showSortDropdown=!a.showSortDropdown)}),i(9,"span"),l(10),r(),h(),i(11,"svg",36),p(12,"path",37),r()(),g(13,Do,2,5,"div",63),r(),x(),i(14,"button",64),_("click",function(){f(e);let a=m();return v(a.toggleSortDirection())}),g(15,Po,2,0,"svg",65)(16,Vo,2,0,"svg",65),r()()(),i(17,"div",66)(18,"button",67),_("click",function(){f(e);let a=m();return v(a.currentListView="grid")}),h(),i(19,"svg",10),p(20,"path",68),r()(),x(),i(21,"button",67),_("click",function(){f(e);let a=m();return v(a.currentListView="list")}),h(),i(22,"svg",10),p(23,"path",69),r()()()()}if(n&2){let e=m();s(3),w(" Showing ",e.locations.length," locations "),s(7),C(e.getSortLabel(e.currentSortBy)),s(),E("rotate-180",e.showSortDropdown),s(2),d("ngIf",e.showSortDropdown),s(),d("title",e.currentSortDirection==="asc"?"Ascending":"Descending"),s(),d("ngIf",e.currentSortDirection==="asc"),s(),d("ngIf",e.currentSortDirection==="desc"),s(2),O(e.currentListView==="grid"?"bg-blue-600 text-white":"bg-white text-gray-600 border border-gray-300"),s(3),O(e.currentListView==="list"?"bg-blue-600 text-white":"bg-white text-gray-600 border border-gray-300")}}function Ro(n,t){n&1&&(i(0,"div",82)(1,"div",83)(2,"div",84),h(),i(3,"svg",85),p(4,"circle",86)(5,"path",87),r()(),x(),i(6,"h3",88),l(7,"Loading Locations"),r(),i(8,"p",89),l(9,"Please wait while we fetch your locations..."),r()()())}function Ao(n,t){if(n&1&&(i(0,"p",122),l(1),r()),n&2){let e=m().$implicit;s(),w(" ",e.description," ")}}function Fo(n,t){if(n&1){let e=S();i(0,"div",92)(1,"div",93)(2,"div",94)(3,"div",95),h(),i(4,"svg",96),p(5,"path",97),r()(),x(),i(6,"div",98)(7,"a",99),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.viewLocation(a))}),i(8,"h3",100),l(9),r()(),i(10,"div",101)(11,"span",102),l(12),r(),i(13,"span",103),l(14),r(),i(15,"span",104),h(),i(16,"svg",105),p(17,"path",106),r(),l(18),r(),x(),i(19,"span",107),h(),i(20,"svg",105),p(21,"path",108),r(),l(22),r()(),x(),i(23,"div",109),h(),i(24,"svg",110),p(25,"path",111)(26,"path",112),r(),x(),i(27,"span",113),l(28),r()(),g(29,Ao,2,1,"p",114),r()()(),i(30,"div",115)(31,"button",116),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.openQRCodeModal(a))}),h(),i(32,"svg",76),p(33,"path",117),r()(),x(),i(34,"button",118),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.editLocation(a))}),h(),i(35,"svg",76),p(36,"path",119),r()(),x(),i(37,"button",120),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.deleteLocation(a))}),h(),i(38,"svg",76),p(39,"path",121),r()()()()}if(n&2){let e=t.$implicit,o=m(3);s(9),w(" ",e.name," "),s(3),w(" ",o.getHierarchyLevelBadge(e.hierarchy_level)," "),s(2),w(" ",(e.type==null?null:e.type.name)||"Unknown Type"," "),s(4),w(" ",e.assets_count||(e.asset_summary==null?null:e.asset_summary.asset_count)||0," Assets "),s(4),w(" ",(e.children==null?null:e.children.length)||0," Sub-locations "),s(6),C(e.address||"No address provided"),s(),d("ngIf",e.description),s(2),d("appTooltip","View QR Code")("tooltipPosition","top"),s(3),d("disabled",o.loading)("appTooltip","Edit Location")("tooltipPosition","top"),s(3),d("disabled",o.loading)("appTooltip","Delete Location")("tooltipPosition","top")}}function Ho(n,t){if(n&1&&(i(0,"div",90),g(1,Fo,40,15,"div",91),r()),n&2){let e=m(2);s(),d("ngForOf",e.locations)}}function No(n,t){n&1&&(h(),i(0,"svg",74),p(1,"path",75),r())}function jo(n,t){if(n&1){let e=S();i(0,"button",72),_("click",function(){let a=f(e).$implicit,c=m(4);return c.onSortChange(a.value),v(c.showSortDropdown=!1)}),i(1,"span"),l(2),r(),g(3,No,2,0,"svg",73),r()}if(n&2){let e=t.$implicit,o=m(4);E("text-left",!o.isRtl())("text-right",o.isRtl())("bg-blue-50",o.currentSortBy===e.value),s(2),C(e.label),s(),d("ngIf",o.currentSortBy===e.value)}}function zo(n,t){if(n&1&&(i(0,"div",70),g(1,jo,4,8,"button",71),r()),n&2){let e=m(3);E("left-0",!e.isRtl())("right-0",e.isRtl()),s(),d("ngForOf",e.sortOptions)}}function Bo(n,t){n&1&&(h(),i(0,"svg",76),p(1,"path",77),r())}function Go(n,t){n&1&&(h(),i(0,"svg",76),p(1,"path",37),r())}function $o(n,t){n&1&&(i(0,"div",130),l(1,"Level"),r())}function Uo(n,t){if(n&1&&(i(0,"div",122),l(1),r()),n&2){let e=m().$implicit;s(),C(e.description)}}function qo(n,t){if(n&1&&(i(0,"div",130)(1,"span"),l(2),r()()),n&2){let e=m().$implicit,o=m(3);s(),O("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-"+o.getHierarchyLevelColor(e.hierarchy_level)+"-100 text-"+o.getHierarchyLevelColor(e.hierarchy_level)+"-800"),s(),w(" ",o.getHierarchyLevelBadge(e.hierarchy_level)," ")}}function Wo(n,t){if(n&1){let e=S();i(0,"div",133)(1,"div",134)(2,"div",127)(3,"div",5)(4,"div",135),p(5,"img",136),r(),i(6,"div",137)(7,"div",138),l(8),r(),g(9,Uo,2,1,"div",114),r()()(),i(10,"div",128)(11,"span",58),l(12),r()(),i(13,"div",128)(14,"span",58),l(15),r()(),g(16,qo,3,3,"div",129),i(17,"div",130)(18,"div",139),h(),i(19,"svg",140),p(20,"path",106),r(),x(),i(21,"span",58),l(22),r()()(),i(23,"div",130)(24,"div",139),h(),i(25,"svg",140),p(26,"path",108),r(),x(),i(27,"span",58),l(28),r()()(),i(29,"div",128)(30,"div",66)(31,"button",141),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.viewLocation(a))}),h(),i(32,"svg",10),p(33,"path",142),r()(),x(),i(34,"button",143),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.editLocation(a))}),h(),i(35,"svg",10),p(36,"path",119),r()(),x(),i(37,"button",144),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.deleteLocation(a))}),h(),i(38,"svg",10),p(39,"path",121),r()()()()()()}if(n&2){let e=t.$implicit,o=m(3);s(5),d("src",e.type.icon,H)("alt",e.type.name),s(3),w("",e.name," "),s(),d("ngIf",e.description),s(3),C(e.type.name),s(3),w(" ",(e.parent==null?null:e.parent.name)||"Root Level"," "),s(),d("ngIf",!1),s(6),C(e.assets_count||(e.asset_summary==null?null:e.asset_summary.asset_count)||0),s(6),C((e.children==null?null:e.children.length)||0),s(6),d("disabled",o.loading),s(3),d("disabled",o.loading)}}function Qo(n,t){if(n&1){let e=S();i(0,"div",123)(1,"div",124)(2,"div",5)(3,"span",60),l(4,"Sort by:"),r(),i(5,"div",61)(6,"button",62),_("click",function(){f(e);let a=m(2);return v(a.showSortDropdown=!a.showSortDropdown)}),i(7,"span"),l(8),r(),h(),i(9,"svg",36),p(10,"path",37),r()(),g(11,zo,2,5,"div",63),r(),x(),i(12,"button",64),_("click",function(){f(e);let a=m(2);return v(a.toggleSortDirection())}),g(13,Bo,2,0,"svg",65)(14,Go,2,0,"svg",65),r()()(),i(15,"div",125)(16,"div",126)(17,"div",127),l(18,"Location"),r(),i(19,"div",128),l(20,"Type"),r(),i(21,"div",128),l(22,"Parent"),r(),g(23,$o,2,0,"div",129),i(24,"div",130),l(25,"Assets"),r(),i(26,"div",130),l(27,"Children"),r(),i(28,"div",128),l(29,"Actions"),r()()(),i(30,"div",131),g(31,Wo,40,11,"div",132),r()()}if(n&2){let e=m(2);s(8),C(e.getSortLabel(e.currentSortBy)),s(),E("rotate-180",e.showSortDropdown),s(2),d("ngIf",e.showSortDropdown),s(),d("title",e.currentSortDirection==="asc"?"Ascending":"Descending"),s(),d("ngIf",e.currentSortDirection==="asc"),s(),d("ngIf",e.currentSortDirection==="desc"),s(9),d("ngIf",!1),s(8),d("ngForOf",e.locations)}}function Zo(n,t){if(n&1){let e=S();i(0,"div",145),h(),i(1,"svg",146),p(2,"path",111)(3,"path",112),r(),x(),i(4,"h3",147),l(5,"No locations found"),r(),i(6,"p",148),l(7,"Get started by creating your first location."),r(),i(8,"div",149)(9,"button",150),_("click",function(){f(e);let a=m(2);return v(a.addLocation())}),h(),i(10,"svg",151),p(11,"path",11),r(),l(12," Add Location "),r()()()}}function Yo(n,t){if(n&1&&(i(0,"div"),g(1,Ro,10,0,"div",78)(2,Ho,2,1,"div",79)(3,Qo,32,9,"div",80)(4,Zo,13,0,"div",81),r()),n&2){let e=m();s(),d("ngIf",e.loading),s(),d("ngIf",!e.loading&&e.currentListView==="grid"),s(),d("ngIf",!e.loading&&e.currentListView==="list"),s(),d("ngIf",!e.loading&&e.locations.length===0)}}function Ko(n,t){n&1&&(i(0,"div",82)(1,"div",83)(2,"div",84),h(),i(3,"svg",85),p(4,"circle",86)(5,"path",87),r()(),x(),i(6,"h3",88),l(7,"Loading Hierarchy"),r(),i(8,"p",89),l(9,"Please wait while we fetch the location hierarchy..."),r()()())}function Xo(n,t){if(n&1){let e=S();i(0,"button",171),_("click",function(){f(e);let a=m().$implicit,c=m(3);return v(c.toggleNode(a.id))}),h(),i(1,"svg",172),p(2,"path",142),r()()}if(n&2){let e=m().$implicit,o=m(3);s(),E("rotate-90",o.isNodeExpanded(e.id))}}function Jo(n,t){n&1&&(i(0,"div",173),p(1,"div",174),r())}function er(n,t){if(n&1&&(i(0,"span",175),l(1),r()),n&2){let e=m().$implicit;s(),G(" ",e.children.length," sub-location",e.children.length!==1?"s":""," ")}}function tr(n,t){if(n&1){let e=S();i(0,"button",171),_("click",function(){f(e);let a=m().$implicit,c=m(5);return v(c.toggleNode(a.id))}),h(),i(1,"svg",172),p(2,"path",142),r()()}if(n&2){let e=m().$implicit,o=m(5);s(),E("rotate-90",o.isNodeExpanded(e.id))}}function ir(n,t){n&1&&(i(0,"div",173),p(1,"div",174),r())}function nr(n,t){if(n&1&&(i(0,"span",175),l(1),r()),n&2){let e=m().$implicit;s(),G(" ",e.children.length," sub-location",e.children.length!==1?"s":""," ")}}function or(n,t){if(n&1&&(i(0,"div",184)(1,"div",173),p(2,"div",174),r(),i(3,"div",185),h(),i(4,"svg",186),p(5,"path",187),r()(),x(),i(6,"div",165)(7,"div",5)(8,"span",179),l(9),r(),i(10,"span",188),l(11),r()(),i(12,"div",168),l(13),r()()()),n&2){let e=t.$implicit;s(9),C(e.name),s(2),w(" ",(e.type==null?null:e.type.name)||"Floor"," "),s(2),w("",e.asset_count||0," assets")}}function rr(n,t){if(n&1&&(i(0,"div",182),g(1,or,14,3,"div",183),r()),n&2){let e=m().$implicit;s(),d("ngForOf",e.children)}}function ar(n,t){if(n&1&&(oe(0),i(1,"div",177)(2,"div",5),g(3,tr,3,2,"button",159)(4,ir,2,0,"div",160),i(5,"div",178),h(),i(6,"svg",74),p(7,"path",97),r()(),x(),i(8,"div",165)(9,"div",5)(10,"span",179),l(11),r(),i(12,"span",180),l(13),r()(),i(14,"div",168),l(15),g(16,nr,2,2,"span",169),r()()()(),g(17,rr,2,1,"div",181),re()),n&2){let e=t.$implicit,o=m(5);s(3),d("ngIf",e.children&&e.children.length>0),s(),d("ngIf",!e.children||e.children.length===0),s(7),C(e.name),s(2),w(" ",(e.type==null?null:e.type.name)||"Residential Building"," "),s(2),w(" ",e.asset_count||0," assets "),s(),d("ngIf",e.children&&e.children.length>0),s(),d("ngIf",o.isNodeExpanded(e.id)&&e.children&&e.children.length>0)}}function sr(n,t){if(n&1&&(i(0,"div",176),g(1,ar,18,7,"ng-container",156),r()),n&2){let e=m().$implicit;s(),d("ngForOf",e.children)}}function lr(n,t){if(n&1&&(oe(0),i(1,"div",157)(2,"div",158)(3,"div",5),g(4,Xo,3,2,"button",159)(5,Jo,2,0,"div",160),i(6,"div",161),h(),i(7,"svg",162),p(8,"path",163)(9,"path",164),r()(),x(),i(10,"div",165)(11,"div",5)(12,"span",166),l(13),r(),i(14,"span",167),l(15),r()(),i(16,"div",168),l(17),g(18,er,2,2,"span",169),r()()()(),g(19,sr,2,1,"div",170),r(),re()),n&2){let e=t.$implicit,o=m(3);s(4),d("ngIf",e.children&&e.children.length>0),s(),d("ngIf",!e.children||e.children.length===0),s(8),C(e.name),s(2),w(" ",(e.type==null?null:e.type.name)||"Community"," "),s(2),w(" ",e.asset_count||0," assets "),s(),d("ngIf",e.children&&e.children.length>0),s(),d("ngIf",o.isNodeExpanded(e.id)&&e.children&&e.children.length>0)}}function cr(n,t){n&1&&(i(0,"div",145),h(),i(1,"svg",146),p(2,"path",108),r(),x(),i(3,"h3",147),l(4,"No hierarchy data"),r(),i(5,"p",148),l(6,"Create some locations to see the hierarchy tree."),r()())}function dr(n,t){if(n&1&&(i(0,"div",155),g(1,lr,20,7,"ng-container",156)(2,cr,7,0,"div",81),r()),n&2){let e=m(2);s(),d("ngForOf",e.hierarchyData),s(),d("ngIf",e.hierarchyData.length===0)}}function mr(n,t){if(n&1){let e=S();i(0,"div")(1,"div",56)(2,"h2",152),l(3,"Location Hierarchy"),r(),i(4,"div",5)(5,"button",153),_("click",function(){f(e);let a=m();return v(a.expandAll())}),l(6," Expand All "),r(),i(7,"button",153),_("click",function(){f(e);let a=m();return v(a.collapseAll())}),l(8," Collapse All "),r()()(),g(9,Ko,10,0,"div",78)(10,dr,3,2,"div",154),r()}if(n&2){let e=m();s(9),d("ngIf",e.hierarchyLoading),s(),d("ngIf",!e.hierarchyLoading)}}function pr(n,t){n&1&&(i(0,"div",189),p(1,"app-hierarchy-management"),r())}function ur(n,t){n&1&&(i(0,"div")(1,"div",56)(2,"h2",152),l(3,"Location Analytics"),r(),i(4,"div",5)(5,"button",190),l(6," Export Report "),r()()(),i(7,"div",145)(8,"div",191),h(),i(9,"svg",192),p(10,"path",193),r()(),x(),i(11,"h3",88),l(12,"Analytics Coming Soon"),r(),i(13,"p",89),l(14,"Detailed analytics and insights about your locations will be available here."),r()()())}function hr(n,t){if(n&1){let e=S();i(0,"button",212),_("click",function(){f(e);let a=m(3);return v(a.goToPage(1))}),l(1," 1 "),r()}}function gr(n,t){n&1&&(i(0,"span",213),h(),i(1,"svg",214),p(2,"circle",215)(3,"circle",216)(4,"circle",217),r()())}function _r(n,t){if(n&1){let e=S();i(0,"button",218),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.goToPage(a))}),l(1),r()}if(n&2){let e=t.$implicit,o=m(3);O(o.pagination.current_page===e?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-gray-500 border-gray-300 hover:bg-gray-50"),d("title","Page "+e),s(),w(" ",e," ")}}function fr(n,t){n&1&&(i(0,"span",213),h(),i(1,"svg",214),p(2,"circle",215)(3,"circle",216)(4,"circle",217),r()())}function vr(n,t){if(n&1){let e=S();i(0,"button",212),_("click",function(){f(e);let a=m(3);return v(a.goToPage(a.pagination.last_page))}),l(1),r()}if(n&2){let e=m(3);s(),w(" ",e.pagination.last_page," ")}}function xr(n,t){if(n&1){let e=S();i(0,"nav",205)(1,"button",206),_("click",function(){f(e);let a=m(2);return v(a.goToPage(a.pagination.current_page-1))}),h(),i(2,"svg",10),p(3,"path",207),r()(),x(),i(4,"div",139),g(5,hr,2,0,"button",208)(6,gr,5,0,"span",209)(7,_r,2,4,"button",210)(8,fr,5,0,"span",209)(9,vr,2,1,"button",208),r(),i(10,"button",211),_("click",function(){f(e);let a=m(2);return v(a.goToPage(a.pagination.current_page+1))}),h(),i(11,"svg",10),p(12,"path",142),r()()()}if(n&2){let e=m(2);s(),d("disabled",e.pagination.current_page===1),s(4),d("ngIf",e.getVisiblePages()[0]>1),s(),d("ngIf",e.getVisiblePages()[0]>2),s(),d("ngForOf",e.getVisiblePages()),s(),d("ngIf",e.getVisiblePages()[e.getVisiblePages().length-1]<e.pagination.last_page-1),s(),d("ngIf",e.getVisiblePages()[e.getVisiblePages().length-1]<e.pagination.last_page),s(),d("disabled",e.pagination.current_page===e.pagination.last_page)}}function yr(n,t){if(n&1){let e=S();i(0,"div",219)(1,"div",195)(2,"span"),l(3,"Go to page:"),r(),i(4,"input",220),wt("ngModelChange",function(a){f(e);let c=m(2);return bt(c.jumpToPage,a)||(c.jumpToPage=a),v(a)}),_("keyup.enter",function(){f(e);let a=m(2);return v(a.goToPage(a.jumpToPage))}),r(),i(5,"button",221),_("click",function(){f(e);let a=m(2);return v(a.goToPage(a.jumpToPage))}),l(6," Go "),r()()()}if(n&2){let e=m(2);s(4),qt("placeholder",e.pagination.current_page),d("min",1)("max",e.pagination.last_page),yt("ngModel",e.jumpToPage),s(),d("disabled",!e.jumpToPage||e.jumpToPage<1||e.jumpToPage>e.pagination.last_page)}}function br(n,t){if(n&1){let e=S();i(0,"div",194)(1,"div",158)(2,"div",195)(3,"span"),l(4,"Show"),r(),i(5,"select",196),wt("ngModelChange",function(a){f(e);let c=m();return bt(c.pagination.per_page,a)||(c.pagination.per_page=a),v(a)}),_("change",function(a){f(e);let c=m();return v(c.changePerPage(a))}),i(6,"option",197),l(7,"10"),r(),i(8,"option",198),l(9,"15"),r(),i(10,"option",199),l(11,"25"),r(),i(12,"option",200),l(13,"50"),r(),i(14,"option",201),l(15,"100"),r()(),i(16,"span"),l(17,"entries"),r()(),g(18,xr,13,7,"nav",202),i(19,"div",203),l(20),r()(),g(21,yr,7,5,"div",204),r()}if(n&2){let e=m();s(5),yt("ngModel",e.pagination.per_page),s(13),d("ngIf",e.pagination.last_page>1),s(2),Wt(" Showing ",e.pagination.from," - ",e.pagination.to," of ",e.pagination.total," entries "),s(),d("ngIf",e.pagination.last_page>10)}}var Re=class n{constructor(t,e,o){this.fb=t;this.locationService=e;this.router=o;this.searchForm=this.fb.group({search:[""]}),this.filtersForm=this.fb.group({type_id:[""],parent_id:[""],hierarchy_level:[""],asset_count:[""],sort_by:["created"],sort_direction:["desc"]}),this.currentSortBy="created",this.currentSortDirection="desc"}destroy$=new T;locations=[];locationTypes=[];hierarchyData=[];loading=!1;hierarchyLoading=!1;showFilters=!1;showSortDropdown=!1;currentView="grid";currentListView="grid";expandedNodes=new Set;showAddLocationModal=!1;showEditLocationModal=!1;showDeleteConfirmationModal=!1;showBulkCreateModal=!1;selectedLocation=null;pagination={current_page:1,last_page:1,per_page:15,total:0,from:0,to:0};searchForm;filtersForm;jumpToPage;sortOptions=[{value:"name",label:"Name"},{value:"created",label:"Created"},{value:"assets",label:"Assets"},{value:"level",label:"Level"}];currentSortBy="created";currentSortDirection="desc";hierarchyLevels=[{value:"",label:"All Levels"},{value:"0",label:"Level 0 (Root)"},{value:"1",label:"Level 1"},{value:"2",label:"Level 2"},{value:"3",label:"Level 3"},{value:"true",label:"Hierarchy Level"}];showQrViewModal=!1;qrData;ngOnInit(){this.initializeSearchSubscription(),this.loadLocationTypes(),this.loadLocations(),this.loadHierarchy()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeSearchSubscription(){this.searchForm.get("search")?.valueChanges.pipe(Ue(300),Ae(),D(this.destroy$)).subscribe(()=>{this.loadLocations()})}loadLocationTypes(){this.locationService.getLocationTypes().pipe(D(this.destroy$)).subscribe({next:t=>{t.success&&(this.locationTypes=t.data.types)},error:t=>{console.error("Error loading location types:",t)}})}loadLocations(t=1){this.loading=!0;let e=this.searchForm.get("search")?.value,o=this.filtersForm.value,a={page:t,per_page:this.pagination.per_page,sort_by:o.sort_by||"created",sort_direction:o.sort_direction||"desc"};e&&e.trim()!==""&&(a.search=e),o.hierarchy_level&&o.hierarchy_level!==""&&o.hierarchy_level!==null&&(a.hierarchy_level=o.hierarchy_level),o.type_id&&o.type_id!==""&&(a.type_id=o.type_id),o.parent_id&&o.parent_id!==""&&(a.parent_id=o.parent_id),o.asset_count&&o.asset_count!==""&&(a.asset_count=o.asset_count),this.locationService.getLocations(a).pipe(D(this.destroy$)).subscribe({next:c=>{if(c.success){this.locations=c.data.locations,this.pagination=c.data.pagination;let u=this.filtersForm.value;this.currentSortBy=u.sort_by||"created",this.currentSortDirection=u.sort_direction||"desc"}this.loading=!1},error:c=>{console.error("Error loading locations:",c),this.loading=!1}})}loadHierarchy(){this.hierarchyLoading=!0,this.locationService.getHierarchy().pipe(D(this.destroy$)).subscribe({next:t=>{t.success&&(this.hierarchyData=t.data.hierarchy),this.hierarchyLoading=!1},error:t=>{console.error("Error loading hierarchy:",t),this.hierarchyLoading=!1}})}setView(t){this.currentView=t,t==="grid"?this.clearFilters():t==="tree"&&this.hierarchyData.length===0&&this.loadHierarchy()}setListView(t){this.currentListView=t}toggleFilters(){this.showFilters=!this.showFilters}applyFilters(){this.loadLocations(1),this.showFilters=!1}clearFilters(){this.filtersForm.reset({type_id:"",parent_id:"",hierarchy_level:"",asset_count:"",sort_by:"created",sort_direction:"desc"}),this.currentSortBy="created",this.currentSortDirection="desc",this.loadLocations(1)}onSortChange(t){this.currentSortBy===t?this.currentSortDirection=this.currentSortDirection==="asc"?"desc":"asc":(this.currentSortDirection=t==="name"?"asc":"desc",this.currentSortBy=t),this.filtersForm.patchValue({sort_by:this.currentSortBy,sort_direction:this.currentSortDirection}),this.loadLocations(1)}toggleSortDirection(){this.currentSortDirection=this.currentSortDirection==="asc"?"desc":"asc",this.filtersForm.patchValue({sort_direction:this.currentSortDirection}),this.loadLocations(this.pagination.current_page)}getSortLabel(t){let e=this.sortOptions.find(o=>o.value===t);return e?e.label:"Created"}goToPage(t){t>=1&&t<=this.pagination.last_page&&this.loadLocations(t)}getVisiblePages(){let t=this.pagination.current_page,e=this.pagination.last_page,o=[],a=Math.max(1,t-2),c=Math.min(e,t+2);for(let u=a;u<=c;u++)o.push(u);return o}changePerPage(t){this.pagination.per_page=parseInt(t.target.value),this.loadLocations(1)}getHierarchyLevelBadge(t){return`L${t}`}getHierarchyLevelColor(t){return["blue","green","yellow","purple"][t]||"gray"}editLocation(t){this.selectedLocation=t,this.showEditLocationModal=!0}deleteLocation(t){this.selectedLocation=t,this.showDeleteConfirmationModal=!0}viewLocation(t){this.router.navigate(["/locations",t.id])}addLocation(){this.showAddLocationModal=!0}closeAddLocationModal(){this.showAddLocationModal=!1}closeEditLocationModal(){this.showEditLocationModal=!1,this.selectedLocation=null}closeDeleteConfirmationModal(){this.showDeleteConfirmationModal=!1,this.selectedLocation=null}openBulkCreateModal(){this.showBulkCreateModal=!0}closeBulkCreateModal(){this.showBulkCreateModal=!1}onLocationCreated(t){this.loadLocations(this.pagination.current_page),this.showAddLocationModal=!1}onLocationUpdated(t){let e=this.locations.findIndex(o=>o.id===t.id);e!==-1&&(this.locations[e]=t),this.showEditLocationModal=!1,this.selectedLocation=null}onLocationDeleted(t){this.locations=this.locations.filter(e=>e.id!==t.id),this.pagination.total=Math.max(0,this.pagination.total-1),this.pagination.to=Math.max(0,this.pagination.to-1),this.locations.length===0&&this.pagination.current_page>1&&this.loadLocations(this.pagination.current_page-1),this.showDeleteConfirmationModal=!1,this.selectedLocation=null}onLocationsCreated(t){this.loadLocations(this.pagination.current_page),this.loadHierarchy(),this.showBulkCreateModal=!1}toggleNode(t){this.expandedNodes.has(t)?this.expandedNodes.delete(t):this.expandedNodes.add(t)}isNodeExpanded(t){return this.expandedNodes.has(t)}expandAll(){this.hierarchyData.forEach(t=>{this.addAllNodeIds(t,this.expandedNodes)})}collapseAll(){this.expandedNodes.clear()}addAllNodeIds(t,e){e.add(t.id),t.children&&t.children.length>0&&t.children.forEach(o=>{this.addAllNodeIds(o,e)})}isRtl(){return document.documentElement.dir==="rtl"}getLocationTypeColor(t){return{Community:"gray","Residential Building":"blue",Floor:"green",Garden:"orange","Office Building":"blue"}[t]||"gray"}exportQR(){this.loading=!0,this.locationService.exportQRCodes().subscribe({next:t=>{let e=window.URL.createObjectURL(t),o=document.createElement("a");o.href=e,o.download=`locations-qr-codes-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(e),this.loading=!1},error:t=>{console.error("Failed to export QR codes:",t),this.loading=!1}})}onDocumentClick(t){let e=t.target,o=e.closest(".filter-button"),a=e.closest(".filter-dropdown"),c=e.closest("select"),u=e.tagName==="OPTION";!o&&!a&&!c&&!u&&this.showFilters&&(this.showFilters=!1),!e.closest("[data-sort-dropdown]")&&this.showSortDropdown&&(this.showSortDropdown=!1)}openQRCodeModal(t){this.qrData=t,this.showQrViewModal=!0}closeQrViewModal(){this.showQrViewModal=!1,this.qrData=null}static \u0275fac=function(e){return new(e||n)(L(_e),L(z),L(Ye))};static \u0275cmp=R({type:n,selectors:[["app-locations"]],hostBindings:function(e,o){e&1&&_("click",function(c){return o.onDocumentClick(c)},!1,$t)},decls:46,vars:27,consts:[[1,"bg-gray-50"],[1,"bg-white","border-b","border-gray-200","px-6","py-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600","mt-1"],[1,"flex","items-center","space-x-3"],[1,"flex","items-center","space-x-2","px-3","py-2","text-sm","font-medium","text-gray-700","hover:bg-gray-100","rounded-lg","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","w-4 h-4","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin",4,"ngIf"],[1,"flex","items-center","space-x-2","px-3","py-2","text-sm","font-medium","text-gray-700","hover:bg-gray-100","rounded-lg","transition-colors","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"flex","items-center","space-x-2","px-4","py-2","bg-blue-600","text-white","rounded-lg","font-medium","hover:bg-blue-700","transition-colors",3,"click"],[1,"flex","items-center","space-x-1","bg-gray-100","rounded-lg","p-1"],[1,"flex-1","px-4","py-2","rounded-md","text-sm","font-medium","transition-all",3,"click"],["class","bg-white border-b border-gray-200 px-6 py-4",4,"ngIf"],[1,"px-6","py-6"],["class","flex items-center justify-between mb-6",4,"ngIf"],[4,"ngIf"],["class","bg-white rounded-lg shadow-sm border border-gray-200 p-6",4,"ngIf"],["class","mt-8 pt-6 border-t border-gray-200",4,"ngIf"],[3,"closeModal","locationCreated","isOpen"],[3,"closeModal","locationUpdated","isOpen","location"],[3,"closeModal","locationDeleted","isOpen","location"],[3,"closeModal","locationsCreated","isOpen"],[3,"closeModal","isOpen","location"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"],[1,"w-4","h-4","border-2","border-gray-300","border-t-blue-600","rounded-full","animate-spin"],[1,"bg-white","border-b","border-gray-200","px-6","py-4"],[1,"flex-1","max-w-md",3,"formGroup"],[1,"relative"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","formControlName","search","placeholder","Search locations...",1,"w-full","pl-10","pr-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"filter-button","relative","flex","items-center","space-x-2","px-3","py-2","text-sm","font-medium","text-gray-700","hover:bg-gray-100","rounded-lg","transition-colors","cursor-pointer",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","filter-dropdown absolute text-start top-full mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-200 py-4 z-50",3,"right-0","left-0",4,"ngIf"],[1,"filter-dropdown","absolute","text-start","top-full","mt-2","w-80","bg-white","rounded-xl","shadow-lg","border","border-gray-200","py-4","z-50"],[1,"p-4",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["formControlName","type_id",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","hierarchy_level",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["formControlName","asset_count",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["value","0"],["value","1-10"],["value","11-50"],["value","51+"],[1,"flex","items-center","justify-between","pt-4","border-t","border-gray-100","mt-4"],["type","button",1,"px-4","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors","cursor-pointer",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","font-medium","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","cursor-pointer"],[3,"value"],[1,"flex","items-center","justify-between","mb-6"],[1,"flex","items-center","space-x-4"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","space-x-3","border-l","border-gray-200","pl-4"],[1,"text-sm","font-medium","text-gray-700"],["data-sort-dropdown","",1,"relative"],[1,"flex","items-center","space-x-2","px-3","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],["class","absolute top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",3,"left-0","right-0",4,"ngIf"],[1,"p-2","text-gray-400","hover:text-gray-600","hover:bg-gray-100","rounded-lg","transition-colors","cursor-pointer",3,"click","title"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"flex","items-center","space-x-2"],[1,"px-3","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 10h16M4 14h16M4 18h16"],[1,"absolute","top-full","mt-2","w-48","bg-white","rounded-lg","shadow-lg","border","border-gray-200","py-2","z-50"],["class","w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors flex items-center justify-between",3,"text-left","text-right","bg-blue-50","click",4,"ngFor","ngForOf"],[1,"w-full","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","transition-colors","flex","items-center","justify-between",3,"click"],["class","w-4 h-4 text-blue-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],["class","flex items-center justify-center py-20",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-6",4,"ngIf"],["class","bg-white rounded-lg shadow-sm border border-gray-200",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","rounded-full","mb-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-8","h-8","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6","mb-6"],["class","relative bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-xl hover:border-blue-400 transition-all duration-300 group",4,"ngFor","ngForOf"],[1,"relative","bg-white","rounded-xl","p-6","shadow-sm","border","border-gray-200","hover:shadow-xl","hover:border-blue-400","transition-all","duration-300","group"],[1,"flex","items-start","justify-between","mb-4"],[1,"flex","items-start","space-x-4","flex-1"],[1,"w-14","h-14","bg-gradient-to-br","from-blue-500","to-blue-600","rounded-xl","flex","items-center","justify-center","group-hover:scale-110","transition-transform","duration-300","shadow-md"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-7","w-7","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"flex-1","min-w-0"],[1,"block","cursor-pointer","group/title",3,"click"],[1,"text-xl","font-bold","text-gray-900","group-hover/title:text-blue-600","transition-colors","duration-200","mb-2","line-clamp-2"],[1,"flex","items-center","gap-2","flex-wrap","mb-3"],[1,"inline-flex","items-center","px-2.5","py-1","rounded-full","text-xs","font-semibold","bg-blue-100","text-blue-700"],[1,"inline-flex","items-center","px-2.5","py-1","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-700"],[1,"inline-flex","items-center","gap-1","px-2.5","py-1","rounded-full","text-xs","font-medium","bg-green-100","text-green-700"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"inline-flex","items-center","gap-1","px-2.5","py-1","rounded-full","text-xs","font-medium","bg-purple-100","text-purple-700"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"],[1,"flex","items-start","gap-2","text-sm","text-gray-600","mb-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mt-0.5","flex-shrink-0","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],[1,"line-clamp-1"],["class","text-sm text-gray-500 line-clamp-2",4,"ngIf"],[1,"flex","items-center","justify-center","gap-2","pt-4","border-t","border-gray-100"],[1,"p-2.5","text-gray-400","hover:text-blue-600","hover:bg-blue-50","rounded-lg","transition-all","duration-200","cursor-pointer",3,"click","appTooltip","tooltipPosition"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"],[1,"p-2.5","text-gray-400","hover:text-blue-600","hover:bg-blue-50","rounded-lg","transition-all","duration-200","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled","appTooltip","tooltipPosition"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"p-2.5","text-gray-400","hover:text-red-600","hover:bg-red-50","rounded-lg","transition-all","duration-200","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled","appTooltip","tooltipPosition"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-sm","text-gray-500","line-clamp-2"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"px-6","py-4","border-b","border-gray-200","bg-gray-50","flex","items-center","justify-between"],[1,"px-6","py-4","border-b","border-gray-200","bg-gray-50"],[1,"grid","grid-cols-12","gap-4","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"col-span-3"],[1,"col-span-2"],["class","col-span-1",4,"ngIf"],[1,"col-span-1"],[1,"divide-y","divide-gray-200"],["class","px-6 py-4 hover:bg-gray-50 hover:shadow-sm transition-all duration-200 cursor-pointer group",4,"ngFor","ngForOf"],[1,"px-6","py-4","hover:bg-gray-50","hover:shadow-sm","transition-all","duration-200","cursor-pointer","group"],[1,"grid","grid-cols-12","gap-4","items-center"],[1,"w-10","h-10","bg-blue-100","rounded-lg","flex","items-center","justify-center","group-hover:bg-blue-200","transition-colors","duration-200"],[1,"w-6","h-6",3,"src","alt"],[1,"w-[90%]"],[1,"font-medium","text-gray-900","group-hover:text-blue-700","transition-colors","duration-200","line-clamp-2"],[1,"flex","items-center","space-x-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],[1,"p-1","text-gray-400","hover:text-blue-600","hover:bg-blue-50","rounded","transition-all","duration-200","hover:scale-110","cursor-pointer",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"p-1","text-gray-400","hover:text-blue-600","hover:bg-blue-50","rounded","transition-all","duration-200","hover:scale-110","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled"],[1,"p-1","text-gray-400","hover:text-red-600","hover:bg-red-50","rounded","transition-all","duration-200","hover:scale-110","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-6"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","shadow-sm","text-sm","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],[1,"text-2xl","font-bold","text-gray-900"],[1,"px-4","py-2","text-sm","font-medium","text-gray-600","hover:text-gray-800","hover:bg-gray-100","rounded-lg","transition-colors","cursor-pointer",3,"click"],["class","space-y-1",4,"ngIf"],[1,"space-y-1"],[4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","border","border-gray-200","p-4"],[1,"flex","items-center","justify-between"],["class","w-4 h-4 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors cursor-pointer",3,"click",4,"ngIf"],["class","w-4 h-4 flex items-center justify-center",4,"ngIf"],[1,"w-8","h-8","bg-blue-100","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 21l4-4 4 4"],[1,"flex-1"],[1,"font-semibold","text-gray-900"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-gray-100","text-gray-700"],[1,"text-sm","text-gray-500","mt-1"],["class","ml-4",4,"ngIf"],["class","mt-4 ml-7 space-y-3",4,"ngIf"],[1,"w-4","h-4","flex","items-center","justify-center","text-gray-400","hover:text-gray-600","transition-colors","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","transition-transform"],[1,"w-4","h-4","flex","items-center","justify-center"],[1,"w-1","h-1","bg-gray-300","rounded-full"],[1,"ml-4"],[1,"mt-4","ml-7","space-y-3"],[1,"flex","items-center","justify-between","py-2","px-3","bg-gray-50","rounded-lg"],[1,"w-6","h-6","bg-blue-100","rounded","flex","items-center","justify-center"],[1,"font-medium","text-gray-900"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-blue-100","text-blue-700"],["class","ml-7 space-y-2",4,"ngIf"],[1,"ml-7","space-y-2"],["class","flex items-center space-x-3 py-2 px-3 bg-white rounded border border-gray-100",4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-3","py-2","px-3","bg-white","rounded","border","border-gray-100"],[1,"w-6","h-6","bg-green-100","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-green-100","text-green-700"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","p-6"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","hover:bg-gray-100","rounded-lg","transition-colors","cursor-pointer","hidden"],[1,"w-16","h-16","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"mt-8","pt-6","border-t","border-gray-200"],[1,"flex","items-center","space-x-2","text-sm","text-gray-600"],[1,"px-3","py-2","border","border-gray-300","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white",3,"ngModelChange","change","ngModel"],["value","10"],["value","15"],["value","25"],["value","50"],["value","100"],["class","flex items-center space-x-1","aria-label","Pagination",4,"ngIf"],[1,"text-sm","text-gray-700"],["class","flex items-center justify-center mt-4",4,"ngIf"],["aria-label","Pagination",1,"flex","items-center","space-x-1"],["title","Previous page",1,"flex","items-center","justify-center","w-10","h-10","text-sm","font-medium","text-gray-500","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],["class","flex items-center justify-center w-10 h-10 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",3,"click",4,"ngIf"],["class","flex items-center justify-center w-10 h-10 text-gray-400",4,"ngIf"],["class","flex items-center justify-center w-10 h-10 text-sm font-medium border rounded-lg transition-colors",3,"class","title","click",4,"ngFor","ngForOf"],["title","Next page",1,"flex","items-center","justify-center","w-10","h-10","text-sm","font-medium","text-gray-500","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"flex","items-center","justify-center","w-10","h-10","text-sm","font-medium","text-gray-500","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],[1,"flex","items-center","justify-center","w-10","h-10","text-gray-400"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4"],["cx","3","cy","10","r","1.5"],["cx","10","cy","10","r","1.5"],["cx","17","cy","10","r","1.5"],[1,"flex","items-center","justify-center","w-10","h-10","text-sm","font-medium","border","rounded-lg","transition-colors",3,"click","title"],[1,"flex","items-center","justify-center","mt-4"],["type","number",1,"w-16","px-2","py-1","border","border-gray-300","rounded","text-center","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","keyup.enter","min","max","ngModel","placeholder"],[1,"px-3","py-1","bg-blue-600","text-white","rounded","text-sm","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),l(5,"Locations"),r(),i(6,"p",4),l(7,"Organize and monitor your locations with hierarchical management"),r()(),i(8,"div",5)(9,"button",6),_("click",function(){return o.exportQR()}),g(10,Co,2,0,"svg",7)(11,So,1,0,"div",8),i(12,"span"),l(13),r()(),i(14,"button",9),_("click",function(){return o.openBulkCreateModal()}),h(),i(15,"svg",10),p(16,"path",11),r(),x(),i(17,"span"),l(18,"Bulk"),r()(),i(19,"button",12),_("click",function(){return o.addLocation()}),h(),i(20,"svg",10),p(21,"path",11),r(),x(),i(22,"span"),l(23,"Add Location"),r()()()(),i(24,"div",13)(25,"button",14),_("click",function(){return o.setView("grid")}),l(26," Grid "),r(),i(27,"button",14),_("click",function(){return o.setView("tree")}),l(28," Tree "),r(),i(29,"button",14),_("click",function(){return o.setView("analytics")}),l(30," Analytics "),r(),i(31,"button",14),_("click",function(){return o.setView("mgmt")}),l(32," Mgmt "),r()()(),g(33,Lo,16,4,"div",15),i(34,"div",16),g(35,Oo,24,12,"div",17)(36,Yo,5,4,"div",18)(37,mr,11,2,"div",18)(38,pr,2,0,"div",19)(39,ur,15,0,"div",18)(40,br,22,6,"div",20),r(),i(41,"app-add-location-modal",21),_("closeModal",function(){return o.closeAddLocationModal()})("locationCreated",function(c){return o.onLocationCreated(c)}),r(),i(42,"app-edit-location-modal",22),_("closeModal",function(){return o.closeEditLocationModal()})("locationUpdated",function(c){return o.onLocationUpdated(c)}),r(),i(43,"app-delete-confirmation-modal",23),_("closeModal",function(){return o.closeDeleteConfirmationModal()})("locationDeleted",function(c){return o.onLocationDeleted(c)}),r(),i(44,"app-bulk-create-modal",24),_("closeModal",function(){return o.closeBulkCreateModal()})("locationsCreated",function(c){return o.onLocationsCreated(c)}),r(),i(45,"app-qr-view",25),_("closeModal",function(){return o.closeQrViewModal()}),r()()),e&2&&(s(9),d("disabled",o.loading),s(),d("ngIf",!o.loading),s(),d("ngIf",o.loading),s(2),C(o.loading?"Exporting...":"Export QR"),s(12),O(o.currentView==="grid"?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-800"),s(2),O(o.currentView==="tree"?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-800"),s(2),O(o.currentView==="analytics"?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-800"),s(2),O(o.currentView==="mgmt"?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-800"),s(2),d("ngIf",o.currentView==="grid"),s(2),d("ngIf",o.currentView==="grid"),s(),d("ngIf",o.currentView==="grid"),s(),d("ngIf",o.currentView==="tree"),s(),d("ngIf",o.currentView==="mgmt"),s(),d("ngIf",o.currentView==="analytics"),s(),d("ngIf",o.currentView==="grid"&&!o.loading&&o.locations.length>0),s(),d("isOpen",o.showAddLocationModal),s(),d("isOpen",o.showEditLocationModal)("location",o.selectedLocation),s(),d("isOpen",o.showDeleteConfirmationModal)("location",o.selectedLocation),s(),d("isOpen",o.showBulkCreateModal),s(),d("isOpen",o.showQrViewModal)("location",o.qrData))},dependencies:[j,W,N,K,de,he,ge,te,oi,ue,ie,ce,ci,li,me,pe,Ke,ni,ke,Pe,Ve,ye,Je,at,st,lt],styles:[".location-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.location-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.filter-button[_ngcontent-%COMP%]{width:100%;padding:0 1rem;text-align:left;border:2px solid #e5e7eb;border-radius:12px;background:#fff;color:#374151;font-size:.875rem;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:space-between;min-height:56px}.filter-button[_ngcontent-%COMP%]:hover{border-color:#d1d5db;background:#f9fafb;transform:translateY(-1px);box-shadow:0 4px 6px -1px #0000001a}.filter-button[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 4px #2563eb1a}.filter-button.active[_ngcontent-%COMP%]{border-color:#2563eb;background:#eff6ff;box-shadow:0 0 0 4px #2563eb1a}.filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{color:#9ca3af;font-style:italic}.filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .selected-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .selected-option[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%], .filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .selected-option[_ngcontent-%COMP%]   .priority-indicator[_ngcontent-%COMP%], .filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .selected-option[_ngcontent-%COMP%]   .category-indicator[_ngcontent-%COMP%], .filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .selected-option[_ngcontent-%COMP%]   .asset-indicator[_ngcontent-%COMP%], .filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .selected-option[_ngcontent-%COMP%]   .location-indicator[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .selected-option[_ngcontent-%COMP%]   .selected-text[_ngcontent-%COMP%]{color:#111827;font-weight:500}.filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .chevron-icon[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem;color:#9ca3af;transition:transform .3s ease;flex-shrink:0}.filter-button[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]   .chevron-icon.active[_ngcontent-%COMP%]{transform:rotate(180deg)}.hierarchy-badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;padding:.25rem .5rem;border-radius:9999px}.location-icon[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center;border-radius:.5rem;font-size:1.25rem}.filter-panel[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border:1px solid #e2e8f0}.search-input[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.search-input[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #3b82f61a}.view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.view-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;box-shadow:0 2px 4px #3b82f633}.table-row[_ngcontent-%COMP%]{transition:background-color .15s ease-in-out}.table-row[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.action-button[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.action-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.location-grid[_ngcontent-%COMP%], .filter-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.table-header[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.5rem}}"]})};function wr(n,t){if(n&1&&(i(0,"div",31),h(),i(1,"svg",32),p(2,"path",33),r(),x(),i(3,"span",9),l(4),r()()),n&2){let e=m(2);s(4),w("",e.selectedCount," selected")}}function Cr(n,t){if(n&1&&(i(0,"div",34)(1,"div",35),h(),i(2,"svg",32),p(3,"path",36),r(),x(),i(4,"span",37),l(5),r()()()),n&2){let e=m(2);s(5),C(e.error)}}function Sr(n,t){n&1&&(i(0,"div",38)(1,"div",39)(2,"div",40),h(),i(3,"svg",41),p(4,"circle",42)(5,"path",43),r()(),x(),i(6,"p",44),l(7,"Loading assets..."),r()()())}function Mr(n,t){if(n&1&&p(0,"img",64),n&2){let e=m().$implicit;d("src",e.images[0].image_url,H)("alt",e.name)}}function Er(n,t){n&1&&(i(0,"div",65),h(),i(1,"svg",66),p(2,"path",67),r()())}function kr(n,t){if(n&1&&(i(0,"span"),l(1),r()),n&2){let e=m().$implicit;s(),w("SN: ",e.serial_number,"")}}function Lr(n,t){if(n&1&&(i(0,"span",68),l(1),r()),n&2){let e=m().$implicit;s(),w(" ",e.category.name," ")}}function Tr(n,t){if(n&1&&(i(0,"div",69),h(),i(1,"svg",70),p(2,"path",71)(3,"path",72),r(),x(),i(4,"span"),l(5),r()()),n&2){let e=m().$implicit;s(5),w("Currently at: ",e.location.name,"")}}function Ir(n,t){n&1&&(i(0,"div",73)(1,"span"),l(2,"No current location"),r()())}function Dr(n,t){if(n&1){let e=S();i(0,"div",52)(1,"input",53),_("change",function(){let a=f(e).$implicit,c=m(3);return v(c.toggleAsset(a.id))}),r(),i(2,"div",54),g(3,Mr,1,2,"img",55)(4,Er,3,0,"div",56),r(),i(5,"div",57)(6,"h4",58),l(7),r(),i(8,"div",59),g(9,kr,2,1,"span",60)(10,Lr,2,1,"span",61),r(),g(11,Tr,6,1,"div",62)(12,Ir,3,0,"div",63),r()()}if(n&2){let e=t.$implicit,o=m(3);E("bg-blue-50",o.isAssetSelected(e.id))("border-blue-400",o.isAssetSelected(e.id)),s(),d("checked",o.isAssetSelected(e.id)),s(2),d("ngIf",e.images&&e.images.length>0),s(),d("ngIf",!e.images||e.images.length===0),s(3),C(e.name),s(2),d("ngIf",e.serial_number),s(),d("ngIf",e.category),s(),d("ngIf",e.location),s(),d("ngIf",!e.location)}}function Pr(n,t){if(n&1){let e=S();i(0,"div",45)(1,"div",46)(2,"label",47)(3,"input",48),_("change",function(){f(e);let a=m(2);return v(a.toggleAll())}),r(),i(4,"span",49),l(5),r()(),i(6,"span",50),l(7),r()(),g(8,Dr,13,12,"div",51),r()}if(n&2){let e=m(2);s(3),d("checked",e.allSelected),s(2),w(" ",e.allSelected?"Deselect All":"Select All"," "),s(2),w("",e.pagination.total," assets available"),s(),d("ngForOf",e.assets)}}function Vr(n,t){if(n&1&&(i(0,"div",74),h(),i(1,"svg",75),p(2,"path",67),r(),x(),i(3,"h3",76),l(4,"No assets found"),r(),i(5,"p",77),l(6),r()()),n&2){let e=m(2);s(6),C(e.searchControl.value?"Try adjusting your search":"All assets are already assigned to this location")}}function Or(n,t){if(n&1){let e=S();i(0,"div",78)(1,"button",79),_("click",function(){f(e);let a=m(2);return v(a.goToPage(a.pagination.current_page-1))}),l(2," Previous "),r(),i(3,"span",80),l(4),r(),i(5,"button",79),_("click",function(){f(e);let a=m(2);return v(a.goToPage(a.pagination.current_page+1))}),l(6," Next "),r()()}if(n&2){let e=m(2);s(),d("disabled",e.pagination.current_page===1),s(3),G(" Page ",e.pagination.current_page," of ",e.pagination.last_page," "),s(),d("disabled",e.pagination.current_page===e.pagination.last_page)}}function Rr(n,t){n&1&&(h(),i(0,"svg",81),p(1,"circle",42)(2,"path",43),r())}function Ar(n,t){if(n&1){let e=S();i(0,"div",1)(1,"div",2),_("click",function(){f(e);let a=m();return v(a.close())}),r(),i(2,"div",3)(3,"div",4),_("click",function(a){return f(e),v(a.stopPropagation())}),i(4,"div",5)(5,"div",6)(6,"div")(7,"h2",7),l(8,"Assign Assets"),r(),i(9,"p",8),l(10,"Select assets to assign to "),i(11,"span",9),l(12),r()()(),i(13,"button",10),_("click",function(){f(e);let a=m();return v(a.close())}),h(),i(14,"svg",11),p(15,"path",12),r()()(),x(),i(16,"div",13)(17,"div",14)(18,"div",15),h(),i(19,"svg",16),p(20,"path",17),r(),x(),p(21,"input",18),r()(),g(22,wr,5,1,"div",19),r()(),i(23,"div",20),g(24,Cr,6,1,"div",21)(25,Sr,8,0,"div",22)(26,Pr,9,4,"div",23)(27,Vr,7,1,"div",24)(28,Or,7,4,"div",25),r(),i(29,"div",26)(30,"div",27)(31,"button",28),_("click",function(){f(e);let a=m();return v(a.close())}),l(32," Cancel "),r(),i(33,"button",29),_("click",function(){f(e);let a=m();return v(a.assignAssets())}),g(34,Rr,3,0,"svg",30),i(35,"span"),l(36),r()()()()()()()}if(n&2){let e=m();s(12),C(e.locationName),s(9),d("formControl",e.searchControl),s(),d("ngIf",e.selectedCount>0),s(2),d("ngIf",e.error),s(),d("ngIf",e.loading),s(),d("ngIf",!e.loading&&e.assets.length>0),s(),d("ngIf",!e.loading&&e.assets.length===0),s(),d("ngIf",!e.loading&&e.assets.length>0&&e.pagination.last_page>1),s(3),d("disabled",e.assigning),s(2),d("disabled",e.selectedCount===0||e.assigning),s(),d("ngIf",e.assigning),s(2),C(e.assigning?"Assigning...":"Assign "+(e.selectedCount>0?e.selectedCount+" Asset"+(e.selectedCount!==1?"s":""):"Assets"))}}var ct=class n{constructor(t){this.locationService=t}isOpen=!1;locationId=null;locationName="";closeModal=new F;assetsAssigned=new F;destroy$=new T;assets=[];selectedAssetIds=new Set;loading=!1;assigning=!1;error=null;searchControl=new ii("");pagination={current_page:1,last_page:1,per_page:20,total:0,from:0,to:0};ngOnInit(){this.searchControl.valueChanges.pipe(Ue(300),Ae(),D(this.destroy$)).subscribe(()=>{this.pagination.current_page=1,this.loadAssets()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnChanges(){this.isOpen&&this.locationId&&(this.selectedAssetIds.clear(),this.pagination.current_page=1,this.loadAssets())}loadAssets(){this.locationId&&(this.loading=!0,this.error=null,this.locationService.getAssignableAssets(this.locationId,{search:this.searchControl.value||void 0,per_page:this.pagination.per_page,page:this.pagination.current_page}).pipe(D(this.destroy$)).subscribe({next:t=>{t.success&&(this.assets=t.data.assets,this.pagination=t.data.pagination),this.loading=!1},error:t=>{this.error=t.error?.message||"Failed to load assets",this.loading=!1}}))}toggleAsset(t){this.selectedAssetIds.has(t)?this.selectedAssetIds.delete(t):this.selectedAssetIds.add(t)}toggleAll(){this.selectedAssetIds.size===this.assets.length?this.selectedAssetIds.clear():this.assets.forEach(t=>this.selectedAssetIds.add(t.id))}isAssetSelected(t){return this.selectedAssetIds.has(t)}get selectedCount(){return this.selectedAssetIds.size}get allSelected(){return this.assets.length>0&&this.selectedAssetIds.size===this.assets.length}goToPage(t){t>=1&&t<=this.pagination.last_page&&(this.pagination.current_page=t,this.loadAssets())}assignAssets(){!this.locationId||this.selectedAssetIds.size===0||(this.assigning=!0,this.error=null,this.locationService.assignAssets(this.locationId,Array.from(this.selectedAssetIds)).pipe(D(this.destroy$)).subscribe({next:t=>{t.success&&(this.assetsAssigned.emit(t.data.assigned_count),this.close()),this.assigning=!1},error:t=>{this.error=t.error?.message||"Failed to assign assets",this.assigning=!1}}))}close(){this.selectedAssetIds.clear(),this.searchControl.setValue(""),this.error=null,this.closeModal.emit()}static \u0275fac=function(e){return new(e||n)(L(z))};static \u0275cmp=R({type:n,selectors:[["app-assign-assets-modal"]],inputs:{isOpen:"isOpen",locationId:"locationId",locationName:"locationName"},outputs:{closeModal:"closeModal",assetsAssigned:"assetsAssigned"},features:[se],decls:1,vars:1,consts:[["class","fixed inset-0 overflow-y-auto","style","z-index: 1000;",4,"ngIf"],[1,"fixed","inset-0","overflow-y-auto",2,"z-index","1000"],[1,"fixed","inset-0","bg-black","bg-opacity-70","transition-opacity",2,"opacity",".5",3,"click"],[1,"flex","min-h-full","items-center","justify-center","p-4"],[1,"relative","bg-white","rounded-2xl","shadow-xl","max-w-4xl","w-full","max-h-[90vh]","flex","flex-col",2,"z-index","1000",3,"click"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600","mt-1"],[1,"font-semibold"],[1,"text-gray-400","hover:text-gray-600","transition-colors","p-2","hover:bg-gray-100","rounded-lg",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","items-center","justify-between","mt-4","gap-4"],[1,"flex-1","max-w-md"],[1,"relative"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Search by name, serial number...",1,"w-full","pl-10","pr-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"formControl"],["class","flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg",4,"ngIf"],[1,"flex-1","overflow-y-auto","px-6","py-4"],["class","mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],["class","flex items-center justify-center py-12",4,"ngIf"],["class","space-y-3",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","mt-4 flex items-center justify-between border-t border-gray-200 pt-4",4,"ngIf"],[1,"px-6","py-4","border-t","border-gray-200","bg-gray-50","rounded-b-2xl"],[1,"flex","items-center","justify-end","gap-3"],[1,"px-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","font-medium","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-6","py-2","bg-blue-600","text-white","rounded-lg","font-medium","hover:bg-blue-700","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"click","disabled"],["class","animate-spin w-5 h-5","fill","none","viewBox","0 0 24 24",4,"ngIf"],[1,"flex","items-center","gap-2","px-4","py-2","bg-blue-50","text-blue-700","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"mb-4","p-4","bg-red-50","border","border-red-200","rounded-lg"],[1,"flex","items-center","gap-2","text-red-800"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"font-medium"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","rounded-full","mb-3"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-6","h-6","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-sm","text-gray-600"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","rounded-lg","border","border-gray-200"],[1,"flex","items-center","gap-3","cursor-pointer","flex-1"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","border-gray-300","focus:ring-blue-500",3,"change","checked"],[1,"font-medium","text-gray-700"],[1,"text-sm","text-gray-500"],["class","flex items-center gap-4 p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-md transition-all duration-200",3,"bg-blue-50","border-blue-400",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-4","p-4","border","border-gray-200","rounded-lg","hover:border-blue-300","hover:shadow-md","transition-all","duration-200"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","border-gray-300","focus:ring-blue-500","cursor-pointer",3,"change","checked"],[1,"w-16","h-16","bg-gray-100","rounded-lg","flex-shrink-0","overflow-hidden"],["class","w-full h-full object-cover",3,"src","alt",4,"ngIf"],["class","w-full h-full flex items-center justify-center",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-gray-900","truncate"],[1,"flex","items-center","gap-3","mt-1","text-sm","text-gray-600"],[4,"ngIf"],["class","inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",4,"ngIf"],["class","flex items-center gap-1 mt-1 text-xs text-gray-500",4,"ngIf"],["class","flex items-center gap-1 mt-1 text-xs text-gray-400",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium","bg-purple-100","text-purple-700"],[1,"flex","items-center","gap-1","mt-1","text-xs","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","gap-1","mt-1","text-xs","text-gray-400"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-4","flex","items-center","justify-between","border-t","border-gray-200","pt-4"],[1,"px-3","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-sm","text-gray-700"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-5","h-5"]],template:function(e,o){e&1&&g(0,Ar,37,12,"div",0),e&2&&d("ngIf",o.isOpen)},dependencies:[j,W,N,K,te,ie,ri],styles:[".overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}"]})};var Fr=n=>["/locations",n],Hr=n=>({node:n,level:0}),Nr=(n,t)=>({node:n,level:t}),jr=n=>["/assets/preview",n];function zr(n,t){if(n&1&&(i(0,"li")(1,"div",15),h(),i(2,"svg",22),p(3,"path",23),r(),x(),i(4,"a",29),l(5),r()()()),n&2){let e=t.$implicit;s(4),d("routerLink",Qe(2,Fr,e.id)),s(),w(" ",e.name," ")}}function Br(n,t){if(n&1&&(i(0,"span",30),l(1),r()),n&2){let e=m(2);s(),G(" \u2022 ",e.ancestors.length," parent location",e.ancestors.length!==1?"s":""," ")}}function Gr(n,t){if(n&1&&(i(0,"div",12)(1,"nav",13)(2,"ol",14)(3,"li")(4,"div",15)(5,"a",16),h(),i(6,"svg",17),p(7,"path",18)(8,"path",19),r(),x(),i(9,"span",20),l(10,"Locations"),r()()()(),g(11,zr,6,4,"li",21),i(12,"li")(13,"div",15),h(),i(14,"svg",22),p(15,"path",23),r(),x(),i(16,"span",24),l(17),r()()()()(),i(18,"div",25)(19,"span",26),l(20),r(),i(21,"span",27),l(22),r(),g(23,Br,2,2,"span",28),r()()),n&2){let e=m();s(11),d("ngForOf",e.ancestors),s(6),C(e.location.name),s(3),w(" Level ",e.location.hierarchy_level," "),s(2),C((e.location.type==null?null:e.location.type.name)||"Unknown Type"),s(),d("ngIf",e.ancestors.length>0)}}function $r(n,t){n&1&&(i(0,"div",31)(1,"div",32)(2,"div",33),h(),i(3,"svg",34),p(4,"circle",35)(5,"path",36),r()(),x(),i(6,"h3",37),l(7,"Loading Location"),r(),i(8,"p",38),l(9,"Please wait while we fetch the location details..."),r()()())}function Ur(n,t){if(n&1){let e=S();i(0,"div",31)(1,"div",32)(2,"div",39),h(),i(3,"svg",40),p(4,"path",41),r()(),x(),i(5,"h3",37),l(6,"Error Loading Location"),r(),i(7,"p",42),l(8),r(),i(9,"button",43),_("click",function(){f(e);let a=m();return v(a.goBack())}),l(10," Back to Locations "),r()()()}if(n&2){let e=m();s(8),C(e.error)}}function qr(n,t){if(n&1){let e=S();i(0,"div",112)(1,"button",113),_("click",function(){f(e);let a=m(2);return v(a.addAsset())}),h(),i(2,"svg",64),p(3,"path",114),r(),x(),i(4,"div")(5,"div",8),l(6,"Create New Asset"),r(),i(7,"div",27),l(8,"Add a brand new asset"),r()()(),i(9,"button",113),_("click",function(){f(e);let a=m(2);return v(a.openAssignAssetsModal())}),h(),i(10,"svg",73),p(11,"path",115),r(),x(),i(12,"div")(13,"div",8),l(14,"Assign Existing Assets"),r(),i(15,"div",27),l(16,"Move assets from other locations"),r()()()()}if(n&2){let e=m(2);E("right-0",!e.isRtl())("left-0",e.isRtl()),s(),E("text-left",!e.isRtl())("text-right",e.isRtl()),s(),E("mr-3",!e.isRtl())("ml-3",e.isRtl()),s(7),E("text-left",!e.isRtl())("text-right",e.isRtl()),s(),E("mr-3",!e.isRtl())("ml-3",e.isRtl())}}function Wr(n,t){n&1&&(i(0,"div",116)(1,"div",32)(2,"div",117),h(),i(3,"svg",118),p(4,"circle",35)(5,"path",36),r()(),x(),i(6,"p",119),l(7,"Loading hierarchy..."),r()()())}function Qr(n,t){n&1&&vt(0)}function Zr(n,t){if(n&1&&(oe(0),g(1,Qr,1,0,"ng-container",121),re()),n&2){let e=t.$implicit;m(2);let o=xt(81);s(),d("ngTemplateOutlet",o)("ngTemplateOutletContext",Qe(2,Hr,e))}}function Yr(n,t){if(n&1&&(i(0,"div",120),g(1,Zr,2,4,"ng-container",21),r()),n&2){let e=m(2);s(),d("ngForOf",e.hierarchyData)}}function Kr(n,t){n&1&&(i(0,"div",122)(1,"div",123),h(),i(2,"svg",124),p(3,"path",74),r()(),x(),i(4,"h3",37),l(5,"No Hierarchy Data"),r(),i(6,"p",119),l(7,"Location hierarchy will appear here."),r()())}function Xr(n,t){if(n&1){let e=S();i(0,"button",143),_("click",function(a){f(e);let c=m().node;return m(2).toggleNode(c.id),v(a.stopPropagation())}),h(),i(1,"svg",144),p(2,"path",23),r()()}if(n&2){let e=m().node,o=m(2);s(),E("rotate-90",o.isNodeExpanded(e.id))}}function Jr(n,t){n&1&&(i(0,"div",145),p(1,"div",146),r())}function ea(n,t){n&1&&(h(),i(0,"svg",64),p(1,"path",48),r())}function ta(n,t){n&1&&(h(),i(0,"svg",64),p(1,"path",18)(2,"path",19),r())}function ia(n,t){if(n&1&&(i(0,"span"),l(1),r()),n&2){let e=m().node;s(),C(e.address)}}function na(n,t){n&1&&(i(0,"span",147),l(1,"No address"),r())}function oa(n,t){if(n&1&&(i(0,"span"),l(1),r()),n&2){let e=m().node;s(),G(" ",e.children.length," sub-location",e.children.length!==1?"s":""," ")}}function ra(n,t){n&1&&vt(0)}function aa(n,t){if(n&1&&(oe(0),g(1,ra,1,0,"ng-container",121),re()),n&2){let e=t.$implicit,o=m(2).level;m();let a=xt(81);s(),d("ngTemplateOutlet",a)("ngTemplateOutletContext",Qt(2,Nr,e,o+1))}}function sa(n,t){if(n&1&&(i(0,"div",148),g(1,aa,2,5,"ng-container",21),r()),n&2){let e=m().node;s(),d("ngForOf",e.children)}}function la(n,t){if(n&1){let e=S();i(0,"div",125)(1,"div",15)(2,"div",126),g(3,Xr,3,2,"button",127)(4,Jr,2,0,"div",128),i(5,"div",129),g(6,ea,2,0,"svg",130)(7,ta,3,0,"svg",130),r(),i(8,"div",131)(9,"div",132)(10,"h3",133),l(11),r(),i(12,"span",134),l(13),r(),i(14,"span",135),l(15),r()(),i(16,"div",136),g(17,ia,2,1,"span",137)(18,na,2,0,"span",138),r(),i(19,"div",139)(20,"span"),l(21),r(),g(22,oa,2,2,"span",137),r()()(),i(23,"div",140)(24,"button",141),_("click",function(a){let c=f(e).node;return m(2).navigateToLocation(c.id),v(a.stopPropagation())}),l(25," View "),r()()(),g(26,sa,2,1,"div",142),r()}if(n&2){let e=t.node,o=m(2);E("bg-blue-50",e.isCurrent)("highlight-current",o.showCurrentLocation&&e.isCurrent),d("id","location-"+e.id),s(3),d("ngIf",e.children&&e.children.length>0),s(),d("ngIf",!e.children||e.children.length===0),s(2),d("ngIf",o.getLocationIcon(e.type)==="factory"),s(),d("ngIf",o.getLocationIcon(e.type)==="building"),s(3),E("font-bold",e.isCurrent)("text-blue-700",e.isCurrent),s(),w(" ",e.name," "),s(2),w(" Level ",e.hierarchy_level," "),s(2),w(" ",(e.type==null?null:e.type.name)||"Unknown Type"," "),s(2),d("ngIf",e.address),s(),d("ngIf",!e.address),s(3),G("",e.assets_count||0," asset",(e.assets_count||0)!==1?"s":"",""),s(),d("ngIf",e.children&&e.children.length>0),s(4),d("ngIf",o.isNodeExpanded(e.id)&&e.children&&e.children.length>0)}}function ca(n,t){n&1&&(i(0,"div",122)(1,"div",117),h(),i(2,"svg",118),p(3,"circle",35)(4,"path",36),r()(),x(),i(5,"p",119),l(6,"Loading assets..."),r()())}function da(n,t){if(n&1&&p(0,"img",159),n&2){let e=m().$implicit;d("src",e.images[0].image_url,H)("alt",e.name)}}function ma(n,t){n&1&&(i(0,"div",160),h(),i(1,"svg",161),p(2,"path",65),r()())}function pa(n,t){if(n&1&&(i(0,"p",162),l(1),r()),n&2){let e=m().$implicit;s(),w("SN: ",e.serial_number,"")}}function ua(n,t){if(n&1&&(i(0,"span",163),l(1),r()),n&2){let e=m().$implicit;s(),w(" ",e.category.name," ")}}function ha(n,t){if(n&1&&(i(0,"span",164),l(1),r()),n&2){let e=m().$implicit;s(),w(" ",e.status," ")}}function ga(n,t){if(n&1&&(i(0,"div",151)(1,"div",152),g(2,da,1,2,"img",153)(3,ma,3,0,"div",154),r(),i(4,"h4",155),l(5),r(),g(6,pa,2,1,"p",156),i(7,"div",3),g(8,ua,2,1,"span",157)(9,ha,2,1,"span",158),r()()),n&2){let e=t.$implicit;d("routerLink",Qe(7,jr,e.id)),s(2),d("ngIf",e.images&&e.images.length>0),s(),d("ngIf",!e.images||e.images.length===0),s(2),C(e.name),s(),d("ngIf",e.serial_number),s(2),d("ngIf",e.category),s(),d("ngIf",e.status)}}function _a(n,t){if(n&1&&(i(0,"div",149),g(1,ga,10,9,"div",150),r()),n&2){let e=m(2);s(),d("ngForOf",e.assets)}}function fa(n,t){if(n&1){let e=S();i(0,"div",122)(1,"div",123),h(),i(2,"svg",124),p(3,"path",65),r()(),x(),i(4,"h3",37),l(5,"No Assets Found"),r(),i(6,"p",165),l(7,"This location doesn't have any assets assigned yet."),r(),i(8,"div",166)(9,"button",167),_("click",function(){f(e);let a=m(2);return v(a.addAsset())}),h(),i(10,"svg",6),p(11,"path",114),r(),x(),i(12,"span"),l(13,"Create New Asset"),r()(),i(14,"button",168),_("click",function(){f(e);let a=m(2);return v(a.openAssignAssetsModal())}),h(),i(15,"svg",6),p(16,"path",115),r(),x(),i(17,"span"),l(18,"Assign Existing"),r()()()()}}function va(n,t){n&1&&(i(0,"div",122)(1,"div",169),h(),i(2,"svg",118),p(3,"circle",35)(4,"path",36),r()(),x(),i(5,"h3",37),l(6,"Loading Sub-locations"),r(),i(7,"p",38),l(8,"Please wait..."),r()())}function xa(n,t){if(n&1){let e=S();i(0,"div",177),_("click",function(){let a=f(e).$implicit,c=m(3);return v(c.viewSubLocation(a))}),i(1,"div",178)(2,"div",50)(3,"div",179),h(),i(4,"svg",180),p(5,"path",74),r()(),x(),i(6,"div")(7,"h4",181),l(8),r(),i(9,"div",182)(10,"span"),l(11),r()(),i(12,"div",183),l(13),r()()(),i(14,"div",184)(15,"button",185),_("click",function(a){let c=f(e).$implicit;return m(3).editSubLocation(c),v(a.stopPropagation())}),h(),i(16,"svg",17),p(17,"path",52),r()()()(),x(),i(18,"div",186)(19,"div",4)(20,"span",93),l(21,"Assets: "),i(22,"span",187),l(23),r()()()()()}if(n&2){let e=t.$implicit;s(8),C(e.name),s(3),C(e.type.name),s(2),C(e.description||e.name),s(10),C(e.assets_count||0)}}function ya(n,t){if(n&1){let e=S();i(0,"button",196),_("click",function(a){f(e);let c=m().$implicit;return m(3).toggleNode(c.id),v(a.stopPropagation())}),h(),i(1,"svg",144),p(2,"path",23),r()()}if(n&2){let e=m().$implicit,o=m(3);s(),E("rotate-90",o.isNodeExpanded(e.id))}}function ba(n,t){n&1&&(i(0,"div",197),p(1,"div",146),r())}function wa(n,t){if(n&1&&(i(0,"span",198),l(1),r()),n&2){let e=m().$implicit;s(),w("(",e.children.length,")")}}function Ca(n,t){if(n&1){let e=S();i(0,"button",210),_("click",function(a){f(e);let c=m().$implicit;return m(5).toggleNode(c.id),v(a.stopPropagation())}),h(),i(1,"svg",211),p(2,"path",23),r()()}if(n&2){let e=m().$implicit,o=m(5);s(),E("rotate-90",o.isNodeExpanded(e.id))}}function Sa(n,t){n&1&&(i(0,"div",201),h(),i(1,"svg",212),p(2,"path",213),r()())}function Ma(n,t){if(n&1&&(i(0,"span",214),l(1),r()),n&2){let e=m().$implicit;s(),w("(",e.children.length,")")}}function Ea(n,t){if(n&1&&(oe(0),i(1,"div",216)(2,"div",217),p(3,"div",218),r(),i(4,"span",27),l(5),r()(),re()),n&2){let e=t.$implicit;s(5),C(e.name)}}function ka(n,t){if(n&1&&(i(0,"div",215),g(1,Ea,6,1,"ng-container",21),r()),n&2){let e=m().$implicit;s(),d("ngForOf",e.children)}}function La(n,t){if(n&1&&(oe(0),i(1,"div",200)(2,"div",201),g(3,Ca,3,2,"button",202)(4,Sa,3,0,"div",203),r(),i(5,"div",204),h(),i(6,"svg",205),p(7,"circle",206),r()(),x(),i(8,"span",207),l(9),r(),g(10,Ma,2,1,"span",208),r(),g(11,ka,2,1,"div",209),re()),n&2){let e=t.$implicit,o=m(5);s(3),d("ngIf",e.children&&e.children.length>0),s(),d("ngIf",!e.children||e.children.length===0),s(5),C(e.name),s(),d("ngIf",e.children==null?null:e.children.length),s(),d("ngIf",o.isNodeExpanded(e.id)&&(e.children==null?null:e.children.length))}}function Ta(n,t){if(n&1&&(i(0,"div",199),g(1,La,12,5,"ng-container",21),r()),n&2){let e=m().$implicit;s(),d("ngForOf",e.children)}}function Ia(n,t){if(n&1&&(oe(0),i(1,"div",188)(2,"div",15),g(3,ya,3,2,"button",189)(4,ba,2,0,"div",190),r(),i(5,"div",191),h(),i(6,"svg",192),p(7,"path",74),r()(),x(),i(8,"span",193),l(9),r(),g(10,wa,2,1,"span",194),r(),g(11,Ta,2,1,"div",195),re()),n&2){let e=t.$implicit,o=m(3);s(3),d("ngIf",e.children&&e.children.length>0),s(),d("ngIf",!e.children||e.children.length===0),s(5),C(e.name),s(),d("ngIf",e.children==null?null:e.children.length),s(),d("ngIf",o.isNodeExpanded(e.id)&&(e.children==null?null:e.children.length))}}function Da(n,t){if(n&1&&(i(0,"div",91),g(1,xa,24,4,"div",170),i(2,"div",171)(3,"h3",172),l(4,"Hierarchy View"),r(),i(5,"div",173)(6,"div",50)(7,"div",174),h(),i(8,"svg",175),p(9,"path",48),r()(),x(),i(10,"div")(11,"h4",176),l(12),r()()()(),i(13,"div",120),g(14,Ia,12,5,"ng-container",21),r()()()),n&2){let e=m(2);s(),d("ngForOf",e.subLocations),s(11),C(e.location.name),s(2),d("ngForOf",e.subLocations)}}function Pa(n,t){if(n&1){let e=S();i(0,"div",122)(1,"div",123),h(),i(2,"svg",124),p(3,"path",74),r()(),x(),i(4,"h3",37),l(5,"No Sub-locations"),r(),i(6,"p",165),l(7,"Create sub-locations to organize your space more effectively."),r(),i(8,"button",219),_("click",function(){f(e);let a=m(2);return v(a.addSubLocation())}),h(),i(9,"svg",17),p(10,"path",54),r(),x(),i(11,"span"),l(12,"Add First Sub-location"),r()()()}}function Va(n,t){n&1&&(i(0,"div",220)(1,"div",117),h(),i(2,"svg",118),p(3,"circle",35)(4,"path",36),r()(),x(),i(5,"p",119),l(6,"Loading activities..."),r()())}function Oa(n,t){if(n&1&&(i(0,"p",119),l(1),r()),n&2){let e=m().$implicit;s(),G(" By ",e.user.first_name," ",e.user.last_name," ")}}function Ra(n,t){if(n&1&&(i(0,"div",222)(1,"div"),h(),i(2,"svg",223),p(3,"path",224),r()(),x(),i(4,"div",225)(5,"h4",187),l(6),r(),g(7,Oa,2,2,"p",226),i(8,"p",227),l(9),r()()()),n&2){let e=t.$implicit,o=m(3);s(),O("w-8 h-8 bg-"+o.getActivityColor(e.action)+"-100 rounded-lg flex items-center justify-center"),s(),O("w-4 h-4 text-"+o.getActivityColor(e.action)+"-600"),s(),Ce("d",o.getActivityIcon(e.action)),s(3),C(o.getActivityTitle(e.action,e.comment)),s(),d("ngIf",e.user),s(2),C(o.formatTimeAgo(e.created_at))}}function Aa(n,t){if(n&1&&(i(0,"div",91),g(1,Ra,10,8,"div",221),r()),n&2){let e=m(2);s(),d("ngForOf",e.activities)}}function Fa(n,t){n&1&&(i(0,"div",220)(1,"div",228),h(),i(2,"svg",124),p(3,"path",99),r()(),x(),i(4,"h3",37),l(5,"No Recent Activity"),r(),i(6,"p",119),l(7,"Activities will appear here as changes are made to this location."),r()())}function Ha(n,t){if(n&1){let e=S();i(0,"img",229),_("error",function(a){f(e);let c=m(2);return v(c.onQRCodeError(a))}),r()}if(n&2){let e=m(2);d("src",e.location.quick_chart_qr_url,H)("alt","QR Code for "+e.location.name)}}function Na(n,t){n&1&&(i(0,"div",230),h(),i(1,"svg",231),p(2,"path",101),r()())}function ja(n,t){if(n&1){let e=S();i(0,"div",44)(1,"div",45)(2,"div",3)(3,"div",4)(4,"div",46),h(),i(5,"svg",47),p(6,"path",48),r()(),x(),i(7,"h1",49),l(8),r()(),i(9,"div",50)(10,"button",51),_("click",function(){f(e);let a=m();return v(a.editLocation())}),h(),i(11,"svg",17),p(12,"path",52),r(),x(),i(13,"span"),l(14,"Edit"),r()(),i(15,"div",53)(16,"button",51),_("click",function(){f(e);let a=m();return v(a.toggleAddAssetDropdown())}),h(),i(17,"svg",17),p(18,"path",54),r(),x(),i(19,"span"),l(20,"Add Asset"),r(),h(),i(21,"svg",17),p(22,"path",55),r()(),g(23,qr,17,20,"div",56),r(),x(),i(24,"button",57),_("click",function(){f(e);let a=m();return v(a.deleteLocation())}),h(),i(25,"svg",17),p(26,"path",58),r(),x(),i(27,"span"),l(28,"Delete"),r()()()()(),i(29,"div",59)(30,"div",60)(31,"div",61)(32,"h3",62),l(33,"Total Assets"),r(),i(34,"div",63),h(),i(35,"svg",64),p(36,"path",65),r()()(),x(),i(37,"div",66),l(38),r()(),i(39,"div",60)(40,"div",61)(41,"h3",67),l(42,"Health Score"),r(),i(43,"div",68),h(),i(44,"svg",69),p(45,"path",70),r()()(),x(),i(46,"div",66),l(47),r()(),i(48,"div",60)(49,"div",61)(50,"h3",71),l(51,"Sub-locations"),r(),i(52,"div",72),h(),i(53,"svg",73),p(54,"path",74),r()()(),x(),i(55,"div",66),l(56),r()(),i(57,"div",60)(58,"div",61)(59,"h3",75),l(60,"Total Value"),r(),i(61,"div",76),h(),i(62,"svg",77),p(63,"path",70),r()()(),x(),i(64,"div",66),l(65),r()()(),i(66,"div",78)(67,"div",79)(68,"h2",80),l(69,"Location Hierarchy"),r(),i(70,"div",50)(71,"button",81),_("click",function(){f(e);let a=m();return v(a.showCurrent())}),l(72," Show Current "),r(),i(73,"button",81),_("click",function(){f(e);let a=m();return v(a.expandAll())}),l(74," Expand All "),r(),i(75,"button",81),_("click",function(){f(e);let a=m();return v(a.collapseAll())}),l(76," Collapse All "),r()()(),g(77,Wr,8,0,"div",82)(78,Yr,2,1,"div",83)(79,Kr,8,0,"div",84),r(),g(80,la,27,22,"ng-template",null,0,Zt),i(82,"div",85)(83,"div",86)(84,"div",87)(85,"div",88),h(),i(86,"svg",89),p(87,"path",90),r(),x(),i(88,"h2",80),l(89,"Location Overview"),r()(),i(90,"div",91)(91,"div")(92,"h4",92),l(93,"Description"),r(),i(94,"p",93),l(95),r()()()(),i(96,"div",87)(97,"div",88),h(),i(98,"svg",89),p(99,"path",94),r(),x(),i(100,"h2",80),l(101),r()(),g(102,ca,7,0,"div",84)(103,_a,2,1,"div",95)(104,fa,19,0,"div",84),r(),i(105,"div",87)(106,"div",79)(107,"div",14),h(),i(108,"svg",89),p(109,"path",74),r(),x(),i(110,"h2",80),l(111),r()(),i(112,"button",96),_("click",function(){f(e);let a=m();return v(a.addSubLocation())}),h(),i(113,"svg",17),p(114,"path",54),r(),x(),i(115,"span"),l(116,"Add Sub-location"),r()()(),g(117,va,9,0,"div",84)(118,Da,15,3,"div",97)(119,Pa,13,0,"div",84),r()(),i(120,"div",98)(121,"div",87)(122,"div",88),h(),i(123,"svg",89),p(124,"path",99),r(),x(),i(125,"h2",80),l(126,"Recent Activity"),r()(),g(127,Va,7,0,"div",100)(128,Aa,2,1,"div",97)(129,Fa,8,0,"div",100),r(),i(130,"div",87)(131,"div",88),h(),i(132,"svg",89),p(133,"path",101),r(),x(),i(134,"h2",80),l(135,"Location QR Code"),r()(),i(136,"div",32)(137,"div",102),g(138,Ha,1,2,"img",103)(139,Na,3,0,"div",104),r(),i(140,"h4",105),l(141),r(),i(142,"p",106),l(143),r(),i(144,"div",107)(145,"button",108),_("click",function(){f(e);let a=m();return v(a.downloadQR())}),h(),i(146,"svg",17),p(147,"path",109),r(),x(),i(148,"span"),l(149,"Download"),r()(),i(150,"button",108),_("click",function(){f(e);let a=m();return v(a.printLabel())}),h(),i(151,"svg",17),p(152,"path",110),r(),x(),i(153,"span"),l(154,"Print Label"),r()()(),i(155,"p",111),l(156," Scan this QR code to quickly access location details and view assets. "),r()()()()()()}if(n&2){let e=m();s(8),C(e.location.name),s(15),d("ngIf",e.showAddAssetDropdown),s(15),C(e.mockStats.totalAssets),s(9),w("",e.mockStats.healthScore,"%"),s(9),C(e.mockStats.subLocations),s(9),w("$",e.mockStats.totalValue,""),s(12),d("ngIf",e.subLocationsLoading),s(),d("ngIf",!e.subLocationsLoading&&e.hierarchyData.length>0),s(),d("ngIf",!e.subLocationsLoading&&e.hierarchyData.length===0),s(16),C(e.location.description||e.location.name),s(6),w("Assets at this Location (",e.mockStats.totalAssets,")"),s(),d("ngIf",e.assetsLoading),s(),d("ngIf",!e.assetsLoading&&e.assets.length>0),s(),d("ngIf",!e.assetsLoading&&e.assets.length===0),s(7),w("Sub-locations (",e.mockStats.subLocations,")"),s(6),d("ngIf",e.subLocationsLoading),s(),d("ngIf",!e.subLocationsLoading&&e.subLocations.length>0),s(),d("ngIf",!e.subLocationsLoading&&e.subLocations.length===0),s(8),d("ngIf",e.activitiesLoading),s(),d("ngIf",!e.activitiesLoading&&e.activities.length>0),s(),d("ngIf",!e.activitiesLoading&&e.activities.length===0),s(9),d("ngIf",e.location.quick_chart_qr_url),s(),d("ngIf",!e.location.quick_chart_qr_url),s(2),C(e.location.name),s(2),C(e.mockStats.totalAssets)}}function za(n,t){if(n&1){let e=S();i(0,"app-add-location-modal",236),_("closeModal",function(){f(e);let a=m(2);return v(a.closeAddSubLocationModal())})("locationCreated",function(a){f(e);let c=m(2);return v(c.onSubLocationCreated(a))}),r()}if(n&2){let e=m(2);d("isOpen",e.showAddSubLocationModal)("parentLocation",e.location)}}function Ba(n,t){if(n&1){let e=S();i(0,"app-assign-assets-modal",237),_("closeModal",function(){f(e);let a=m(2);return v(a.closeAssignAssetsModal())})("assetsAssigned",function(a){f(e);let c=m(2);return v(c.onAssetsAssigned(a))}),r()}if(n&2){let e=m(2);d("isOpen",e.showAssignAssetsModal)("locationId",e.location.id)("locationName",e.location.name)}}function Ga(n,t){if(n&1){let e=S();g(0,za,1,2,"app-add-location-modal",232),i(1,"app-edit-location-modal",233),_("closeModal",function(){f(e);let a=m();return v(a.closeEditLocationModal())})("locationUpdated",function(a){f(e);let c=m();return v(c.isEditingSubLocation?c.onSubLocationUpdated():c.onLocationUpdated(a))}),r(),i(2,"app-delete-confirmation-modal",234),_("closeModal",function(){f(e);let a=m();return v(a.closeDeleteConfirmationModal())})("locationDeleted",function(a){f(e);let c=m();return v(c.onLocationDeleted(a))}),r(),g(3,Ba,1,3,"app-assign-assets-modal",235)}if(n&2){let e=m();d("ngIf",e.location),s(),d("isOpen",e.showEditLocationModal)("location",e.isEditingSubLocation?e.subLocation:e.location),s(),d("isOpen",e.showDeleteConfirmationModal)("location",e.location),s(),d("ngIf",e.location)}}var dt=class n{constructor(t,e,o,a){this.route=t;this.router=e;this.locationService=o;this.angularLocation=a}destroy$=new T;location=null;subLocation=null;loading=!0;error="";ancestors=[];subLocations=[];subLocationsLoading=!1;assets=[];assetsLoading=!1;activities=[];activitiesLoading=!1;expandedNodes=new Set;hierarchyData=[];hierarchyLoading=!1;showCurrentLocation=!1;showAddSubLocationModal=!1;showEditLocationModal=!1;showDeleteConfirmationModal=!1;showAssignAssetsModal=!1;showAddAssetDropdown=!1;mockStats={totalAssets:0,healthScore:100,subLocations:0,totalValue:0};isEditingSubLocation=!1;ngOnInit(){this.route.params.pipe(D(this.destroy$)).subscribe(t=>{let e=t.id;e&&this.loadLocation(parseInt(e))})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadLocation(t){this.loading=!0,this.error="",this.locationService.getLocation(t).pipe(D(this.destroy$)).subscribe({next:e=>{e.success?(this.location=e.data.location,e.data.asset_summary&&(this.location.asset_summary=e.data.asset_summary),this.ancestors=e.data.ancestors||[],this.updateMockStats(),this.loadSubLocations(),this.loadAssets(),this.loadActivities()):this.error=e.message||"Failed to load location",this.loading=!1},error:e=>{this.error=e.error?.message||"An error occurred while loading the location",this.loading=!1}})}loadAssets(){this.location&&(this.assetsLoading=!0,this.locationService.getLocationAssets(this.location.id,{per_page:100}).pipe(D(this.destroy$)).subscribe({next:t=>{t.success&&(this.assets=t.data.assets,this.mockStats.totalAssets=t.data.pagination.total),this.assetsLoading=!1},error:t=>{console.error("Failed to load assets:",t),this.assetsLoading=!1}}))}loadSubLocations(){if(!this.location)return;this.subLocationsLoading=!0;let t={parent_id:this.location.id,per_page:100};this.locationService.getLocations(t).pipe(D(this.destroy$)).subscribe({next:e=>{e.success&&(this.subLocations=e.data.locations,this.subLocations.forEach(o=>{this.loadChildrenRecursively(o)}),this.updateMockStats(),this.buildHierarchyTree()),this.subLocationsLoading=!1},error:e=>{console.error("Error loading sub-locations:",e),this.subLocationsLoading=!1}})}loadChildrenRecursively(t){let e={parent_id:t.id,per_page:100};this.locationService.getLocations(e).pipe(D(this.destroy$)).subscribe({next:o=>{o.success&&o.data.locations.length>0&&(t.children=o.data.locations,this.buildHierarchyTree(),t.children.forEach(a=>{this.loadChildrenRecursively(a)}))},error:o=>{console.error("Error loading nested children:",o)}})}updateMockStats(){this.location&&(this.mockStats={totalAssets:this.location.asset_summary?.asset_count||0,healthScore:this.location.asset_summary?.health_score??100,subLocations:this.subLocations.length,totalValue:this.location.asset_summary?.total_value||0})}goBack(){this.angularLocation.back()}editLocation(){this.isEditingSubLocation=!1,this.showEditLocationModal=!0}addAsset(){this.router.navigate(["/assets/create"],{queryParams:{location_id:this.location?.id}}),this.showAddAssetDropdown=!1}openAssignAssetsModal(){this.showAssignAssetsModal=!0,this.showAddAssetDropdown=!1}closeAssignAssetsModal(){this.showAssignAssetsModal=!1}onAssetsAssigned(t){this.loadAssets(),this.loadActivities(),console.log(`${t} asset(s) assigned successfully`)}toggleAddAssetDropdown(){this.showAddAssetDropdown=!this.showAddAssetDropdown}deleteLocation(){this.showDeleteConfirmationModal=!0}addSubLocation(){this.showAddSubLocationModal=!0}closeAddSubLocationModal(){this.showAddSubLocationModal=!1}onSubLocationCreated(t){this.loadSubLocations(),this.loadActivities(),this.showAddSubLocationModal=!1}closeEditLocationModal(){this.showEditLocationModal=!1,this.isEditingSubLocation=!1,this.subLocation&&(this.subLocation=null)}onLocationUpdated(t){console.log(t,"updated location"),this.location=t,this.updateMockStats(),this.loadActivities(),this.showEditLocationModal=!1}onSubLocationUpdated(){this.loadSubLocations(),this.showEditLocationModal=!1}closeDeleteConfirmationModal(){this.showDeleteConfirmationModal=!1}onLocationDeleted(t){this.router.navigate(["/locations"])}onQRCodeError(t){t.target.style.display="none",console.log("QR code image failed to load")}regenerateQR(){console.log("Regenerate QR code")}downloadQR(){if(this.location?.quick_chart_qr_url){let t=document.createElement("a");t.href=this.location.quick_chart_qr_url,t.target="_blank",t.download=`qr-code-${this.location.name.toLowerCase().replace(/\s+/g,"-")}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}}printLabel(){if(this.location?.quick_chart_qr_url){let t=window.open("","_blank");t&&(t.document.write(`
         <html>
           <head>
             <title>Print Label</title>
             <style>
               body {
                 font-family: Arial, sans-serif;
                 text-align: center;
                 margin: 20px;
               }
               img {
                 max-width: 100%;
                 height: auto;
               }
                .info {
               margin-top: 15px;
               font-size: 14px;

             }
             .info strong {
               display: inline-block;
              margin: 0 auto;
               width: 120px;
             }
             </style>
           </head>
           <body>
             <h1>${this.location.name}</h1>
             <img src="${this.location.quick_chart_qr_url}" alt="QR Code for ${this.location.name}">
             <p>Scan this QR code to access location details.</p>

              <div class="info text-center">
             <p><strong>Branch:</strong> ${this.location.name}</p>
             <p><strong>Location ID:</strong> ${this.location.id}</p>
             <p><strong>Type:</strong> ${this.location.type.name}</p>
             <p><strong>Address:</strong> ${this.location.address}</p>
           </div>
             <script>
               window.onload = function() {
                setTimeout(() => {
                  window.print();
                  window.close();
                }, 200);
               };
             <\/script>
           </body>
         </html>
       `),t.document.close())}else console.error("QR code URL is not available for printing.")}loadActivities(){this.location&&(this.activitiesLoading=!0,this.locationService.getLocationActivities(this.location.id,{per_page:10}).pipe(D(this.destroy$)).subscribe({next:t=>{t.success&&(this.activities=t.data.activities||[]),this.activitiesLoading=!1},error:t=>{console.error("Failed to load activities:",t),this.activitiesLoading=!1}}))}getActivityIcon(t){return{location_created:"M12 4v16m8-8H4",sub_location_created:"M12 4v16m8-8H4",location_updated:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",location_deleted:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",sub_location_deleted:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",asset_assigned:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",asset_removed:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}[t]||"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"}getActivityColor(t){return{location_created:"green",sub_location_created:"green",location_updated:"blue",location_deleted:"red",sub_location_deleted:"red",asset_assigned:"orange",asset_removed:"orange"}[t]||"gray"}getActivityTitle(t,e){return e||{location_created:"Location Created",sub_location_created:"Sub-Location Added",location_updated:"Location Updated",location_deleted:"Location Deleted",sub_location_deleted:"Sub-Location Removed",asset_assigned:"Asset Assigned",asset_removed:"Asset Removed"}[t]||"Activity"}formatTimeAgo(t){let e=new Date(t),a=Math.floor((new Date().getTime()-e.getTime())/1e3);if(a<60)return"just now";if(a<3600){let c=Math.floor(a/60);return`${c} minute${c!==1?"s":""} ago`}else if(a<86400){let c=Math.floor(a/3600);return`about ${c} hour${c!==1?"s":""} ago`}else if(a<2592e3){let c=Math.floor(a/86400);return`${c} day${c!==1?"s":""} ago`}else{let c=Math.floor(a/2592e3);return`${c} month${c!==1?"s":""} ago`}}viewSubLocation(t){this.router.navigate(["/locations",t.id]),setTimeout(()=>{this.route.params.pipe(D(this.destroy$)).subscribe(e=>{let o=e.id;o&&this.loadLocation(parseInt(o))})},500)}editSubLocation(t){this.subLocation=t,this.isEditingSubLocation=!0,this.showEditLocationModal=!0}deleteSubLocation(t){console.log("Delete sublocation:",t)}toggleNode(t){this.expandedNodes.has(t)?this.expandedNodes.delete(t):this.expandedNodes.add(t)}isNodeExpanded(t){return this.expandedNodes.has(t)}isRtl(){return document.documentElement.dir==="rtl"}buildHierarchyTree(){if(!this.location)return;this.hierarchyData=[];let t={id:this.location.id,name:this.location.name,type:this.location.type,hierarchy_level:this.location.hierarchy_level,address:this.location.address,assets_count:this.location.assets_count||this.location.asset_summary?.asset_count||0,children:this.buildChildrenTree(this.subLocations),isCurrent:!0};this.hierarchyData=[t]}buildChildrenTree(t){return!t||t.length===0?[]:t.map(e=>{let o={id:e.id,name:e.name,type:e.type,hierarchy_level:e.hierarchy_level,address:e.address,assets_count:e.assets_count||e.asset_summary?.asset_count||0,children:[]};return e.children&&e.children.length>0&&(o.children=this.buildChildrenTree(e.children)),o})}expandAll(){if(!this.hierarchyData||this.hierarchyData.length===0)return;let t=e=>{this.expandedNodes.add(e.id),e.children&&e.children.length>0&&e.children.forEach(o=>t(o))};this.hierarchyData.forEach(e=>t(e))}collapseAll(){this.expandedNodes.clear()}showCurrent(){if(!this.location||!this.hierarchyData||this.hierarchyData.length===0)return;let t=(e,o)=>{for(let a of e){if(a.id===o)return this.expandedNodes.add(a.id),!0;if(a.children&&a.children.length>0&&t(a.children,o))return this.expandedNodes.add(a.id),!0}return!1};t(this.hierarchyData,this.location.id),this.showCurrentLocation=!0,setTimeout(()=>{let e=document.getElementById(`location-${this.location?.id}`);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("highlight-current"),setTimeout(()=>{e.classList.remove("highlight-current")},2e3)),this.showCurrentLocation=!1},100)}getLocationIcon(t){if(!t||!t.name)return"building";let e=t.name.toLowerCase();return e.includes("factory")||e.includes("warehouse")?"factory":"building"}countChildren(t){return!t.children||t.children.length===0?0:t.children.length+t.children.reduce((e,o)=>e+this.countChildren(o),0)}navigateToLocation(t){this.router.navigate(["/locations",t])}static \u0275fac=function(e){return new(e||n)(L(ei),L(Ye),L(z),L(Kt))};static \u0275cmp=R({type:n,selectors:[["app-location-view"]],decls:14,vars:5,consts:[["hierarchyNodeTemplate",""],[1,"min-h-screen","bg-gray-50"],[1,"bg-white","border-b","border-gray-200","px-6","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"font-medium"],["class","mt-4",4,"ngIf"],["class","flex items-center justify-center py-20",4,"ngIf"],["class","px-6 py-6",4,"ngIf"],[1,"mt-4"],["aria-label","Breadcrumb",1,"flex"],[1,"flex","items-center","space-x-2"],[1,"flex","items-center"],["routerLink","/locations",1,"text-gray-500","hover:text-gray-700","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 21l4-4 4 4"],[1,"sr-only"],[4,"ngFor","ngForOf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400","mx-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"text-gray-900","text-sm","font-medium"],[1,"mt-2","flex","items-center","space-x-2"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"text-xs","text-gray-500"],["class","text-xs text-gray-400",4,"ngIf"],[1,"text-gray-500","hover:text-gray-700","transition-colors","text-sm","font-medium",3,"routerLink"],[1,"text-xs","text-gray-400"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","rounded-full","mb-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-8","h-8","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-red-100","rounded-full","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-sm","text-gray-500","mb-4"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"px-6","py-6"],[1,"bg-blue-100","rounded-lg","p-6","mb-6"],[1,"w-12","h-12","bg-blue-200","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-700"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"text-2xl","font-bold","text-gray-900"],[1,"flex","items-center","space-x-3"],[1,"flex","items-center","space-x-2","px-4","py-2","text-gray-700","hover:bg-blue-200","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"relative"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",3,"right-0","left-0",4,"ngIf"],[1,"flex","items-center","space-x-2","px-4","py-2","text-red-600","hover:bg-red-50","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","mb-6"],[1,"bg-white","rounded-lg","p-4","border","border-gray-200"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-sm","font-medium","text-blue-600"],[1,"w-8","h-8","bg-blue-50","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","font-medium","text-green-600"],[1,"w-8","h-8","bg-green-50","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"text-sm","font-medium","text-purple-600"],[1,"w-8","h-8","bg-purple-50","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"],[1,"text-sm","font-medium","text-orange-600"],[1,"w-8","h-8","bg-orange-50","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],[1,"bg-white","rounded-lg","p-6","shadow-sm","mb-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"px-4","py-2","text-sm","font-medium","text-gray-600","hover:text-gray-800","hover:bg-gray-100","rounded-lg","transition-colors","cursor-pointer",3,"click"],["class","flex items-center justify-center py-12",4,"ngIf"],["class","space-y-1",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-6"],[1,"bg-white","rounded-lg","p-6","shadow-sm","border","border-gray-200"],[1,"flex","items-center","space-x-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-700","mb-2"],[1,"text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",4,"ngIf"],[1,"flex","items-center","space-x-2","px-3","py-2","text-blue-600","hover:bg-blue-50","rounded-lg","transition-colors",3,"click"],["class","space-y-4",4,"ngIf"],[1,"space-y-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],["class","text-center py-8",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"],[1,"w-32","h-32","bg-gray-100","rounded-lg","mx-auto","mb-4","flex","items-center","justify-center","overflow-hidden"],["class","w-full h-full object-contain",3,"src","alt","error",4,"ngIf"],["class","w-24 h-24 bg-gray-300 rounded flex items-center justify-center",4,"ngIf"],[1,"font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-600","mb-4"],[1,"flex","gap-3","items-center"],[1,"border","border-gray-200","hover:border-gray-300","font-medium","cursor-pointer","w-full","flex","items-center","justify-center","space-x-2","px-3","py-2","text-gray-600","hover:bg-gray-50","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"],[1,"text-xs","text-gray-500","mt-4"],[1,"absolute","mt-2","w-56","bg-white","rounded-lg","shadow-lg","border","border-gray-200","py-2","z-50"],[1,"w-full","flex","items-center","px-4","py-2","text-gray-700","hover:bg-blue-50","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"],[1,"flex","items-center","justify-center","py-12"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","rounded-full","mb-3"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-6","h-6","text-blue-600"],[1,"text-sm","text-gray-600"],[1,"space-y-1"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"text-center","py-12"],[1,"w-16","h-16","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],[1,"bg-white","rounded-lg","p-4","mb-1","transition-colors",3,"id"],[1,"flex","items-center","space-x-3","flex-1","min-w-0"],["class","w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors cursor-pointer flex-shrink-0",3,"click",4,"ngIf"],["class","w-6 h-6 flex items-center justify-center flex-shrink-0",4,"ngIf"],[1,"w-8","h-8","bg-blue-100","rounded","flex","items-center","justify-center","flex-shrink-0"],["class","w-5 h-5 text-blue-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"flex","items-center","space-x-2","flex-wrap"],[1,"font-semibold","text-gray-900","text-sm"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-700"],[1,"mt-1","text-xs","text-gray-500"],[4,"ngIf"],["class","text-gray-400",4,"ngIf"],[1,"mt-1","flex","items-center","space-x-4","text-xs","text-gray-600"],[1,"ml-4","w-16","flex-shrink-0","flex","justify-end"],[1,"px-3","py-1.5","text-xs","font-medium","text-blue-600","hover:text-blue-700","hover:bg-blue-50","rounded-lg","transition-colors","whitespace-nowrap",3,"click"],["class","mt-3 ml-7 space-y-1",4,"ngIf"],[1,"w-6","h-6","flex","items-center","justify-center","text-gray-400","hover:text-gray-600","transition-colors","cursor-pointer","flex-shrink-0",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","transition-transform"],[1,"w-6","h-6","flex","items-center","justify-center","flex-shrink-0"],[1,"w-1","h-1","bg-gray-300","rounded-full"],[1,"text-gray-400"],[1,"mt-3","ml-7","space-y-1"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],["class","border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-md transition-all duration-200 cursor-pointer",3,"routerLink",4,"ngFor","ngForOf"],[1,"border","border-gray-200","rounded-lg","p-4","hover:border-blue-300","hover:shadow-md","transition-all","duration-200","cursor-pointer",3,"routerLink"],[1,"w-full","h-32","bg-gray-100","rounded-lg","mb-3","overflow-hidden"],["class","w-full h-full object-cover",3,"src","alt",4,"ngIf"],["class","w-full h-full flex items-center justify-center",4,"ngIf"],[1,"font-semibold","text-gray-900","mb-1","truncate"],["class","text-sm text-gray-600 mb-2",4,"ngIf"],["class","inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",4,"ngIf"],["class","inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-400"],[1,"text-sm","text-gray-600","mb-2"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-700"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-green-100","text-green-700"],[1,"text-gray-600","mb-4"],[1,"flex","items-center","justify-center","gap-3"],[1,"flex","items-center","gap-2","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"flex","items-center","gap-2","px-4","py-2","bg-purple-600","text-white","rounded-lg","hover:bg-purple-700","transition-colors",3,"click"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","rounded-full","mb-4"],["class","bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-all cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"mt-8","pt-6","border-t","border-gray-200"],[1,"text-base","font-semibold","text-gray-900","mb-4"],[1,"bg-blue-100","rounded-lg","p-3","mb-2"],[1,"w-6","h-6","bg-blue-200","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","text-blue-700"],[1,"font-medium","text-blue-800","text-sm"],[1,"bg-gray-50","rounded-lg","p-4","hover:bg-gray-100","transition-all","cursor-pointer",3,"click"],[1,"flex","items-start","justify-between","mb-3"],[1,"w-8","h-8","bg-white","rounded-lg","flex","items-center","justify-center","border","border-gray-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-600"],[1,"font-semibold","text-gray-900"],[1,"flex","items-center","space-x-2","text-sm","text-gray-500"],[1,"text-sm","text-gray-500","mt-1"],[1,"flex","items-center","space-x-1"],[1,"p-1","text-gray-400","hover:text-blue-600","hover:bg-blue-50","rounded","transition-all",3,"click"],[1,"flex","items-center","justify-between","text-sm"],[1,"font-medium","text-gray-900"],[1,"flex","items-center","space-x-3","p-2","hover:bg-gray-50","rounded","transition-colors"],["class","w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors cursor-pointer",3,"click",4,"ngIf"],["class","w-6 h-6 flex items-center justify-center",4,"ngIf"],[1,"w-5","h-5","bg-gray-100","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","text-gray-600"],[1,"text-sm","font-medium","text-gray-700"],["class","text-xs text-gray-500 ml-1",4,"ngIf"],["class","ml-8 space-y-1",4,"ngIf"],[1,"w-6","h-6","flex","items-center","justify-center","text-gray-400","hover:text-gray-600","transition-colors","cursor-pointer",3,"click"],[1,"w-6","h-6","flex","items-center","justify-center"],[1,"text-xs","text-gray-500","ml-1"],[1,"ml-8","space-y-1"],[1,"flex","items-center","space-x-2","p-1.5","hover:bg-gray-50","rounded","transition-colors"],[1,"w-4","h-4","flex","items-center","justify-center"],["class","w-4 h-4 flex items-center justify-center text-gray-400 hover:text-gray-600 transition-colors cursor-pointer",3,"click",4,"ngIf"],["class","w-4 h-4 flex items-center justify-center",4,"ngIf"],[1,"w-4","h-4","bg-gray-200","rounded","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 8 8",1,"w-2.5","h-2.5","text-gray-600"],["cx","4","cy","4","r","2"],[1,"text-xs","font-medium","text-gray-600"],["class","text-xs text-gray-400 ml-1",4,"ngIf"],["class","ml-6 space-y-1",4,"ngIf"],[1,"w-4","h-4","flex","items-center","justify-center","text-gray-400","hover:text-gray-600","transition-colors","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","transition-transform"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1","d","M5 12h14"],[1,"text-xs","text-gray-400","ml-1"],[1,"ml-6","space-y-1"],[1,"flex","items-center","space-x-2","p-1","hover:bg-gray-50","rounded","transition-colors"],[1,"w-3","h-3","flex","items-center","justify-center","ml-1"],[1,"w-1.5","h-1.5","bg-gray-400","rounded-full"],[1,"flex","items-center","space-x-2","mx-auto","px-4","py-2","text-blue-600","hover:bg-blue-50","rounded-lg","transition-colors",3,"click"],[1,"text-center","py-8"],["class","flex items-start space-x-3",4,"ngFor","ngForOf"],[1,"flex","items-start","space-x-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"flex-1"],["class","text-sm text-gray-600",4,"ngIf"],[1,"text-xs","text-gray-500","mt-1"],[1,"w-16","h-16","bg-gray-100","rounded-lg","mx-auto","mb-4","flex","items-center","justify-center"],[1,"w-full","h-full","object-contain",3,"error","src","alt"],[1,"w-24","h-24","bg-gray-300","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-500"],[3,"isOpen","parentLocation","closeModal","locationCreated",4,"ngIf"],[3,"closeModal","locationUpdated","isOpen","location"],[3,"closeModal","locationDeleted","isOpen","location"],[3,"isOpen","locationId","locationName","closeModal","assetsAssigned",4,"ngIf"],[3,"closeModal","locationCreated","isOpen","parentLocation"],[3,"closeModal","assetsAssigned","isOpen","locationId","locationName"]],template:function(e,o){e&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"button",5),_("click",function(){return o.goBack()}),h(),i(5,"svg",6),p(6,"path",7),r(),x(),i(7,"span",8),l(8,"Back to Locations"),r()()()(),g(9,Gr,24,5,"div",9),r(),g(10,$r,10,0,"div",10)(11,Ur,11,1,"div",10)(12,ja,157,25,"div",11)(13,Ga,4,6),r()),e&2&&(s(9),d("ngIf",o.location&&!o.loading),s(),d("ngIf",o.loading),s(),d("ngIf",o.error&&!o.loading),s(),d("ngIf",o.location&&!o.loading),s(),De(o.loading?-1:13))},dependencies:[j,W,N,Xt,ke,ti,Pe,Ve,ye,ct],styles:[".location-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9)}.stats-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.stats-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.activity-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.activity-item[_ngcontent-%COMP%]:hover{background-color:#f8fafc;border-radius:.5rem;padding:.75rem;margin:-.75rem}.qr-code-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc);border:2px dashed #e5e7eb}.qr-code-container[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:linear-gradient(135deg,#eff6ff,#dbeafe)}.action-button[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.action-button[_ngcontent-%COMP%]:hover{transform:scale(1.02)}.action-button[_ngcontent-%COMP%]:active{transform:scale(.98)}.back-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.back-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;border-radius:.5rem;padding:.5rem 1rem;margin:-.5rem -1rem}.overview-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#fafbfc)}.utilization-bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3b82f6,#1d4ed8);transition:width .3s ease-in-out}.temperature-reading[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-radius:.75rem;padding:1rem}.status-indicator[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7,#bbf7d0);border-radius:.75rem;padding:1rem}.empty-state[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f9fafb,#f3f4f6);border:2px dashed #d1d5db;border-radius:1rem}.empty-state[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:linear-gradient(135deg,#eff6ff,#dbeafe)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.stats-grid[_ngcontent-%COMP%], .main-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.location-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.action-buttons[_ngcontent-%COMP%]{width:100%;justify-content:space-between}}@media print{.action-buttons[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{display:none}.qr-code-container[_ngcontent-%COMP%]{border:1px solid #000;background:#fff}}button[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}*[_ngcontent-%COMP%]{transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.activity-scroll[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}.activity-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.activity-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.activity-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.activity-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.hierarchy-section[_ngcontent-%COMP%]   .hierarchy-node[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.hierarchy-section[_ngcontent-%COMP%]   .hierarchy-node[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#d1d5db}.hierarchy-section[_ngcontent-%COMP%]   .highlight-current[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_highlightPulse 2s ease-in-out;border-color:#3b82f6!important;box-shadow:0 0 0 3px #3b82f61a}.hierarchy-section[_ngcontent-%COMP%]   .expand-icon[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}.hierarchy-section[_ngcontent-%COMP%]   .expand-icon.expanded[_ngcontent-%COMP%]{transform:rotate(90deg)}.hierarchy-section[_ngcontent-%COMP%]   .location-icon[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.hierarchy-section[_ngcontent-%COMP%]   .location-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1)}@keyframes _ngcontent-%COMP%_highlightPulse{0%,to{box-shadow:0 0 0 3px #3b82f61a}50%{box-shadow:0 0 0 6px #3b82f633}}"]})};var $a=[{path:"",component:Re},{path:":id",component:dt}],mt=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=le({type:n});static \u0275inj=ae({imports:[ke.forChild($a),ke]})};var Hi=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=le({type:n});static \u0275inj=ae({imports:[j,K,Ke,mt,Re]})};export{Hi as LocationsModule};
