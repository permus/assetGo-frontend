import{a as te}from"./chunk-PK2MUKIP.js";import{a as ee}from"./chunk-5S6YH7S2.js";import{a as I}from"./chunk-GVXPQDBC.js";import{B as V,c as G,e as q,f as U,g as J,i as K,j as Q,k as X,w as Y,x as Z}from"./chunk-UQACUQIP.js";import{a as B}from"./chunk-MEXLA3FU.js";import{a as W,b as $}from"./chunk-YGU4T3V7.js";import{k,l as D,x as E}from"./chunk-HV2J6S7U.js";import{Gb as n,Hb as i,Ib as C,Mb as h,Pb as _,Qb as c,Y as H,Ya as l,ba as N,bb as v,bc as s,cc as T,dc as f,gc as P,hc as x,ia as z,ic as w,ja as g,ka as m,kb as S,la as M,ma as O,pb as u,ta as A,wb as p,yb as j,za as b}from"./chunk-RHVXZUNF.js";import{a as L,b as F}from"./chunk-EQDQRRRY.js";var y=class r{constructor(t){this.http=t}base=`${B.apiUrl}/sla`;listDefinitions(t){let e=new W;return t&&Object.keys(t).forEach(a=>{t[a]!==void 0&&t[a]!==null&&(e=e.set(a,String(t[a])))}),this.http.get(`${this.base}/definitions`,{params:e})}getDefinition(t){return this.http.get(`${this.base}/definitions/${t}`)}createDefinition(t){return this.http.post(`${this.base}/definitions`,t)}updateDefinition(t,e){return this.http.put(`${this.base}/definitions/${t}`,e)}deleteDefinition(t){return this.http.delete(`${this.base}/definitions/${t}`)}toggleActive(t){return this.http.patch(`${this.base}/definitions/${t}/toggle-active`,{})}static \u0275fac=function(e){return new(e||r)(N($))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};function se(r,t){if(r&1){let e=h();n(0,"button",33),_("click",function(){let o=g(e).$implicit,d=c(3);return m(d.selectAppliesTo(o.value))}),s(1),i()}if(r&2){let e=t.$implicit;l(),f(" ",e.label," ")}}function ce(r,t){if(r&1&&(n(0,"div",31),u(1,se,2,1,"button",32),i()),r&2){let e=c(2);l(),p("ngForOf",e.appliesToOptions)}}function de(r,t){if(r&1){let e=h();n(0,"button",33),_("click",function(){let o=g(e).$implicit,d=c(3);return m(d.selectPriority(o.value))}),s(1),i()}if(r&2){let e=t.$implicit;l(),f(" ",e.label," ")}}function ge(r,t){if(r&1){let e=h();n(0,"div",31)(1,"button",33),_("click",function(){g(e);let o=c(2);return m(o.selectPriority(null))}),s(2," None "),i(),u(3,de,2,1,"button",32),i()}if(r&2){let e=c(2);l(3),p("ngForOf",e.priorityOptions)}}function me(r,t){if(r&1){let e=h();n(0,"button",33),_("click",function(){let o=g(e).$implicit,d=c(3);return m(d.selectCategory(o.id))}),s(1),i()}if(r&2){let e=t.$implicit;l(),f(" ",e.name," ")}}function pe(r,t){if(r&1){let e=h();n(0,"div",31)(1,"button",33),_("click",function(){g(e);let o=c(2);return m(o.selectCategory(null))}),s(2," No Category "),i(),u(3,me,2,1,"button",32),i()}if(r&2){let e=c(2);l(3),p("ngForOf",e.categoryOptions)}}function _e(r,t){r&1&&(n(0,"span"),s(1,"Saving..."),i())}function ue(r,t){if(r&1&&(n(0,"span"),s(1),i()),r&2){let e=c(2);l(),f("",e.editMode?"Update":"Create"," SLA Rule")}}function fe(r,t){if(r&1){let e=h();n(0,"div",1),_("click",function(){g(e);let o=c();return m(o.close())}),n(1,"div",2),_("click",function(o){return g(e),m(o.stopPropagation())}),n(2,"div",3)(3,"div")(4,"h2",4),s(5),i(),n(6,"p",5),s(7,"Define service level agreement rules for work orders and maintenance tasks."),i()(),n(8,"button",6),_("click",function(){g(e);let o=c();return m(o.close())}),M(),n(9,"svg",7),C(10,"line",8)(11,"line",9),i()()(),O(),n(12,"div",10)(13,"form",11),_("ngSubmit",function(){g(e);let o=c();return m(o.submit())}),n(14,"div",12)(15,"h3",13),s(16,"Basic Information"),i(),n(17,"div",14)(18,"label",15),s(19,"SLA Rule Name"),i(),n(20,"input",16),w("ngModelChange",function(o){g(e);let d=c();return x(d.model.name,o)||(d.model.name=o),m(o)}),i()(),n(21,"div",14)(22,"label",15),s(23,"Description"),i(),n(24,"textarea",17),w("ngModelChange",function(o){g(e);let d=c();return x(d.model.description,o)||(d.model.description=o),m(o)}),i()()(),n(25,"div",12)(26,"h3",13),s(27,"Applies To"),i(),n(28,"div",18)(29,"div",14)(30,"label",15),s(31,"Applies To"),i(),n(32,"div",19)(33,"button",20),_("click",function(){g(e);let o=c();return m(o.showAppliesToDropdown=!o.showAppliesToDropdown)}),s(34),M(),n(35,"svg",21),C(36,"polyline",22),i()(),u(37,ce,2,1,"div",23),i()(),O(),n(38,"div",14)(39,"label",15),s(40,"Priority Level (Optional)"),i(),n(41,"div",19)(42,"button",20),_("click",function(){g(e);let o=c();return m(o.showPriorityDropdown=!o.showPriorityDropdown)}),s(43),M(),n(44,"svg",21),C(45,"polyline",22),i()(),u(46,ge,4,1,"div",23),i()()(),O(),n(47,"div",14)(48,"label",15),s(49,"Category (Optional)"),i(),n(50,"div",19)(51,"button",20),_("click",function(){g(e);let o=c();return m(o.showCategoryDropdown=!o.showCategoryDropdown)}),s(52),M(),n(53,"svg",21),C(54,"polyline",22),i()(),u(55,pe,4,1,"div",23),i()()(),O(),n(56,"div",12)(57,"h3",13),s(58,"Time Thresholds"),i(),n(59,"div",18)(60,"div",14)(61,"label",15),s(62,"Response Time (hours)"),i(),n(63,"input",24),w("ngModelChange",function(o){g(e);let d=c();return x(d.model.responseTimeHours,o)||(d.model.responseTimeHours=o),m(o)}),i()(),n(64,"div",14)(65,"label",15),s(66,"Containment Time (hours)"),i(),n(67,"input",25),w("ngModelChange",function(o){g(e);let d=c();return x(d.model.containmentTimeHours,o)||(d.model.containmentTimeHours=o),m(o)}),i()(),n(68,"div",14)(69,"label",15),s(70,"Completion Time (hours)"),i(),n(71,"input",26),w("ngModelChange",function(o){g(e);let d=c();return x(d.model.completionTimeHours,o)||(d.model.completionTimeHours=o),m(o)}),i()()()(),n(72,"div",27)(73,"button",28),_("click",function(){g(e);let o=c();return m(o.close())}),s(74,"Cancel"),i(),n(75,"button",29),u(76,_e,2,0,"span",30)(77,ue,2,1,"span",30),i()()()()()()}if(r&2){let e=c();l(5),f("",e.editMode?"Edit":"Create"," SLA Rule"),l(15),P("ngModel",e.model.name),l(4),P("ngModel",e.model.description),l(10),f(" ",e.getAppliesToLabel()," "),l(3),p("ngIf",e.showAppliesToDropdown),l(6),f(" ",e.getPriorityLabel()," "),l(3),p("ngIf",e.showPriorityDropdown),l(6),f(" ",e.getCategoryLabel()," "),l(3),p("ngIf",e.showCategoryDropdown),l(8),P("ngModel",e.model.responseTimeHours),l(4),P("ngModel",e.model.containmentTimeHours),l(4),P("ngModel",e.model.completionTimeHours),l(4),p("disabled",e.loading),l(),p("ngIf",e.loading),l(),p("ngIf",!e.loading)}}var R=class r{constructor(t,e,a){this.slaService=t;this.toast=e;this.metaWorkOrdersService=a}isOpen=!1;editMode=!1;definition=null;closed=new A;saved=new A;loading=!1;submitted=!1;model={name:"",description:"",appliesTo:"work_orders",priorityLevel:null,categoryId:null,responseTimeHours:4,containmentTimeHours:null,completionTimeHours:24,isActive:!0};showAppliesToDropdown=!1;showPriorityDropdown=!1;showCategoryDropdown=!1;categoryOptions=[];selectedCategoryId=null;appliesToOptions=[{value:"work_orders",label:"Work Orders"},{value:"maintenance",label:"Maintenance Tasks"},{value:"both",label:"Both"}];priorityOptions=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"},{value:"ppm",label:"PPM"}];ngOnInit(){this.loadCategories(),this.editMode&&this.definition&&this.loadDefinition()}loadCategories(){this.metaWorkOrdersService.getCategories().subscribe({next:t=>{this.categoryOptions=t},error:t=>{console.error("Error loading categories:",t),this.toast.error("Failed to load category options"),this.categoryOptions=[]}})}ngOnChanges(t){t.definition&&this.editMode&&this.definition&&this.loadDefinition()}loadDefinition(){this.definition&&(this.model={name:this.definition.name,description:this.definition.description||"",appliesTo:this.definition.appliesTo,priorityLevel:this.definition.priorityLevel||null,categoryId:this.definition.categoryId||null,responseTimeHours:this.definition.responseTimeHours,containmentTimeHours:this.definition.containmentTimeHours||null,completionTimeHours:this.definition.completionTimeHours,isActive:this.definition.isActive},this.selectedCategoryId=this.model.categoryId||null)}close(){this.isOpen=!1,this.submitted=!1,this.resetForm(),this.closed.emit()}resetForm(){this.model={name:"",description:"",appliesTo:"work_orders",priorityLevel:null,categoryId:null,responseTimeHours:4,containmentTimeHours:null,completionTimeHours:24,isActive:!0},this.selectedCategoryId=null,this.showAppliesToDropdown=!1,this.showPriorityDropdown=!1,this.showCategoryDropdown=!1}getAppliesToLabel(){return this.appliesToOptions.find(t=>t.value===this.model.appliesTo)?.label||"Select"}getPriorityLabel(){return this.model.priorityLevel?this.priorityOptions.find(t=>t.value===this.model.priorityLevel)?.label||"":"Select priority level"}selectAppliesTo(t){this.model.appliesTo=t,this.showAppliesToDropdown=!1}selectPriority(t){this.model.priorityLevel=t,this.showPriorityDropdown=!1}selectCategory(t){this.model.categoryId=t,this.selectedCategoryId=t,this.showCategoryDropdown=!1}getCategoryLabel(){if(!this.selectedCategoryId)return"No Category";let t=this.categoryOptions.find(e=>e.id===this.selectedCategoryId);return t?t.name:"No Category"}submit(){if(this.submitted=!0,!this.model.name||!this.model.appliesTo||!this.model.responseTimeHours||!this.model.completionTimeHours)return;this.loading=!0;let t={name:this.model.name,description:this.model.description||null,applies_to:this.model.appliesTo,priority_level:this.model.priorityLevel||null,category_id:this.model.categoryId||null,response_time_hours:this.model.responseTimeHours,containment_time_hours:this.model.containmentTimeHours||null,completion_time_hours:this.model.completionTimeHours,is_active:this.model.isActive!==!1};(this.editMode&&this.definition?.id?this.slaService.updateDefinition(this.definition.id,t):this.slaService.createDefinition(t)).subscribe({next:a=>{a.success&&(this.toast.success(`SLA rule ${this.editMode?"updated":"created"} successfully`),this.close(),this.saved.emit()),this.loading=!1},error:a=>{console.error("Failed to save SLA definition:",a),this.toast.error(a.error?.message||`Failed to ${this.editMode?"update":"create"} SLA rule`),this.loading=!1}})}static \u0275fac=function(e){return new(e||r)(v(y),v(I),v(te))};static \u0275cmp=S({type:r,selectors:[["app-sla-rule-form-dialog"]],inputs:{isOpen:"isOpen",editMode:"editMode",definition:"definition"},outputs:{closed:"closed",saved:"saved"},features:[z],decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"modal-subtitle"],["type","button",1,"close-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-section"],[1,"section-title"],[1,"form-group"],[1,"form-label"],["type","text","name","name","placeholder","e.g., Critical Equipment Response","required","",1,"form-input",3,"ngModelChange","ngModel"],["name","description","placeholder","Optional description of this SLA rule","rows","3",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"form-row"],[1,"dropdown-container"],["type","button",1,"dropdown-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["points","6 9 12 15 18 9"],["class","dropdown-menu",4,"ngIf"],["type","number","name","responseTimeHours","step","0.01","min","0.01","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","number","name","containmentTimeHours","step","0.01","min","0.01","placeholder","Optional",1,"form-input",3,"ngModelChange","ngModel"],["type","number","name","completionTimeHours","step","0.01","min","0.01","required","",1,"form-input",3,"ngModelChange","ngModel"],[1,"modal-actions"],["type","button",1,"btn-cancel",3,"click"],["type","submit",1,"btn-submit",3,"disabled"],[4,"ngIf"],[1,"dropdown-menu"],["type","button","class","dropdown-item",3,"click",4,"ngFor","ngForOf"],["type","button",1,"dropdown-item",3,"click"]],template:function(e,a){e&1&&u(0,fe,78,15,"div",0),e&2&&p("ngIf",a.isOpen)},dependencies:[E,k,D,V,Q,G,X,q,U,Z,Y,K,J],styles:['.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:.75rem;width:100%;max-width:600px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 25px -5px #0000001a}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:1.5rem;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0 0 .25rem;color:#1f2937}.modal-header[_ngcontent-%COMP%]   .modal-subtitle[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.25rem;color:#6b7280;display:flex;align-items:center;justify-content:center}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{color:#1f2937}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem}.form-section[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}.form-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin:0 0 1rem;color:#1f2937}.form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.5rem}.form-group[_ngcontent-%COMP%]   .form-hint[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin:.25rem 0 0}.form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]{width:100%;padding:.625rem .75rem;border:1px solid #d1d5db;border-radius:.5rem;font-size:.875rem;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]{resize:vertical}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.dropdown-container[_ngcontent-%COMP%]{position:relative}.dropdown-container[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]{width:100%;padding:.625rem .75rem;border:1px solid #d1d5db;border-radius:.5rem;background:#fff;font-size:.875rem;text-align:left;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:border-color .2s}.dropdown-container[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;margin-top:.25rem;background:#fff;border:1px solid #d1d5db;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;z-index:10;max-height:200px;overflow-y:auto}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{width:100%;padding:.625rem .75rem;background:none;border:none;text-align:left;cursor:pointer;font-size:.875rem;color:#374151;transition:background-color .2s}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:first-child{border-radius:.5rem .5rem 0 0}.dropdown-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:last-child{border-radius:0 0 .5rem .5rem}.toggle-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:44px;height:24px}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2563eb}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.working-days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem;margin-top:.5rem}.working-days-grid[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.875rem;color:#374151}.working-days-grid[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid #e5e7eb}.modal-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{padding:.625rem 1.25rem;background:#fff;border:1px solid #d1d5db;border-radius:.5rem;font-weight:500;color:#374151;cursor:pointer;transition:all .2s}.modal-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.modal-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{padding:.625rem 1.25rem;background-color:#2563eb;color:#fff;border:none;border-radius:.5rem;font-weight:500;cursor:pointer;transition:background-color .2s}.modal-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8}.modal-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}']})};function Ce(r,t){if(r&1&&(n(0,"p",42),s(1),i()),r&2){let e=c().$implicit;l(),T(e.description)}}function Me(r,t){if(r&1){let e=h();n(0,"div",43)(1,"button",44),_("click",function(){g(e);let o=c().$implicit,d=c(2);return d.openEditDialog(o),m(d.closeMenu(o.id))}),M(),n(2,"svg",5),C(3,"path",45)(4,"path",46),i(),s(5," Edit "),i(),O(),n(6,"button",47),_("click",function(){g(e);let o=c().$implicit,d=c(2);return d.deleteDefinition(o),m(d.closeMenu(o.id))}),M(),n(7,"svg",5),C(8,"polyline",48)(9,"path",49),i(),s(10," Delete "),i()()}}function Oe(r,t){if(r&1&&(n(0,"span",50),s(1),i()),r&2){let e=c().$implicit,a=c(2);j("critical",e.priorityLevel==="critical"),l(),f(" ",a.getPriorityLabel(e.priorityLevel).toUpperCase()," ")}}function he(r,t){if(r&1&&(n(0,"span",51),s(1),i()),r&2){let e=c().$implicit;l(),f(" ",e.category.name," ")}}function be(r,t){if(r&1&&(n(0,"div",38),M(),n(1,"svg",5),C(2,"circle",39)(3,"polyline",40),i(),O(),n(4,"span"),s(5),i()()),r&2){let e=c().$implicit;l(5),f("Containment: ",e.containmentTimeHours,"h")}}function ve(r,t){if(r&1){let e=h();n(0,"div",14)(1,"div",15)(2,"div",16)(3,"h3",17),s(4),i(),u(5,Ce,2,1,"p",18),i(),n(6,"div",19)(7,"div",20)(8,"span",21),s(9,"Active"),i(),n(10,"label",22)(11,"input",23),_("change",function(){let o=g(e).$implicit,d=c(2);return m(d.toggleActive(o))}),i(),C(12,"span",24),i()(),n(13,"div",25)(14,"button",26),_("click",function(){let o=g(e).$implicit,d=c(2);return m(d.toggleMenu(o.id))})("clickOutside",function(){let o=g(e).$implicit,d=c(2);return m(d.closeMenu(o.id))}),M(),n(15,"svg",27),C(16,"circle",28)(17,"circle",29)(18,"circle",30),i()(),u(19,Me,11,0,"div",31),i()()(),O(),n(20,"div",32)(21,"div",33)(22,"span",34),s(23),i(),u(24,Oe,2,3,"span",35)(25,he,2,1,"span",36),i(),n(26,"div",37)(27,"div",38),M(),n(28,"svg",5),C(29,"circle",39)(30,"polyline",40),i(),O(),n(31,"span"),s(32),i()(),u(33,be,6,1,"div",41),n(34,"div",38),M(),n(35,"svg",5),C(36,"circle",39)(37,"polyline",40),i(),O(),n(38,"span"),s(39),i()()()()()}if(r&2){let e=t.$implicit,a=c(2);l(4),T(e.name),l(),p("ngIf",e.description),l(6),p("checked",e.isActive),l(8),p("ngIf",a.menuOpen()[e.id]),l(4),T(a.getAppliesToLabel(e.appliesTo)),l(),p("ngIf",e.priorityLevel),l(),p("ngIf",e.category),l(7),f("Response: ",e.responseTimeHours,"h"),l(),p("ngIf",e.containmentTimeHours),l(6),f("Completion: ",e.completionTimeHours,"h")}}function Pe(r,t){r&1&&(n(0,"div",52)(1,"p"),s(2,"No SLA definitions found. Create your first SLA rule to get started."),i()())}function xe(r,t){if(r&1&&(n(0,"div",11),u(1,ve,40,10,"div",12)(2,Pe,3,0,"div",13),i()),r&2){let e=c();l(),p("ngForOf",e.definitions()),l(),p("ngIf",e.definitions().length===0)}}function we(r,t){r&1&&(n(0,"div",53)(1,"p"),s(2,"Loading SLA definitions..."),i()())}function ye(r,t){if(r&1){let e=h();n(0,"app-sla-rule-form-dialog",54),_("closed",function(){g(e);let o=c();return m(o.onDialogClosed())})("saved",function(){g(e);let o=c();return m(o.onSaved())}),i()}if(r&2){let e=c();p("isOpen",e.isDialogOpen())("editMode",e.editMode())("definition",e.definitionToEdit())}}var oe=class r{constructor(t,e){this.slaService=t;this.toast=e}definitions=b([]);loading=b(!1);isDialogOpen=b(!1);editMode=b(!1);definitionToEdit=b(null);menuOpen=b({});ngOnInit(){this.loadDefinitions()}loadDefinitions(){this.loading.set(!0),this.slaService.listDefinitions().subscribe({next:t=>{t.success&&this.definitions.set(t.data.definitions),this.loading.set(!1)},error:t=>{console.error("Failed to load SLA definitions:",t),this.toast.error("Failed to load SLA definitions"),this.loading.set(!1)}})}openCreateDialog(){this.editMode.set(!1),this.definitionToEdit.set(null),this.isDialogOpen.set(!0)}openEditDialog(t){this.editMode.set(!0),this.definitionToEdit.set(t),this.isDialogOpen.set(!0)}onDialogClosed(){this.isDialogOpen.set(!1),this.editMode.set(!1),this.definitionToEdit.set(null)}onSaved(){this.onDialogClosed(),this.loadDefinitions()}toggleMenu(t){this.menuOpen.update(e=>F(L({},e),{[t]:!e[t]}))}closeMenu(t){this.menuOpen.update(e=>F(L({},e),{[t]:!1}))}toggleActive(t){t.id&&this.slaService.toggleActive(t.id).subscribe({next:e=>{e.success&&(this.loadDefinitions(),this.toast.success(`SLA rule ${e.data.isActive?"activated":"deactivated"} successfully`))},error:e=>{console.error("Failed to toggle SLA definition:",e),this.toast.error("Failed to toggle SLA definition")}})}deleteDefinition(t){t.id&&confirm(`Are you sure you want to delete "${t.name}"?`)&&this.slaService.deleteDefinition(t.id).subscribe({next:e=>{e.success&&(this.loadDefinitions(),this.toast.success("SLA rule deleted successfully"),this.closeMenu(t.id))},error:e=>{console.error("Failed to delete SLA definition:",e),this.toast.error("Failed to delete SLA definition")}})}getAppliesToLabel(t){return{work_orders:"Work Orders",maintenance:"Maintenance",both:"Both"}[t]||t}getPriorityLabel(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}getCategoryName(t){return t.category?.name||"N/A"}static \u0275fac=function(e){return new(e||r)(v(y),v(I))};static \u0275cmp=S({type:r,selectors:[["app-sla-rules-page"]],decls:15,vars:3,consts:[[1,"sla-rules-page"],[1,"header-section"],[1,"section-title"],[1,"section-subtitle"],["type","button",1,"btn-create",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M5 12h14"],["d","M12 5v14"],["class","definitions-list",4,"ngIf"],["class","loading-state",4,"ngIf"],[3,"isOpen","editMode","definition","closed","saved",4,"ngIf"],[1,"definitions-list"],["class","sla-card",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"sla-card"],[1,"card-header"],[1,"card-title-section"],[1,"card-title"],["class","card-description",4,"ngIf"],[1,"card-actions"],[1,"active-toggle"],[1,"toggle-label"],[1,"toggle-switch"],["type","checkbox",3,"change","checked"],[1,"slider"],[1,"menu-container"],["type","button",1,"menu-button",3,"click","clickOutside"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","1"],["cx","12","cy","5","r","1"],["cx","12","cy","19","r","1"],["class","dropdown-menu",4,"ngIf"],[1,"card-body"],[1,"badges"],[1,"badge","applies-to"],["class","badge priority",3,"critical",4,"ngIf"],["class","badge category",4,"ngIf"],[1,"time-details"],[1,"time-item"],["cx","12","cy","12","r","10"],["points","12 6 12 12 16 14"],["class","time-item",4,"ngIf"],[1,"card-description"],[1,"dropdown-menu"],["type","button",1,"menu-item",3,"click"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["type","button",1,"menu-item","delete",3,"click"],["points","3 6 5 6 21 6"],["d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"],[1,"badge","priority"],[1,"badge","category"],[1,"empty-state"],[1,"loading-state"],[3,"closed","saved","isOpen","editMode","definition"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),s(4,"SLA Definitions"),i(),n(5,"p",3),s(6,"Configure SLA rules and thresholds."),i()(),n(7,"button",4),_("click",function(){return a.openCreateDialog()}),M(),n(8,"svg",5),C(9,"path",6)(10,"path",7),i(),s(11," Create SLA Rule "),i()(),u(12,xe,3,2,"div",8)(13,we,3,0,"div",9),i(),u(14,ye,1,3,"app-sla-rule-form-dialog",10)),e&2&&(l(12),p("ngIf",!a.loading()),l(),p("ngIf",a.loading()),l(),p("ngIf",a.isDialogOpen()))},dependencies:[E,k,D,V,R,ee],styles:['.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:2rem}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0 0 .25rem;color:#1f2937}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .section-subtitle[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .btn-create[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.625rem 1.25rem;background-color:#2563eb;color:#fff;border:none;border-radius:.5rem;font-weight:500;cursor:pointer;transition:background-color .2s}.sla-rules-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .btn-create[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.sla-rules-page[_ngcontent-%COMP%]   .definitions-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:1.5rem;box-shadow:0 1px 3px #0000001a}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-title-section[_ngcontent-%COMP%]{flex:1}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-title-section[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin:0 0 .25rem;color:#1f2937}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-title-section[_ngcontent-%COMP%]   .card-description[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:44px;height:24px}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2563eb}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .active-toggle[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]{position:relative}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.25rem;color:#6b7280;display:flex;align-items:center;justify-content:center}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]:hover{color:#1f2937}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;margin-top:.5rem;background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;z-index:10;min-width:150px}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;width:100%;padding:.625rem 1rem;background:none;border:none;text-align:left;cursor:pointer;font-size:.875rem;color:#374151;transition:background-color .2s}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item.delete[_ngcontent-%COMP%]{color:#dc2626}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item.delete[_ngcontent-%COMP%]:hover{background-color:#fee2e2}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:9999px;font-size:.75rem;font-weight:500}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge.applies-to[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#374151}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge.priority[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .badges[_ngcontent-%COMP%]   .badge.priority.critical[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .time-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .time-details[_ngcontent-%COMP%]   .time-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:#374151}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .time-details[_ngcontent-%COMP%]   .time-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#6b7280}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;font-size:.875rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]   .schedule-item[_ngcontent-%COMP%]{display:flex;gap:.5rem}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]   .schedule-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#6b7280}.sla-rules-page[_ngcontent-%COMP%]   .sla-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .schedule-details[_ngcontent-%COMP%]   .schedule-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#374151;font-weight:500}.sla-rules-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%], .sla-rules-page[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#6b7280}']})};export{oe as SlaRulesPageComponent};
