import{a as fd,b as ro,c as ud}from"./chunk-WBEGUE6J.js";import"./chunk-FK6H3RFT.js";import{a as Kn}from"./chunk-CGTUHVKC.js";import"./chunk-Y77GJ64Z.js";import"./chunk-GGQ7LRWG.js";import{c as Xn,d as Lt,f as ut,g as Rt}from"./chunk-C5P3YSZX.js";import{a as od,b as cn,c as ai,d as dn,e as er,f as Xs,g as Pn,h as tr,i as Ks,j as qs,k as Js,n as Qs,o as ld,p as cd,q as dd,r as Zs,s as eo,t as ta,u as to,v as no,w as fn,x as io}from"./chunk-QRZWFBQ3.js";import{$ as C,A as z,B,Ba as Zr,C as q,Ca as Ji,Da as kn,Ea as td,F as In,Fa as Qi,Ga as Zi,Ha as nd,Ka as id,N as kt,O as Qr,P as x,Ra as Ws,S as ft,Sa as js,T as Yt,Ta as Yn,U as Hs,Ua as Xt,Va as Gs,Wa as rd,X as J,Xa as ad,Ya as $s,Za as ln,_ as Us,aa as yt,ba as ge,c as Jr,ca as Ot,cb as sd,fa as d,fb as ea,ga as u,ha as D,hb as _i,i as Qc,ia as Il,ib as Ys,ja as Pl,ka as ue,la as Y,lb as Oi,ma as b,o as rt,oa as pi,pa as gi,qa as xi,ra as zs,sa as g,t as Bs,ta as oe,ua as xe,va as Ft,wa as ed,xa as at,y as Zc,ya as st,z as U,za as ot}from"./chunk-V246Y5EX.js";import{a as Kr,b as qr,e as Jc}from"./chunk-EQDQRRRY.js";function xp(t,n){if(t&1&&(d(0,"span"),g(1),u()),t&2){let e=b(2);x(),Ft("Archive ",e.selectedCount," Asset",e.selectedCount!==1?"s":"","")}}function _p(t,n){t&1&&(d(0,"span",28),B(),d(1,"svg",29),D(2,"circle",30)(3,"path",31),u(),q(),d(4,"span"),g(5,"Archiving..."),u()())}function vp(t,n){if(t&1){let e=ue();d(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),B(),d(5,"svg",6),D(6,"path",7),u()(),q(),d(7,"h2",8),g(8,"Archive Selected Assets"),u()(),d(9,"button",9),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),B(),d(10,"svg",10),D(11,"path",11),u()()(),q(),d(12,"div",12)(13,"div",13)(14,"label",14),g(15,"Archive Reason (Optional)"),u(),d(16,"textarea",15),ot("ngModelChange",function(r){U(e);let a=b();return st(a.archiveReason,r)||(a.archiveReason=r),z(r)}),u(),d(17,"p",16),g(18,"This will be recorded in the audit trail"),u()(),d(19,"div",17)(20,"div",18),B(),d(21,"svg",19),D(22,"path",7),u()()(),q(),d(23,"div",20)(24,"h3",21),g(25),u(),d(26,"p",22),g(27," This will change their status to inactive but keep all data intact. "),u()(),d(28,"div",23)(29,"button",24),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),g(30," Cancel "),u(),d(31,"button",25),Y("click",function(){U(e);let r=b();return z(r.onConfirm())}),J(32,xp,2,2,"span",26)(33,_p,6,0,"span",27),u()()()()()}if(t&2){let e=b();C("@backdropAnimation",void 0),x(),C("@modalAnimation",void 0),x(8),C("disabled",e.loading),x(7),at("ngModel",e.archiveReason),x(9),Ft("Are you sure you want to archive ",e.selectedCount," asset",e.selectedCount!==1?"s":"","?"),x(4),C("disabled",e.loading),x(2),C("disabled",e.loading),x(),C("ngIf",!e.loading),x(),C("ngIf",e.loading)}}var ao=class t{isOpen=!1;selectedCount=0;closeModal=new In;confirmArchive=new In;loading=!1;archiveReason="";onConfirm(){this.loading=!0,this.confirmArchive.emit(this.archiveReason),setTimeout(()=>{this.loading=!1,this.archiveReason=""},2e3)}onCancel(){this.loading||(this.archiveReason="",this.closeModal.emit())}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Yt({type:t,selectors:[["app-archive-confirmation-modal"]],inputs:{isOpen:"isOpen",selectedCount:"selectedCount"},outputs:{closeModal:"closeModal",confirmArchive:"confirmArchive"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-[#00000085] flex items-center justify-center z-50 p-4",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-md","w-full"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-orange-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 8h14M5 8a2 2 0 110-4h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293H19a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors","disabled:opacity-50",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"mb-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["rows","3","placeholder","Enter reason for archiving these assets...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:border-transparent","resize-none","placeholder-gray-400",3,"ngModelChange","ngModel"],[1,"text-xs","text-gray-500","mt-1"],[1,"flex","justify-center","mb-4"],[1,"w-16","h-16","bg-orange-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-orange-600"],[1,"text-center","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"flex","items-center","justify-end","space-x-3"],[1,"px-6","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"px-6","py-2","bg-orange-600","text-white","font-medium","rounded-lg","hover:bg-orange-700","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],[1,"flex","items-center","space-x-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){e&1&&J(0,vp,34,10,"div",0),e&2&&C("ngIf",i.isOpen)},dependencies:[ln,Xt,fn,cn,dn,Pn],styles:[".modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.warning-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.8}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{margin:1rem;max-height:calc(100vh - 2rem)}}"],data:{animation:[Xn("backdropAnimation",[Rt(":enter",[ut({opacity:0}),Lt("150ms ease-out",ut({opacity:1}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0}))])]),Xn("modalAnimation",[Rt(":enter",[ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}),Lt("200ms ease-out",ut({opacity:1,transform:"scale(1) translateY(0)"}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};function wp(t,n){if(t&1&&(d(0,"span"),g(1),u()),t&2){let e=b(2);x(),Ft("Delete ",e.selectedCount," Asset",e.selectedCount!==1?"s":"","")}}function bp(t,n){t&1&&(d(0,"span",30),B(),d(1,"svg",31),D(2,"circle",32)(3,"path",33),u(),q(),d(4,"span"),g(5,"Deleting..."),u()())}function yp(t,n){if(t&1){let e=ue();d(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),B(),d(5,"svg",6),D(6,"path",7),u()(),q(),d(7,"h2",8),g(8,"Delete Selected Assets"),u()(),d(9,"button",9),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),B(),d(10,"svg",10),D(11,"path",11),u()()(),q(),d(12,"div",12)(13,"div",13)(14,"label",14),g(15,"Deletion Reason (Optional)"),u(),d(16,"textarea",15),ot("ngModelChange",function(r){U(e);let a=b();return st(a.deletionReason,r)||(a.deletionReason=r),z(r)}),u(),d(17,"p",16),g(18,"This will be recorded in the audit trail"),u()(),d(19,"div",17)(20,"div",18),B(),d(21,"svg",19),D(22,"path",7),u()()(),q(),d(23,"div",20)(24,"h3",21),g(25),u(),d(26,"p",22),g(27," This action cannot be undone. The assets will be permanently removed from the system. "),u(),d(28,"div",23)(29,"p",24),g(30," \u26A0\uFE0F Warning: Only archived assets can be permanently deleted "),u()()(),d(31,"div",25)(32,"button",26),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),g(33," Cancel "),u(),d(34,"button",27),Y("click",function(){U(e);let r=b();return z(r.onConfirm())}),J(35,wp,2,2,"span",28)(36,bp,6,0,"span",29),u()()()()()}if(t&2){let e=b();C("@backdropAnimation",void 0),x(),C("@modalAnimation",void 0),x(8),C("disabled",e.loading),x(7),at("ngModel",e.deletionReason),x(9),Ft("Are you sure you want to permanently delete ",e.selectedCount," asset",e.selectedCount!==1?"s":"","?"),x(7),C("disabled",e.loading),x(2),C("disabled",e.loading),x(),C("ngIf",!e.loading),x(),C("ngIf",e.loading)}}var so=class t{isOpen=!1;selectedCount=0;closeModal=new In;confirmDelete=new In;loading=!1;deletionReason="";onConfirm(){this.loading=!0,this.confirmDelete.emit(this.deletionReason),setTimeout(()=>{this.loading=!1,this.deletionReason=""},2e3)}onCancel(){this.loading||(this.deletionReason="",this.closeModal.emit())}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Yt({type:t,selectors:[["app-delete-confirmation-modal"]],inputs:{isOpen:"isOpen",selectedCount:"selectedCount"},outputs:{closeModal:"closeModal",confirmDelete:"confirmDelete"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-[#00000085] flex items-center justify-center z-50 p-4",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-md","w-full"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-red-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors","disabled:opacity-50",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"mb-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["rows","3","placeholder","Enter reason for permanently deleting these assets...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:border-transparent","resize-none","placeholder-gray-400",3,"ngModelChange","ngModel"],[1,"text-xs","text-gray-500","mt-1"],[1,"flex","justify-center","mb-4"],[1,"w-16","h-16","bg-red-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],[1,"text-center","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"mt-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-800","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-3"],[1,"px-6","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"px-6","py-2","bg-red-600","text-white","font-medium","rounded-lg","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-red-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],[1,"flex","items-center","space-x-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){e&1&&J(0,yp,37,10,"div",0),e&2&&C("ngIf",i.isOpen)},dependencies:[ln,Xt,fn,cn,dn,Pn],styles:[".modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.warning-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.8}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{margin:1rem;max-height:calc(100vh - 2rem)}}"],data:{animation:[Xn("backdropAnimation",[Rt(":enter",[ut({opacity:0}),Lt("150ms ease-out",ut({opacity:1}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0}))])]),Xn("modalAnimation",[Rt(":enter",[ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}),Lt("200ms ease-out",ut({opacity:1,transform:"scale(1) translateY(0)"}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};function Sp(t,n){if(t&1&&(d(0,"span"),g(1),u()),t&2){let e=b(2);x(),Ft(" Restore ",e.selectedCount," Asset",e.selectedCount!==1?"s":""," ")}}function Cp(t,n){t&1&&(d(0,"span",24),B(),d(1,"svg",33),D(2,"circle",34)(3,"path",35),u(),q(),d(4,"span"),g(5,"Restoring..."),u()())}function kp(t,n){if(t&1){let e=ue();d(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),B(),d(5,"svg",6),D(6,"path",7),u()(),q(),d(7,"h2",8),g(8),u()(),d(9,"button",9),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),B(),d(10,"svg",10),D(11,"path",11),u()()(),q(),d(12,"div",12)(13,"div",13)(14,"div",14),B(),d(15,"svg",15),D(16,"path",7),u()()(),q(),d(17,"div",16)(18,"h3",17),g(19),u(),d(20,"p",18),g(21),u()(),d(22,"div",19)(23,"label",20),g(24,"Restore Reason (Optional)"),u(),d(25,"textarea",21),ot("ngModelChange",function(r){U(e);let a=b();return st(a.restoreReason,r)||(a.restoreReason=r),z(r)}),u(),d(26,"p",22),g(27,"This will be recorded in the audit trail"),u()(),d(28,"div",23)(29,"div",24),B(),d(30,"svg",25),D(31,"path",26),u(),q(),d(32,"p",27),g(33," Assets will be restored to active status "),u()()(),d(34,"div",28)(35,"button",29),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),g(36," Cancel "),u(),d(37,"button",30),Y("click",function(){U(e);let r=b();return z(r.onConfirm())}),J(38,Sp,2,2,"span",31)(39,Cp,6,0,"span",32),u()()()()()}if(t&2){let e=b();C("@backdropAnimation",void 0),x(),C("@modalAnimation",void 0),x(7),xe(" ",e.selectedCount>1?"Restore Selected Assets":"Restore Asset"," "),x(),C("disabled",e.loading),x(10),xe(" Are you sure you want to restore ",e.selectedCount>1?e.selectedCount+" assets":e.assetName||"1 asset","? "),x(2),xe(" ",e.selectedCount>1?"These assets will be moved back to active status and become available in searches.":"This asset will be moved back to active status and become available in searches."," "),x(4),at("ngModel",e.restoreReason),C("placeholder","Enter reason for restoring "+(e.selectedCount>1?"these assets":"this asset")+"..."),x(10),C("disabled",e.loading),x(2),C("disabled",e.loading),x(),C("ngIf",!e.loading),x(),C("ngIf",e.loading)}}var oo=class t{isOpen=!1;selectedCount=0;assetName="";closeModal=new In;confirmRestore=new In;loading=!1;restoreReason="";onConfirm(){this.loading=!0,this.confirmRestore.emit(this.restoreReason),setTimeout(()=>{this.loading=!1,this.restoreReason=""},2e3)}onCancel(){this.loading||(this.restoreReason="",this.closeModal.emit())}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=Yt({type:t,selectors:[["app-restore-confirmation-modal"]],inputs:{isOpen:"isOpen",selectedCount:"selectedCount",assetName:"assetName"},outputs:{closeModal:"closeModal",confirmRestore:"confirmRestore"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-[#00000085] flex items-center justify-center z-50 p-4",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-md","w-full"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors","disabled:opacity-50",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"flex","justify-center","mb-6"],[1,"w-16","h-16","bg-green-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-green-600"],[1,"text-center","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-3"],[1,"text-gray-600","mb-4"],[1,"mb-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["rows","3",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:border-transparent","resize-none","placeholder-gray-400",3,"ngModelChange","ngModel","placeholder"],[1,"text-xs","text-gray-500","mt-1"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-3","mb-6"],[1,"flex","items-center","space-x-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-green-800","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-3"],[1,"px-6","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"px-6","py-2","bg-green-600","text-white","font-medium","rounded-lg","hover:bg-green-700","focus:outline-none","focus:ring-2","focus:ring-green-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){e&1&&J(0,kp,40,12,"div",0),e&2&&C("ngIf",i.isOpen)},dependencies:[ln,Xt,fn,cn,dn,Pn],styles:[".modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.success-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.8}}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{margin:1rem;max-height:calc(100vh - 2rem)}}"],data:{animation:[Xn("backdropAnimation",[Rt(":enter",[ut({opacity:0}),Lt("150ms ease-out",ut({opacity:1}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0}))])]),Xn("modalAnimation",[Rt(":enter",[ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}),Lt("200ms ease-out",ut({opacity:1,transform:"scale(1) translateY(0)"}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};var hd=Jc(fd());var md=t=>({"bg-blue-100":t}),Tp=t=>({"bg-blue-100 font-semibold":t}),Ap=t=>["/assets/preview",t];function Mp(t,n){t&1&&(B(),D(0,"path",104))}function Dp(t,n){t&1&&(B(),D(0,"path",105))}function Fp(t,n){t&1&&(B(),d(0,"svg",86),D(1,"path",91),u())}function Ip(t,n){t&1&&(B(),d(0,"svg",106),D(1,"circle",107)(2,"path",108),u())}function Pp(t,n){if(t&1){let e=ue();d(0,"div",84)(1,"button",85),B(),d(2,"svg",86),D(3,"path",87),u(),q(),d(4,"span"),g(5,"Analytics"),u()(),d(6,"button",88),Y("click",function(){U(e);let r=b();return z(r.toggleArchivedView())}),B(),d(7,"svg",86),J(8,Mp,1,0,"path",89)(9,Dp,1,0,"path",90),u(),q(),d(10,"span"),g(11),u()(),d(12,"button",88),Y("click",function(){U(e);let r=b();return z(r.exportToPdf())}),B(),d(13,"svg",86),D(14,"path",91),u(),q(),d(15,"span"),g(16,"Export Assets to PDF"),u()(),d(17,"button",92),Y("click",function(){U(e);let r=b();return z(r.exportToExcel())}),J(18,Fp,2,0,"svg",93)(19,Ip,3,0,"svg",94),d(20,"span"),g(21),u()(),d(22,"button",95),B(),d(23,"svg",86),D(24,"path",96),u(),q(),d(25,"span"),g(26,"Smart Import"),u()(),D(27,"div",97),d(28,"button",98),B(),d(29,"svg",99),D(30,"path",100),u(),q(),d(31,"span"),g(32,"Archive Selected"),u()(),d(33,"button",101),B(),d(34,"svg",102),D(35,"path",103),u(),q(),d(36,"span"),g(37,"Delete Selected"),u()()()}if(t&2){let e=b();x(8),C("ngIf",!e.showingArchived),x(),C("ngIf",e.showingArchived),x(2),oe(e.showingArchived?"View Active Assets":"View Archived Assets"),x(6),C("disabled",e.exportingExcel),x(),C("ngIf",!e.exportingExcel),x(),C("ngIf",e.exportingExcel),x(2),oe(e.exportingExcel?"Exporting to Excel...":"Export Assets to Excel")}}function Op(t,n){t&1&&(d(0,"span",109),g(1,"Select asset type"),u())}function Lp(t,n){if(t&1&&(Il(0),D(1,"img",111),Pl()),t&2){let e=b(2);x(),C("src",e.selectedAssetType.icon,kt)}}function Rp(t,n){if(t&1&&(d(0,"div",110),J(1,Lp,2,1,"ng-container",60),d(2,"span"),g(3),u()()),t&2){let e=b();x(),C("ngIf",e.selectedAssetType.icon),x(2),oe(e.selectedAssetType.label)}}function Vp(t,n){if(t&1&&(Il(0),D(1,"img",116),Pl()),t&2){let e=b().$implicit;x(),C("src",e.icon,kt)}}function Np(t,n){if(t&1){let e=ue();d(0,"div",115),Y("click",function(){let r=U(e).$implicit,a=b(2);return a.selectAssetType(r),z(a.showAssetTypeDropdown=!1)}),J(1,Vp,2,1,"ng-container",60),d(2,"span"),g(3),u()()}if(t&2){let e=n.$implicit,i=b(2);C("ngClass",Ji(3,md,(i.selectedAssetType==null?null:i.selectedAssetType.id)===e.id)),x(),C("ngIf",e.icon),x(2),oe(e.label)}}function Bp(t,n){if(t&1&&(d(0,"div",112)(1,"div",113),g(2,"Select Asset Type"),u(),J(3,Np,4,5,"div",114),u()),t&2){let e=b();x(3),C("ngForOf",e.assetTypes)}}function Hp(t,n){t&1&&(d(0,"span",109),g(1,"Select asset status"),u())}function Up(t,n){if(t&1&&D(0,"span",118),t&2){let e=b(2);yt("background",e.selectedAssetStatus.color)}}function zp(t,n){if(t&1&&(d(0,"div",110),J(1,Up,1,2,"span",117),d(2,"span"),g(3),u()()),t&2){let e=b();x(),C("ngIf",e.selectedAssetStatus.color),x(2),oe(e.selectedAssetStatus.label)}}function Wp(t,n){if(t&1&&D(0,"span",118),t&2){let e=b().$implicit;yt("background",e.color)}}function jp(t,n){if(t&1){let e=ue();d(0,"div",115),Y("click",function(){let r=U(e).$implicit,a=b(2);return a.selectAssetStatus(r),z(a.showAssetStatusDropdown=!1)}),J(1,Wp,1,2,"span",117),d(2,"span"),g(3),u()()}if(t&2){let e=n.$implicit,i=b(2);C("ngClass",Ji(3,md,(i.selectedAssetStatus==null?null:i.selectedAssetStatus.id)===e.id)),x(),C("ngIf",e.color),x(2),oe(e.label)}}function Gp(t,n){if(t&1&&(d(0,"div",112)(1,"div",113),g(2,"Select Asset Status"),u(),J(3,jp,4,5,"div",114),u()),t&2){let e=b();x(3),C("ngForOf",e.assetStatuses)}}function $p(t,n){t&1&&(d(0,"span",109),g(1,"Sort By"),u())}function Yp(t,n){if(t&1&&(d(0,"span"),g(1),u()),t&2){let e=b();x(),oe(e.selectedSort.label)}}function Xp(t,n){if(t&1){let e=ue();d(0,"div",121),Y("click",function(){let r=U(e).$implicit,a=b(2);return a.selectSort(r),z(a.showSortDropdown=!1)}),g(1),u()}if(t&2){let e=n.$implicit,i=b(2);C("ngClass",Ji(2,Tp,(i.selectedSort==null?null:i.selectedSort.value)===e.value)),x(),xe(" ",e.label," ")}}function Kp(t,n){if(t&1&&(d(0,"div",119)(1,"div",113),g(2,"Sort By"),u(),J(3,Xp,2,4,"div",120),u()),t&2){let e=b();x(3),C("ngForOf",e.sortOptions)}}function qp(t,n){t&1&&(B(),d(0,"svg",122),D(1,"path",123),u())}function Jp(t,n){t&1&&(B(),d(0,"svg",122),D(1,"path",124),u())}function Qp(t,n){t&1&&(d(0,"div",125)(1,"div",126)(2,"div",127),B(),d(3,"svg",128),D(4,"circle",107)(5,"path",108),u()(),q(),d(6,"h3",129),g(7,"Loading Assets"),u(),d(8,"p",130),g(9,"Please wait while we fetch your assets..."),u()()())}function Zp(t,n){if(t&1){let e=ue();d(0,"div",125)(1,"div",126)(2,"div",131),B(),d(3,"svg",132),D(4,"path",133),u()(),q(),d(5,"h3",129),g(6,"Error Loading Assets"),u(),d(7,"p",134),g(8),u(),d(9,"button",135),Y("click",function(){U(e);let r=b();return z(r.loadAssets())}),g(10," Retry "),u()()()}if(t&2){let e=b();x(8),oe(e.error)}}function e1(t,n){if(t&1){let e=ue();d(0,"div",136)(1,"button",137),Y("click",function(){U(e);let r=b();return z(r.toggleSelectAllAssets())}),D(2,"span",138),u(),d(3,"span",139),g(4),u()()}if(t&2){let e=b();x(4),xe("Select all ",e.assetList.length," assets")}}function t1(t,n){if(t&1){let e=ue();d(0,"button",155),Y("click",function(){U(e);let r=b(2);return z(r.duplicateSelected())}),B(),d(1,"svg",145),D(2,"rect",156)(3,"rect",157),u(),g(4," Duplicate"),u()}if(t&2){let e=b(2);C("disabled",e.selectedCount===0)}}function n1(t,n){if(t&1){let e=ue();d(0,"button",158),Y("click",function(){U(e);let r=b(2);return z(r.showArchiveModal())}),B(),d(1,"svg",145),D(2,"rect",159)(3,"path",160),u(),g(4," Archive "),u()}if(t&2){let e=b(2);C("disabled",e.selectedCount===0)}}function i1(t,n){if(t&1){let e=ue();d(0,"button",161),Y("click",function(){U(e);let r=b(2);return z(r.showDeleteModal())}),B(),d(1,"svg",145),D(2,"rect",159)(3,"path",162),u(),g(4," Delete "),u()}if(t&2){let e=b(2);C("disabled",e.selectedCount===0)}}function r1(t,n){if(t&1){let e=ue();d(0,"button",163),Y("click",function(){U(e);let r=b(2);return z(r.restoreSelected())}),B(),d(1,"svg",145),D(2,"path",164),u(),g(3," Restore "),u()}if(t&2){let e=b(2);C("disabled",e.selectedCount===0)}}function a1(t,n){if(t&1){let e=ue();d(0,"div",140)(1,"div",141)(2,"button",137),Y("click",function(){U(e);let r=b();return z(r.toggleSelectAllAssets())}),D(3,"span",142),u(),d(4,"span",143),g(5),u(),d(6,"span",144),B(),d(7,"svg",145),D(8,"path",146),u(),g(9," Selection Mode Active - Click cards to select "),u()(),q(),d(10,"div",110),J(11,t1,5,1,"button",147),d(12,"button",148),Y("click",function(){U(e);let r=b();return z(r.generateQRCodeForSelectedAssets())}),B(),d(13,"svg",145),D(14,"path",149),u(),g(15," Generate QR Codes "),u(),J(16,n1,5,1,"button",150)(17,i1,5,1,"button",151)(18,r1,4,1,"button",152),q(),d(19,"button",153),Y("click",function(){U(e);let r=b();return z(r.clearSelection())}),d(20,"span",154),g(21,"\xD7"),u(),g(22," Clear"),u()()()}if(t&2){let e=b();x(2),ge("bg-blue-100",e.selectedCount===e.assetList.length),x(),ge("bg-blue-400",e.selectedCount===e.assetList.length)("bg-white",e.selectedCount!==e.assetList.length),x(2),Ft("",e.selectedCount," asset",e.selectedCount>1?"s":""," selected"),x(6),C("ngIf",!e.showingArchived),x(),C("disabled",e.selectedCount===0),x(4),C("ngIf",!e.showingArchived),x(),C("ngIf",e.showingArchived),x(),C("ngIf",e.showingArchived)}}function s1(t,n){if(t&1){let e=ue();d(0,"div",165)(1,"div",166),B(),d(2,"svg",167),D(3,"path",21),u()(),q(),d(4,"h3",129),g(5,"No Assets Found"),u(),d(6,"p",168),g(7,"Get started by creating your first asset."),u(),d(8,"button",135),Y("click",function(){U(e);let r=b();return z(r.goToCreateAsset())}),g(9," Add Asset "),u()()}}function o1(t,n){t&1&&(d(0,"span",200),g(1,"Active"),u())}function l1(t,n){if(t&1&&(d(0,"span"),g(1),u()),t&2){let e=b().$implicit,i=b(2);Ot("bg-"+i.getStatusColor((e.asset_status==null?null:e.asset_status.name)||e.status||"Active")+"-100 text-"+i.getStatusColor((e.asset_status==null?null:e.asset_status.name)||e.status||"Active")+"-700 text-xs font-semibold px-3 py-1 rounded-full"),x(),oe((e.asset_status==null?null:e.asset_status.name)||e.status)}}function c1(t,n){if(t&1){let e=ue();d(0,"button",214),Y("click",function(){U(e);let r=b(2).$implicit,a=b(2);return z(a.viewAsset(r))}),B(),d(1,"svg",215),D(2,"path",216)(3,"path",217),u(),q(),d(4,"span",218),g(5,"View Details"),u()()}}function d1(t,n){if(t&1){let e=ue();d(0,"button",214),Y("click",function(){U(e);let r=b(2).$implicit,a=b(2);return z(a.editAsset(r))}),B(),d(1,"svg",215),D(2,"path",219),u(),q(),d(3,"span",218),g(4,"Edit Asset"),u()()}}function f1(t,n){if(t&1){let e=ue();d(0,"button",214),Y("click",function(){U(e);let r=b(2).$implicit,a=b(2);return z(a.duplicateAsset(r))}),B(),d(1,"svg",215),D(2,"path",208),u(),q(),d(3,"span",218),g(4,"Duplicate"),u()()}}function u1(t,n){if(t&1){let e=ue();d(0,"button",220),Y("click",function(){U(e);let r=b(2).$implicit,a=b(2);return z(a.archiveAsset(r))}),B(),d(1,"svg",221),D(2,"path",104),u(),q(),d(3,"span",222),g(4,"Archive"),u()()}}function h1(t,n){if(t&1){let e=ue();d(0,"button",223),Y("click",function(){U(e);let r=b(2).$implicit,a=b(2);return z(a.restoreAsset(r))}),B(),d(1,"svg",224),D(2,"path",164),u(),q(),d(3,"span",225),g(4,"Restore"),u()()}}function m1(t,n){if(t&1){let e=ue();d(0,"button",226),Y("click",function(){U(e);let r=b(2).$implicit,a=b(2);return z(a.deleteAsset(r))}),B(),d(1,"svg",227),D(2,"path",228),u(),q(),d(3,"span",229),g(4,"Delete Permanently"),u()()}}function p1(t,n){if(t&1){let e=ue();d(0,"div",201),J(1,c1,6,0,"button",202)(2,d1,5,0,"button",202)(3,f1,5,0,"button",202),d(4,"button",203),Y("click",function(){U(e);let r=b().$implicit,a=b(2);return z(a.generateQRCodeForAsset(r))}),B(),d(5,"svg",204),D(6,"path",149),u(),q(),d(7,"span",205),g(8,"Generate QR Code"),u()(),d(9,"button",206),Y("click",function(){U(e);let r=b().$implicit,a=b(2);return z(a.copyPublicUrl(r))}),B(),d(10,"svg",207),D(11,"path",208),u(),q(),d(12,"span",209),g(13,"Copy Public URL"),u()(),D(14,"div",210),J(15,u1,5,0,"button",211)(16,h1,5,0,"button",212)(17,m1,5,0,"button",213),u()}if(t&2){let e=b(3);x(),C("ngIf",!e.showingArchived),x(),C("ngIf",!e.showingArchived),x(),C("ngIf",!e.showingArchived),x(12),C("ngIf",!e.showingArchived),x(),C("ngIf",e.showingArchived),x(),C("ngIf",e.showingArchived)}}function g1(t,n){if(t&1&&(d(0,"div",230)(1,"a",231),g(2),u()()),t&2){let e=b().$implicit;x(),C("routerLink",Ji(3,Ap,e.parent.id)),x(),Ft(" Parent: ",e.parent.name," (",e.parent.asset_id,") ")}}function x1(t,n){if(t&1&&(d(0,"b"),g(1),kn(2,"number"),u()),t&2){let e=b().$implicit;x(),xe("$",Qi(2,1,e.purchase_price,"1.0-0"),"")}}function _1(t,n){t&1&&(d(0,"b"),g(1,"N/A"),u())}function v1(t,n){if(t&1&&(d(0,"div",192),B(),d(1,"svg",145),D(2,"path",232),u(),q(),d(3,"span"),g(4,"Purchase Date "),d(5,"b"),g(6),kn(7,"date"),u()()()),t&2){let e=b().$implicit;x(6),oe(Qi(7,1,e.purchase_date,"MMM d, y"))}}function w1(t,n){if(t&1){let e=ue();d(0,"div",171)(1,"div",172)(2,"div",173)(3,"input",174),ot("ngModelChange",function(r){let a=U(e).$implicit;return st(a.selected,r)||(a.selected=r),z(r)}),u()(),d(4,"div",175),J(5,o1,2,0,"span",176)(6,l1,2,3,"span",177),d(7,"div",8),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(8,"button",178),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.toggleAssetMenu(r.id))}),B(),d(9,"svg",179),D(10,"circle",180)(11,"circle",181)(12,"circle",182),u()(),J(13,p1,18,6,"div",183),u()(),d(14,"svg",184),D(15,"path",21),u()(),q(),d(16,"div",185)(17,"div"),J(18,g1,3,5,"div",186),d(19,"div",187),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(!a.showingArchived&&a.viewAsset(r))}),g(20),u(),d(21,"div",188),g(22),u(),d(23,"div",189),B(),d(24,"svg",145),D(25,"path",190),u(),q(),d(26,"span"),g(27),u()(),D(28,"hr",191),d(29,"div",192),B(),d(30,"svg",145),D(31,"path",43),u(),q(),d(32,"span"),g(33,"Value "),J(34,x1,3,4,"b",60)(35,_1,2,0,"b",60),u()(),J(36,v1,8,4,"div",193),u(),d(37,"div",194)(38,"div",195)(39,"span",196),g(40,"Health Score"),u(),d(41,"span",197),g(42),u()(),d(43,"div",198),D(44,"div",199),u()()()()}if(t&2){let e=n.$implicit,i=b(2);ge("border-blue-400",e.selected),x(3),at("ngModel",e.selected),x(2),C("ngIf",(e.asset_status==null?null:e.asset_status.name)==="Active"),x(),C("ngIf",(e.asset_status==null?null:e.asset_status.name)!=="Active"),x(7),C("ngIf",e.showMenu),x(5),C("ngIf",e.parent),x(),ge("cursor-pointer",!i.showingArchived)("hover:text-blue-600",!i.showingArchived)("cursor-default",i.showingArchived),x(),xe(" ",e.name||"Unnamed Asset"," "),x(2),Ft("",e.asset_id||e.id," \u2022 ",e.type||"General",""),x(5),oe((e.location==null?null:e.location.name)||"No location"),x(7),C("ngIf",e.purchase_price!==null),x(),C("ngIf",e.purchase_price===null),x(),C("ngIf",e.purchase_date),x(6),xe("",e.health_score||100,"%"),x(2),yt("width",e.health_score||100,"%"),C("ngClass",(e.health_score||100)<50?"bg-red-500":"bg-green-500")}}function b1(t,n){if(t&1&&(d(0,"div",169),J(1,w1,45,24,"div",170),u()),t&2){let e=b();x(),C("ngForOf",e.assetList)}}function y1(t,n){if(t&1){let e=ue();d(0,"div",243)(1,"div",244)(2,"div",240)(3,"input",245),ot("ngModelChange",function(r){let a=U(e).$implicit;return st(a.selected,r)||(a.selected=r),z(r)}),u()(),d(4,"div",238)(5,"div",246)(6,"div",247),B(),d(7,"svg",248),D(8,"path",21),u()(),q(),d(9,"div")(10,"div",249),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.viewAsset(r))}),g(11),u(),d(12,"div",130),g(13),u()()()(),d(14,"div",239)(15,"div",250),g(16),u(),d(17,"div",130),g(18),u()(),d(19,"div",239)(20,"div",251),B(),d(21,"svg",252),D(22,"path",253)(23,"path",254),u(),q(),d(24,"span",255),g(25),u()()(),d(26,"div",240)(27,"span"),g(28),u()(),d(29,"div",239)(30,"div",250),g(31),kn(32,"currency"),u(),d(33,"div",130),g(34),u()(),d(35,"div",240)(36,"div",110)(37,"button",256),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.viewAsset(r))}),B(),d(38,"svg",122),D(39,"path",216)(40,"path",217),u()(),q(),d(41,"button",257),B(),d(42,"svg",122),D(43,"path",219),u()(),q(),d(44,"button",258),B(),d(45,"svg",122),D(46,"path",228),u()()()()()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",e.selected),x(3),at("ngModel",e.selected),x(8),xe(" ",e.name||"Unnamed Asset"," "),x(2),oe(e.asset_id||"AST-"+e.id),x(3),oe(e.type||"Standard Asset"),x(2),oe((e.category==null?null:e.category.name)||"General"),x(7),oe((e.location==null?null:e.location.name)||"No location"),x(2),Ot("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-"+i.getStatusColor((e.asset_status==null?null:e.asset_status.name)||e.status||"Active")+"-100 text-"+i.getStatusColor((e.asset_status==null?null:e.asset_status.name)||e.status||"Active")+"-800"),x(),xe(" ",(e.asset_status==null?null:e.asset_status.name)||e.status||"Active"," "),x(3),xe(" ",e.purchase_price?Zi(32,13,e.purchase_price,"USD","symbol","1.0-0"):"N/A"," "),x(3),xe(" Health: ",e.health_score||100,"% ")}}function S1(t,n){if(t&1){let e=ue();d(0,"div",233)(1,"div",234)(2,"div",235)(3,"div",236)(4,"input",237),Y("change",function(){U(e);let r=b();return z(r.toggleSelectAllAssets())}),u()(),d(5,"div",238),g(6,"Asset"),u(),d(7,"div",239),g(8,"Type & Category"),u(),d(9,"div",239),g(10,"Location"),u(),d(11,"div",240),g(12,"Status"),u(),d(13,"div",239),g(14,"Financial"),u(),d(15,"div",240),g(16,"Actions"),u()()(),d(17,"div",241),J(18,y1,47,18,"div",242),u()()}if(t&2){let e=b();x(4),C("checked",e.selectedCount===e.assetList.length&&e.assetList.length>0)("indeterminate",e.selectedCount>0&&e.selectedCount<e.assetList.length),x(14),C("ngForOf",e.assetList)}}var ia=class t{constructor(n,e,i){this.router=n;this.assetService=e;this.pdfExportService=i}destroy$=new Jr;summary={totalAssets:0,activeAssets:0,maintenance:0,totalValue:0,assetHealth:0};loading=!1;exportingExcel=!1;error="";showMenu=!1;showTypeDropdown=!1;showStatusDropdown=!1;showSortDropdown=!1;showSortDirDropdown=!1;showArchiveConfirmationModal=!1;showDeleteConfirmationModal=!1;showRestoreConfirmationModal=!1;selectedAssetForRestore=null;showingArchived=!1;typeOptions=[{value:"",label:"All Types"},{value:"fixed",label:"Fixed Asset"},{value:"semi-fixed",label:"Semi-Fixed Asset"},{value:"mobile",label:"Mobile Asset"},{value:"fleet",label:"Fleet Asset"}];statusOptions=[{value:"",label:"All Status"},{value:"Active",label:"Active"},{value:"Maintenance",label:"Maintenance"},{value:"Inactive",label:"Inactive"},{value:"Retired",label:"Retired"}];sortOptions=[{value:"name",label:"Name"},{value:"created_at",label:"Date Added"},{value:"status",label:"Status"},{value:"manufacturer",label:"Manufacturer"},{value:"purchase_price",label:"Cost"}];selectedType=this.typeOptions[0];selectedStatus=this.statusOptions[0];selectedSort=this.sortOptions[0];selectedSortDir="desc";viewType="grid";searchQuery="";currentFilters={search:"",type:"",status:"",category_id:"",location_id:"",sort_by:"name",sort_direction:"desc",page:1,per_page:20,archived:!1};assetList=[];categories=[];locations=[];assetTypes=[];showAssetTypeDropdown=!1;selectedAssetType=null;assetStatuses=[];showAssetStatusDropdown=!1;selectedAssetStatus=null;openAssetMenuId=null;pagination={current_page:1,last_page:1,per_page:20,total:0,from:0,to:0};selectAllAssets=!1;ngOnInit(){this.loadAssetStatistics(),this.loadAssets(),this.loadCategories(),this.loadLocations(),this.assetService.getAssetTypes().subscribe(n=>{n.success&&n.data&&(this.assetTypes=[{id:"",name:"All Types",label:"All Types",icon:null},...n.data.map(e=>({id:e.id,name:e.name,label:e.name,icon:e.icon||null}))],this.selectedAssetType=this.assetTypes[0])}),this.assetService.getAssetStatuses().subscribe(n=>{n.success&&n.data&&(this.assetStatuses=[{id:"",name:"All Statuses",label:"All Statuses",color:null},...n.data.map(e=>({id:e.id,name:e.name,label:e.name,color:e.color||null}))],this.selectedAssetStatus=this.assetStatuses[0])})}loadAssetStatistics(){this.assetService.getAssetStatistics().pipe(rt(this.destroy$)).subscribe({next:n=>{if(n.success&&n.data){let e=n.data;this.summary={totalAssets:e.total_assets||0,activeAssets:e.active_assets||0,maintenance:e.maintenance||0,totalValue:e.total_asset_value||0,assetHealth:e.total_asset_health&&e.total_assets?Math.round(e.total_asset_health/e.total_assets):100}}},error:n=>{console.error("Error loading asset statistics:",n)}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAssets(){this.loading=!0,this.error="";let n={};this.currentFilters.search&&(n.search=this.currentFilters.search),this.currentFilters.type&&(n.type=this.currentFilters.type),this.currentFilters.status&&(n.status=this.currentFilters.status),this.currentFilters.category_id&&(n.category_id=this.currentFilters.category_id),this.currentFilters.location_id&&(n.location_id=this.currentFilters.location_id),this.currentFilters.sort_by&&(n.sort_by=this.currentFilters.sort_by),this.currentFilters.sort_direction&&(n.sort_direction=this.currentFilters.sort_direction),n.archived=this.currentFilters.archived,n.page=this.currentFilters.page,n.per_page=this.currentFilters.per_page,this.assetService.getAssets(n).pipe(rt(this.destroy$)).subscribe({next:e=>{e.success?(this.assetList=(e.data.assets||e.data).map(i=>qr(Kr({},i),{selected:!1,showMenu:!1})),e.data.pagination&&(this.pagination=e.data.pagination)):this.error=e.message||"Failed to load assets",this.loading=!1},error:e=>{this.error=e.error?.message||"An error occurred while loading assets",this.loading=!1}})}loadCategories(){this.assetService.getAssetCategories().pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&(this.categories=n.data.categories)},error:n=>{console.error("Error loading categories:",n)}})}loadLocations(){this.assetService.getLocations().pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&(this.locations=n.data.locations||n.data)},error:n=>{console.error("Error loading locations:",n)}})}onSearch(){this.currentFilters.search=this.searchQuery,this.currentFilters.page=1,this.loadAssets()}applyFilters(){this.currentFilters.page=1,this.loadAssets()}get selectedCount(){return this.assetList.filter(n=>n.selected).length}toggleSelectAllAssets(){let n=this.selectedCount===this.assetList.length;this.assetList.forEach(e=>e.selected=!n),this.selectAllAssets=!n}selectType(n){let e=this.typeOptions.find(i=>i.value===n);e&&(this.selectedType=e,this.currentFilters.type=e.value),this.showTypeDropdown=!1,this.applyFilters()}selectStatus(n){let e=this.statusOptions.find(i=>i.value===n);e&&(this.selectedStatus=e,this.currentFilters.status=e.value),this.showStatusDropdown=!1,this.applyFilters()}selectSort(n){let e=this.sortOptions.find(i=>i.value===n);e&&(this.selectedSort=e,this.currentFilters.sort_by=e.value),this.showSortDropdown=!1,this.applyFilters()}selectSortDir(n){this.selectedSortDir=n,this.currentFilters.sort_direction=n,this.showSortDirDropdown=!1,this.applyFilters()}toggleSortDir(){this.selectedSortDir=this.selectedSortDir==="asc"?"desc":"asc",this.currentFilters.sort_direction=this.selectedSortDir,this.applyFilters()}duplicateSelected(){let n=this.assetList.filter(i=>i.selected);if(n.length===0)return;let e=n[0];this.router.navigate(["/assets/create"],{queryParams:{duplicate:!0,sourceId:e.id}}),this.clearSelection()}generateSerialNumber(){let n=Date.now().toString(),e=Math.random().toString(36).substring(2,8).toUpperCase();return`SN${n.slice(-6)}${e}`}clearSelection(){this.assetList.forEach(n=>n.selected=!1),this.selectAllAssets=!1}showArchiveModal(){this.selectedCount>0&&(this.showArchiveConfirmationModal=!0)}closeArchiveModal(){this.showArchiveConfirmationModal=!1}showDeleteModal(){this.selectedCount>0&&(this.showDeleteConfirmationModal=!0)}closeDeleteModal(){this.showDeleteConfirmationModal=!1}closeRestoreModal(){this.showRestoreConfirmationModal=!1,this.selectedAssetForRestore=null}restoreSelectedAsset(n){if(this.assetList.filter(i=>i.selected).length>1)this.restoreBulkAssets(n);else if(this.selectedAssetForRestore){let i={};n&&n.trim()&&(i.restore_reason=n.trim()),this.assetService.restoreAsset(this.selectedAssetForRestore.id,i).pipe(rt(this.destroy$)).subscribe({next:r=>{r.success?(this.loadAssets(),this.loadAssetStatistics(),console.log("Asset restored successfully")):this.error=r.message||"Failed to restore asset",this.closeRestoreModal()},error:r=>{this.error=r.error?.message||"An error occurred while restoring the asset",this.closeRestoreModal()}})}else this.closeRestoreModal()}deleteSelected(n){let e=this.assetList.filter(a=>a.selected);if(e.length===0){this.closeDeleteModal();return}let r={asset_ids:e.map(a=>a.id)};n&&n.trim()&&(r.deletion_reason=n.trim()),this.assetService.bulkDeleteAssets(r).pipe(rt(this.destroy$)).subscribe({next:a=>{if(a.success){if(a.failed&&a.failed.length>0){let s=a.failed.length,o=a.deleted?a.deleted.length:0;this.error=`${o} assets deleted successfully, ${s} failed to delete`}else{let s=a.deleted?a.deleted.length:e.length;console.log(`${s} assets deleted successfully`)}this.loadAssets(),this.loadAssetStatistics(),this.clearSelection()}else this.error=a.message||"Failed to delete assets";this.closeDeleteModal()},error:a=>{this.error=a.error?.message||"An error occurred while deleting assets",this.closeDeleteModal()}})}viewAsset(n){this.router.navigate(["/assets/preview",n.id])}archiveSelected(n){let e=this.assetList.filter(a=>a.selected);if(e.length===0){this.closeArchiveModal();return}let r={asset_ids:e.map(a=>a.id)};n&&n.trim()&&(r.archive_reason=n.trim()),this.assetService.bulkArchiveAssets(r).pipe(rt(this.destroy$)).subscribe({next:a=>{if(a.success){if(a.failed&&a.failed.length>0){let s=a.failed.length,o=a.archived?a.archived.length:0;this.error=`${o} assets archived successfully, ${s} failed to archive`}else{let s=a.archived?a.archived.length:e.length;console.log(`${s} assets archived successfully`)}this.loadAssets(),this.loadAssetStatistics(),this.clearSelection()}else this.error=a.message||"Failed to archive assets";this.closeArchiveModal()},error:a=>{this.error=a.error?.message||"An error occurred while archiving assets",this.closeArchiveModal()}})}toggleTypeDropdown(){this.showTypeDropdown=!this.showTypeDropdown,this.showStatusDropdown=!1,this.showSortDropdown=!1,this.showSortDirDropdown=!1}toggleStatusDropdown(){this.showStatusDropdown=!this.showStatusDropdown,this.showTypeDropdown=!1,this.showSortDropdown=!1,this.showSortDirDropdown=!1}toggleSortDropdown(){this.showSortDropdown=!this.showSortDropdown,this.showTypeDropdown=!1,this.showStatusDropdown=!1,this.showSortDirDropdown=!1}toggleArchivedView(){this.showingArchived=!this.showingArchived,this.currentFilters.archived=this.showingArchived,this.currentFilters.page=1,this.clearSelection(),this.loadAssets(),this.showMenu=!1}goToCreateAsset(){this.router.navigate(["assets/create"])}exportToPdf(){if(this.assetList.length>0){let n=this.showingArchived?"Archived Assets Export Report":"Asset Export Report";this.pdfExportService.exportAssetsToPdf(this.assetList,n),this.showMenu=!1}else console.log("No assets to export")}exportToExcel(){this.assetList.length>0?(this.exportingExcel=!0,this.assetService.exportAssetsToExcel(this.showingArchived).subscribe({next:n=>{let e=window.URL.createObjectURL(n),i=document.createElement("a");i.href=e;let r=this.showingArchived?"archived-assets-export.xlsx":"assets-export.xlsx";i.download=r,i.click(),window.URL.revokeObjectURL(e),this.exportingExcel=!1,this.showMenu=!1},error:n=>{console.error("Error exporting to Excel:",n),this.exportingExcel=!1}})):console.log("No assets to export")}getStatusColor(n){return{Active:"green",Maintenance:"orange",Inactive:"gray",Retired:"red"}[n]||"gray"}toggleAssetMenu(n){this.assetList.forEach(i=>{i.id!==n&&(i.showMenu=!1)});let e=this.assetList.find(i=>i.id===n);e&&(e.showMenu=!e.showMenu)}editAsset(n){this.router.navigate(["/assets",n.id,"edit"]),n.showMenu=!1}duplicateAsset(n){this.router.navigate(["/assets/create"],{queryParams:{duplicate:!0,sourceId:n.id}}),n.showMenu=!1}archiveAsset(n){this.assetList.forEach(e=>e.selected=!1),n.selected=!0,this.showArchiveConfirmationModal=!0,n.showMenu=!1}deleteAsset(n){this.assetList.forEach(e=>e.selected=!1),n.selected=!0,this.showDeleteConfirmationModal=!0,n.showMenu=!1}restoreSelected(){this.assetList.filter(e=>e.selected).length!==0&&(this.showRestoreConfirmationModal=!0)}restoreBulkAssets(n){let e=this.assetList.filter(r=>r.selected);if(e.length===0){this.closeRestoreModal();return}let i=e.map(r=>r.id);this.assetService.bulkRestoreAssets(i,n).pipe(rt(this.destroy$)).subscribe({next:r=>{if(r.success){if(r.failed&&r.failed.length>0){let a=r.failed.length,s=r.restored?r.restored.length:0;this.error=`${s} assets restored successfully, ${a} failed to restore`}else{let a=r.restored?r.restored.length:e.length;console.log(`${a} assets restored successfully`)}this.loadAssets(),this.loadAssetStatistics(),this.clearSelection()}else this.error=r.message||"Failed to restore assets";this.closeRestoreModal()},error:r=>{this.error=r.error?.message||"An error occurred while restoring assets",this.closeRestoreModal()}})}restoreAsset(n){this.selectedAssetForRestore=n,this.showRestoreConfirmationModal=!0,n.showMenu=!1}toggleAssetTypeDropdown(){this.showAssetTypeDropdown=!this.showAssetTypeDropdown,this.showStatusDropdown=!1,this.showSortDropdown=!1,this.showSortDirDropdown=!1}selectAssetType(n){this.selectedAssetType=n,this.currentFilters.type=n.id,this.showAssetTypeDropdown=!1,this.applyFilters()}toggleAssetStatusDropdown(){this.showAssetStatusDropdown=!this.showAssetStatusDropdown}selectAssetStatus(n){this.selectedAssetStatus=n,this.currentFilters.status=n.id,this.showAssetStatusDropdown=!1,this.applyFilters()}onDocumentClick(n){n.target.closest(".menu-container")||(this.showMenu=!1)}generateQRCodeForAsset(n){let e=`${window.location.origin}/public/asset/${n.id}`;hd.toDataURL(e,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}}).then(i=>{let r=document.createElement("a");r.href=i,r.download=`asset-${n.id}-qr.png`,r.click()}).catch(i=>{console.error("Error generating QR code:",i)})}generateQRCodeForSelectedAssets(){let n=this.assetList.filter(e=>e.selected);if(n.length===0){console.log("No assets selected");return}n.forEach(e=>{this.generateQRCodeForAsset(e)})}copyPublicUrl(n){let e=`${window.location.origin}/public/asset/${n.id}`;navigator.clipboard.writeText(e).then(()=>{console.log("Public URL copied to clipboard")})}static \u0275fac=function(e){return new(e||t)(ft(_i),ft(Kn),ft(ro))};static \u0275cmp=Yt({type:t,selectors:[["app-asset-list"]],hostBindings:function(e,i){e&1&&Y("click",function(a){return i.onDocumentClick(a)},!1,Qr)},decls:132,vars:60,consts:[[1,"asset-list-page","min-h-screen","bg-gray-50","p-6"],[1,"mb-6","flex","flex-col","md:flex-row","md:items-center","md:justify-between"],[1,"text-2xl","font-bold","text-gray-900","mb-1"],[1,"text-gray-600","text-base"],[1,"flex","items-center","space-x-3","mt-4","md:mt-0"],[1,"bg-blue-600","hover:bg-blue-700","text-white","font-semibold","px-5","py-2","rounded-lg","shadow-sm","transition-colors","flex","items-center","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"relative",3,"click"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-lg","hover:bg-gray-100","transition-colors","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-gray-600"],["cx","12","cy","5","r","2"],["cx","12","cy","12","r","2"],["cx","12","cy","19","r","2"],["class","absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-5","gap-4","mb-8"],[1,"rounded-xl","bg-blue-50","border","border-blue-100","p-6","flex","flex-col","justify-between","shadow-sm","transition-all","hover:shadow-md"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-base","font-medium","text-gray-700"],[1,"w-10","h-10","bg-blue-100","rounded-xl","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"text-3xl","font-bold","text-gray-900"],["href","#",1,"text-sm","text-blue-600","font-medium","mt-1"],[1,"rounded-xl","bg-green-50","border","border-green-100","p-6","flex","flex-col","justify-between","shadow-sm","transition-all","hover:shadow-md"],[1,"w-10","h-10","bg-green-100","rounded-xl","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-400"],["cx","12","cy","12","r","8","stroke","currentColor","stroke-width","2","fill","none"],["cx","12","cy","12","r","4","fill","currentColor",1,"text-green-400"],[1,"text-sm","text-green-600","font-medium","mt-1"],[1,"rounded-xl","bg-orange-50","border","border-orange-100","p-6","flex","flex-col","justify-between","shadow-sm","transition-all","hover:shadow-md"],[1,"w-10","h-10","bg-orange-100","rounded-xl","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-orange-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.232 5.232l3.536 3.536m-2.036-1.5a2.5 2.5 0 11-3.536 3.536l-7.5 7.5a2 2 0 102.828 2.828l7.5-7.5a2.5 2.5 0 013.536-3.536z"],[1,"text-sm","text-orange-600","font-medium","mt-1"],[1,"rounded-xl","bg-purple-50","border","border-purple-100","p-6","flex","flex-col","justify-between","shadow-sm","transition-all","hover:shadow-md"],[1,"w-10","h-10","bg-purple-100","rounded-xl","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-purple-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"text-sm","text-purple-600","font-medium","mt-1"],[1,"rounded-xl","bg-cyan-50","border","border-cyan-100","p-6","flex","flex-col","justify-between","shadow-sm","transition-all","hover:shadow-md"],[1,"w-10","h-10","bg-cyan-100","rounded-xl","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-cyan-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 1.343-3 3s1.343 3 3 3 3-1.343 3-3-1.343-3-3-3zm0 0V4m0 8v8m8-8h-8m8 0a8 8 0 11-16 0 8 8 0 0116 0z"],[1,"text-sm","text-cyan-600","font-medium","mt-1"],[1,"flex","flex-col","md:flex-row","md:items-center","md:justify-between","mb-6"],[1,"flex-1","flex","flex-col","space-y-3","md:space-y-0","md:flex-row","md:items-center","md:space-x-3"],[1,"relative","w-full","md:w-80"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Search assets by name, location, or ID...",1,"w-full","pl-10","pr-4","py-2","border-2","border-blue-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","placeholder-gray-400",3,"ngModelChange","input","ngModel"],["type","button",1,"w-full","px-4","py-2","text-left","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white","transition-all","min-w-[220px]",3,"click"],[1,"flex","items-center","justify-between"],["class","text-gray-400",4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute z-10 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-72 overflow-y-auto min-w-[220px] w-full",4,"ngIf"],[1,"relative","ml-2",3,"click"],["type","button",1,"w-full","px-4","py-2","text-left","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white","transition-all","min-w-[180px]",3,"click"],[4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400","transition-transform","ml-2"],["class","absolute z-10 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-72 overflow-y-auto min-w-[180px] w-full",4,"ngIf"],[1,"relative"],[1,"px-4","py-2","bg-gray-100","rounded-lg","text-gray-700","flex","items-center","space-x-2","min-w-[70px]","cursor-pointer",3,"click"],["class","w-4 h-4","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"flex","items-center","space-x-2","mt-4","md:mt-0"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-lg","border","border-gray-200","hover:bg-blue-50","transition-colors","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["x","4","y","4","width","7","height","7","rx","2"],["x","13","y","4","width","7","height","7","rx","2"],["x","4","y","13","width","7","height","7","rx","2"],["x","13","y","13","width","7","height","7","rx","2"],["x","4","y","6","width","16","height","4","rx","2"],["x","4","y","14","width","16","height","4","rx","2"],["class","flex items-center justify-center py-20",4,"ngIf"],["class","w-full bg-white rounded-xl border border-gray-200 px-6 py-3 mb-4 flex items-center",4,"ngIf"],["class","w-full bg-white rounded-xl border border-gray-200 px-6 py-3 mb-4 flex items-center justify-between",4,"ngIf"],["class","text-center py-20",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-2",4,"ngIf"],["class","bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",4,"ngIf"],[3,"closeModal","confirmArchive","isOpen","selectedCount"],[3,"closeModal","confirmDelete","isOpen","selectedCount"],[3,"closeModal","confirmRestore","isOpen","selectedCount","assetName"],[1,"absolute","right-0","mt-2","w-64","bg-white","rounded-xl","shadow-lg","border","border-gray-200","py-2","z-50"],[1,"w-full","flex","items-center","space-x-3","px-4","py-2","hover:bg-gray-50","text-left","transition-colors","cursor-pointer"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 17v-2a4 4 0 014-4h2a4 4 0 014 4v2"],[1,"w-full","flex","items-center","space-x-3","px-4","py-2","hover:bg-gray-50","text-left","transition-colors","cursor-pointer",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 8h14M5 8a2 2 0 110-4h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293H19a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"],[1,"w-full","flex","items-center","space-x-3","px-4","py-2","hover:bg-gray-50","text-left","transition-colors","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","w-5 h-5 text-gray-500","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","animate-spin w-5 h-5 text-gray-500","fill","none","viewBox","0 0 24 24",4,"ngIf"],["routerLink","/assets/import",1,"w-full","flex","items-center","space-x-3","px-4","py-2","hover:bg-gray-50","text-left","transition-colors","cursor-pointer"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"border-t","border-gray-100","my-2"],[1,"w-full","flex","items-center","space-x-3","px-4","py-2","hover:bg-orange-50","text-left","transition-colors","cursor-pointer","text-orange-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 12H4"],[1,"w-full","flex","items-center","space-x-3","px-4","py-2","hover:bg-red-50","text-left","transition-colors","cursor-pointer","text-red-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 8h14M5 8a2 2 0 110-4h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293H19a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-5","h-5","text-gray-500"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-gray-400"],[1,"flex","items-center","space-x-2"],["alt","icon",1,"w-5","h-5",3,"src"],[1,"absolute","z-10","mt-1","bg-white","border","border-gray-300","rounded-lg","shadow-lg","max-h-72","overflow-y-auto","min-w-[220px]","w-full"],[1,"px-4","py-2","text-xs","text-gray-400","font-semibold","uppercase","tracking-wider"],["class","flex items-center px-4 py-2 cursor-pointer hover:bg-blue-50",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"flex","items-center","px-4","py-2","cursor-pointer","hover:bg-blue-50",3,"click","ngClass"],["alt","icon",1,"w-5","h-5","mr-2",3,"src"],["class","inline-block w-3 h-3 rounded-full mr-2",3,"background",4,"ngIf"],[1,"inline-block","w-3","h-3","rounded-full","mr-2"],[1,"absolute","z-10","mt-1","bg-white","border","border-gray-300","rounded-lg","shadow-lg","max-h-72","overflow-y-auto","min-w-[180px]","w-full"],["class","px-4 py-2 cursor-pointer hover:bg-blue-50",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"px-4","py-2","cursor-pointer","hover:bg-blue-50",3,"click","ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 17l-4 4m0 0l-4-4m4 4V3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7l4-4m0 0l4 4m-4-4v18"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","rounded-full","mb-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-8","h-8","text-blue-600"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-red-100","rounded-full","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-sm","text-gray-500","mb-4"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"w-full","bg-white","rounded-xl","border","border-gray-200","px-6","py-3","mb-4","flex","items-center"],["type","button",1,"focus:outline-none","inline-flex","items-center","justify-center","w-6","h-6","rounded-full","border-2","border-blue-400","mr-3","transition-colors",3,"click"],[1,"w-3","h-3","rounded-full","block","bg-white","transition-colors"],[1,"font-semibold","text-gray-900"],[1,"w-full","bg-white","rounded-xl","border","border-gray-200","px-6","py-3","mb-4","flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"w-3","h-3","rounded-full","block","transition-colors"],[1,"font-bold","text-gray-900"],[1,"bg-blue-50","text-blue-600","px-3","py-1","rounded-full","text-sm","flex","items-center","font-medium"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7"],["class","bg-gray-50 text-gray-700 font-semibold px-4 py-2 rounded-lg flex items-center space-x-2 border border-gray-200 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",3,"disabled","click",4,"ngIf"],[1,"bg-purple-50","text-purple-600","font-semibold","px-4","py-2","rounded-lg","flex","items-center","space-x-2","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V6a1 1 0 00-1-1H5a1 1 0 00-1 1v1a1 1 0 001 1zm12 0h2a1 1 0 001-1V6a1 1 0 00-1-1h-2a1 1 0 00-1 1v1a1 1 0 001 1zM5 20h2a1 1 0 001-1v-1a1 1 0 00-1-1H5a1 1 0 00-1 1v1a1 1 0 001 1z"],["class","bg-orange-50 text-orange-600 font-semibold px-4 py-2 rounded-lg flex items-center space-x-2 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",3,"disabled","click",4,"ngIf"],["class","bg-red-50 text-red-600 font-semibold px-4 py-2 rounded-lg flex items-center space-x-2 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",3,"disabled","click",4,"ngIf"],["class","bg-green-50 text-green-600 font-semibold px-4 py-2 rounded-lg flex items-center space-x-2 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",3,"disabled","click",4,"ngIf"],[1,"bg-transparent","text-gray-700","font-semibold","px-2","py-2","rounded-lg","flex","items-center","space-x-2","cursor-pointer",3,"click"],[1,"text-xl"],[1,"bg-gray-50","text-gray-700","font-semibold","px-4","py-2","rounded-lg","flex","items-center","space-x-2","border","border-gray-200","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["x","8","y","8","width","8","height","8","rx","2","stroke-width","2"],["x","4","y","4","width","8","height","8","rx","2","stroke-width","2"],[1,"bg-orange-50","text-orange-600","font-semibold","px-4","py-2","rounded-lg","flex","items-center","space-x-2","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["x","4","y","4","width","16","height","16","rx","2","stroke-width","2"],["d","M8 12h8","stroke-width","2"],[1,"bg-red-50","text-red-600","font-semibold","px-4","py-2","rounded-lg","flex","items-center","space-x-2","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["d","M8 8l8 8M8 16l8-8","stroke-width","2"],[1,"bg-green-50","text-green-600","font-semibold","px-4","py-2","rounded-lg","flex","items-center","space-x-2","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-center","py-20"],[1,"w-16","h-16","bg-gray-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],[1,"text-gray-600","mb-4"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-6","mt-2"],["class","rounded-2xl border border-blue-200 bg-white shadow-sm flex flex-col transition-all hover:shadow-md overflow-hidden",3,"border-blue-400",4,"ngFor","ngForOf"],[1,"rounded-2xl","border","border-blue-200","bg-white","shadow-sm","flex","flex-col","transition-all","hover:shadow-md","overflow-hidden"],[1,"relative","bg-[#e0edff]","h-32","flex","flex-col","items-center","justify-center"],[1,"absolute","left-4","top-4","flex","items-center"],["type","checkbox",1,"asset-card-checkbox",3,"ngModelChange","ngModel"],[1,"absolute","right-4","top-4","flex","items-center","space-x-2"],["class","bg-green-100 text-green-700 text-xs font-semibold px-3 py-1 rounded-full",4,"ngIf"],[3,"class",4,"ngIf"],[1,"w-8","h-8","flex","items-center","justify-center","rounded-full","hover:bg-gray-100","transition-colors","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["cx","12","cy","6","r","1.5"],["cx","12","cy","12","r","1.5"],["cx","12","cy","18","r","1.5"],["class","absolute right-0 top-full mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-blue-400"],[1,"flex-1","flex","flex-col","justify-between","p-6","pt-4"],["class","mb-2",4,"ngIf"],[1,"font-semibold","text-lg","text-gray-900","mb-1","cursor-pointer","hover:text-blue-600","transition-colors",3,"click"],[1,"text-sm","text-gray-500","mb-1"],[1,"flex","items-center","text-xs","text-gray-400","mb-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 12.414a4 4 0 10-1.414 1.414l4.243 4.243a1 1 0 001.414-1.414z"],[1,"my-3","border-gray-200"],[1,"flex","items-center","text-sm","text-gray-700","mb-1"],["class","flex items-center text-sm text-gray-700 mb-1",4,"ngIf"],[1,"mt-4"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","text-gray-500"],[1,"text-xs","font-semibold","text-gray-700"],[1,"w-full","h-2","bg-gray-200","rounded-full"],[1,"h-2","rounded-full",3,"ngClass"],[1,"bg-green-100","text-green-700","text-xs","font-semibold","px-3","py-1","rounded-full"],[1,"absolute","right-0","top-full","mt-1","w-48","bg-white","rounded-lg","shadow-lg","border","border-gray-200","py-1","z-50"],["class","w-full flex items-center space-x-3 px-3 py-2 text-left hover:bg-gray-50 transition-colors",3,"click",4,"ngIf"],[1,"w-full","flex","items-center","space-x-3","px-3","py-2","text-left","hover:bg-purple-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-purple-500"],[1,"text-sm","text-purple-600"],[1,"w-full","flex","items-center","space-x-3","px-3","py-2","text-left","hover:bg-blue-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"text-sm","text-blue-600"],[1,"border-t","border-gray-100","my-1"],["class","w-full flex items-center space-x-3 px-3 py-2 text-left hover:bg-orange-50 transition-colors",3,"click",4,"ngIf"],["class","w-full flex items-center space-x-3 px-3 py-2 text-left hover:bg-green-50 transition-colors",3,"click",4,"ngIf"],["class","w-full flex items-center space-x-3 px-3 py-2 text-left hover:bg-red-50 transition-colors",3,"click",4,"ngIf"],[1,"w-full","flex","items-center","space-x-3","px-3","py-2","text-left","hover:bg-gray-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],[1,"text-sm","text-gray-700"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"w-full","flex","items-center","space-x-3","px-3","py-2","text-left","hover:bg-orange-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-orange-500"],[1,"text-sm","text-orange-600"],[1,"w-full","flex","items-center","space-x-3","px-3","py-2","text-left","hover:bg-green-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-500"],[1,"text-sm","text-green-600"],[1,"w-full","flex","items-center","space-x-3","px-3","py-2","text-left","hover:bg-red-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-red-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-sm","text-red-600"],[1,"mb-2"],[1,"text-blue-600","hover:underline","text-xs",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200","bg-gray-50"],[1,"grid","grid-cols-12","gap-4","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"col-span-1","flex","items-center"],["type","checkbox",1,"w-4","h-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500",3,"change","checked","indeterminate"],[1,"col-span-3"],[1,"col-span-2"],[1,"col-span-1"],[1,"divide-y","divide-gray-200"],["class","px-6 py-4 hover:bg-gray-50 transition-colors",3,"bg-blue-50",4,"ngFor","ngForOf"],[1,"px-6","py-4","hover:bg-gray-50","transition-colors"],[1,"grid","grid-cols-12","gap-4","items-center"],["type","checkbox",1,"w-4","h-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],[1,"font-medium","text-gray-900","hover:text-blue-600","cursor-pointer","transition-colors",3,"click"],[1,"text-sm","text-gray-900"],[1,"flex","items-center","space-x-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],[1,"text-sm","text-gray-600"],[1,"p-1","text-gray-400","hover:text-blue-600","hover:bg-blue-50","rounded","transition-all",3,"click"],[1,"p-1","text-gray-400","hover:text-blue-600","hover:bg-blue-50","rounded","transition-all"],[1,"p-1","text-gray-400","hover:text-red-600","hover:bg-red-50","rounded","transition-all"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),g(4,"Asset Intelligence Hub"),u(),d(5,"p",3),g(6,"Advanced asset monitoring with AI-powered insights and real-time analytics"),u()(),d(7,"div",4)(8,"button",5),Y("click",function(){return i.goToCreateAsset()}),B(),d(9,"svg",6),D(10,"path",7),u(),g(11," Add Asset "),u(),q(),d(12,"div",8),Y("click",function(a){return a.stopPropagation()}),d(13,"button",9),Y("click",function(){return i.showMenu=!i.showMenu}),B(),d(14,"svg",10),D(15,"circle",11)(16,"circle",12)(17,"circle",13),u()(),J(18,Pp,38,7,"div",14),u()()(),q(),d(19,"div",15)(20,"div",16)(21,"div",17)(22,"span",18),g(23,"Total Assets"),u(),d(24,"span",19),B(),d(25,"svg",20),D(26,"path",21),u()()(),q(),d(27,"div",22),g(28),u(),d(29,"a",23),g(30,"Assets in system"),u()(),d(31,"div",24)(32,"div",17)(33,"span",18),g(34,"Active"),u(),d(35,"span",25),B(),d(36,"svg",26),D(37,"circle",27)(38,"circle",28),u()()(),q(),d(39,"div",22),g(40),u(),d(41,"span",29),g(42,"Operational assets"),u()(),d(43,"div",30)(44,"div",17)(45,"span",18),g(46,"Maintenance"),u(),d(47,"span",31),B(),d(48,"svg",32),D(49,"path",33),u()()(),q(),d(50,"div",22),g(51),u(),d(52,"span",34),g(53,"Under maintenance"),u()(),d(54,"div",35)(55,"div",17)(56,"span",18),g(57,"Total Value"),u(),d(58,"span",36),B(),d(59,"svg",37),D(60,"path",38),u()()(),q(),d(61,"div",22),g(62),kn(63,"currency"),u(),d(64,"span",39),g(65,"Asset portfolio value"),u()(),d(66,"div",40)(67,"div",17)(68,"span",18),g(69,"Asset Health"),u(),d(70,"span",41),B(),d(71,"svg",42),D(72,"path",43),u()()(),q(),d(73,"div",22),g(74),u(),d(75,"span",44),g(76,"Excellent health"),u()()(),d(77,"div",45)(78,"div",46)(79,"div",47),B(),d(80,"svg",48),D(81,"path",49),u(),q(),d(82,"input",50),ot("ngModelChange",function(a){return st(i.searchQuery,a)||(i.searchQuery=a),a}),Y("input",function(){return i.onSearch()}),u()(),d(83,"div",8),Y("click",function(a){return a.stopPropagation()}),d(84,"button",51),Y("click",function(){return i.toggleAssetTypeDropdown()}),d(85,"div",52),J(86,Op,2,0,"span",53)(87,Rp,4,2,"div",54),B(),d(88,"svg",55),D(89,"path",56),u()()(),J(90,Bp,4,1,"div",57),u(),q(),d(91,"div",58),Y("click",function(a){return a.stopPropagation()}),d(92,"button",51),Y("click",function(){return i.toggleAssetStatusDropdown()}),d(93,"div",52),J(94,Hp,2,0,"span",53)(95,zp,4,2,"div",54),u()(),J(96,Gp,4,1,"div",57),u(),d(97,"div",58),Y("click",function(a){return a.stopPropagation()}),d(98,"button",59),Y("click",function(){return i.toggleSortDropdown()}),d(99,"div",52),J(100,$p,2,0,"span",53)(101,Yp,2,1,"span",60),B(),d(102,"svg",61),D(103,"path",56),u()()(),J(104,Kp,4,1,"div",62),u(),q(),d(105,"div",63)(106,"button",64),Y("click",function(){return i.toggleSortDir()}),J(107,qp,2,0,"svg",65)(108,Jp,2,0,"svg",65),d(109,"span"),g(110),u()()()(),d(111,"div",66)(112,"button",67),Y("click",function(){return i.viewType="grid"}),B(),d(113,"svg",68),D(114,"rect",69)(115,"rect",70)(116,"rect",71)(117,"rect",72),u()(),q(),d(118,"button",67),Y("click",function(){return i.viewType="list"}),B(),d(119,"svg",68),D(120,"rect",73)(121,"rect",74),u()()()(),J(122,Qp,10,0,"div",75)(123,Zp,11,1,"div",75)(124,e1,5,1,"div",76)(125,a1,23,13,"div",77)(126,s1,10,0,"div",78)(127,b1,2,1,"div",79)(128,S1,19,3,"div",80),q(),d(129,"app-archive-confirmation-modal",81),Y("closeModal",function(){return i.closeArchiveModal()})("confirmArchive",function(){return i.archiveSelected()}),u(),d(130,"app-delete-confirmation-modal",82),Y("closeModal",function(){return i.closeDeleteModal()})("confirmDelete",function(a){return i.deleteSelected(a)}),u(),d(131,"app-restore-confirmation-modal",83),Y("closeModal",function(){return i.closeRestoreModal()})("confirmRestore",function(a){return i.restoreSelectedAsset(a)}),u()()),e&2&&(x(18),C("ngIf",i.showMenu),x(10),oe(i.summary.totalAssets),x(12),oe(i.summary.activeAssets),x(11),oe(i.summary.maintenance),x(11),oe(Zi(63,55,i.summary.totalValue,"USD","symbol","1.0-0")),x(12),xe("",i.summary.assetHealth,"%"),x(8),at("ngModel",i.searchQuery),x(2),ge("border-blue-500",i.showAssetTypeDropdown),x(2),C("ngIf",!i.selectedAssetType),x(),C("ngIf",i.selectedAssetType),x(),ge("rotate-180",i.showAssetTypeDropdown),x(2),C("ngIf",i.showAssetTypeDropdown),x(2),ge("border-blue-500",i.showAssetStatusDropdown),x(2),C("ngIf",!i.selectedAssetStatus),x(),C("ngIf",i.selectedAssetStatus),x(),C("ngIf",i.showAssetStatusDropdown),x(2),ge("border-blue-500",i.showSortDropdown),x(2),C("ngIf",!i.selectedSort),x(),C("ngIf",i.selectedSort),x(),ge("rotate-180",i.showSortDropdown),x(2),C("ngIf",i.showSortDropdown),x(2),ge("bg-blue-100",i.selectedSortDir==="asc")("text-blue-700",i.selectedSortDir==="asc"),x(),C("ngIf",i.selectedSortDir==="desc"),x(),C("ngIf",i.selectedSortDir==="asc"),x(2),oe(i.selectedSortDir==="asc"?"A-Z":"Z-A"),x(2),ge("bg-blue-100",i.viewType==="grid")("text-blue-700",i.viewType==="grid"),x(6),ge("bg-blue-100",i.viewType==="list")("text-blue-700",i.viewType==="list"),x(4),C("ngIf",i.loading),x(),C("ngIf",i.error&&!i.loading),x(),C("ngIf",i.viewType==="grid"&&i.selectedCount===0&&!i.loading&&!i.error),x(),C("ngIf",i.viewType==="grid"&&i.selectedCount>0&&!i.loading&&!i.error),x(),C("ngIf",!i.loading&&!i.error&&i.assetList.length===0),x(),C("ngIf",i.viewType==="grid"&&!i.loading&&!i.error&&i.assetList.length>0),x(),C("ngIf",i.viewType==="list"&&!i.loading&&!i.error&&i.assetList.length>0),x(),C("isOpen",i.showArchiveConfirmationModal)("selectedCount",i.selectedCount),x(),C("isOpen",i.showDeleteConfirmationModal)("selectedCount",i.selectedCount),x(),C("isOpen",i.showRestoreConfirmationModal)("selectedCount",i.selectedCount>0?i.selectedCount:1)("assetName",(i.selectedAssetForRestore==null?null:i.selectedAssetForRestore.name)||""))},dependencies:[$s,Xt,Yn,fn,cn,od,dn,Pn,ad,Gs,ao,so,oo,js,Oi,Ys],styles:['.asset-list-page[_ngcontent-%COMP%]   .asset-card-checkbox[_ngcontent-%COMP%]{width:20px!important;height:20px!important;border-radius:50%!important;border-width:2px;border-color:#3b82f6;appearance:none;background-color:#fff;display:inline-block;vertical-align:middle;position:relative;transition:border-color .2s}.asset-list-page[_ngcontent-%COMP%]   .asset-card-checkbox[_ngcontent-%COMP%]:checked{background-color:#3b82f6;border-color:#2563eb}.asset-list-page[_ngcontent-%COMP%]   .asset-card-checkbox[_ngcontent-%COMP%]:checked:after{content:"";display:block;width:10px;height:10px;border-radius:50%;background:#fff;position:absolute;top:3px;left:3px}.asset-list-page[_ngcontent-%COMP%]   .asset-card-header[_ngcontent-%COMP%]{background:#e0edff;height:8rem;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;border-top-left-radius:1rem;border-top-right-radius:1rem;overflow:hidden}.asset-list-page[_ngcontent-%COMP%]   .asset-card[_ngcontent-%COMP%]{border-radius:1rem;box-shadow:0 2px 8px #101e3614;overflow:hidden;background:#fff;border:1px solid #bfdbfe;display:flex;flex-direction:column;transition:box-shadow .2s}.asset-list-page[_ngcontent-%COMP%]   .asset-card[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{margin-top:.75rem;margin-bottom:.75rem;border-color:#e5e7eb}']})};var co=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],ir={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(t){return typeof console<"u"&&console.warn(t)},getWeek:function(t){var n=new Date(t.getTime());n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7);var e=new Date(n.getFullYear(),0,4);return 1+Math.round(((n.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1};var fo={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(t){var n=t%100;if(n>3&&n<21)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},uo=fo;var un=function(t,n){return n===void 0&&(n=2),("000"+t).slice(n*-1)},On=function(t){return t===!0?1:0};function Ol(t,n){var e;return function(){var i=this,r=arguments;clearTimeout(e),e=setTimeout(function(){return t.apply(i,r)},n)}}var ho=function(t){return t instanceof Array?t:[t]};function hn(t,n,e){if(e===!0)return t.classList.add(n);t.classList.remove(n)}function nt(t,n,e){var i=window.document.createElement(t);return n=n||"",e=e||"",i.className=n,e!==void 0&&(i.textContent=e),i}function Ua(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Ll(t,n){if(n(t))return t;if(t.parentNode)return Ll(t.parentNode,n)}function za(t,n){var e=nt("div","numInputWrapper"),i=nt("input","numInput "+t),r=nt("span","arrowUp"),a=nt("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?i.type="number":(i.type="text",i.pattern="\\d*"),n!==void 0)for(var s in n)i.setAttribute(s,n[s]);return e.appendChild(i),e.appendChild(r),e.appendChild(a),e}function Ln(t){try{if(typeof t.composedPath=="function"){var n=t.composedPath();return n[0]}return t.target}catch{return t.target}}var Rl=function(){},Wa=function(t,n,e){return e.months[n?"shorthand":"longhand"][t]},pd={D:Rl,F:function(t,n,e){t.setMonth(e.months.longhand.indexOf(n))},G:function(t,n){t.setHours((t.getHours()>=12?12:0)+parseFloat(n))},H:function(t,n){t.setHours(parseFloat(n))},J:function(t,n){t.setDate(parseFloat(n))},K:function(t,n,e){t.setHours(t.getHours()%12+12*On(new RegExp(e.amPM[1],"i").test(n)))},M:function(t,n,e){t.setMonth(e.months.shorthand.indexOf(n))},S:function(t,n){t.setSeconds(parseFloat(n))},U:function(t,n){return new Date(parseFloat(n)*1e3)},W:function(t,n,e){var i=parseInt(n),r=new Date(t.getFullYear(),0,2+(i-1)*7,0,0,0,0);return r.setDate(r.getDate()-r.getDay()+e.firstDayOfWeek),r},Y:function(t,n){t.setFullYear(parseFloat(n))},Z:function(t,n){return new Date(n)},d:function(t,n){t.setDate(parseFloat(n))},h:function(t,n){t.setHours((t.getHours()>=12?12:0)+parseFloat(n))},i:function(t,n){t.setMinutes(parseFloat(n))},j:function(t,n){t.setDate(parseFloat(n))},l:Rl,m:function(t,n){t.setMonth(parseFloat(n)-1)},n:function(t,n){t.setMonth(parseFloat(n)-1)},s:function(t,n){t.setSeconds(parseFloat(n))},u:function(t,n){return new Date(parseFloat(n))},w:Rl,y:function(t,n){t.setFullYear(2e3+parseFloat(n))}},Li={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},ra={Z:function(t){return t.toISOString()},D:function(t,n,e){return n.weekdays.shorthand[ra.w(t,n,e)]},F:function(t,n,e){return Wa(ra.n(t,n,e)-1,!1,n)},G:function(t,n,e){return un(ra.h(t,n,e))},H:function(t){return un(t.getHours())},J:function(t,n){return n.ordinal!==void 0?t.getDate()+n.ordinal(t.getDate()):t.getDate()},K:function(t,n){return n.amPM[On(t.getHours()>11)]},M:function(t,n){return Wa(t.getMonth(),!0,n)},S:function(t){return un(t.getSeconds())},U:function(t){return t.getTime()/1e3},W:function(t,n,e){return e.getWeek(t)},Y:function(t){return un(t.getFullYear(),4)},d:function(t){return un(t.getDate())},h:function(t){return t.getHours()%12?t.getHours()%12:12},i:function(t){return un(t.getMinutes())},j:function(t){return t.getDate()},l:function(t,n){return n.weekdays.longhand[t.getDay()]},m:function(t){return un(t.getMonth()+1)},n:function(t){return t.getMonth()+1},s:function(t){return t.getSeconds()},u:function(t){return t.getTime()},w:function(t){return t.getDay()},y:function(t){return String(t.getFullYear()).substring(2)}};var Vl=function(t){var n=t.config,e=n===void 0?ir:n,i=t.l10n,r=i===void 0?fo:i,a=t.isMobile,s=a===void 0?!1:a;return function(o,l,c){var f=c||r;return e.formatDate!==void 0&&!s?e.formatDate(o,l,f):l.split("").map(function(h,m,p){return ra[h]&&p[m-1]!=="\\"?ra[h](o,f,e):h!=="\\"?h:""}).join("")}},mo=function(t){var n=t.config,e=n===void 0?ir:n,i=t.l10n,r=i===void 0?fo:i;return function(a,s,o,l){if(!(a!==0&&!a)){var c=l||r,f,h=a;if(a instanceof Date)f=new Date(a.getTime());else if(typeof a!="string"&&a.toFixed!==void 0)f=new Date(a);else if(typeof a=="string"){var m=s||(e||ir).dateFormat,p=String(a).trim();if(p==="today")f=new Date,o=!0;else if(e&&e.parseDate)f=e.parseDate(a,m);else if(/Z$/.test(p)||/GMT$/.test(p))f=new Date(a);else{for(var v=void 0,_=[],w=0,E=0,S="";w<m.length;w++){var y=m[w],V=y==="\\",H=m[w-1]==="\\"||V;if(Li[y]&&!H){S+=Li[y];var I=new RegExp(S).exec(a);I&&(v=!0)&&_[y!=="Y"?"push":"unshift"]({fn:pd[y],val:I[++E]})}else V||(S+=".")}f=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),_.forEach(function(T){var N=T.fn,W=T.val;return f=N(f,W,c)||f}),f=v?f:void 0}}if(!(f instanceof Date&&!isNaN(f.getTime()))){e.errorHandler(new Error("Invalid date provided: "+h));return}return o===!0&&f.setHours(0,0,0,0),f}}};function Rn(t,n,e){return e===void 0&&(e=!0),e!==!1?new Date(t.getTime()).setHours(0,0,0,0)-new Date(n.getTime()).setHours(0,0,0,0):t.getTime()-n.getTime()}var gd=function(t,n,e){return t>Math.min(n,e)&&t<Math.max(n,e)},po=function(t,n,e){return t*3600+n*60+e},xd=function(t){var n=Math.floor(t/3600),e=(t-n*3600)/60;return[n,e,t-n*3600-e*60]},_d={DAY:864e5};function go(t){var n=t.defaultHour,e=t.defaultMinute,i=t.defaultSeconds;if(t.minDate!==void 0){var r=t.minDate.getHours(),a=t.minDate.getMinutes(),s=t.minDate.getSeconds();n<r&&(n=r),n===r&&e<a&&(e=a),n===r&&e===a&&i<s&&(i=t.minDate.getSeconds())}if(t.maxDate!==void 0){var o=t.maxDate.getHours(),l=t.maxDate.getMinutes();n=Math.min(n,o),n===o&&(e=Math.min(l,e)),n===o&&e===l&&(i=t.maxDate.getSeconds())}return{hours:n,minutes:e,seconds:i}}typeof Object.assign!="function"&&(Object.assign=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(!t)throw TypeError("Cannot convert undefined or null to object");for(var i=function(o){o&&Object.keys(o).forEach(function(l){return t[l]=o[l]})},r=0,a=n;r<a.length;r++){var s=a[r];i(s)}return t});var mn=function(){return mn=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mn.apply(this,arguments)},vd=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;for(var i=Array(t),r=0,n=0;n<e;n++)for(var a=arguments[n],s=0,o=a.length;s<o;s++,r++)i[r]=a[s];return i},C1=300;function k1(t,n){var e={config:mn(mn({},ir),Vt.defaultConfig),l10n:uo};e.parseDate=mo({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=_,e._setHoursFromDate=m,e._positionCalendar=Qt,e.changeMonth=fe,e.changeYear=De,e.clear=j,e.close=ne,e.onMouseOver=G,e._createElement=nt,e.createDay=I,e.destroy=Q,e.isEnabled=be,e.jumpToDate=S,e.updateValue=ri,e.open=qe,e.redraw=Ki,e.set=mi,e.setDate=Zt,e.toggle=Ii;function i(){e.utils={getDaysInMonth:function(M,O){return M===void 0&&(M=e.currentMonth),O===void 0&&(O=e.currentYear),M===1&&(O%4===0&&O%100!==0||O%400===0)?29:e.l10n.daysInMonth[M]}}}function r(){e.element=e.input=t,e.isOpen=!1,$e(),bt(),Ct(),Ge(),i(),e.isMobile||H(),E(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&m(e.config.noCalendar?e.latestSelectedDateObj:void 0),ri(!1)),o();var M=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&M&&Qt(),mt("onReady")}function a(){var M;return((M=e.calendarContainer)===null||M===void 0?void 0:M.getRootNode()).activeElement||document.activeElement}function s(M){return M.bind(e)}function o(){var M=e.config;M.weekNumbers===!1&&M.showMonths===1||M.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var O=(e.days.offsetWidth+1)*M.showMonths;e.daysContainer.style.width=O+"px",e.calendarContainer.style.width=O+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function l(M){if(e.selectedDates.length===0){var O=e.config.minDate===void 0||Rn(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),Z=go(e.config);O.setHours(Z.hours,Z.minutes,Z.seconds,O.getMilliseconds()),e.selectedDates=[O],e.latestSelectedDateObj=O}M!==void 0&&M.type!=="blur"&&Xr(M);var le=e._input.value;h(),ri(),e._input.value!==le&&e._debouncedChange()}function c(M,O){return M%12+12*On(O===e.l10n.amPM[1])}function f(M){switch(M%24){case 0:case 12:return 12;default:return M%12}}function h(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var M=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,O=(parseInt(e.minuteElement.value,10)||0)%60,Z=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(M=c(M,e.amPM.textContent));var le=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&Rn(e.latestSelectedDateObj,e.config.minDate,!0)===0,ye=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&Rn(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var Fe=po(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),ze=po(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),Le=po(M,O,Z);if(Le>ze&&Le<Fe){var We=xd(Fe);M=We[0],O=We[1],Z=We[2]}}else{if(ye){var Oe=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;M=Math.min(M,Oe.getHours()),M===Oe.getHours()&&(O=Math.min(O,Oe.getMinutes())),O===Oe.getMinutes()&&(Z=Math.min(Z,Oe.getSeconds()))}if(le){var Re=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;M=Math.max(M,Re.getHours()),M===Re.getHours()&&O<Re.getMinutes()&&(O=Re.getMinutes()),O===Re.getMinutes()&&(Z=Math.max(Z,Re.getSeconds()))}}p(M,O,Z)}}function m(M){var O=M||e.latestSelectedDateObj;O&&O instanceof Date&&p(O.getHours(),O.getMinutes(),O.getSeconds())}function p(M,O,Z){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(M%24,O,Z||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=un(e.config.time_24hr?M:(12+M)%12+12*On(M%12===0)),e.minuteElement.value=un(O),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[On(M>=12)]),e.secondElement!==void 0&&(e.secondElement.value=un(Z)))}function v(M){var O=Ln(M),Z=parseInt(O.value)+(M.delta||0);(Z/1e3>1||M.key==="Enter"&&!/[^\d]/.test(Z.toString()))&&De(Z)}function _(M,O,Z,le){if(O instanceof Array)return O.forEach(function(ye){return _(M,ye,Z,le)});if(M instanceof Array)return M.forEach(function(ye){return _(ye,O,Z,le)});M.addEventListener(O,Z,le),e._handlers.push({remove:function(){return M.removeEventListener(O,Z,le)}})}function w(){mt("onChange")}function E(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(Z){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+Z+"]"),function(le){return _(le,"click",e[Z])})}),e.isMobile){Dt();return}var M=Ol(_t,50);if(e._debouncedChange=Ol(w,C1),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&_(e.daysContainer,"mouseover",function(Z){e.config.mode==="range"&&G(Ln(Z))}),_(e._input,"keydown",Xe),e.calendarContainer!==void 0&&_(e.calendarContainer,"keydown",Xe),!e.config.inline&&!e.config.static&&_(window,"resize",M),window.ontouchstart!==void 0?_(window.document,"touchstart",de):_(window.document,"mousedown",de),_(window.document,"focus",de,{capture:!0}),e.config.clickOpens===!0&&(_(e._input,"focus",e.open),_(e._input,"click",e.open)),e.daysContainer!==void 0&&(_(e.monthNav,"click",Dl),_(e.monthNav,["keyup","increment"],v),_(e.daysContainer,"click",on)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var O=function(Z){return Ln(Z).select()};_(e.timeContainer,["increment"],l),_(e.timeContainer,"blur",l,{capture:!0}),_(e.timeContainer,"click",y),_([e.hourElement,e.minuteElement],["focus","click"],O),e.secondElement!==void 0&&_(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&_(e.amPM,"click",function(Z){l(Z)})}e.config.allowInput&&_(e._input,"blur",pe)}function S(M,O){var Z=M!==void 0?e.parseDate(M):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),le=e.currentYear,ye=e.currentMonth;try{Z!==void 0&&(e.currentYear=Z.getFullYear(),e.currentMonth=Z.getMonth())}catch(Fe){Fe.message="Invalid date supplied: "+Z,e.config.errorHandler(Fe)}O&&e.currentYear!==le&&(mt("onYearChange"),me()),O&&(e.currentYear!==le||e.currentMonth!==ye)&&mt("onMonthChange"),e.redraw()}function y(M){var O=Ln(M);~O.className.indexOf("arrow")&&V(M,O.classList.contains("arrowUp")?1:-1)}function V(M,O,Z){var le=M&&Ln(M),ye=Z||le&&le.parentNode&&le.parentNode.firstChild,Fe=Ra("increment");Fe.delta=O,ye&&ye.dispatchEvent(Fe)}function H(){var M=window.document.createDocumentFragment();if(e.calendarContainer=nt("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(M.appendChild(ke()),e.innerContainer=nt("div","flatpickr-innerContainer"),e.config.weekNumbers){var O=Ie(),Z=O.weekWrapper,le=O.weekNumbers;e.innerContainer.appendChild(Z),e.weekNumbers=le,e.weekWrapper=Z}e.rContainer=nt("div","flatpickr-rContainer"),e.rContainer.appendChild(Ve()),e.daysContainer||(e.daysContainer=nt("div","flatpickr-days"),e.daysContainer.tabIndex=-1),X(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),M.appendChild(e.innerContainer)}e.config.enableTime&&M.appendChild(we()),hn(e.calendarContainer,"rangeMode",e.config.mode==="range"),hn(e.calendarContainer,"animate",e.config.animate===!0),hn(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(M);var ye=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!ye&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var Fe=nt("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(Fe,e.element),Fe.appendChild(e.element),e.altInput&&Fe.appendChild(e.altInput),Fe.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function I(M,O,Z,le){var ye=be(O,!0),Fe=nt("span",M,O.getDate().toString());return Fe.dateObj=O,Fe.$i=le,Fe.setAttribute("aria-label",e.formatDate(O,e.config.ariaDateFormat)),M.indexOf("hidden")===-1&&Rn(O,e.now)===0&&(e.todayDateElem=Fe,Fe.classList.add("today"),Fe.setAttribute("aria-current","date")),ye?(Fe.tabIndex=-1,Va(O)&&(Fe.classList.add("selected"),e.selectedDateElem=Fe,e.config.mode==="range"&&(hn(Fe,"startRange",e.selectedDates[0]&&Rn(O,e.selectedDates[0],!0)===0),hn(Fe,"endRange",e.selectedDates[1]&&Rn(O,e.selectedDates[1],!0)===0),M==="nextMonthDay"&&Fe.classList.add("inRange")))):Fe.classList.add("flatpickr-disabled"),e.config.mode==="range"&&Ns(O)&&!Va(O)&&Fe.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&M!=="prevMonthDay"&&le%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(O)+"</span>"),mt("onDayCreate",Fe),Fe}function T(M){M.focus(),e.config.mode==="range"&&G(M)}function N(M){for(var O=M>0?0:e.config.showMonths-1,Z=M>0?e.config.showMonths:-1,le=O;le!=Z;le+=M)for(var ye=e.daysContainer.children[le],Fe=M>0?0:ye.children.length-1,ze=M>0?ye.children.length:-1,Le=Fe;Le!=ze;Le+=M){var We=ye.children[Le];if(We.className.indexOf("hidden")===-1&&be(We.dateObj))return We}}function W(M,O){for(var Z=M.className.indexOf("Month")===-1?M.dateObj.getMonth():e.currentMonth,le=O>0?e.config.showMonths:-1,ye=O>0?1:-1,Fe=Z-e.currentMonth;Fe!=le;Fe+=ye)for(var ze=e.daysContainer.children[Fe],Le=Z-e.currentMonth===Fe?M.$i+O:O<0?ze.children.length-1:0,We=ze.children.length,Oe=Le;Oe>=0&&Oe<We&&Oe!=(O>0?We:-1);Oe+=ye){var Re=ze.children[Oe];if(Re.className.indexOf("hidden")===-1&&be(Re.dateObj)&&Math.abs(M.$i-Oe)>=Math.abs(O))return T(Re)}e.changeMonth(ye),ee(N(ye),0)}function ee(M,O){var Z=a(),le=Me(Z||document.body),ye=M!==void 0?M:le?Z:e.selectedDateElem!==void 0&&Me(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&Me(e.todayDateElem)?e.todayDateElem:N(O>0?1:-1);ye===void 0?e._input.focus():le?W(ye,O):T(ye)}function te(M,O){for(var Z=(new Date(M,O,1).getDay()-e.l10n.firstDayOfWeek+7)%7,le=e.utils.getDaysInMonth((O-1+12)%12,M),ye=e.utils.getDaysInMonth(O,M),Fe=window.document.createDocumentFragment(),ze=e.config.showMonths>1,Le=ze?"prevMonthDay hidden":"prevMonthDay",We=ze?"nextMonthDay hidden":"nextMonthDay",Oe=le+1-Z,Re=0;Oe<=le;Oe++,Re++)Fe.appendChild(I("flatpickr-day "+Le,new Date(M,O-1,Oe),Oe,Re));for(Oe=1;Oe<=ye;Oe++,Re++)Fe.appendChild(I("flatpickr-day",new Date(M,O,Oe),Oe,Re));for(var dt=ye+1;dt<=42-Z&&(e.config.showMonths===1||Re%7!==0);dt++,Re++)Fe.appendChild(I("flatpickr-day "+We,new Date(M,O+1,dt%ye),dt,Re));var k=nt("div","dayContainer");return k.appendChild(Fe),k}function X(){if(e.daysContainer!==void 0){Ua(e.daysContainer),e.weekNumbers&&Ua(e.weekNumbers);for(var M=document.createDocumentFragment(),O=0;O<e.config.showMonths;O++){var Z=new Date(e.currentYear,e.currentMonth,1);Z.setMonth(e.currentMonth+O),M.appendChild(te(Z.getFullYear(),Z.getMonth()))}e.daysContainer.appendChild(M),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&G()}}function me(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var M=function(le){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&le<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&le>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var O=0;O<12;O++)if(M(O)){var Z=nt("option","flatpickr-monthDropdown-month");Z.value=new Date(e.currentYear,O).getMonth().toString(),Z.textContent=Wa(O,e.config.shorthandCurrentMonth,e.l10n),Z.tabIndex=-1,e.currentMonth===O&&(Z.selected=!0),e.monthsDropdownContainer.appendChild(Z)}}}function Ae(){var M=nt("div","flatpickr-month"),O=window.document.createDocumentFragment(),Z;e.config.showMonths>1||e.config.monthSelectorType==="static"?Z=nt("span","cur-month"):(e.monthsDropdownContainer=nt("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),_(e.monthsDropdownContainer,"change",function(ze){var Le=Ln(ze),We=parseInt(Le.value,10);e.changeMonth(We-e.currentMonth),mt("onMonthChange")}),me(),Z=e.monthsDropdownContainer);var le=za("cur-year",{tabindex:"-1"}),ye=le.getElementsByTagName("input")[0];ye.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&ye.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(ye.setAttribute("max",e.config.maxDate.getFullYear().toString()),ye.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var Fe=nt("div","flatpickr-current-month");return Fe.appendChild(Z),Fe.appendChild(le),O.appendChild(Fe),M.appendChild(O),{container:M,yearElement:ye,monthElement:Z}}function he(){Ua(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var M=e.config.showMonths;M--;){var O=Ae();e.yearElements.push(O.yearElement),e.monthElements.push(O.monthElement),e.monthNav.appendChild(O.container)}e.monthNav.appendChild(e.nextMonthNav)}function ke(){return e.monthNav=nt("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=nt("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=nt("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,he(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(M){e.__hidePrevMonthArrow!==M&&(hn(e.prevMonthNav,"flatpickr-disabled",M),e.__hidePrevMonthArrow=M)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(M){e.__hideNextMonthArrow!==M&&(hn(e.nextMonthNav,"flatpickr-disabled",M),e.__hideNextMonthArrow=M)}}),e.currentYearElement=e.yearElements[0],Sr(),e.monthNav}function we(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var M=go(e.config);e.timeContainer=nt("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var O=nt("span","flatpickr-time-separator",":"),Z=za("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=Z.getElementsByTagName("input")[0];var le=za("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=le.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=un(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?M.hours:f(M.hours)),e.minuteElement.value=un(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():M.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(Z),e.timeContainer.appendChild(O),e.timeContainer.appendChild(le),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var ye=za("flatpickr-second");e.secondElement=ye.getElementsByTagName("input")[0],e.secondElement.value=un(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():M.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(nt("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(ye)}return e.config.time_24hr||(e.amPM=nt("span","flatpickr-am-pm",e.l10n.amPM[On((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function Ve(){e.weekdayContainer?Ua(e.weekdayContainer):e.weekdayContainer=nt("div","flatpickr-weekdays");for(var M=e.config.showMonths;M--;){var O=nt("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(O)}return ve(),e.weekdayContainer}function ve(){if(e.weekdayContainer){var M=e.l10n.firstDayOfWeek,O=vd(e.l10n.weekdays.shorthand);M>0&&M<O.length&&(O=vd(O.splice(M,O.length),O.splice(0,M)));for(var Z=e.config.showMonths;Z--;)e.weekdayContainer.children[Z].innerHTML=`
      <span class='flatpickr-weekday'>
        `+O.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function Ie(){e.calendarContainer.classList.add("hasWeeks");var M=nt("div","flatpickr-weekwrapper");M.appendChild(nt("span","flatpickr-weekday",e.l10n.weekAbbreviation));var O=nt("div","flatpickr-weeks");return M.appendChild(O),{weekWrapper:M,weekNumbers:O}}function fe(M,O){O===void 0&&(O=!0);var Z=O?M:M-e.currentMonth;Z<0&&e._hidePrevMonthArrow===!0||Z>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=Z,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,mt("onYearChange"),me()),X(),mt("onMonthChange"),Sr())}function j(M,O){if(M===void 0&&(M=!0),O===void 0&&(O=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,O===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var Z=go(e.config),le=Z.hours,ye=Z.minutes,Fe=Z.seconds;p(le,ye,Fe)}e.redraw(),M&&mt("onChange")}function ne(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),mt("onClose")}function Q(){e.config!==void 0&&mt("onDestroy");for(var M=e._handlers.length;M--;)e._handlers[M].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var O=e.calendarContainer.parentNode;if(O.lastChild&&O.removeChild(O.lastChild),O.parentNode){for(;O.firstChild;)O.parentNode.insertBefore(O.firstChild,O);O.parentNode.removeChild(O)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(Z){try{delete e[Z]}catch{}})}function K(M){return e.calendarContainer.contains(M)}function de(M){if(e.isOpen&&!e.config.inline){var O=Ln(M),Z=K(O),le=O===e.input||O===e.altInput||e.element.contains(O)||M.path&&M.path.indexOf&&(~M.path.indexOf(e.input)||~M.path.indexOf(e.altInput)),ye=!le&&!Z&&!K(M.relatedTarget),Fe=!e.config.ignoredFocusElements.some(function(ze){return ze.contains(O)});ye&&Fe&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&l(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function De(M){if(!(!M||e.config.minDate&&M<e.config.minDate.getFullYear()||e.config.maxDate&&M>e.config.maxDate.getFullYear())){var O=M,Z=e.currentYear!==O;e.currentYear=O||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),Z&&(e.redraw(),mt("onYearChange"),me())}}function be(M,O){var Z;O===void 0&&(O=!0);var le=e.parseDate(M,void 0,O);if(e.config.minDate&&le&&Rn(le,e.config.minDate,O!==void 0?O:!e.minDateHasTime)<0||e.config.maxDate&&le&&Rn(le,e.config.maxDate,O!==void 0?O:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(le===void 0)return!1;for(var ye=!!e.config.enable,Fe=(Z=e.config.enable)!==null&&Z!==void 0?Z:e.config.disable,ze=0,Le=void 0;ze<Fe.length;ze++){if(Le=Fe[ze],typeof Le=="function"&&Le(le))return ye;if(Le instanceof Date&&le!==void 0&&Le.getTime()===le.getTime())return ye;if(typeof Le=="string"){var We=e.parseDate(Le,void 0,!0);return We&&We.getTime()===le.getTime()?ye:!ye}else if(typeof Le=="object"&&le!==void 0&&Le.from&&Le.to&&le.getTime()>=Le.from.getTime()&&le.getTime()<=Le.to.getTime())return ye}return!ye}function Me(M){return e.daysContainer!==void 0?M.className.indexOf("hidden")===-1&&M.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(M):!1}function pe(M){var O=M.target===e._input,Z=e._input.value.trimEnd()!==Yr();O&&Z&&!(M.relatedTarget&&K(M.relatedTarget))&&e.setDate(e._input.value,!0,M.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function Xe(M){var O=Ln(M),Z=e.config.wrap?t.contains(O):O===e._input,le=e.config.allowInput,ye=e.isOpen&&(!le||!Z),Fe=e.config.inline&&Z&&!le;if(M.keyCode===13&&Z){if(le)return e.setDate(e._input.value,!0,O===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),O.blur();e.open()}else if(K(O)||ye||Fe){var ze=!!e.timeContainer&&e.timeContainer.contains(O);switch(M.keyCode){case 13:ze?(M.preventDefault(),l(),$n()):on(M);break;case 27:M.preventDefault(),$n();break;case 8:case 46:Z&&!e.config.allowInput&&(M.preventDefault(),e.clear());break;case 37:case 39:if(!ze&&!Z){M.preventDefault();var Le=a();if(e.daysContainer!==void 0&&(le===!1||Le&&Me(Le))){var We=M.keyCode===39?1:-1;M.ctrlKey?(M.stopPropagation(),fe(We),ee(N(1),0)):ee(void 0,We)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:M.preventDefault();var Oe=M.keyCode===40?1:-1;e.daysContainer&&O.$i!==void 0||O===e.input||O===e.altInput?M.ctrlKey?(M.stopPropagation(),De(e.currentYear-Oe),ee(N(1),0)):ze||ee(void 0,Oe*7):O===e.currentYearElement?De(e.currentYear-Oe):e.config.enableTime&&(!ze&&e.hourElement&&e.hourElement.focus(),l(M),e._debouncedChange());break;case 9:if(ze){var Re=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(P){return P}),dt=Re.indexOf(O);if(dt!==-1){var k=Re[dt+(M.shiftKey?-1:1)];M.preventDefault(),(k||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(O)&&M.shiftKey&&(M.preventDefault(),e._input.focus());break;default:break}}if(e.amPM!==void 0&&O===e.amPM)switch(M.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],h(),ri();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],h(),ri();break}(Z||K(O))&&mt("onKeyDown",M)}function G(M,O){if(O===void 0&&(O="flatpickr-day"),!(e.selectedDates.length!==1||M&&(!M.classList.contains(O)||M.classList.contains("flatpickr-disabled")))){for(var Z=M?M.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),le=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),ye=Math.min(Z,e.selectedDates[0].getTime()),Fe=Math.max(Z,e.selectedDates[0].getTime()),ze=!1,Le=0,We=0,Oe=ye;Oe<Fe;Oe+=_d.DAY)be(new Date(Oe),!0)||(ze=ze||Oe>ye&&Oe<Fe,Oe<le&&(!Le||Oe>Le)?Le=Oe:Oe>le&&(!We||Oe<We)&&(We=Oe));var Re=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+O));Re.forEach(function(dt){var k=dt.dateObj,P=k.getTime(),A=Le>0&&P<Le||We>0&&P>We;if(A){dt.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(F){dt.classList.remove(F)});return}else if(ze&&!A)return;["startRange","inRange","endRange","notAllowed"].forEach(function(F){dt.classList.remove(F)}),M!==void 0&&(M.classList.add(Z<=e.selectedDates[0].getTime()?"startRange":"endRange"),le<Z&&P===le?dt.classList.add("startRange"):le>Z&&P===le&&dt.classList.add("endRange"),P>=Le&&(We===0||P<=We)&&gd(P,le,Z)&&dt.classList.add("inRange"))})}}function _t(){e.isOpen&&!e.config.static&&!e.config.inline&&Qt()}function qe(M,O){if(O===void 0&&(O=e._positionElement),e.isMobile===!0){if(M){M.preventDefault();var Z=Ln(M);Z&&Z.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),mt("onOpen");return}else if(e._input.disabled||e.config.inline)return;var le=e.isOpen;e.isOpen=!0,le||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),mt("onOpen"),Qt(O)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(M===void 0||!e.timeContainer.contains(M.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function it(M){return function(O){var Z=e.config["_"+M+"Date"]=e.parseDate(O,e.config.dateFormat),le=e.config["_"+(M==="min"?"max":"min")+"Date"];Z!==void 0&&(e[M==="min"?"minDateHasTime":"maxDateHasTime"]=Z.getHours()>0||Z.getMinutes()>0||Z.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(ye){return be(ye)}),!e.selectedDates.length&&M==="min"&&m(Z),ri()),e.daysContainer&&(Ki(),Z!==void 0?e.currentYearElement[M]=Z.getFullYear().toString():e.currentYearElement.removeAttribute(M),e.currentYearElement.disabled=!!le&&Z!==void 0&&le.getFullYear()===Z.getFullYear())}}function $e(){var M=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],O=mn(mn({},JSON.parse(JSON.stringify(t.dataset||{}))),n),Z={};e.config.parseDate=O.parseDate,e.config.formatDate=O.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(Re){e.config._enable=Un(Re)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(Re){e.config._disable=Un(Re)}});var le=O.mode==="time";if(!O.dateFormat&&(O.enableTime||le)){var ye=Vt.defaultConfig.dateFormat||ir.dateFormat;Z.dateFormat=O.noCalendar||le?"H:i"+(O.enableSeconds?":S":""):ye+" H:i"+(O.enableSeconds?":S":"")}if(O.altInput&&(O.enableTime||le)&&!O.altFormat){var Fe=Vt.defaultConfig.altFormat||ir.altFormat;Z.altFormat=O.noCalendar||le?"h:i"+(O.enableSeconds?":S K":" K"):Fe+(" h:i"+(O.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:it("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:it("max")});var ze=function(Re){return function(dt){e.config[Re==="min"?"_minTime":"_maxTime"]=e.parseDate(dt,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:ze("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:ze("max")}),O.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,Z,O);for(var Le=0;Le<M.length;Le++)e.config[M[Le]]=e.config[M[Le]]===!0||e.config[M[Le]]==="true";co.filter(function(Re){return e.config[Re]!==void 0}).forEach(function(Re){e.config[Re]=ho(e.config[Re]||[]).map(s)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var Le=0;Le<e.config.plugins.length;Le++){var We=e.config.plugins[Le](e)||{};for(var Oe in We)co.indexOf(Oe)>-1?e.config[Oe]=ho(We[Oe]).map(s).concat(e.config[Oe]):typeof O[Oe]>"u"&&(e.config[Oe]=We[Oe])}O.altInputClass||(e.config.altInputClass=Te().className+" "+e.config.altInputClass),mt("onParseConfig")}function Te(){return e.config.wrap?t.querySelector("[data-input]"):t}function bt(){typeof e.config.locale!="object"&&typeof Vt.l10ns[e.config.locale]>"u"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=mn(mn({},Vt.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?Vt.l10ns[e.config.locale]:void 0),Li.D="("+e.l10n.weekdays.shorthand.join("|")+")",Li.l="("+e.l10n.weekdays.longhand.join("|")+")",Li.M="("+e.l10n.months.shorthand.join("|")+")",Li.F="("+e.l10n.months.longhand.join("|")+")",Li.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var M=mn(mn({},n),JSON.parse(JSON.stringify(t.dataset||{})));M.time_24hr===void 0&&Vt.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=Vl(e),e.parseDate=mo({config:e.config,l10n:e.l10n})}function Qt(M){if(typeof e.config.position=="function")return void e.config.position(e,M);if(e.calendarContainer!==void 0){mt("onPreCalendarPosition");var O=M||e._positionElement,Z=Array.prototype.reduce.call(e.calendarContainer.children,function(Se,Pe){return Se+Pe.offsetHeight},0),le=e.calendarContainer.offsetWidth,ye=e.config.position.split(" "),Fe=ye[0],ze=ye.length>1?ye[1]:null,Le=O.getBoundingClientRect(),We=window.innerHeight-Le.bottom,Oe=Fe==="above"||Fe!=="below"&&We<Z&&Le.top>Z,Re=window.pageYOffset+Le.top+(Oe?-Z-2:O.offsetHeight+2);if(hn(e.calendarContainer,"arrowTop",!Oe),hn(e.calendarContainer,"arrowBottom",Oe),!e.config.inline){var dt=window.pageXOffset+Le.left,k=!1,P=!1;ze==="center"?(dt-=(le-Le.width)/2,k=!0):ze==="right"&&(dt-=le-Le.width,P=!0),hn(e.calendarContainer,"arrowLeft",!k&&!P),hn(e.calendarContainer,"arrowCenter",k),hn(e.calendarContainer,"arrowRight",P);var A=window.document.body.offsetWidth-(window.pageXOffset+Le.right),F=dt+le>window.document.body.offsetWidth,L=A+le>window.document.body.offsetWidth;if(hn(e.calendarContainer,"rightMost",F),!e.config.static)if(e.calendarContainer.style.top=Re+"px",!F)e.calendarContainer.style.left=dt+"px",e.calendarContainer.style.right="auto";else if(!L)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=A+"px";else{var R=Gn();if(R===void 0)return;var ie=window.document.body.offsetWidth,ce=Math.max(0,ie/2-le/2),ae=".flatpickr-calendar.centerMost:before",re=".flatpickr-calendar.centerMost:after",se=R.cssRules.length,_e="{left:"+Le.left+"px;right:auto;}";hn(e.calendarContainer,"rightMost",!1),hn(e.calendarContainer,"centerMost",!0),R.insertRule(ae+","+re+_e,se),e.calendarContainer.style.left=ce+"px",e.calendarContainer.style.right="auto"}}}}function Gn(){for(var M=null,O=0;O<document.styleSheets.length;O++){var Z=document.styleSheets[O];if(Z.cssRules){try{Z.cssRules}catch{continue}M=Z;break}}return M??ii()}function ii(){var M=document.createElement("style");return document.head.appendChild(M),M.sheet}function Ki(){e.config.noCalendar||e.isMobile||(me(),Sr(),X())}function $n(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function on(M){M.preventDefault(),M.stopPropagation();var O=function(Re){return Re.classList&&Re.classList.contains("flatpickr-day")&&!Re.classList.contains("flatpickr-disabled")&&!Re.classList.contains("notAllowed")},Z=Ll(Ln(M),O);if(Z!==void 0){var le=Z,ye=e.latestSelectedDateObj=new Date(le.dateObj.getTime()),Fe=(ye.getMonth()<e.currentMonth||ye.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=le,e.config.mode==="single")e.selectedDates=[ye];else if(e.config.mode==="multiple"){var ze=Va(ye);ze?e.selectedDates.splice(parseInt(ze),1):e.selectedDates.push(ye)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=ye,e.selectedDates.push(ye),Rn(ye,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(Re,dt){return Re.getTime()-dt.getTime()}));if(h(),Fe){var Le=e.currentYear!==ye.getFullYear();e.currentYear=ye.getFullYear(),e.currentMonth=ye.getMonth(),Le&&(mt("onYearChange"),me()),mt("onMonthChange")}if(Sr(),X(),ri(),!Fe&&e.config.mode!=="range"&&e.config.showMonths===1?T(le):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var We=e.config.mode==="single"&&!e.config.enableTime,Oe=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;(We||Oe)&&$n()}w()}}var Dn={locale:[bt,ve],showMonths:[he,o,Ve],minDate:[S],maxDate:[S],positionElement:[Cn],clickOpens:[function(){e.config.clickOpens===!0?(_(e._input,"focus",e.open),_(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function mi(M,O){if(M!==null&&typeof M=="object"){Object.assign(e.config,M);for(var Z in M)Dn[Z]!==void 0&&Dn[Z].forEach(function(le){return le()})}else e.config[M]=O,Dn[M]!==void 0?Dn[M].forEach(function(le){return le()}):co.indexOf(M)>-1&&(e.config[M]=ho(O));e.redraw(),ri(!0)}function qi(M,O){var Z=[];if(M instanceof Array)Z=M.map(function(le){return e.parseDate(le,O)});else if(M instanceof Date||typeof M=="number")Z=[e.parseDate(M,O)];else if(typeof M=="string")switch(e.config.mode){case"single":case"time":Z=[e.parseDate(M,O)];break;case"multiple":Z=M.split(e.config.conjunction).map(function(le){return e.parseDate(le,O)});break;case"range":Z=M.split(e.l10n.rangeSeparator).map(function(le){return e.parseDate(le,O)});break;default:break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(M)));e.selectedDates=e.config.allowInvalidPreload?Z:Z.filter(function(le){return le instanceof Date&&be(le,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(le,ye){return le.getTime()-ye.getTime()})}function Zt(M,O,Z){if(O===void 0&&(O=!1),Z===void 0&&(Z=e.config.dateFormat),M!==0&&!M||M instanceof Array&&M.length===0)return e.clear(O);qi(M,Z),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),S(void 0,O),m(),e.selectedDates.length===0&&e.clear(!1),ri(O),O&&mt("onChange")}function Un(M){return M.slice().map(function(O){return typeof O=="string"||typeof O=="number"||O instanceof Date?e.parseDate(O,void 0,!0):O&&typeof O=="object"&&O.from&&O.to?{from:e.parseDate(O.from,void 0),to:e.parseDate(O.to,void 0)}:O}).filter(function(O){return O})}function Ge(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var M=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);M&&qi(M,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function Ct(){if(e.input=Te(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=nt(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),Cn()}function Cn(){e._positionElement=e.config.positionElement||e._input}function Dt(){var M=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=nt("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=M,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=M==="datetime-local"?"Y-m-d\\TH:i:S":M==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch{}_(e.mobileInput,"change",function(O){e.setDate(Ln(O).value,!1,e.mobileFormatStr),mt("onChange"),mt("onClose")})}function Ii(M){if(e.isOpen===!0)return e.close();e.open(M)}function mt(M,O){if(e.config!==void 0){var Z=e.config[M];if(Z!==void 0&&Z.length>0)for(var le=0;Z[le]&&le<Z.length;le++)Z[le](e.selectedDates,e.input.value,e,O);M==="onChange"&&(e.input.dispatchEvent(Ra("change")),e.input.dispatchEvent(Ra("input")))}}function Ra(M){var O=document.createEvent("Event");return O.initEvent(M,!0,!0),O}function Va(M){for(var O=0;O<e.selectedDates.length;O++){var Z=e.selectedDates[O];if(Z instanceof Date&&Rn(Z,M)===0)return""+O}return!1}function Ns(M){return e.config.mode!=="range"||e.selectedDates.length<2?!1:Rn(M,e.selectedDates[0])>=0&&Rn(M,e.selectedDates[1])<=0}function Sr(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(M,O){var Z=new Date(e.currentYear,e.currentMonth,1);Z.setMonth(e.currentMonth+O),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[O].textContent=Wa(Z.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=Z.getMonth().toString(),M.value=Z.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function Yr(M){var O=M||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(Z){return e.formatDate(Z,O)}).filter(function(Z,le,ye){return e.config.mode!=="range"||e.config.enableTime||ye.indexOf(Z)===le}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function ri(M){M===void 0&&(M=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=Yr(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=Yr(e.config.altFormat)),M!==!1&&mt("onValueUpdate")}function Dl(M){var O=Ln(M),Z=e.prevMonthNav.contains(O),le=e.nextMonthNav.contains(O);Z||le?fe(Z?-1:1):e.yearElements.indexOf(O)>=0?O.select():O.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):O.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function Xr(M){M.preventDefault();var O=M.type==="keydown",Z=Ln(M),le=Z;e.amPM!==void 0&&Z===e.amPM&&(e.amPM.textContent=e.l10n.amPM[On(e.amPM.textContent===e.l10n.amPM[0])]);var ye=parseFloat(le.getAttribute("min")),Fe=parseFloat(le.getAttribute("max")),ze=parseFloat(le.getAttribute("step")),Le=parseInt(le.value,10),We=M.delta||(O?M.which===38?1:-1:0),Oe=Le+ze*We;if(typeof le.value<"u"&&le.value.length===2){var Re=le===e.hourElement,dt=le===e.minuteElement;Oe<ye?(Oe=Fe+Oe+On(!Re)+(On(Re)&&On(!e.amPM)),dt&&V(void 0,-1,e.hourElement)):Oe>Fe&&(Oe=le===e.hourElement?Oe-Fe-On(!e.amPM):ye,dt&&V(void 0,1,e.hourElement)),e.amPM&&Re&&(ze===1?Oe+Le===23:Math.abs(Oe-Le)>ze)&&(e.amPM.textContent=e.l10n.amPM[On(e.amPM.textContent===e.l10n.amPM[0])]),le.value=un(Oe)}}return r(),e}function aa(t,n){for(var e=Array.prototype.slice.call(t).filter(function(s){return s instanceof HTMLElement}),i=[],r=0;r<e.length;r++){var a=e[r];try{if(a.getAttribute("data-fp-omit")!==null)continue;a._flatpickr!==void 0&&(a._flatpickr.destroy(),a._flatpickr=void 0),a._flatpickr=k1(a,n||{}),i.push(a._flatpickr)}catch(s){console.error(s)}}return i.length===1?i[0]:i}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(t){return aa(this,t)},HTMLElement.prototype.flatpickr=function(t){return aa([this],t)});var Vt=function(t,n){return typeof t=="string"?aa(window.document.querySelectorAll(t),n):t instanceof Node?aa([t],n):aa(t,n)};Vt.defaultConfig={};Vt.l10ns={en:mn({},uo),default:mn({},uo)};Vt.localize=function(t){Vt.l10ns.default=mn(mn({},Vt.l10ns.default),t)};Vt.setDefaults=function(t){Vt.defaultConfig=mn(mn({},Vt.defaultConfig),t)};Vt.parseDate=mo({});Vt.formatDate=Vl({});Vt.compareDates=Rn;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(t){return aa(this,t)});Date.prototype.fp_incr=function(t){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof t=="string"?parseInt(t,10):t))};typeof window<"u"&&(window.flatpickr=Vt);var rr=Vt;var E1=["fileInput"],T1=["dateInput"];function A1(t,n){t&1&&(d(0,"div",106)(1,"div",85),B(),d(2,"svg",19),D(3,"path",88),u(),q(),d(4,"div")(5,"p",107),g(6,"Duplicating Asset"),u(),d(7,"p",108),g(8,"Most fields have been pre-filled. Please enter a new serial number and review all information before saving."),u()()()())}function M1(t,n){if(t&1&&(d(0,"div",109),B(),d(1,"svg",110),D(2,"path",111),u(),g(3),u()),t&2){let e=b();x(3),xe(" ",e.nameError," ")}}function D1(t,n){t&1&&(d(0,"span",84),g(1,"Select parent asset"),u())}function F1(t,n){if(t&1&&(d(0,"span",112),g(1),u()),t&2){let e=b();x(),Ft(" ",e.getSelectedParent().name," (",e.getSelectedParent().asset_id,") ")}}function I1(t,n){if(t&1){let e=ue();d(0,"button",116),Y("click",function(){let r=U(e).$implicit,a=b(2);return a.parent_id=r.id,z(a.showParentDropdown=!1)}),d(1,"div",28)(2,"div",118),B(),d(3,"svg",119),D(4,"path",54),u()(),q(),d(5,"div")(6,"div",120),g(7),u(),d(8,"div",121),g(9),u()()()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",i.parent_id===e.id),x(7),oe(e.name),x(2),oe(e.asset_id)}}function P1(t,n){if(t&1){let e=ue();d(0,"div",113)(1,"div",114)(2,"div",115),g(3,"Select parent asset"),u(),d(4,"button",116),Y("click",function(){U(e);let r=b();return r.parent_id=null,z(r.showParentDropdown=!1)}),g(5," -- None -- "),u(),J(6,I1,10,4,"button",117),u()()}if(t&2){let e=b();x(4),ge("bg-blue-50",!e.parent_id),x(2),C("ngForOf",e.possibleParents)}}function O1(t,n){t&1&&(d(0,"span",84),g(1,"Select asset type"),u())}function L1(t,n){if(t&1){let e=ue();d(0,"img",125),Y("error",function(r){U(e);let a=b(2);return z(a.onAssetTypeIconError(r,a.selectedAssetType))}),u()}if(t&2){let e=b(2);C("src",e.selectedAssetType.icon,kt)("alt",e.selectedAssetType.name||e.selectedAssetType.label)}}function R1(t,n){if(t&1&&(B(),d(0,"svg",126),D(1,"path",127),u()),t&2){let e=b(2);yt("color",e.selectedAssetType.color)}}function V1(t,n){if(t&1&&(d(0,"div",28)(1,"div",122),J(2,L1,1,2,"img",123)(3,R1,2,2,"svg",124),u(),d(4,"span",112),g(5),u()()),t&2){let e=b();x(),yt("background-color",e.selectedAssetType.color+"20"),x(),C("ngIf",e.selectedAssetType.icon&&!e.selectedAssetType.iconError),x(),C("ngIf",!e.selectedAssetType.icon||e.selectedAssetType.iconError),x(2),oe(e.selectedAssetType.label)}}function N1(t,n){if(t&1){let e=ue();d(0,"img",133),Y("error",function(r){U(e);let a=b().$implicit,s=b(2);return z(s.onAssetTypeIconError(r,a))}),u()}if(t&2){let e=b().$implicit;C("src",e.icon,kt)("alt",e.name||e.label)}}function B1(t,n){t&1&&(B(),d(0,"svg",19),D(1,"path",127),u())}function H1(t,n){if(t&1){let e=ue();d(0,"button",116),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.selectAssetType(r))}),d(1,"div",28)(2,"div",129),J(3,N1,1,2,"img",130)(4,B1,2,0,"svg",131),u(),d(5,"div")(6,"div",120),g(7),u(),d(8,"div",132),g(9),u()()()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",(i.selectedAssetType==null?null:i.selectedAssetType.id)===e.id)("text-blue-700",(i.selectedAssetType==null?null:i.selectedAssetType.id)===e.id),x(3),C("ngIf",e.icon&&!e.iconError),x(),C("ngIf",!e.icon||e.iconError),x(3),oe(e.label||e.name),x(2),oe(e.description)}}function U1(t,n){if(t&1&&(d(0,"div",113)(1,"div",114)(2,"div",115),g(3,"Select asset type"),u(),J(4,H1,10,8,"button",128),u()()),t&2){let e=b();x(4),C("ngForOf",e.assetTypes)}}function z1(t,n){if(t&1&&(d(0,"div",109),B(),d(1,"svg",110),D(2,"path",111),u(),g(3),u()),t&2){let e=b();x(3),xe(" ",e.assetTypeError," ")}}function W1(t,n){t&1&&(d(0,"span",84),g(1,"Select category"),u())}function j1(t,n){if(t&1&&(d(0,"span",112),g(1),u()),t&2){let e=b();x(),oe(e.selectedCategory.name)}}function G1(t,n){if(t&1){let e=ue();d(0,"img",133),Y("error",function(r){U(e);let a=b().$implicit,s=b(2);return z(s.onCategoryIconError(r,a))}),u()}if(t&2){let e=b().$implicit;C("src",e.icon,kt)("alt",e.name)}}function $1(t,n){t&1&&(B(),d(0,"svg",119),D(1,"path",54),u())}function Y1(t,n){if(t&1&&(d(0,"div",132),g(1),u()),t&2){let e=b().$implicit;x(),oe(e.description)}}function X1(t,n){if(t&1){let e=ue();d(0,"button",116),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.selectCategory(r))}),d(1,"div",28)(2,"div",118),J(3,G1,1,2,"img",130)(4,$1,2,0,"svg",134),u(),d(5,"div")(6,"div",120),g(7),u(),J(8,Y1,2,1,"div",86),u()()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",(i.selectedCategory==null?null:i.selectedCategory.id)===e.id)("text-blue-700",(i.selectedCategory==null?null:i.selectedCategory.id)===e.id),x(3),C("ngIf",e.icon),x(),C("ngIf",!e.icon||e.iconError),x(3),oe(e.name),x(),C("ngIf",e.description)}}function K1(t,n){if(t&1&&(d(0,"div",113)(1,"div",114)(2,"div",115),g(3,"Select category"),u(),J(4,X1,9,8,"button",128),u()()),t&2){let e=b();x(4),C("ngForOf",e.categories)}}function q1(t,n){if(t&1&&(d(0,"div",109),B(),d(1,"svg",110),D(2,"path",111),u(),g(3),u()),t&2){let e=b();x(3),xe(" ",e.categoryError," ")}}function J1(t,n){if(t&1&&(d(0,"div",109),B(),d(1,"svg",110),D(2,"path",111),u(),g(3),u()),t&2){let e=b();x(3),xe(" ",e.serialNumberError," ")}}function Q1(t,n){t&1&&(d(0,"span",84),g(1,"Select location"),u())}function Z1(t,n){if(t&1&&(d(0,"div",28)(1,"div",135),B(),d(2,"svg",136),D(3,"path",78)(4,"path",79),u()(),q(),d(5,"span",112),g(6),u()()),t&2){let e=b();x(6),oe(e.selectedLocation.name)}}function eg(t,n){if(t&1&&(d(0,"div",132),g(1),u()),t&2){let e=b().$implicit;x(),oe(e.type.name)}}function tg(t,n){if(t&1){let e=ue();d(0,"button",116),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.selectLocation(r))}),d(1,"div",28)(2,"div",137),B(),d(3,"svg",77),D(4,"path",78)(5,"path",79),u()(),q(),d(6,"div")(7,"div",120),g(8),u(),J(9,eg,2,1,"div",86),u()()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",(i.selectedLocation==null?null:i.selectedLocation.id)===e.id)("text-blue-700",(i.selectedLocation==null?null:i.selectedLocation.id)===e.id),x(8),oe(e.name),x(),C("ngIf",e.type)}}function ng(t,n){if(t&1&&(d(0,"div",113)(1,"div",114)(2,"div",115),g(3,"Select location"),u(),J(4,tg,10,6,"button",128),u()()),t&2){let e=b();x(4),C("ngForOf",e.locations)}}function ig(t,n){t&1&&(d(0,"span",84),g(1,"Select department"),u())}function rg(t,n){if(t&1&&(d(0,"div",28)(1,"div",138),B(),d(2,"svg",139),D(3,"path",140),u()(),q(),d(4,"span",112),g(5),u()()),t&2){let e=b();x(5),oe(e.selectedDepartment.name)}}function ag(t,n){if(t&1&&(d(0,"div",132),g(1),u()),t&2){let e=b().$implicit;x(),oe(e.description)}}function sg(t,n){if(t&1&&(d(0,"div",143),g(1),u()),t&2){let e=b().$implicit;x(),xe("Code: ",e.code,"")}}function og(t,n){if(t&1){let e=ue();d(0,"button",116),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.selectDepartment(r))}),d(1,"div",28)(2,"div",141),B(),d(3,"svg",53),D(4,"path",140),u()(),q(),d(5,"div")(6,"div",120),g(7),u(),J(8,ag,2,1,"div",86)(9,sg,2,1,"div",142),u()()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",(i.selectedDepartment==null?null:i.selectedDepartment.id)===e.id)("text-blue-700",(i.selectedDepartment==null?null:i.selectedDepartment.id)===e.id),x(7),oe(e.name),x(),C("ngIf",e.description),x(),C("ngIf",e.code)}}function lg(t,n){if(t&1&&(d(0,"div",113)(1,"div",114)(2,"div",115),g(3,"Select department"),u(),J(4,og,10,7,"button",128),u()()),t&2){let e=b();x(4),C("ngForOf",e.departments)}}function cg(t,n){if(t&1&&(d(0,"div",28),D(1,"div",144),d(2,"span",112),g(3),u()()),t&2){let e=b();x(),yt("background-color",e.selectedStatus.hexColor||"#6B7280"),x(2),oe(e.selectedStatus.label)}}function dg(t,n){if(t&1){let e=ue();d(0,"button",116),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.selectStatus(r))}),d(1,"div",28)(2,"div"),D(3,"div",144),u(),d(4,"div")(5,"div",120),g(6),u(),d(7,"div",132),g(8),u()()()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",(i.selectedStatus==null?null:i.selectedStatus.value)===e.value)("text-blue-700",(i.selectedStatus==null?null:i.selectedStatus.value)===e.value),x(2),Ot("w-6 h-6 bg-"+e.color+"-100 rounded-lg flex items-center justify-center"),x(),yt("background-color",e.hexColor||"#6B7280"),x(3),oe(e.label),x(2),oe(e.description)}}function fg(t,n){if(t&1&&(d(0,"div",145)(1,"div",114)(2,"div",115),g(3,"Select status"),u(),J(4,dg,9,10,"button",128),u()()),t&2){let e=b();x(4),C("ngForOf",e.statusOptions)}}function ug(t,n){if(t&1){let e=ue();d(0,"span"),g(1),d(2,"button",149),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.removeTag(r))}),B(),d(3,"svg",150),D(4,"path",151),u()()()}if(t&2){let e=n.$implicit;Ot("inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-"+e.color+"-100 text-"+e.color+"-800"),x(),xe(" ",e.name," ")}}function hg(t,n){if(t&1&&(d(0,"div",146)(1,"div",147),J(2,ug,5,3,"span",148),u()()),t&2){let e=b();x(2),C("ngForOf",e.selectedTags)}}function mg(t,n){if(t&1&&(d(0,"span",132),g(1),u()),t&2){let e=b();x(),xe(" ",e.selectedTags.length," selected ")}}function pg(t,n){t&1&&(d(0,"div",156),B(),d(1,"svg",126),D(2,"path",157),u()())}function gg(t,n){if(t&1){let e=ue();d(0,"button",116),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.toggleTag(r))}),d(1,"div",34)(2,"div",28)(3,"div"),D(4,"div"),u(),d(5,"span",120),g(6),u()(),J(7,pg,3,0,"div",155),u()()}if(t&2){let e=n.$implicit,i=b(2);ge("bg-blue-50",i.isTagSelected(e)),x(3),Ot("w-6 h-6 bg-"+e.color+"-100 rounded-full flex items-center justify-center"),x(),Ot("w-3 h-3 rounded-full bg-"+e.color+"-500"),x(2),oe(e.name),x(),C("ngIf",i.isTagSelected(e))}}function xg(t,n){if(t&1){let e=ue();d(0,"div",113)(1,"div",114)(2,"div",152)(3,"div",67)(4,"input",153),ot("ngModelChange",function(r){U(e);let a=b();return st(a.newTagInput,r)||(a.newTagInput=r),z(r)}),Y("keydown",function(r){U(e);let a=b();return z(a.onTagInputKeydown(r))})("click",function(r){return U(e),z(r.stopPropagation())}),u(),d(5,"div",154),g(6," Press Enter "),u()()(),d(7,"div",115),g(8,"Select tags"),u(),J(9,gg,8,8,"button",117),u()()}if(t&2){let e=b();x(4),at("ngModel",e.newTagInput),x(5),C("ngForOf",e.availableTags)}}function _g(t,n){if(t&1){let e=ue();d(0,"button",177),Y("click",function(){U(e);let r=b().index,a=b(2);return z(a.moveImageUp(r))}),B(),d(1,"svg",126),D(2,"path",178),u()()}}function vg(t,n){if(t&1){let e=ue();d(0,"button",177),Y("click",function(){U(e);let r=b().index,a=b(2);return z(a.moveImageDown(r))}),B(),d(1,"svg",126),D(2,"path",38),u()()}}function wg(t,n){if(t&1){let e=ue();d(0,"div",167)(1,"div",168)(2,"img",169),Y("error",function(r){let a=U(e).index,s=b(2);return z(s.onImageError(r,a))})("load",function(r){let a=U(e).index,s=b(2);return z(s.onImageLoad(r,a))}),u(),d(3,"div",170)(4,"div",171),J(5,_g,3,0,"button",172)(6,vg,3,0,"button",172),u()(),d(7,"button",173),Y("click",function(){let r=U(e).index,a=b(2);return z(a.removeImage(r))}),B(),d(8,"svg",126),D(9,"path",151),u()(),q(),d(10,"div",174),g(11),u()(),d(12,"div",175)(13,"p",176),g(14),u(),d(15,"p",121),g(16),u()()()}if(t&2){let e,i=n.$implicit,r=n.index,a=b(2);x(2),C("src",i,kt)("alt","Asset Image "+(r+1)),x(3),C("ngIf",r>0),x(),C("ngIf",r<a.imagePreviewUrls.length-1),x(5),xe(" ",r+1," "),x(3),oe(a.images[r].name),x(2),xe("",(((e=a.images[r].size)!==null&&e!==void 0?e:0)/1024/1024).toFixed(1)," MB")}}function bg(t,n){if(t&1){let e=ue();d(0,"div",158)(1,"div",159)(2,"h4",160),g(3),u(),d(4,"button",161),Y("click",function(){U(e);let r=b();return z(r.removeAllImages())}),g(5," Remove All "),u()(),d(6,"div",162),J(7,wg,17,7,"div",163),u(),d(8,"div",164)(9,"div",85),B(),d(10,"svg",165),D(11,"path",88),u(),q(),d(12,"p",166)(13,"strong"),g(14,"Gallery Tips:"),u(),g(15," Hover over images to reorder them. The first image will be the primary asset image. "),u()()()()}if(t&2){let e=b();x(3),xe("Selected Images (",e.imagePreviewUrls.length,")"),x(4),C("ngForOf",e.imagePreviewUrls)}}function yg(t,n){if(t&1&&(d(0,"div",179)(1,"div",85),B(),d(2,"svg",180),D(3,"path",111),u(),q(),d(4,"p",181),g(5),u()()()),t&2){let e=b();x(5),oe(e.submitError)}}function Sg(t,n){if(t&1&&(d(0,"div",182)(1,"div",85),B(),d(2,"svg",58),D(3,"path",157),u(),q(),d(4,"p",183),g(5),u()()()),t&2){let e=b();x(5),oe(e.submitSuccess)}}function Cg(t,n){t&1&&(d(0,"span",85),B(),d(1,"svg",184),D(2,"path",96),u(),q(),d(3,"span"),g(4,"Create Asset"),u()())}function kg(t,n){t&1&&(d(0,"span",85),B(),d(1,"svg",185),D(2,"circle",186)(3,"path",187),u(),q(),d(4,"span"),g(5,"Creating Asset..."),u()())}var xo=class t{constructor(n,e,i,r){this.assetService=n;this.router=e;this.route=i;this.http=r}dateInputs;fileInput;flatpickrInstances=[];name="";description="";serial_number="";model="";manufacturer="";purchase_date="";purchase_price=null;depreciation=null;depreciation_life=null;location_id=null;department_id=null;warranty="";insurance="";health_score=85;status=null;tags=[];images=[];imagePreviewUrls=[];meta={};isSubmitting=!1;isDragOver=!1;submitError="";submitSuccess="";submitFieldErrors={};locations=[];availableTags=[];departments=[];possibleParents=[];parent_id=null;showAssetTypeDropdown=!1;showCategoryDropdown=!1;showLocationDropdown=!1;showStatusDropdown=!1;showTagsDropdown=!1;showDepartmentDropdown=!1;showParentDropdown=!1;selectedAssetType=null;selectedCategory=null;selectedLocation=null;selectedStatus=null;selectedDepartment=null;selectedTags=[];newTagInput="";nameError="";assetTypeError="";categoryError="";serialNumberError="";address="";onFileChange(n){if(n.target.files&&n.target.files.length){let e=Array.from(n.target.files);this.processFiles(e),n.target.value=""}}onDragOver(n){n.preventDefault(),n.stopPropagation(),this.isDragOver=!0}onDragLeave(n){n.preventDefault(),n.stopPropagation(),this.isDragOver=!1}onDrop(n){n.preventDefault(),n.stopPropagation(),this.isDragOver=!1;let e=n.dataTransfer?.files;if(e&&e.length>0){let i=Array.from(e).filter(r=>r.type.startsWith("image/"));i.length>0&&this.processFiles(i)}}processFiles(n){let i=["image/jpeg","image/png","image/gif","image/webp"],r=[],a=[];for(let s of n){if(!i.includes(s.type)){console.warn("Invalid file type:",s.name);continue}if(s.size>10*1024*1024){console.warn("File too large:",s.name);continue}if(this.images.some(c=>c.name===s.name&&c.size===s.size)){console.warn("Duplicate file skipped:",s.name);continue}if(this.images.length+r.length>=10){console.warn("Max image count exceeded:",s.name);break}r.push(s);let l=new FileReader;l.onload=c=>{c.target?.result&&this.imagePreviewUrls.push(c.target.result)},l.onerror=c=>{console.error("Preview failed for:",s.name,c)},l.readAsDataURL(s)}this.images=[...this.images,...r]}onSubmit(){this.clearErrors(),this.validateForm()&&(this.isSubmitting=!0,this.submitError="",this.submitSuccess="",this.submitFieldErrors={},this.convertImagesToBase64().then(n=>{let e={name:this.name,description:this.description,category_id:this.category_id,type:this.assetType,serial_number:this.serial_number,model:this.model,manufacturer:this.manufacturer,purchase_date:this.purchase_date?this.convertDateToBackendFormat(this.purchase_date):null,purchase_price:this.purchase_price,depreciation:this.depreciation,depreciation_life:this.depreciation_life,location_id:this.location_id,department_id:this.department_id,parent_id:this.parent_id,warranty:this.warranty,insurance:this.insurance,health_score:this.health_score,status:this.status,tags:this.selectedTags.map(i=>i.name),meta:this.meta,images:n};this.assetService.createAsset(e).subscribe({next:i=>{this.isSubmitting=!1,i.success?(this.submitSuccess="Asset created successfully!",setTimeout(()=>{this.router.navigate(["/assets/list"])},2e3)):(this.submitError=i.message||"Failed to create asset.",this.handleFieldErrors(i.errors||{}))},error:i=>{this.isSubmitting=!1,this.submitError=i.error?.message||"Failed to create asset.",this.handleFieldErrors(i.error?.errors||i.errors||{})}})}).catch(n=>{this.isSubmitting=!1,this.submitError="Failed to process images. Please try again.",console.error("Image conversion error:",n)}))}healthScore=85;categories=[];category_id=null;assetTypes=[];assetType=null;assetTypesFromAPI=[];statusOptionsFromAPI=[];statusOptions=[{value:1,label:"Active",color:"green",description:"Asset is operational and in use",sort_order:1},{value:2,label:"Maintenance",color:"orange",description:"Asset is under maintenance or repair",sort_order:2},{value:3,label:"Inactive",color:"gray",description:"Asset is not currently in use",sort_order:3},{value:4,label:"Retired",color:"red",description:"Asset is retired and no longer in service",sort_order:4}];ngOnInit(){this.route.queryParams.subscribe(n=>{n.duplicate&&n.sourceId&&this.loadAssetForDuplication(n.sourceId)}),this.assetService.getAssetCategories().subscribe(n=>{n.success&&n.data?.categories&&(this.categories=n.data.categories)}),this.assetService.getAssetTypes().subscribe(n=>{n.success&&n.data&&(this.assetTypesFromAPI=n.data,this.assetTypes=this.assetTypesFromAPI.map(e=>({id:e.id,name:e.name,label:e.name,icon:e.icon,color:this.getColorForType(e.name),description:`${e.name} asset type`,iconError:!1})))}),this.assetService.getAssetStatuses().subscribe(n=>{n.success&&n.data&&(this.statusOptionsFromAPI=n.data,this.statusOptions=this.statusOptionsFromAPI.map(e=>({id:e.id,value:e.id,label:e.name,color:this.hexToTailwindColor(e.color),description:e.description||`Asset is ${e.name.toLowerCase()}`,hexColor:e.color,sort_order:e.sort_order})),this.statusOptions.sort((e,i)=>e.sort_order-i.sort_order),this.statusOptions.length>0&&(this.selectedStatus=this.statusOptions[0],this.status=this.selectedStatus.value))}),this.assetService.getLocations().subscribe(n=>{n.success&&n.data&&(this.locations=n.data.locations||n.data)}),this.assetService.getDepartments().subscribe(n=>{n.success&&n.data&&(this.departments=n.data)}),this.assetService.getAssets({per_page:1e3}).subscribe(n=>{n.success&&n.data?.assets&&(this.possibleParents=n.data.assets)}),this.loadAvailableTags()}ngAfterViewInit(){setTimeout(()=>{this.initializeFlatpickr()},100)}ngOnDestroy(){this.flatpickrInstances.forEach(n=>{n&&n.destroy()})}initializeFlatpickr(){this.flatpickrInstances.forEach(n=>{n&&n.destroy()}),this.flatpickrInstances=[],setTimeout(()=>{this.dateInputs?(console.log("Found date inputs:",this.dateInputs.length),this.dateInputs.forEach((n,e)=>{if(n?.nativeElement){let i=n.nativeElement,r=i.getAttribute("name");if(console.log("Processing date input:",r),r==="purchase_date"){console.log("Initializing Flatpickr for purchase_date");let s=rr(i,{dateFormat:"d M, Y",allowInput:!0,clickOpens:!0,maxDate:"today",onChange:(o,l)=>{console.log("Date selected:",l),this.purchase_date=l}});this.flatpickrInstances.push(s),console.log("Flatpickr initialized successfully for purchase_date")}}})):console.warn("No date inputs found")},50)}loadAvailableTags(){this.availableTags=[{id:1,name:"Critical",color:"red"},{id:2,name:"High Priority",color:"orange"},{id:3,name:"Equipment",color:"blue"},{id:4,name:"IT Hardware",color:"purple"},{id:5,name:"Furniture",color:"green"},{id:6,name:"Vehicle",color:"yellow"},{id:7,name:"Safety Equipment",color:"red"},{id:8,name:"Office Supplies",color:"gray"}]}loadAssetForDuplication(n){this.assetService.getAsset(n).subscribe({next:e=>{if(e.success){let i=e.data.asset||e.data;this.populateFormFromSource(i)}},error:e=>{console.error("Error loading source asset for duplication:",e)}})}populateFormFromSource(n){this.name=n.name?`${n.name} (Copy)`:"",this.description=n.description||"",this.model=n.model||"",this.manufacturer=n.manufacturer||"",this.purchase_date=n.purchase_date?this.convertBackendDateToDisplay(n.purchase_date):"",this.purchase_price=n.purchase_price||null,this.depreciation=n.depreciation||null,this.depreciation_life=n.depreciation_life||null,this.location_id=n.location_id||null,this.department_id=n.department_id||null,this.warranty=n.warranty?this.convertBackendDateToDisplay(n.warranty):"",this.insurance=n.insurance||"",this.health_score=n.health_score||85,this.status=n.status||"Active",setTimeout(()=>{n.type&&(this.selectedAssetType=this.assetTypes.find(e=>e.id==n.type||e.id===parseInt(n.type))||null,this.selectedAssetType&&(this.assetType=this.selectedAssetType.id)),n.category_id&&(this.selectedCategory=this.categories.find(e=>e.id===n.category_id)||null,this.category_id=n.category_id),n.location_id&&(this.selectedLocation=this.locations.find(e=>e.id===n.location_id)||null),n.department_id&&(this.selectedDepartment=this.departments.find(e=>e.id===n.department_id)||null),n.status&&(this.selectedStatus=this.statusOptions.find(e=>e.value===n.status||e.label===n.status||e.id===n.status)||null,this.selectedStatus&&(this.status=this.selectedStatus.value)),!this.selectedStatus&&this.statusOptions.length>0&&(this.selectedStatus=this.statusOptions[0],this.status=this.selectedStatus.value),n.tags&&Array.isArray(n.tags)&&(this.selectedTags=n.tags.map(e=>this.availableTags.find(i=>i.id===e.id)||e)),this.clearErrors()},500),this.serial_number="",n.images&&Array.isArray(n.images)&&n.images.length>0&&this.duplicateImages(n.images)}goBack(){this.router.navigate(["/assets/list"])}toggleAssetTypeDropdown(){this.showAssetTypeDropdown=!this.showAssetTypeDropdown,this.showCategoryDropdown=!1,this.showLocationDropdown=!1}toggleCategoryDropdown(){this.showCategoryDropdown=!this.showCategoryDropdown,this.showAssetTypeDropdown=!1,this.showLocationDropdown=!1}toggleLocationDropdown(){this.showLocationDropdown=!this.showLocationDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showStatusDropdown=!1}toggleStatusDropdown(){this.showStatusDropdown=!this.showStatusDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showTagsDropdown=!1}toggleTagsDropdown(){this.showTagsDropdown=!this.showTagsDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showDepartmentDropdown=!1}toggleDepartmentDropdown(){this.showDepartmentDropdown=!this.showDepartmentDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showTagsDropdown=!1}selectAssetType(n){this.selectedAssetType=n,this.assetType=n.id,this.showAssetTypeDropdown=!1,this.clearErrors()}selectCategory(n){this.selectedCategory=n,this.category_id=n.id,this.showCategoryDropdown=!1,this.clearErrors()}selectLocation(n){this.selectedLocation=n,this.location_id=n.id,this.showLocationDropdown=!1}selectStatus(n){this.selectedStatus=n,this.status=n.value,this.showStatusDropdown=!1}selectDepartment(n){this.selectedDepartment=n,this.department_id=n.id,this.showDepartmentDropdown=!1}toggleTag(n){let e=this.selectedTags.findIndex(i=>i.id===n.id);e>-1?this.selectedTags.splice(e,1):this.selectedTags.push(n)}isTagSelected(n){return this.selectedTags.some(e=>e.id===n.id)}onTagInputKeydown(n){n.key==="Enter"&&(n.preventDefault(),this.createNewTag())}createNewTag(){let n=this.newTagInput.trim();if(n&&!this.selectedTags.some(e=>e.name.toLowerCase()===n.toLowerCase())){let e=["red","blue","green","yellow","purple","pink","indigo","gray"],i=e[Math.floor(Math.random()*e.length)],r={id:Date.now(),name:n,color:i,isNew:!0};this.selectedTags.push(r),this.newTagInput=""}}removeTag(n){let e=this.selectedTags.findIndex(i=>i.id===n.id);e>-1&&this.selectedTags.splice(e,1)}onDocumentClick(n){this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showTagsDropdown=!1,this.showDepartmentDropdown=!1}validateForm(){let n=!0;if(!this.name||this.name.trim().length===0?(this.nameError="Asset name is required",n=!1):this.name.trim().length>100&&(this.nameError="Asset name cannot exceed 100 characters",n=!1),this.description&&this.description.length>1e3&&(this.submitError="Description cannot exceed 1000 characters",n=!1),!this.serial_number||this.serial_number.trim().length===0?(this.serialNumberError="Serial number is required",n=!1):this.serial_number.length>100&&(this.serialNumberError="Serial number cannot exceed 100 characters",n=!1),this.model&&this.model.length>100&&(this.submitError="Model cannot exceed 100 characters",n=!1),this.manufacturer&&this.manufacturer.length>100&&(this.submitError="Manufacturer cannot exceed 100 characters",n=!1),this.warranty&&this.warranty.length>255&&(this.submitError="Warranty cannot exceed 255 characters",n=!1),this.insurance&&this.insurance.length>255&&(this.submitError="Insurance cannot exceed 255 characters",n=!1),this.purchase_price!==null&&this.purchase_price<0&&(this.submitError="Purchase price cannot be negative",n=!1),this.depreciation!==null&&(this.depreciation<0||this.depreciation>100)&&(this.submitError="Depreciation must be between 0 and 100",n=!1),this.depreciation_life!==null&&(this.depreciation_life<1||this.depreciation_life>100)&&(this.submitError="Depreciation life must be between 1 and 100 years",n=!1),this.purchase_date){let e=new Date;new Date(this.purchase_date)>e&&(this.submitError="Purchase date cannot be in the future",n=!1)}return(this.health_score<0||this.health_score>100)&&(this.submitError="Health score must be between 0 and 100",n=!1),this.category_id||(this.categoryError="Category is required",n=!1),this.assetType||(this.assetTypeError="Asset type is required",n=!1),n}clearErrors(){this.nameError="",this.assetTypeError="",this.categoryError="",this.serialNumberError="",this.submitError="",this.submitSuccess=""}handleFieldErrors(n){n.name&&(this.nameError=n.name[0]),n.type&&(this.assetTypeError=n.type[0]),n.category_id&&(this.categoryError=n.category_id[0]),n.serial_number&&(this.serialNumberError=n.serial_number[0])}isFormValid(){return!!(this.name&&this.name.trim().length>0&&this.name.trim().length<=100)}removeImage(n){this.images.splice(n,1),this.imagePreviewUrls.splice(n,1)}removeAllImages(){this.images=[],this.imagePreviewUrls=[]}moveImage(n,e){if(e>=0&&e<this.images.length){let i=this.images.splice(n,1)[0];this.images.splice(e,0,i);let r=this.imagePreviewUrls.splice(n,1)[0];this.imagePreviewUrls.splice(e,0,r)}}moveImageUp(n){n>0&&this.moveImage(n,n-1)}moveImageDown(n){n<this.images.length-1&&this.moveImage(n,n+1)}getTodayDate(){return new Date().toISOString().split("T")[0]}convertDateToBackendFormat(n){if(!n)return"";try{let e=new Date(n);if(isNaN(e.getTime()))return n;let i=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${i}-${r}-${a}`}catch(e){return console.error("Date conversion error:",e),n}}convertBackendDateToDisplay(n){if(!n)return"";try{let e=new Date(n);if(isNaN(e.getTime()))return n;let i={day:"2-digit",month:"short",year:"numeric"};return e.toLocaleDateString("en-GB",i).replace(/,/g,",")}catch(e){return console.error("Date conversion error:",e),n}}getIconFromPath(n){return n&&(n.split("/").pop()||"").replace(".svg","")||"cube"}getColorForType(n){return{"Fixed Asset":"#2563eb","Semi-Fixed Asset":"#22c55e","Mobile Asset":"#f59e42","Fleet Asset":"#a855f7","IT Equipment":"#3b82f6",Furniture:"#10b981",Vehicle:"#f59e0b",Machinery:"#ef4444",Electronics:"#8b5cf6",Tools:"#f97316"}[n]||"#6b7280"}hexToTailwindColor(n){return{"#10B981":"green","#F59E0B":"orange","#9CA3AF":"gray","#EF4444":"red","#6B7280":"gray","#22C55E":"green","#3B82F6":"blue","#8B5CF6":"purple","#F97316":"orange"}[n.toUpperCase()]||"gray"}onImageError(n,e){console.error("Image failed to load at index:",e),console.error("Image src:",n.target.src),console.error("Image file:",this.images[e]),n.target.style.display="none"}onImageLoad(n,e){console.log("Image loaded successfully at index:",e),console.log("Image dimensions:",n.target.naturalWidth,"x",n.target.naturalHeight)}convertImagesToBase64(){return Promise.all(this.images.map(n=>new Promise((e,i)=>{let r=new FileReader;r.onload=()=>{r.result?e(r.result):i(new Error("Failed to read file"))},r.onerror=()=>i(r.error),r.readAsDataURL(n)})))}onCategoryIconError(n,e){console.warn("Category icon failed to load:",e.name,e.icon),e.iconError=!0,n.target.style.display="none"}onAssetTypeIconError(n,e){console.warn("Asset type icon failed to load:",e.name,e.icon),e.iconError=!0,n.target.style.display="none"}triggerFileInput(){this.fileInput.nativeElement.click()}duplicateImages(n){n.forEach((e,i)=>{if(e.image_url){this.imagePreviewUrls.push(e.image_url);let r=`existing-image-${i+1}.jpg`,a=new File([""],r,{type:"image/jpeg"});this.images.push(a)}})}getSelectedParent(){return this.possibleParents.find(n=>n.id===this.parent_id)}static \u0275fac=function(e){return new(e||t)(ft(Kn),ft(_i),ft(ea),ft(sd))};static \u0275cmp=Yt({type:t,selectors:[["app-asset-create"]],viewQuery:function(e,i){if(e&1&&(pi(E1,5),pi(T1,5)),e&2){let r;gi(r=xi())&&(i.fileInput=r.first),gi(r=xi())&&(i.dateInputs=r)}},hostBindings:function(e,i){e&1&&Y("click",function(a){return i.onDocumentClick(a)},!1,Qr)},decls:300,vars:118,consts:[["assetForm","ngForm"],["nameInput","ngModel"],["dateInput",""],["fileInput",""],[1,"min-h-screen","bg-gray-50","p-6"],[1,"asset-create-page"],[1,"mb-8"],[1,"flex","items-center","space-x-4","mb-4"],["type","button",1,"flex","items-center","space-x-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"font-medium"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],["class","mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",4,"ngIf"],[3,"ngSubmit"],[1,"section-card"],[1,"flex","items-center","space-x-3","mb-6"],[1,"w-10","h-10","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"section-title"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mb-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","text","placeholder","e.g., Main Server Room AC Unit","name","name","required","",1,"input",3,"ngModelChange","ngModel"],["class","text-red-600 text-sm mt-1",4,"ngIf"],[1,"text-xs","text-gray-500","mt-1"],[1,"flex","items-center","space-x-3"],["type","text","value","AST-012","readonly","",1,"input","flex-1"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"mb-6"],[1,"relative",3,"click"],["type","button",1,"w-full","px-4","py-3","text-left","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white","transition-all",3,"click"],[1,"flex","items-center","justify-between"],["class","text-gray-400",4,"ngIf"],["class","text-gray-900",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",4,"ngIf"],["rows","3","placeholder","Brief description of the asset and its purpose...","name","description","maxlength","500",1,"input","resize-none",3,"ngModelChange","ngModel"],[1,"block","text-sm","font-medium","text-gray-700","mb-3"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-sm","text-gray-600"],[1,"text-2xl","font-bold"],[1,"relative","w-full","h-6","mb-3"],[1,"absolute","top-1/2","transform","-translate-y-1/2","w-full","h-2","bg-gray-200","rounded-lg"],[1,"absolute","top-1/2","transform","-translate-y-1/2","h-2","rounded-lg","transition-all","duration-300"],["type","range","min","0","max","100","name","health_score",1,"absolute","top-1/2","transform","-translate-y-1/2","w-full","h-6","bg-transparent","appearance-none","cursor-pointer","slider-input",3,"ngModelChange","ngModel"],[1,"absolute","top-1/2","transform","-translate-y-1/2","w-4","h-4","rounded-full","border-2","border-white","shadow-md","pointer-events-none","transition-all","duration-300",2,"margin-left","-8px"],[1,"flex","justify-between","text-xs","text-gray-500","mt-2"],[1,"w-10","h-10","bg-purple-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["class","flex items-center space-x-3",4,"ngIf"],[1,"w-10","h-10","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["type","text","placeholder","e.g., Dell, HP, Toyota","name","manufacturer","maxlength","100",1,"input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., PowerEdge R730","name","model","maxlength","100",1,"input",3,"ngModelChange","ngModel"],["type","text","placeholder","e.g., SN123456789","name","serial_number","required","","maxlength","100",1,"input",3,"ngModelChange","ngModel"],[1,"w-10","h-10","bg-yellow-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"text-gray-500","sm:text-sm"],["type","number","placeholder","5,000.00","name","purchase_price","step","0.01","min","0",1,"input",2,"padding-left","24px",3,"ngModelChange","ngModel"],["type","text","name","purchase_date","placeholder","Select purchase date","readonly","",1,"input",3,"ngModelChange","ngModel"],["type","number","name","depreciation","placeholder","e.g., 20","min","0","max","100","step","0.01",1,"input",3,"ngModelChange","ngModel"],["type","number","name","depreciation_life","placeholder","e.g., 5","min","1","max","100",1,"input",3,"ngModelChange","ngModel"],["type","text","name","warranty","placeholder","e.g., 2 years manufacturer warranty","maxlength","255",1,"input",3,"ngModelChange","ngModel"],["type","text","name","insurance","placeholder","e.g., Policy #12345, expires 2025-12-31","maxlength","255",1,"input",3,"ngModelChange","ngModel"],[1,"w-10","h-10","bg-indigo-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],[1,"col-span-1","md:col-span-2"],["type","text","placeholder","Enter asset address","name","address","autocomplete","off",1,"input","w-full",3,"ngModelChange","ngModel"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"text-gray-400"],[1,"flex","items-center","space-x-2"],["class","text-sm text-gray-500",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"w-10","h-10","bg-pink-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-pink-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"mt-1","flex","justify-center","px-6","pt-8","pb-8","border-2","border-dashed","rounded-lg","transition-all","duration-200",3,"click","dragover","dragleave","drop"],[1,"space-y-1","text-center"],[1,"w-16","h-16","bg-gray-100","rounded-lg","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"text-sm","transition-colors"],["id","file-upload","name","file-upload","type","file","accept","image/*","multiple","",1,"sr-only",3,"change"],["class","mt-6",4,"ngIf"],["class","mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],["class","mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",4,"ngIf"],[1,"flex","items-center","justify-between","pt-6","border-t","border-gray-200"],["type","button",1,"px-6","py-3","border","border-gray-300","rounded-lg","text-gray-700","font-medium","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","submit",1,"px-8","py-3","bg-blue-600","text-white","font-medium","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed","shadow-sm",3,"disabled"],["class","flex items-center space-x-2",4,"ngIf"],[1,"mt-4","p-4","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"text-blue-800","font-medium"],[1,"text-blue-700","text-sm"],[1,"text-red-600","text-sm","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-gray-900"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-200","rounded-lg","shadow-lg","max-h-60","overflow-auto"],[1,"py-1"],[1,"px-3","py-2","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","bg-gray-50"],["type","button",1,"w-full","px-3","py-3","text-left","hover:bg-blue-50","focus:bg-blue-50","focus:outline-none","transition-colors",3,"click"],["type","button","class","w-full px-3 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors",3,"bg-blue-50","click",4,"ngFor","ngForOf"],[1,"w-8","h-8","bg-gray-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"w-6","h-6","rounded","flex","items-center","justify-center"],["class","w-4 h-4",3,"src","alt","error",4,"ngIf"],["class","w-4 h-4","fill","none","stroke","currentColor","viewBox","0 0 24 24",3,"color",4,"ngIf"],[1,"w-4","h-4",3,"error","src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],["type","button","class","w-full px-3 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors",3,"bg-blue-50","text-blue-700","click",4,"ngFor","ngForOf"],[1,"w-8","h-8","rounded-lg","flex","items-center","justify-center","bg-blue-100"],["class","w-5 h-5",3,"src","alt","error",4,"ngIf"],["class","w-5 h-5 text-blue-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"w-5","h-5",3,"error","src","alt"],["class","w-5 h-5 text-gray-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"w-6","h-6","bg-indigo-100","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-indigo-600"],[1,"w-8","h-8","bg-indigo-100","rounded-lg","flex","items-center","justify-center"],[1,"w-6","h-6","bg-purple-100","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"w-8","h-8","bg-purple-100","rounded-lg","flex","items-center","justify-center"],["class","text-xs text-gray-400",4,"ngIf"],[1,"text-xs","text-gray-400"],[1,"w-3","h-3","rounded-full"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-200","rounded-lg","shadow-lg"],[1,"mb-3"],[1,"flex","flex-wrap","gap-2"],[3,"class",4,"ngFor","ngForOf"],["type","button",1,"ml-2","inline-flex","items-center","justify-center","w-4","h-4","rounded-full","hover:bg-black","hover:bg-opacity-20","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"px-3","py-2","border-b","border-gray-100"],["type","text","name","newTagInput","placeholder","Type to create new tag...",1,"w-full","px-3","py-2","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","keydown","click","ngModel"],[1,"absolute","right-2","top-1/2","transform","-translate-y-1/2","text-xs","text-gray-400"],["class","text-blue-600",4,"ngIf"],[1,"text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"mt-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-sm","font-medium","text-gray-700"],["type","button",1,"text-red-600","hover:text-red-700","text-sm","font-medium","transition-colors",3,"click"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4"],["class","relative group",4,"ngFor","ngForOf"],[1,"mt-4","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-600"],[1,"text-blue-800","text-sm"],[1,"relative","group"],[1,"relative","aspect-square","bg-gray-100","rounded-lg","overflow-hidden","border","border-gray-200","hover:border-blue-300","transition-colors"],["loading","lazy",1,"w-full","h-full","object-cover","bg-white",3,"error","load","src","alt"],[1,"absolute","inset-0","bg-black","opacity-50","group-hover:bg-opacity-20","transition-all","duration-200","flex","items-center","justify-center"],[1,"opacity-0","group-hover:opacity-100","transition-opacity","duration-200","flex","items-center","space-x-2"],["type","button","class","w-8 h-8 bg-white bg-opacity-90 text-gray-700 rounded-full flex items-center justify-center hover:bg-opacity-100 transition-all shadow-sm",3,"click",4,"ngIf"],["type","button",1,"absolute","top-2","right-2","w-6","h-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","hover:bg-red-600","transition-colors","shadow-sm",3,"click"],[1,"absolute","top-2","left-2","w-6","h-6","bg-blue-600","text-white","rounded-full","flex","items-center","justify-center","text-xs","font-medium"],[1,"mt-2","text-center"],[1,"text-xs","text-gray-600","truncate"],["type","button",1,"w-8","h-8","bg-white","bg-opacity-90","text-gray-700","rounded-full","flex","items-center","justify-center","hover:bg-opacity-100","transition-all","shadow-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],[1,"mb-6","p-4","bg-red-50","border","border-red-200","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-600"],[1,"text-red-800","font-medium"],[1,"mb-6","p-4","bg-green-50","border","border-green-200","rounded-lg"],[1,"text-green-800","font-medium"],["xmlns","http://www.w3.org/2000/svg","fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){if(e&1){let r=ue();d(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"button",8),Y("click",function(){return U(r),z(i.goBack())}),B(),d(5,"svg",9),D(6,"path",10),u(),q(),d(7,"span",11),g(8,"Back to Assets"),u()()(),d(9,"h1",12),g(10),u(),d(11,"p",13),g(12),u(),J(13,A1,9,0,"div",14),u(),d(14,"form",15,0),Y("ngSubmit",function(){return U(r),z(i.onSubmit())}),d(16,"div",16)(17,"div",17)(18,"div",18),B(),d(19,"svg",19),D(20,"path",20),u()(),q(),d(21,"h2",21),g(22,"Basic Information"),u()(),d(23,"div",22)(24,"div")(25,"label",23),g(26," Asset Name "),d(27,"span",24),g(28,"*"),u()(),d(29,"input",25,1),ot("ngModelChange",function(s){return U(r),st(i.name,s)||(i.name=s),z(s)}),u(),J(31,M1,4,1,"div",26),d(32,"div",27),g(33,"Maximum 100 characters"),u()(),d(34,"div")(35,"label",23),g(36,"Asset ID"),u(),d(37,"div",28),D(38,"input",29),d(39,"span",30),g(40," auto-generated "),u()(),d(41,"p",27),g(42,"Unique identifier automatically assigned"),u()()(),d(43,"div",31)(44,"label",23),g(45,"Parent Asset"),u(),d(46,"div",32),Y("click",function(s){return U(r),z(s.stopPropagation())}),d(47,"button",33),Y("click",function(){return U(r),z(i.showParentDropdown=!i.showParentDropdown)}),d(48,"div",34),J(49,D1,2,0,"span",35)(50,F1,2,2,"span",36),B(),d(51,"svg",37),D(52,"path",38),u()()(),J(53,P1,7,3,"div",39),u(),q(),d(54,"div",27),g(55,"Optional: Select a parent asset if this asset is a child of another."),u()(),d(56,"div",31)(57,"label",23),g(58,"Description"),u(),d(59,"textarea",40),ot("ngModelChange",function(s){return U(r),st(i.description,s)||(i.description=s),z(s)}),u(),d(60,"div",27),g(61,"Maximum 500 characters"),u()(),d(62,"div")(63,"label",41),g(64,"Health Score"),u(),d(65,"div",42)(66,"div",43)(67,"span",44),g(68,"Current Score"),u(),d(69,"span",45),g(70),u()(),d(71,"div",46),D(72,"div",47)(73,"div",48),d(74,"input",49),ot("ngModelChange",function(s){return U(r),st(i.healthScore,s)||(i.healthScore=s),z(s)}),u(),D(75,"div",50),u(),d(76,"div",51)(77,"span"),g(78,"Poor (0%)"),u(),d(79,"span"),g(80,"Fair (25%)"),u(),d(81,"span"),g(82,"Good (50%)"),u(),d(83,"span"),g(84,"Very Good (75%)"),u(),d(85,"span"),g(86,"Excellent (100%)"),u()()()()(),d(87,"div",16)(88,"div",17)(89,"div",52),B(),d(90,"svg",53),D(91,"path",54),u()(),q(),d(92,"h2",21),g(93,"Asset Classification"),u()(),d(94,"div",55)(95,"div")(96,"label",23),g(97," Asset Type "),d(98,"span",24),g(99,"*"),u()(),d(100,"div",32),Y("click",function(s){return U(r),z(s.stopPropagation())}),d(101,"button",33),Y("click",function(){return U(r),z(i.toggleAssetTypeDropdown())}),d(102,"div",34),J(103,O1,2,0,"span",35)(104,V1,6,5,"div",56),B(),d(105,"svg",37),D(106,"path",38),u()()(),J(107,U1,5,1,"div",39),u(),J(108,z1,4,1,"div",26),u(),q(),d(109,"div")(110,"label",23),g(111," Category "),d(112,"span",24),g(113,"*"),u()(),d(114,"div",32),Y("click",function(s){return U(r),z(s.stopPropagation())}),d(115,"button",33),Y("click",function(){return U(r),z(i.toggleCategoryDropdown())}),d(116,"div",34),J(117,W1,2,0,"span",35)(118,j1,2,1,"span",36),B(),d(119,"svg",37),D(120,"path",38),u()()(),J(121,K1,5,1,"div",39),u(),J(122,q1,4,1,"div",26),u()()(),q(),d(123,"div",16)(124,"div",17)(125,"div",57),B(),d(126,"svg",58),D(127,"path",59),u()(),q(),d(128,"h2",21),g(129,"Technical Details"),u()(),d(130,"div",60)(131,"div")(132,"label",23),g(133,"Manufacturer"),u(),d(134,"input",61),ot("ngModelChange",function(s){return U(r),st(i.manufacturer,s)||(i.manufacturer=s),z(s)}),u(),d(135,"div",27),g(136,"Maximum 100 characters"),u()(),d(137,"div")(138,"label",23),g(139,"Model"),u(),d(140,"input",62),ot("ngModelChange",function(s){return U(r),st(i.model,s)||(i.model=s),z(s)}),u(),d(141,"div",27),g(142,"Maximum 100 characters"),u()(),d(143,"div")(144,"label",23),g(145," Serial Number "),d(146,"span",24),g(147,"*"),u()(),d(148,"input",63),ot("ngModelChange",function(s){return U(r),st(i.serial_number,s)||(i.serial_number=s),z(s)}),u(),J(149,J1,4,1,"div",26),d(150,"div",27),g(151,"Required, max 100 chars, must be unique within your company"),u()()()(),d(152,"div",16)(153,"div",17)(154,"div",64),B(),d(155,"svg",65),D(156,"path",66),u()(),q(),d(157,"h2",21),g(158,"Financial Information"),u()(),d(159,"div",22)(160,"div")(161,"label",23),g(162,"Purchase Value (USD)"),u(),d(163,"div",67)(164,"div",68)(165,"span",69),g(166,"$ "),u()(),d(167,"input",70),ot("ngModelChange",function(s){return U(r),st(i.purchase_price,s)||(i.purchase_price=s),z(s)}),u()(),d(168,"div",27),g(169,"Must be a non-negative number"),u()(),d(170,"div")(171,"label",23),g(172,"Purchase Date"),u(),d(173,"input",71,2),ot("ngModelChange",function(s){return U(r),st(i.purchase_date,s)||(i.purchase_date=s),z(s)}),u(),d(175,"div",27),g(176,"Cannot be in the future"),u()()(),d(177,"div",22)(178,"div")(179,"label",23),g(180,"Depreciation Rate (%)"),u(),d(181,"input",72),ot("ngModelChange",function(s){return U(r),st(i.depreciation,s)||(i.depreciation=s),z(s)}),u(),d(182,"div",27),g(183,"Annual depreciation rate (0-100%)"),u()(),d(184,"div")(185,"label",23),g(186,"Depreciation Life (Years)"),u(),d(187,"input",73),ot("ngModelChange",function(s){return U(r),st(i.depreciation_life,s)||(i.depreciation_life=s),z(s)}),u(),d(188,"div",27),g(189,"Useful life for depreciation calculation (1-100 years)"),u()()(),d(190,"div",22)(191,"div")(192,"label",23),g(193,"Warranty Information"),u(),d(194,"input",74),ot("ngModelChange",function(s){return U(r),st(i.warranty,s)||(i.warranty=s),z(s)}),u(),d(195,"div",27),g(196,"Warranty details (max 255 characters)"),u()(),d(197,"div")(198,"label",23),g(199,"Insurance Information"),u(),d(200,"input",75),ot("ngModelChange",function(s){return U(r),st(i.insurance,s)||(i.insurance=s),z(s)}),u(),d(201,"div",27),g(202,"Insurance details (max 255 characters)"),u()()()(),d(203,"div",16)(204,"div",17)(205,"div",76),B(),d(206,"svg",77),D(207,"path",78)(208,"path",79),u()(),q(),d(209,"h2",21),g(210,"Location & Assignment"),u()(),d(211,"div",55)(212,"div")(213,"label",23),g(214,"Location"),u(),d(215,"div",32),Y("click",function(s){return U(r),z(s.stopPropagation())}),d(216,"button",33),Y("click",function(){return U(r),z(i.toggleLocationDropdown())}),d(217,"div",34),J(218,Q1,2,0,"span",35)(219,Z1,7,1,"div",56),B(),d(220,"svg",37),D(221,"path",38),u()()(),J(222,ng,5,1,"div",39),u()(),q(),d(223,"div",80)(224,"label",23),g(225,"Address"),u(),d(226,"input",81),ot("ngModelChange",function(s){return U(r),st(i.address,s)||(i.address=s),z(s)}),u(),d(227,"div",27),g(228,"Enter the physical address of the asset"),u()(),d(229,"div")(230,"label",23),g(231,"Department ID"),u(),d(232,"div",32),Y("click",function(s){return U(r),z(s.stopPropagation())}),d(233,"button",33),Y("click",function(){return U(r),z(i.toggleDepartmentDropdown())}),d(234,"div",34),J(235,ig,2,0,"span",35)(236,rg,6,1,"div",56),B(),d(237,"svg",37),D(238,"path",38),u()()(),J(239,lg,5,1,"div",39),u(),q(),d(240,"div",27),g(241,"Optional department assignment"),u()(),d(242,"div")(243,"label",23),g(244,"Status"),u(),d(245,"div",32),Y("click",function(s){return U(r),z(s.stopPropagation())}),d(246,"button",33),Y("click",function(){return U(r),z(i.toggleStatusDropdown())}),d(247,"div",34),J(248,cg,4,3,"div",56),B(),d(249,"svg",37),D(250,"path",38),u()()(),J(251,fg,5,1,"div",82),u(),q(),d(252,"div",27),g(253,"Current operational status of the asset"),u()(),d(254,"div")(255,"label",23),g(256,"Tags"),u(),J(257,hg,3,1,"div",83),d(258,"div",32),Y("click",function(s){return U(r),z(s.stopPropagation())}),d(259,"button",33),Y("click",function(){return U(r),z(i.toggleTagsDropdown())}),d(260,"div",34)(261,"span",84),g(262),u(),d(263,"div",85),J(264,mg,2,1,"span",86),B(),d(265,"svg",37),D(266,"path",38),u()()()(),J(267,xg,10,2,"div",39),u(),q(),d(268,"div",27),B(),d(269,"svg",87),D(270,"path",88),u(),g(271," Select existing tags or type to create new ones. Press Enter to add custom tags. "),u()()()(),q(),d(272,"div",16)(273,"div",17)(274,"div",89),B(),d(275,"svg",90),D(276,"path",91),u()(),q(),d(277,"h2",21),g(278,"Asset Image"),u()(),d(279,"div")(280,"label",23),g(281,"Upload Image"),u(),d(282,"div",92),Y("click",function(){return U(r),z(i.triggerFileInput())})("dragover",function(s){return U(r),z(i.onDragOver(s))})("dragleave",function(s){return U(r),z(i.onDragLeave(s))})("drop",function(s){return U(r),z(i.onDrop(s))}),d(283,"div",93)(284,"div",94),B(),d(285,"svg",95),D(286,"path",96),u()(),q(),d(287,"p",97),g(288),u(),d(289,"input",98,3),Y("change",function(s){return U(r),z(i.onFileChange(s))}),u()()(),J(291,bg,16,2,"div",99),u()(),J(292,yg,6,1,"div",100)(293,Sg,6,1,"div",101),d(294,"div",102)(295,"button",103),Y("click",function(){return U(r),z(i.goBack())}),g(296," Cancel "),u(),d(297,"button",104),J(298,Cg,5,0,"span",105)(299,kg,6,0,"span",105),u()()()()()}e&2&&(x(10),xe(" ",i.route.snapshot.queryParams.duplicate?"Duplicate Asset":"Create New Asset"," "),x(2),xe(" ",i.route.snapshot.queryParams.duplicate?"Creating a copy of an existing asset. Please review and update the information below.":"Add a new asset to your inventory with detailed information and specifications"," "),x(),C("ngIf",i.route.snapshot.queryParams.duplicate),x(16),ge("border-red-300",i.nameError),at("ngModel",i.name),x(2),C("ngIf",i.nameError),x(16),ge("border-blue-500",i.showParentDropdown),x(2),C("ngIf",!i.parent_id),x(),C("ngIf",i.parent_id&&i.getSelectedParent()),x(),ge("rotate-180",i.showParentDropdown),x(2),C("ngIf",i.showParentDropdown),x(6),at("ngModel",i.description),x(10),ge("text-red-600",i.healthScore<50)("text-green-600",i.healthScore>=50),x(),xe("",i.healthScore,"%"),x(3),yt("width",i.healthScore,"%"),ge("bg-red-500",i.healthScore<50)("bg-green-500",i.healthScore>=50),x(),at("ngModel",i.healthScore),x(),yt("left",i.healthScore,"%"),ge("bg-red-500",i.healthScore<50)("bg-green-500",i.healthScore>=50),x(26),ge("border-red-300",i.assetTypeError)("border-blue-500",i.showAssetTypeDropdown),x(2),C("ngIf",!i.selectedAssetType),x(),C("ngIf",i.selectedAssetType),x(),ge("rotate-180",i.showAssetTypeDropdown),x(2),C("ngIf",i.showAssetTypeDropdown),x(),C("ngIf",i.assetTypeError),x(7),ge("border-red-300",i.categoryError)("border-blue-500",i.showCategoryDropdown),x(2),C("ngIf",!i.selectedCategory),x(),C("ngIf",i.selectedCategory),x(),ge("rotate-180",i.showCategoryDropdown),x(2),C("ngIf",i.showCategoryDropdown),x(),C("ngIf",i.categoryError),x(12),at("ngModel",i.manufacturer),x(6),at("ngModel",i.model),x(8),ge("border-red-300",i.serialNumberError),at("ngModel",i.serial_number),x(),C("ngIf",i.serialNumberError),x(18),at("ngModel",i.purchase_price),x(6),at("ngModel",i.purchase_date),x(8),at("ngModel",i.depreciation),x(6),at("ngModel",i.depreciation_life),x(7),at("ngModel",i.warranty),x(6),at("ngModel",i.insurance),x(16),ge("border-blue-500",i.showLocationDropdown),x(2),C("ngIf",!i.selectedLocation),x(),C("ngIf",i.selectedLocation),x(),ge("rotate-180",i.showLocationDropdown),x(2),C("ngIf",i.showLocationDropdown),x(4),at("ngModel",i.address),x(7),ge("border-blue-500",i.showDepartmentDropdown),x(2),C("ngIf",!i.selectedDepartment),x(),C("ngIf",i.selectedDepartment),x(),ge("rotate-180",i.showDepartmentDropdown),x(2),C("ngIf",i.showDepartmentDropdown),x(7),ge("border-blue-500",i.showStatusDropdown),x(2),C("ngIf",i.selectedStatus),x(),ge("rotate-180",i.showStatusDropdown),x(2),C("ngIf",i.showStatusDropdown),x(6),C("ngIf",i.selectedTags.length>0),x(2),ge("border-blue-500",i.showTagsDropdown),x(3),xe(" ",i.selectedTags.length===0?"Select tags":"Add more tags"," "),x(2),C("ngIf",i.selectedTags.length>0),x(),ge("rotate-180",i.showTagsDropdown),x(2),C("ngIf",i.showTagsDropdown),x(15),ge("border-gray-300",!i.isDragOver)("border-blue-500",i.isDragOver)("bg-blue-50",i.isDragOver)("hover:border-blue-400",!i.isDragOver),x(3),ge("text-gray-400",!i.isDragOver)("text-blue-500",i.isDragOver),x(2),ge("text-gray-500",!i.isDragOver)("text-blue-600",i.isDragOver),x(),xe(" ",i.isDragOver?"Release to upload images":"PNG, JPG, GIF up to 10MB - click to browse or drag and drop files here"," "),x(3),C("ngIf",i.imagePreviewUrls.length>0),x(),C("ngIf",i.submitError),x(),C("ngIf",i.submitSuccess),x(2),C("disabled",i.isSubmitting),x(2),C("disabled",i.isSubmitting||!i.isFormValid()),x(),C("ngIf",!i.isSubmitting),x(),C("ngIf",i.isSubmitting))},dependencies:[fn,tr,cn,Ks,qs,dn,er,ta,to,eo,Zs,Pn,Xs,Xt,Yn],styles:[".asset-create-page[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:1.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;border:1px solid #e5e7eb;padding:2rem;margin-bottom:1.5rem;transition:all .2s ease-in-out}.section-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.section-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin:0;color:#1f2937}.input[_ngcontent-%COMP%]{width:100%;border-radius:.5rem;border:1px solid #d1d5db;padding:.75rem .875rem;font-size:1rem;background:#fff;transition:all .2s ease-in-out}.input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a;background:#fff}.input.border-red-300[_ngcontent-%COMP%]{border-color:#fca5a5;box-shadow:0 0 0 3px #ef44441a}@media (max-width: 768px){.asset-create-page[_ngcontent-%COMP%]{padding:1rem}.section-card[_ngcontent-%COMP%]{padding:1.5rem;margin-bottom:1rem}.grid-cols-2[_ngcontent-%COMP%], .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:1fr}}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .2s ease-out}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#eff6ff}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.rotate-180[_ngcontent-%COMP%]{transform:rotate(180deg)}.transition-transform[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}[_nghost-%COMP%]     .flatpickr-calendar{border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;border:1px solid #e5e7eb;font-family:inherit}[_nghost-%COMP%]     .flatpickr-day{border-radius:.375rem}[_nghost-%COMP%]     .flatpickr-day:hover{background-color:#eff6ff;border-color:#3b82f6}[_nghost-%COMP%]     .flatpickr-day.selected{background-color:#3b82f6;border-color:#3b82f6}[_nghost-%COMP%]     .flatpickr-day.today{border-color:#3b82f6;color:#3b82f6;font-weight:600}[_nghost-%COMP%]     .flatpickr-months{background-color:#f8fafc;border-radius:.5rem .5rem 0 0}[_nghost-%COMP%]     .flatpickr-current-month{color:#1f2937;font-weight:600}[_nghost-%COMP%]     .flatpickr-weekday{color:#6b7280;font-weight:500}[_nghost-%COMP%]     .flatpickr-input{cursor:pointer}[_nghost-%COMP%]     .flatpickr-input:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.slider-input[_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none;background:transparent;outline:none;z-index:20}.slider-input[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:transparent;border:2px solid transparent;cursor:pointer;position:relative;z-index:30}.slider-input[_ngcontent-%COMP%]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:transparent;border:2px solid transparent;cursor:pointer;box-shadow:none}.slider-input[_ngcontent-%COMP%]:focus{outline:none}"]})};var Eg=["dateInput"];function Tg(t,n){t&1&&(d(0,"span",42),g(1,"No location assigned"),u())}function Ag(t,n){if(t&1&&(d(0,"span",43),g(1),u()),t&2){let e=b(2);x(),xe(" ",e.getLocationNameById(e.transferData.new_location_id)," ")}}function Mg(t,n){if(t&1){let e=ue();d(0,"button",48),Y("click",function(){let r=U(e).$implicit,a=b(3);return a.transferData.new_location_id=r.id,z(a.showLocationDropdown=!1)}),g(1),u()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",i.transferData.new_location_id===e.id),C("disabled",e.id===(i.asset==null?null:i.asset.location_id)),x(),xe(" ",e.name," ")}}function Dg(t,n){if(t&1){let e=ue();d(0,"div",44)(1,"div",45)(2,"button",46),Y("click",function(){U(e);let r=b(2);return r.transferData.new_location_id=null,z(r.showLocationDropdown=!1)}),g(3," No location assigned "),u(),J(4,Mg,2,4,"button",47),u()()}if(t&2){let e=b(2);x(2),ge("bg-blue-50",!e.transferData.new_location_id),x(2),C("ngForOf",e.locations)}}function Fg(t,n){t&1&&(d(0,"span",42),g(1,"Select new department (optional)"),u())}function Ig(t,n){if(t&1&&(d(0,"span",43),g(1),u()),t&2){let e=b(2);x(),xe(" ",e.getDepartmentNameById(e.transferData.new_department_id)," ")}}function Pg(t,n){if(t&1){let e=ue();d(0,"button",46),Y("click",function(){let r=U(e).$implicit,a=b(3);return a.transferData.new_department_id=r.id,z(a.showDepartmentDropdown=!1)}),g(1),u()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",i.transferData.new_department_id===e.id),x(),xe(" ",e.name," ")}}function Og(t,n){if(t&1){let e=ue();d(0,"div",44)(1,"div",45)(2,"button",46),Y("click",function(){U(e);let r=b(2);return r.transferData.new_department_id=null,z(r.showDepartmentDropdown=!1)}),g(3," Select new department (optional) "),u(),J(4,Pg,2,3,"button",49),u()()}if(t&2){let e=b(2);x(2),ge("bg-blue-50",!e.transferData.new_department_id),x(2),C("ngForOf",e.departments)}}function Lg(t,n){t&1&&(d(0,"span",42),g(1,"Select reason"),u())}function Rg(t,n){if(t&1&&(d(0,"span",43),g(1),u()),t&2){let e=b(2);x(),xe(" ",e.transferData.transfer_reason," ")}}function Vg(t,n){if(t&1){let e=ue();d(0,"button",46),Y("click",function(){let r=U(e).$implicit,a=b(3);return a.transferData.transfer_reason=r,z(a.showReasonDropdown=!1)}),g(1),u()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",i.transferData.transfer_reason===e),x(),xe(" ",e," ")}}function Ng(t,n){if(t&1){let e=ue();d(0,"div",44)(1,"div",45)(2,"button",46),Y("click",function(){U(e);let r=b(2);return r.transferData.transfer_reason="",z(r.showReasonDropdown=!1)}),g(3," Select reason "),u(),J(4,Vg,2,3,"button",49),u()()}if(t&2){let e=b(2);x(2),ge("bg-blue-50",!e.transferData.transfer_reason),x(2),C("ngForOf",e.transferReasons)}}function Bg(t,n){if(t&1&&(d(0,"div",50)(1,"div",51)(2,"div",52),B(),d(3,"svg",53),D(4,"path",54),u()(),q(),d(5,"div",55)(6,"p",56),g(7),u()()()()),t&2){let e=b(2);x(7),oe(e.error)}}function Hg(t,n){t&1&&(d(0,"span"),g(1,"Create Transfer"),u())}function Ug(t,n){t&1&&(d(0,"span",57),B(),d(1,"svg",58),D(2,"circle",59)(3,"path",60),u(),g(4," Creating Transfer... "),u())}function zg(t,n){if(t&1){let e=ue();d(0,"div",2),Y("click",function(r){U(e);let a=b();return z(a.onModalClick(r))}),d(1,"div",3),D(2,"div",4),d(3,"div",5),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(4,"div",6)(5,"h3",7),g(6),u(),d(7,"button",8),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),B(),d(8,"svg",9),D(9,"path",10),u()()(),q(),d(10,"div",11)(11,"div")(12,"p",12),g(13,"Current Location"),u(),d(14,"p",13),g(15),u()(),d(16,"div")(17,"p",12),g(18,"Current Department"),u(),d(19,"p",13),g(20),u()()(),d(21,"div",14)(22,"div",15),B(),d(23,"svg",16),D(24,"path",17),u()()(),q(),d(25,"form",18),Y("ngSubmit",function(){U(e);let r=b();return z(r.onTransfer())}),d(26,"div",19),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(27,"label",20),g(28,"New Location"),u(),d(29,"button",21),Y("click",function(){U(e);let r=b();return z(r.showLocationDropdown=!r.showLocationDropdown)}),d(30,"div",22),J(31,Tg,2,0,"span",23)(32,Ag,2,1,"span",24),B(),d(33,"svg",25),D(34,"path",26),u()()(),J(35,Dg,5,3,"div",27),u(),q(),d(36,"div",19),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(37,"label",20),g(38,"New Department"),u(),d(39,"button",21),Y("click",function(){U(e);let r=b();return z(r.showDepartmentDropdown=!r.showDepartmentDropdown)}),d(40,"div",22),J(41,Fg,2,0,"span",23)(42,Ig,2,1,"span",24),B(),d(43,"svg",25),D(44,"path",26),u()()(),J(45,Og,5,3,"div",27),u(),q(),d(46,"div",19),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(47,"label",20),g(48,"Transfer Reason *"),u(),d(49,"button",21),Y("click",function(){U(e);let r=b();return z(r.showReasonDropdown=!r.showReasonDropdown)}),d(50,"div",22),J(51,Lg,2,0,"span",23)(52,Rg,2,1,"span",24),B(),d(53,"svg",25),D(54,"path",26),u()()(),J(55,Ng,5,3,"div",27),u(),q(),d(56,"div")(57,"label",28),g(58," Transfer Date * "),u(),d(59,"div",29)(60,"input",30,0),ot("ngModelChange",function(r){U(e);let a=b();return st(a.transferData.transfer_date,r)||(a.transferData.transfer_date=r),z(r)}),u(),d(62,"div",31),B(),d(63,"svg",32),D(64,"path",33),u()()()(),q(),d(65,"div")(66,"label",34),g(67," Additional Notes "),u(),d(68,"textarea",35),ot("ngModelChange",function(r){U(e);let a=b();return st(a.transferData.notes,r)||(a.transferData.notes=r),z(r)}),u()(),J(69,Bg,8,1,"div",36),d(70,"div",37)(71,"button",38),Y("click",function(){U(e);let r=b();return z(r.onCancel())}),g(72," Cancel "),u(),d(73,"button",39),J(74,Hg,2,0,"span",40)(75,Ug,5,0,"span",41),u()()()()()()}if(t&2){let e=b();C("@backdropAnimation",void 0),x(3),C("@modalAnimation",void 0),x(3),xe(" Transfer Asset: ",(e.asset==null?null:e.asset.name)||"Unknown Asset"," "),x(),C("disabled",e.loading),x(8),oe(e.getCurrentLocationName()),x(5),oe(e.getCurrentDepartmentName()),x(9),ge("border-blue-500",e.showLocationDropdown),x(2),C("ngIf",!e.transferData.new_location_id),x(),C("ngIf",e.transferData.new_location_id),x(),ge("rotate-180",e.showLocationDropdown),x(2),C("ngIf",e.showLocationDropdown),x(4),ge("border-blue-500",e.showDepartmentDropdown),x(2),C("ngIf",!e.transferData.new_department_id),x(),C("ngIf",e.transferData.new_department_id),x(),ge("rotate-180",e.showDepartmentDropdown),x(2),C("ngIf",e.showDepartmentDropdown),x(4),ge("border-blue-500",e.showReasonDropdown),x(2),C("ngIf",!e.transferData.transfer_reason),x(),C("ngIf",e.transferData.transfer_reason),x(),ge("rotate-180",e.showReasonDropdown),x(2),C("ngIf",e.showReasonDropdown),x(5),at("ngModel",e.transferData.transfer_date),C("disabled",e.loading),x(8),at("ngModel",e.transferData.notes),C("disabled",e.loading),x(),C("ngIf",e.error),x(2),C("disabled",e.loading),x(2),C("disabled",e.loading),x(),C("ngIf",!e.loading),x(),C("ngIf",e.loading)}}var sa=class t{constructor(n){this.assetService=n}isOpen=!1;asset=null;closeModal=new In;transferComplete=new In;dateInput;flatpickrInstance;showLocationDropdown=!1;showDepartmentDropdown=!1;showReasonDropdown=!1;loading=!1;error="";transferData={new_location_id:null,new_department_id:null,to_user_id:null,transfer_reason:"",transfer_date:new Date().toISOString().split("T")[0],notes:"",condition_report:""};locations=[];departments=[];users=[];transferReasons=["Relocation","Maintenance","Replacement","Department Transfer","User Assignment","Storage","Disposal","Other"];ngOnInit(){console.log("TransferAssetModalComponent initialized"),this.loadDropdownData()}ngOnChanges(){console.log("TransferAssetModalComponent changes:",{isOpen:this.isOpen,asset:this.asset}),this.isOpen&&setTimeout(()=>{this.initializeFlatpickr()},200)}ngAfterViewInit(){}ngOnDestroy(){this.destroyFlatpickr()}destroyFlatpickr(){if(this.flatpickrInstance)try{this.flatpickrInstance.destroy(),this.flatpickrInstance=null}catch(n){console.error("Error destroying flatpickr:",n)}}initializeFlatpickr(){try{this.destroyFlatpickr(),this.dateInput&&this.dateInput.nativeElement?(console.log("Initializing flatpickr on element:",this.dateInput.nativeElement),this.flatpickrInstance=rr(this.dateInput.nativeElement,{dateFormat:"Y-m-d",defaultDate:new Date,allowInput:!1,clickOpens:!0,minDate:new Date,locale:{firstDayOfWeek:1},onChange:(n,e)=>{console.log("Date selected:",e),this.transferData.transfer_date=e},onOpen:()=>{console.log("Flatpickr opened")},onClose:()=>{console.log("Flatpickr closed")}}),console.log("Flatpickr initialized successfully")):console.warn("Date input element not found")}catch(n){console.error("Error initializing flatpickr:",n)}}loadDropdownData(){console.log("Loading dropdown data..."),console.log("Calling locations API with pagination..."),this.assetService.getLocations(1,1e3,"created","desc").subscribe({next:n=>{console.log("Locations API response:",n),console.log("Response type:",typeof n),console.log("Response keys:",Object.keys(n)),n&&n.data&&n.data.locations?(this.locations=n.data.locations,console.log("Using response.data.locations (paginated):",this.locations),console.log("Response pagination:",n.data.pagination)):n&&n.data&&Array.isArray(n.data)?(this.locations=n.data,console.log("Using response.data as array:",this.locations)):Array.isArray(n)?(this.locations=n,console.log("Using response as array:",this.locations)):(this.locations=[],console.warn("Unexpected response format:",n),console.log("Response structure:",n)),console.log("Final locations array:",this.locations),console.log("Locations count:",this.locations.length),this.locations.length===0&&console.warn("No locations found in response")},error:n=>{console.error("Error loading locations:",n),console.error("Error details:",{status:n.status,statusText:n.statusText,message:n.message,url:n.url}),this.locations=[]}}),console.log("Calling departments API with pagination..."),this.assetService.getDepartments(1,1e3,"created","desc").subscribe({next:n=>{console.log("Departments API response:",n),n&&n.data&&n.data.departments?(this.departments=n.data.departments,console.log("Using response.data.departments (paginated):",this.departments),console.log("Response pagination:",n.data.pagination)):n&&n.data&&Array.isArray(n.data)?(this.departments=n.data,console.log("Using response.data as array:",this.departments)):Array.isArray(n)?this.departments=n:(this.departments=[],console.warn("Unexpected departments response format:",n),console.log("Response structure:",n)),console.log("Final departments array:",this.departments),console.log("Departments count:",this.departments.length),this.departments.length===0&&console.warn("No departments found")},error:n=>{console.error("Error loading departments:",n),console.error("Error details:",{status:n.status,statusText:n.statusText,message:n.message,url:n.url}),this.departments=[]}})}reloadLocationData(){console.log("Manually reloading location data..."),this.loadDropdownData()}onTransfer(){this.validateForm()&&(this.loading=!0,this.error="",this.assetService.transferAsset(this.asset.id,this.transferData).subscribe({next:n=>{this.loading=!1,this.transferComplete.emit(n),this.resetForm(),this.closeModal.emit()},error:n=>{this.loading=!1,this.error=n.error?.message||"Transfer failed. Please try again.",console.error("Transfer error:",n)}}))}onCancel(){this.loading||(this.destroyFlatpickr(),this.resetForm(),this.closeModal.emit())}validateForm(){return this.transferData.new_location_id?this.transferData.transfer_reason?this.transferData.transfer_date?this.asset?.location_id===this.transferData.new_location_id?(this.error="Transfer location must be different from current location.",!1):(this.error="",!0):(this.error="Please select a transfer date.",!1):(this.error="Please select a transfer reason.",!1):(this.error="Please select a new location.",!1)}resetForm(){this.transferData={new_location_id:null,new_department_id:null,to_user_id:null,transfer_reason:"",transfer_date:new Date().toISOString().split("T")[0],notes:"",condition_report:""},this.error=""}getCurrentLocationName(){return this.asset?.location?.name||"No location assigned"}getCurrentDepartmentName(){return this.asset?.department?.name||"No department assigned"}getLocationNameById(n){if(!n)return"";let e=this.locations.find(i=>i.id===n);return e?e.name:""}getDepartmentNameById(n){if(!n)return"";let e=this.departments.find(i=>i.id===n);return e?e.name:""}getLocationsCount(){return this.locations.length}getDepartmentsCount(){return this.departments.length}getUsersCount(){return this.users.length}onModalClick(n){n.target===n.currentTarget&&(this.showLocationDropdown=!1,this.showDepartmentDropdown=!1,this.showReasonDropdown=!1)}static \u0275fac=function(e){return new(e||t)(ft(Kn))};static \u0275cmp=Yt({type:t,selectors:[["app-transfer-asset-modal"]],viewQuery:function(e,i){if(e&1&&pi(Eg,5),e&2){let r;gi(r=xi())&&(i.dateInput=r.first)}},inputs:{isOpen:"isOpen",asset:"asset"},outputs:{closeModal:"closeModal",transferComplete:"transferComplete"},features:[Zc],decls:1,vars:1,consts:[["dateInput",""],["class","fixed inset-0 z-50 overflow-y-auto",3,"click",4,"ngIf"],[1,"fixed","inset-0","z-50","overflow-y-auto",3,"click"],[1,"flex","items-center","justify-center","min-h-screen","px-4","pt-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","transition-opacity","z-0","bg-[#00000085]"],[1,"inline-block","w-full","max-w-2xl","z-1","p-6","my-8","relative","overflow-hidden","text-left","align-middle","transition-all","transform","bg-white","shadow-xl","rounded-2xl",3,"click"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-sm","text-gray-500"],[1,"text-sm","font-medium","text-gray-900"],[1,"flex","justify-center","mb-6"],[1,"w-8","h-8","bg-blue-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 14l-7 7m0 0l-7-7m7 7V3"],[1,"space-y-4",3,"ngSubmit"],[1,"relative",3,"click"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","button",1,"w-full","px-4","py-3","text-left","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white","transition-all",3,"click"],[1,"flex","items-center","justify-between"],["class","text-gray-400",4,"ngIf"],["class","text-gray-900",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",4,"ngIf"],["for","transfer_date",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["type","text","id","transfer_date","name","transfer_date","placeholder","Select date","required","","readonly","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","bg-white","cursor-pointer",3,"ngModelChange","ngModel","disabled"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-4","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["for","notes",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","notes","name","notes","rows","3","placeholder","Enter any additional notes about this transfer...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","bg-white","resize-none",3,"ngModelChange","ngModel","disabled"],["class","bg-red-50 border border-red-200 rounded-md p-4",4,"ngIf"],[1,"flex","justify-end","space-x-3","pt-6"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click","disabled"],["type","submit",1,"px-4","py-2","text-sm","font-medium","text-white","bg-blue-600","border","border-transparent","rounded-md","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[4,"ngIf"],["class","flex items-center",4,"ngIf"],[1,"text-gray-400"],[1,"text-gray-900"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-200","rounded-lg","shadow-lg","max-h-60","overflow-auto"],[1,"py-1"],["type","button",1,"w-full","px-3","py-3","text-left","hover:bg-blue-50","focus:bg-blue-50","focus:outline-none","transition-colors",3,"click"],["type","button","class","w-full px-3 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors",3,"bg-blue-50","disabled","click",4,"ngFor","ngForOf"],["type","button",1,"w-full","px-3","py-3","text-left","hover:bg-blue-50","focus:bg-blue-50","focus:outline-none","transition-colors",3,"click","disabled"],["type","button","class","w-full px-3 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors",3,"bg-blue-50","click",4,"ngFor","ngForOf"],[1,"bg-red-50","border","border-red-200","rounded-md","p-4"],[1,"flex"],[1,"flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","text-red-700"],[1,"flex","items-center"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,i){e&1&&J(0,zg,76,36,"div",1),e&2&&C("ngIf",i.isOpen)},dependencies:[ln,Yn,Xt,fn,tr,cn,dn,er,ta,Pn,Xs],styles:[".transfer-asset-modal[_ngcontent-%COMP%]   .modal-backdrop[_ngcontent-%COMP%]{background-color:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.transfer-asset-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{max-height:90vh;overflow-y:auto}.transfer-asset-modal[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%], .transfer-asset-modal[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .transfer-asset-modal[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.transfer-asset-modal[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus, .transfer-asset-modal[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus, .transfer-asset-modal[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #3b82f61a}.transfer-asset-modal[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:disabled, .transfer-asset-modal[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:disabled, .transfer-asset-modal[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]:disabled{background-color:#f9fafb;cursor:not-allowed}.transfer-asset-modal[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background-image:none!important;-webkit-appearance:none;-moz-appearance:none;appearance:none}.transfer-asset-modal[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]::-ms-expand{display:none}.transfer-asset-modal[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{padding:8px 12px;background-color:#fff;color:#374151}.transfer-asset-modal[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.transfer-asset-modal[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:disabled{color:#9ca3af;background-color:#f9fafb}.transfer-asset-modal[_ngcontent-%COMP%]   .flatpickr-calendar[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 10px 25px #00000026;border:1px solid #e5e7eb}.transfer-asset-modal[_ngcontent-%COMP%]   .flatpickr-calendar[_ngcontent-%COMP%]   .flatpickr-day[_ngcontent-%COMP%]{border-radius:4px}.transfer-asset-modal[_ngcontent-%COMP%]   .flatpickr-calendar[_ngcontent-%COMP%]   .flatpickr-day.selected[_ngcontent-%COMP%]{background-color:#3b82f6;border-color:#3b82f6}.transfer-asset-modal[_ngcontent-%COMP%]   .flatpickr-calendar[_ngcontent-%COMP%]   .flatpickr-day[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.transfer-asset-modal[_ngcontent-%COMP%]   .transfer-arrow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce 2s infinite}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}.transfer-asset-modal[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.transfer-asset-modal[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 640px){.transfer-asset-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{margin:1rem;max-width:calc(100vw - 2rem)}}"],data:{animation:[Xn("backdropAnimation",[Rt(":enter",[ut({opacity:0}),Lt("150ms ease-out",ut({opacity:1}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0}))])]),Xn("modalAnimation",[Rt(":enter",[ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}),Lt("200ms ease-out",ut({opacity:1,transform:"scale(1) translateY(0)"}))]),Rt(":leave",[Lt("150ms ease-in",ut({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};var Lu=Jc(fd());function $a(t){return t+.5|0}var ar=(t,n,e)=>Math.max(Math.min(t,e),n);function ja(t){return ar($a(t*2.55),0,255)}function sr(t){return ar($a(t*255),0,255)}function Ri(t){return ar($a(t/2.55)/100,0,1)}function wd(t){return ar($a(t*100),0,100)}var qn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Bl=[..."0123456789ABCDEF"],Wg=t=>Bl[t&15],jg=t=>Bl[(t&240)>>4]+Bl[t&15],_o=t=>(t&240)>>4===(t&15),Gg=t=>_o(t.r)&&_o(t.g)&&_o(t.b)&&_o(t.a);function $g(t){var n=t.length,e;return t[0]==="#"&&(n===4||n===5?e={r:255&qn[t[1]]*17,g:255&qn[t[2]]*17,b:255&qn[t[3]]*17,a:n===5?qn[t[4]]*17:255}:(n===7||n===9)&&(e={r:qn[t[1]]<<4|qn[t[2]],g:qn[t[3]]<<4|qn[t[4]],b:qn[t[5]]<<4|qn[t[6]],a:n===9?qn[t[7]]<<4|qn[t[8]]:255})),e}var Yg=(t,n)=>t<255?n(t):"";function Xg(t){var n=Gg(t)?Wg:jg;return t?"#"+n(t.r)+n(t.g)+n(t.b)+Yg(t.a,n):void 0}var Kg=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Cd(t,n,e){let i=n*Math.min(e,1-e),r=(a,s=(a+t/30)%12)=>e-i*Math.max(Math.min(s-3,9-s,1),-1);return[r(0),r(8),r(4)]}function qg(t,n,e){let i=(r,a=(r+t/60)%6)=>e-e*n*Math.max(Math.min(a,4-a,1),0);return[i(5),i(3),i(1)]}function Jg(t,n,e){let i=Cd(t,1,.5),r;for(n+e>1&&(r=1/(n+e),n*=r,e*=r),r=0;r<3;r++)i[r]*=1-n-e,i[r]+=n;return i}function Qg(t,n,e,i,r){return t===r?(n-e)/i+(n<e?6:0):n===r?(e-t)/i+2:(t-n)/i+4}function Hl(t){let e=t.r/255,i=t.g/255,r=t.b/255,a=Math.max(e,i,r),s=Math.min(e,i,r),o=(a+s)/2,l,c,f;return a!==s&&(f=a-s,c=o>.5?f/(2-a-s):f/(a+s),l=Qg(e,i,r,f,a),l=l*60+.5),[l|0,c||0,o]}function Ul(t,n,e,i){return(Array.isArray(n)?t(n[0],n[1],n[2]):t(n,e,i)).map(sr)}function zl(t,n,e){return Ul(Cd,t,n,e)}function Zg(t,n,e){return Ul(Jg,t,n,e)}function ex(t,n,e){return Ul(qg,t,n,e)}function kd(t){return(t%360+360)%360}function tx(t){let n=Kg.exec(t),e=255,i;if(!n)return;n[5]!==i&&(e=n[6]?ja(+n[5]):sr(+n[5]));let r=kd(+n[2]),a=+n[3]/100,s=+n[4]/100;return n[1]==="hwb"?i=Zg(r,a,s):n[1]==="hsv"?i=ex(r,a,s):i=zl(r,a,s),{r:i[0],g:i[1],b:i[2],a:e}}function nx(t,n){var e=Hl(t);e[0]=kd(e[0]+n),e=zl(e),t.r=e[0],t.g=e[1],t.b=e[2]}function ix(t){if(!t)return;let n=Hl(t),e=n[0],i=wd(n[1]),r=wd(n[2]);return t.a<255?`hsla(${e}, ${i}%, ${r}%, ${Ri(t.a)})`:`hsl(${e}, ${i}%, ${r}%)`}var bd={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},yd={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function rx(){let t={},n=Object.keys(yd),e=Object.keys(bd),i,r,a,s,o;for(i=0;i<n.length;i++){for(s=o=n[i],r=0;r<e.length;r++)a=e[r],o=o.replace(a,bd[a]);a=parseInt(yd[s],16),t[o]=[a>>16&255,a>>8&255,a&255]}return t}var vo;function ax(t){vo||(vo=rx(),vo.transparent=[0,0,0,0]);let n=vo[t.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:n.length===4?n[3]:255}}var sx=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ox(t){let n=sx.exec(t),e=255,i,r,a;if(n){if(n[7]!==i){let s=+n[7];e=n[8]?ja(s):ar(s*255,0,255)}return i=+n[1],r=+n[3],a=+n[5],i=255&(n[2]?ja(i):ar(i,0,255)),r=255&(n[4]?ja(r):ar(r,0,255)),a=255&(n[6]?ja(a):ar(a,0,255)),{r:i,g:r,b:a,a:e}}}function lx(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ri(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}var Nl=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,oa=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function cx(t,n,e){let i=oa(Ri(t.r)),r=oa(Ri(t.g)),a=oa(Ri(t.b));return{r:sr(Nl(i+e*(oa(Ri(n.r))-i))),g:sr(Nl(r+e*(oa(Ri(n.g))-r))),b:sr(Nl(a+e*(oa(Ri(n.b))-a))),a:t.a+e*(n.a-t.a)}}function wo(t,n,e){if(t){let i=Hl(t);i[n]=Math.max(0,Math.min(i[n]+i[n]*e,n===0?360:1)),i=zl(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function Ed(t,n){return t&&Object.assign(n||{},t)}function Sd(t){var n={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(n={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(n.a=sr(t[3]))):(n=Ed(t,{r:0,g:0,b:0,a:1}),n.a=sr(n.a)),n}function dx(t){return t.charAt(0)==="r"?ox(t):tx(t)}var Ga=class t{constructor(n){if(n instanceof t)return n;let e=typeof n,i;e==="object"?i=Sd(n):e==="string"&&(i=$g(n)||ax(n)||dx(n)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var n=Ed(this._rgb);return n&&(n.a=Ri(n.a)),n}set rgb(n){this._rgb=Sd(n)}rgbString(){return this._valid?lx(this._rgb):void 0}hexString(){return this._valid?Xg(this._rgb):void 0}hslString(){return this._valid?ix(this._rgb):void 0}mix(n,e){if(n){let i=this.rgb,r=n.rgb,a,s=e===a?.5:e,o=2*s-1,l=i.a-r.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;a=1-c,i.r=255&c*i.r+a*r.r+.5,i.g=255&c*i.g+a*r.g+.5,i.b=255&c*i.b+a*r.b+.5,i.a=s*i.a+(1-s)*r.a,this.rgb=i}return this}interpolate(n,e){return n&&(this._rgb=cx(this._rgb,n._rgb,e)),this}clone(){return new t(this.rgb)}alpha(n){return this._rgb.a=sr(n),this}clearer(n){let e=this._rgb;return e.a*=1-n,this}greyscale(){let n=this._rgb,e=$a(n.r*.3+n.g*.59+n.b*.11);return n.r=n.g=n.b=e,this}opaquer(n){let e=this._rgb;return e.a*=1+n,this}negate(){let n=this._rgb;return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,this}lighten(n){return wo(this._rgb,2,n),this}darken(n){return wo(this._rgb,2,-n),this}saturate(n){return wo(this._rgb,1,n),this}desaturate(n){return wo(this._rgb,1,-n),this}rotate(n){return nx(this._rgb,n),this}};function yi(){}var Vd=(()=>{let t=0;return()=>t++})();function Ye(t){return t==null}function pt(t){if(Array.isArray&&Array.isArray(t))return!0;let n=Object.prototype.toString.call(t);return n.slice(0,7)==="[object"&&n.slice(-6)==="Array]"}function Ke(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Et(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Vn(t,n){return Et(t)?t:n}function Be(t,n){return typeof t>"u"?n:t}var Nd=(t,n)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/n,$l=(t,n)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*n:+t;function ht(t,n,e){if(t&&typeof t.call=="function")return t.apply(e,n)}function lt(t,n,e,i){let r,a,s;if(pt(t))if(a=t.length,i)for(r=a-1;r>=0;r--)n.call(e,t[r],r);else for(r=0;r<a;r++)n.call(e,t[r],r);else if(Ke(t))for(s=Object.keys(t),a=s.length,r=0;r<a;r++)n.call(e,t[s[r]],s[r])}function Ka(t,n){let e,i,r,a;if(!t||!n||t.length!==n.length)return!1;for(e=0,i=t.length;e<i;++e)if(r=t[e],a=n[e],r.datasetIndex!==a.datasetIndex||r.index!==a.index)return!1;return!0}function ko(t){if(pt(t))return t.map(ko);if(Ke(t)){let n=Object.create(null),e=Object.keys(t),i=e.length,r=0;for(;r<i;++r)n[e[r]]=ko(t[e[r]]);return n}return t}function Bd(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function fx(t,n,e,i){if(!Bd(t))return;let r=n[t],a=e[t];Ke(r)&&Ke(a)?ca(r,a,i):n[t]=ko(a)}function ca(t,n,e){let i=pt(n)?n:[n],r=i.length;if(!Ke(t))return t;e=e||{};let a=e.merger||fx,s;for(let o=0;o<r;++o){if(s=i[o],!Ke(s))continue;let l=Object.keys(s);for(let c=0,f=l.length;c<f;++c)a(l[c],t,s,e)}return t}function fa(t,n){return ca(t,n,{merger:ux})}function ux(t,n,e){if(!Bd(t))return;let i=n[t],r=e[t];Ke(i)&&Ke(r)?fa(i,r):Object.prototype.hasOwnProperty.call(n,t)||(n[t]=ko(r))}var Td={"":t=>t,x:t=>t.x,y:t=>t.y};function hx(t){let n=t.split("."),e=[],i="";for(let r of n)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}function mx(t){let n=hx(t);return e=>{for(let i of n){if(i==="")break;e=e&&e[i]}return e}}function Bi(t,n){return(Td[n]||(Td[n]=mx(n)))(t)}function Mo(t){return t.charAt(0).toUpperCase()+t.slice(1)}var ua=t=>typeof t<"u",Vi=t=>typeof t=="function",Yl=(t,n)=>{if(t.size!==n.size)return!1;for(let e of t)if(!n.has(e))return!1;return!0};function Hd(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}var et=Math.PI,gt=2*et,px=gt+et,Eo=Number.POSITIVE_INFINITY,gx=et/180,Tt=et/2,Er=et/4,Ad=et*2/3,Ni=Math.log10,si=Math.sign;function ha(t,n,e){return Math.abs(t-n)<e}function Xl(t){let n=Math.round(t);t=ha(t,n,t/1e3)?n:t;let e=Math.pow(10,Math.floor(Ni(t))),i=t/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function Ud(t){let n=[],e=Math.sqrt(t),i;for(i=1;i<e;i++)t%i===0&&(n.push(i),n.push(t/i));return e===(e|0)&&n.push(e),n.sort((r,a)=>r-a).pop(),n}function xx(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Mr(t){return!xx(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function zd(t,n){let e=Math.round(t);return e-n<=t&&e+n>=t}function Kl(t,n,e){let i,r,a;for(i=0,r=t.length;i<r;i++)a=t[i][e],isNaN(a)||(n.min=Math.min(n.min,a),n.max=Math.max(n.max,a))}function Jn(t){return t*(et/180)}function Do(t){return t*(180/et)}function ql(t){if(!Et(t))return;let n=1,e=0;for(;Math.round(t*n)/n!==t;)n*=10,e++;return e}function Jl(t,n){let e=n.x-t.x,i=n.y-t.y,r=Math.sqrt(e*e+i*i),a=Math.atan2(i,e);return a<-.5*et&&(a+=gt),{angle:a,distance:r}}function To(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}function _x(t,n){return(t-n+px)%gt-et}function en(t){return(t%gt+gt)%gt}function ma(t,n,e,i){let r=en(t),a=en(n),s=en(e),o=en(a-r),l=en(s-r),c=en(r-a),f=en(r-s);return r===a||r===s||i&&a===s||o>l&&c<f}function jt(t,n,e){return Math.max(n,Math.min(e,t))}function Wd(t){return jt(t,-32768,32767)}function Si(t,n,e,i=1e-6){return t>=Math.min(n,e)-i&&t<=Math.max(n,e)+i}function Fo(t,n,e){e=e||(s=>t[s]<n);let i=t.length-1,r=0,a;for(;i-r>1;)a=r+i>>1,e(a)?r=a:i=a;return{lo:r,hi:i}}var wi=(t,n,e,i)=>Fo(t,e,i?r=>{let a=t[r][n];return a<e||a===e&&t[r+1][n]===e}:r=>t[r][n]<e),jd=(t,n,e)=>Fo(t,e,i=>t[i][n]>=e);function Gd(t,n,e){let i=0,r=t.length;for(;i<r&&t[i]<n;)i++;for(;r>i&&t[r-1]>e;)r--;return i>0||r<t.length?t.slice(i,r):t}var $d=["push","pop","shift","splice","unshift"];function Yd(t,n){if(t._chartjs){t._chartjs.listeners.push(n);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),$d.forEach(e=>{let i="_onData"+Mo(e),r=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...a){let s=r.apply(this,a);return t._chartjs.listeners.forEach(o=>{typeof o[i]=="function"&&o[i](...a)}),s}})})}function Ql(t,n){let e=t._chartjs;if(!e)return;let i=e.listeners,r=i.indexOf(n);r!==-1&&i.splice(r,1),!(i.length>0)&&($d.forEach(a=>{delete t[a]}),delete t._chartjs)}function Zl(t){let n=new Set(t);return n.size===t.length?t:Array.from(n)}var e0=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function t0(t,n){let e=[],i=!1;return function(...r){e=r,i||(i=!0,e0.call(window,()=>{i=!1,t.apply(n,e)}))}}function Xd(t,n){let e;return function(...i){return n?(clearTimeout(e),e=setTimeout(t,n,i)):t.apply(this,i),n}}var Io=t=>t==="start"?"left":t==="end"?"right":"center",tn=(t,n,e)=>t==="start"?n:t==="end"?e:(n+e)/2,Kd=(t,n,e,i)=>t===(i?"left":"right")?e:t==="center"?(n+e)/2:n;function n0(t,n,e){let i=n.length,r=0,a=i;if(t._sorted){let{iScale:s,vScale:o,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,f=s.axis,{min:h,max:m,minDefined:p,maxDefined:v}=s.getUserBounds();if(p){if(r=Math.min(wi(l,f,h).lo,e?i:wi(n,f,s.getPixelForValue(h)).lo),c){let _=l.slice(0,r+1).reverse().findIndex(w=>!Ye(w[o.axis]));r-=Math.max(0,_)}r=jt(r,0,i-1)}if(v){let _=Math.max(wi(l,s.axis,m,!0).hi+1,e?0:wi(n,f,s.getPixelForValue(m),!0).hi+1);if(c){let w=l.slice(_-1).findIndex(E=>!Ye(E[o.axis]));_+=Math.max(0,w)}a=jt(_,r,i)-r}else a=i-r}return{start:r,count:a}}function i0(t){let{xScale:n,yScale:e,_scaleRanges:i}=t,r={xmin:n.min,xmax:n.max,ymin:e.min,ymax:e.max};if(!i)return t._scaleRanges=r,!0;let a=i.xmin!==n.min||i.xmax!==n.max||i.ymin!==e.min||i.ymax!==e.max;return Object.assign(i,r),a}var bo=t=>t===0||t===1,Md=(t,n,e)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-n)*gt/e)),Dd=(t,n,e)=>Math.pow(2,-10*t)*Math.sin((t-n)*gt/e)+1,la={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Tt)+1,easeOutSine:t=>Math.sin(t*Tt),easeInOutSine:t=>-.5*(Math.cos(et*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>bo(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>bo(t)?t:Md(t,.075,.3),easeOutElastic:t=>bo(t)?t:Dd(t,.075,.3),easeInOutElastic(t){return bo(t)?t:t<.5?.5*Md(t*2,.1125,.45):.5+.5*Dd(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let n=1.70158;return(t/=.5)<1?.5*(t*t*(((n*=1.525)+1)*t-n)):.5*((t-=2)*t*(((n*=1.525)+1)*t+n)+2)},easeInBounce:t=>1-la.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?la.easeInBounce(t*2)*.5:la.easeOutBounce(t*2-1)*.5+.5};function r0(t){if(t&&typeof t=="object"){let n=t.toString();return n==="[object CanvasPattern]"||n==="[object CanvasGradient]"}return!1}function a0(t){return r0(t)?t:new Ga(t)}function Wl(t){return r0(t)?t:new Ga(t).saturate(.5).darken(.1).hexString()}var vx=["x","y","borderWidth","radius","tension"],wx=["color","borderColor","backgroundColor"];function bx(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>n!=="onProgress"&&n!=="onComplete"&&n!=="fn"}),t.set("animations",{colors:{type:"color",properties:wx},numbers:{type:"number",properties:vx}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>n|0}}}})}function yx(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var Fd=new Map;function Sx(t,n){n=n||{};let e=t+JSON.stringify(n),i=Fd.get(e);return i||(i=new Intl.NumberFormat(t,n),Fd.set(e,i)),i}function pa(t,n,e){return Sx(n,e).format(t)}var qd={values(t){return pt(t)?t:""+t},numeric(t,n,e){if(t===0)return"0";let i=this.chart.options.locale,r,a=t;if(e.length>1){let c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),a=Cx(t,e)}let s=Ni(Math.abs(a)),o=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),pa(t,i,l)},logarithmic(t,n,e){if(t===0)return"0";let i=e[n].significand||t/Math.pow(10,Math.floor(Ni(t)));return[1,2,3,5,10,15].includes(i)||n>.8*e.length?qd.numeric.call(this,t,n,e):""}};function Cx(t,n){let e=n.length>3?n[2].value-n[1].value:n[1].value-n[0].value;return Math.abs(e)>=1&&t!==Math.floor(t)&&(e=t-Math.floor(t)),e}var qa={formatters:qd};function kx(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,e)=>e.lineWidth,tickColor:(n,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:qa.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&n!=="callback"&&n!=="parser",_indexable:n=>n!=="borderDash"&&n!=="tickBorderDash"&&n!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:n=>n!=="backdropPadding"&&n!=="callback",_indexable:n=>n!=="backdropPadding"})}var lr=Object.create(null),Po=Object.create(null);function Ya(t,n){if(!n)return t;let e=n.split(".");for(let i=0,r=e.length;i<r;++i){let a=e[i];t=t[a]||(t[a]=Object.create(null))}return t}function jl(t,n,e){return typeof n=="string"?ca(Ya(t,n),e):ca(Ya(t,""),n)}var Gl=class{constructor(n,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>Wl(r.backgroundColor),this.hoverBorderColor=(i,r)=>Wl(r.borderColor),this.hoverColor=(i,r)=>Wl(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(n),this.apply(e)}set(n,e){return jl(this,n,e)}get(n){return Ya(this,n)}describe(n,e){return jl(Po,n,e)}override(n,e){return jl(lr,n,e)}route(n,e,i,r){let a=Ya(this,n),s=Ya(this,i),o="_"+e;Object.defineProperties(a,{[o]:{value:a[e],writable:!0},[e]:{enumerable:!0,get(){let l=this[o],c=s[r];return Ke(l)?Object.assign({},c,l):Be(l,c)},set(l){this[o]=l}}})}apply(n){n.forEach(e=>e(this))}},wt=new Gl({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[bx,yx,kx]);function Ex(t){return!t||Ye(t.size)||Ye(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Xa(t,n,e,i,r){let a=n[r];return a||(a=n[r]=t.measureText(r).width,e.push(r)),a>i&&(i=a),i}function Jd(t,n,e,i){i=i||{};let r=i.data=i.data||{},a=i.garbageCollect=i.garbageCollect||[];i.font!==n&&(r=i.data={},a=i.garbageCollect=[],i.font=n),t.save(),t.font=n;let s=0,o=e.length,l,c,f,h,m;for(l=0;l<o;l++)if(h=e[l],h!=null&&!pt(h))s=Xa(t,r,a,s,h);else if(pt(h))for(c=0,f=h.length;c<f;c++)m=h[c],m!=null&&!pt(m)&&(s=Xa(t,r,a,s,m));t.restore();let p=a.length/2;if(p>e.length){for(l=0;l<p;l++)delete r[a[l]];a.splice(0,p)}return s}function cr(t,n,e){let i=t.currentDevicePixelRatio,r=e!==0?Math.max(e/2,.5):0;return Math.round((n-r)*i)/i+r}function s0(t,n){!n&&!t||(n=n||t.getContext("2d"),n.save(),n.resetTransform(),n.clearRect(0,0,t.width,t.height),n.restore())}function Oo(t,n,e,i){o0(t,n,e,i,null)}function o0(t,n,e,i,r){let a,s,o,l,c,f,h,m,p=n.pointStyle,v=n.rotation,_=n.radius,w=(v||0)*gx;if(p&&typeof p=="object"&&(a=p.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){t.save(),t.translate(e,i),t.rotate(w),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(_)||_<=0)){switch(t.beginPath(),p){default:r?t.ellipse(e,i,r/2,_,0,0,gt):t.arc(e,i,_,0,gt),t.closePath();break;case"triangle":f=r?r/2:_,t.moveTo(e+Math.sin(w)*f,i-Math.cos(w)*_),w+=Ad,t.lineTo(e+Math.sin(w)*f,i-Math.cos(w)*_),w+=Ad,t.lineTo(e+Math.sin(w)*f,i-Math.cos(w)*_),t.closePath();break;case"rectRounded":c=_*.516,l=_-c,s=Math.cos(w+Er)*l,h=Math.cos(w+Er)*(r?r/2-c:l),o=Math.sin(w+Er)*l,m=Math.sin(w+Er)*(r?r/2-c:l),t.arc(e-h,i-o,c,w-et,w-Tt),t.arc(e+m,i-s,c,w-Tt,w),t.arc(e+h,i+o,c,w,w+Tt),t.arc(e-m,i+s,c,w+Tt,w+et),t.closePath();break;case"rect":if(!v){l=Math.SQRT1_2*_,f=r?r/2:l,t.rect(e-f,i-l,2*f,2*l);break}w+=Er;case"rectRot":h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,m=Math.sin(w)*(r?r/2:_),t.moveTo(e-h,i-o),t.lineTo(e+m,i-s),t.lineTo(e+h,i+o),t.lineTo(e-m,i+s),t.closePath();break;case"crossRot":w+=Er;case"cross":h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,m=Math.sin(w)*(r?r/2:_),t.moveTo(e-h,i-o),t.lineTo(e+h,i+o),t.moveTo(e+m,i-s),t.lineTo(e-m,i+s);break;case"star":h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,m=Math.sin(w)*(r?r/2:_),t.moveTo(e-h,i-o),t.lineTo(e+h,i+o),t.moveTo(e+m,i-s),t.lineTo(e-m,i+s),w+=Er,h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,m=Math.sin(w)*(r?r/2:_),t.moveTo(e-h,i-o),t.lineTo(e+h,i+o),t.moveTo(e+m,i-s),t.lineTo(e-m,i+s);break;case"line":s=r?r/2:Math.cos(w)*_,o=Math.sin(w)*_,t.moveTo(e-s,i-o),t.lineTo(e+s,i+o);break;case"dash":t.moveTo(e,i),t.lineTo(e+Math.cos(w)*(r?r/2:_),i+Math.sin(w)*_);break;case!1:t.closePath();break}t.fill(),n.borderWidth>0&&t.stroke()}}function bi(t,n,e){return e=e||.5,!n||t&&t.x>n.left-e&&t.x<n.right+e&&t.y>n.top-e&&t.y<n.bottom+e}function Ja(t,n){t.save(),t.beginPath(),t.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),t.clip()}function Qa(t){t.restore()}function Qd(t,n,e,i,r){if(!n)return t.lineTo(e.x,e.y);if(r==="middle"){let a=(n.x+e.x)/2;t.lineTo(a,n.y),t.lineTo(a,e.y)}else r==="after"!=!!i?t.lineTo(n.x,e.y):t.lineTo(e.x,n.y);t.lineTo(e.x,e.y)}function Zd(t,n,e,i){if(!n)return t.lineTo(e.x,e.y);t.bezierCurveTo(i?n.cp1x:n.cp2x,i?n.cp1y:n.cp2y,i?e.cp2x:e.cp1x,i?e.cp2y:e.cp1y,e.x,e.y)}function Tx(t,n){n.translation&&t.translate(n.translation[0],n.translation[1]),Ye(n.rotation)||t.rotate(n.rotation),n.color&&(t.fillStyle=n.color),n.textAlign&&(t.textAlign=n.textAlign),n.textBaseline&&(t.textBaseline=n.textBaseline)}function Ax(t,n,e,i,r){if(r.strikethrough||r.underline){let a=t.measureText(i),s=n-a.actualBoundingBoxLeft,o=n+a.actualBoundingBoxRight,l=e-a.actualBoundingBoxAscent,c=e+a.actualBoundingBoxDescent,f=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(s,f),t.lineTo(o,f),t.stroke()}}function Mx(t,n){let e=t.fillStyle;t.fillStyle=n.color,t.fillRect(n.left,n.top,n.width,n.height),t.fillStyle=e}function dr(t,n,e,i,r,a={}){let s=pt(n)?n:[n],o=a.strokeWidth>0&&a.strokeColor!=="",l,c;for(t.save(),t.font=r.string,Tx(t,a),l=0;l<s.length;++l)c=s[l],a.backdrop&&Mx(t,a.backdrop),o&&(a.strokeColor&&(t.strokeStyle=a.strokeColor),Ye(a.strokeWidth)||(t.lineWidth=a.strokeWidth),t.strokeText(c,e,i,a.maxWidth)),t.fillText(c,e,i,a.maxWidth),Ax(t,e,i,c,a),i+=Number(r.lineHeight);t.restore()}function ga(t,n){let{x:e,y:i,w:r,h:a,radius:s}=n;t.arc(e+s.topLeft,i+s.topLeft,s.topLeft,1.5*et,et,!0),t.lineTo(e,i+a-s.bottomLeft),t.arc(e+s.bottomLeft,i+a-s.bottomLeft,s.bottomLeft,et,Tt,!0),t.lineTo(e+r-s.bottomRight,i+a),t.arc(e+r-s.bottomRight,i+a-s.bottomRight,s.bottomRight,Tt,0,!0),t.lineTo(e+r,i+s.topRight),t.arc(e+r-s.topRight,i+s.topRight,s.topRight,0,-Tt,!0),t.lineTo(e+s.topLeft,i)}var Dx=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Fx=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Ix(t,n){let e=(""+t).match(Dx);if(!e||e[1]==="normal")return n*1.2;switch(t=+e[2],e[3]){case"px":return t;case"%":t/=100;break}return n*t}var Px=t=>+t||0;function Lo(t,n){let e={},i=Ke(n),r=i?Object.keys(n):n,a=Ke(t)?i?s=>Be(t[s],t[n[s]]):s=>t[s]:()=>t;for(let s of r)e[s]=Px(a(s));return e}function l0(t){return Lo(t,{top:"y",right:"x",bottom:"y",left:"x"})}function fr(t){return Lo(t,["topLeft","topRight","bottomLeft","bottomRight"])}function nn(t){let n=l0(t);return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function Nt(t,n){t=t||{},n=n||wt.font;let e=Be(t.size,n.size);typeof e=="string"&&(e=parseInt(e,10));let i=Be(t.style,n.style);i&&!(""+i).match(Fx)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);let r={family:Be(t.family,n.family),lineHeight:Ix(Be(t.lineHeight,n.lineHeight),e),size:e,style:i,weight:Be(t.weight,n.weight),string:""};return r.string=Ex(r),r}function xa(t,n,e,i){let r=!0,a,s,o;for(a=0,s=t.length;a<s;++a)if(o=t[a],o!==void 0&&(n!==void 0&&typeof o=="function"&&(o=o(n),r=!1),e!==void 0&&pt(o)&&(o=o[e%o.length],r=!1),o!==void 0))return i&&!r&&(i.cacheable=!1),o}function ef(t,n,e){let{min:i,max:r}=t,a=$l(n,(r-i)/2),s=(o,l)=>e&&o===0?0:o+l;return{min:s(i,-Math.abs(a)),max:s(r,a)}}function Hi(t,n){return Object.assign(Object.create(t),n)}function Ro(t,n=[""],e,i,r=()=>t[0]){let a=e||t;typeof i>"u"&&(i=rf("_fallback",t));let s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:a,_fallback:i,_getTarget:r,override:o=>Ro([o,...t],n,a,i)};return new Proxy(s,{deleteProperty(o,l){return delete o[l],delete o._keys,delete t[0][l],!0},get(o,l){return tf(o,l,()=>Ux(l,n,t,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(o,l){return Pd(o).includes(l)},ownKeys(o){return Pd(o)},set(o,l,c){let f=o._storage||(o._storage=r());return o[l]=f[l]=c,delete o._keys,!0}})}function Ar(t,n,e,i){let r={_cacheable:!1,_proxy:t,_context:n,_subProxy:e,_stack:new Set,_descriptors:c0(t,i),setContext:a=>Ar(t,a,e,i),override:a=>Ar(t.override(a),n,e,i)};return new Proxy(r,{deleteProperty(a,s){return delete a[s],delete t[s],!0},get(a,s,o){return tf(a,s,()=>Lx(a,s,o))},getOwnPropertyDescriptor(a,s){return a._descriptors.allKeys?Reflect.has(t,s)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,s)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(a,s){return Reflect.has(t,s)},ownKeys(){return Reflect.ownKeys(t)},set(a,s,o){return t[s]=o,delete a[s],!0}})}function c0(t,n={scriptable:!0,indexable:!0}){let{_scriptable:e=n.scriptable,_indexable:i=n.indexable,_allKeys:r=n.allKeys}=t;return{allKeys:r,scriptable:e,indexable:i,isScriptable:Vi(e)?e:()=>e,isIndexable:Vi(i)?i:()=>i}}var Ox=(t,n)=>t?t+Mo(n):n,d0=(t,n)=>Ke(n)&&t!=="adapters"&&(Object.getPrototypeOf(n)===null||n.constructor===Object);function tf(t,n,e){if(Object.prototype.hasOwnProperty.call(t,n)||n==="constructor")return t[n];let i=e();return t[n]=i,i}function Lx(t,n,e){let{_proxy:i,_context:r,_subProxy:a,_descriptors:s}=t,o=i[n];return Vi(o)&&s.isScriptable(n)&&(o=Rx(n,o,t,e)),pt(o)&&o.length&&(o=Vx(n,o,t,s.isIndexable)),d0(n,o)&&(o=Ar(o,r,a&&a[n],s)),o}function Rx(t,n,e,i){let{_proxy:r,_context:a,_subProxy:s,_stack:o}=e;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let l=n(a,s||i);return o.delete(t),d0(t,l)&&(l=f0(r._scopes,r,t,l)),l}function Vx(t,n,e,i){let{_proxy:r,_context:a,_subProxy:s,_descriptors:o}=e;if(typeof a.index<"u"&&i(t))return n[a.index%n.length];if(Ke(n[0])){let l=n,c=r._scopes.filter(f=>f!==l);n=[];for(let f of l){let h=f0(c,r,t,f);n.push(Ar(h,a,s&&s[t],o))}}return n}function nf(t,n,e){return Vi(t)?t(n,e):t}var Nx=(t,n)=>t===!0?n:typeof t=="string"?Bi(n,t):void 0;function Bx(t,n,e,i,r){for(let a of n){let s=Nx(e,a);if(s){t.add(s);let o=nf(s._fallback,e,r);if(typeof o<"u"&&o!==e&&o!==i)return o}else if(s===!1&&typeof i<"u"&&e!==i)return null}return!1}function f0(t,n,e,i){let r=n._rootScopes,a=nf(n._fallback,e,i),s=[...t,...r],o=new Set;o.add(i);let l=Id(o,s,e,a||e,i);return l===null||typeof a<"u"&&a!==e&&(l=Id(o,s,a,l,i),l===null)?!1:Ro(Array.from(o),[""],r,a,()=>Hx(n,e,i))}function Id(t,n,e,i,r){for(;e;)e=Bx(t,n,e,i,r);return e}function Hx(t,n,e){let i=t._getTarget();n in i||(i[n]={});let r=i[n];return pt(r)&&Ke(e)?e:r||{}}function Ux(t,n,e,i){let r;for(let a of n)if(r=rf(Ox(a,t),e),typeof r<"u")return d0(t,r)?f0(e,i,t,r):r}function rf(t,n){for(let e of n){if(!e)continue;let i=e[t];if(typeof i<"u")return i}}function Pd(t){let n=t._keys;return n||(n=t._keys=zx(t._scopes)),n}function zx(t){let n=new Set;for(let e of t)for(let i of Object.keys(e).filter(r=>!r.startsWith("_")))n.add(i);return Array.from(n)}function u0(t,n,e,i){let{iScale:r}=t,{key:a="r"}=this._parsing,s=new Array(i),o,l,c,f;for(o=0,l=i;o<l;++o)c=o+e,f=n[c],s[o]={r:r.parse(Bi(f,a),c)};return s}var Wx=Number.EPSILON||1e-14,da=(t,n)=>n<t.length&&!t[n].skip&&t[n],af=t=>t==="x"?"y":"x";function jx(t,n,e,i){let r=t.skip?n:t,a=n,s=e.skip?n:e,o=To(a,r),l=To(s,a),c=o/(o+l),f=l/(o+l);c=isNaN(c)?0:c,f=isNaN(f)?0:f;let h=i*c,m=i*f;return{previous:{x:a.x-h*(s.x-r.x),y:a.y-h*(s.y-r.y)},next:{x:a.x+m*(s.x-r.x),y:a.y+m*(s.y-r.y)}}}function Gx(t,n,e){let i=t.length,r,a,s,o,l,c=da(t,0);for(let f=0;f<i-1;++f)if(l=c,c=da(t,f+1),!(!l||!c)){if(ha(n[f],0,Wx)){e[f]=e[f+1]=0;continue}r=e[f]/n[f],a=e[f+1]/n[f],o=Math.pow(r,2)+Math.pow(a,2),!(o<=9)&&(s=3/Math.sqrt(o),e[f]=r*s*n[f],e[f+1]=a*s*n[f])}}function $x(t,n,e="x"){let i=af(e),r=t.length,a,s,o,l=da(t,0);for(let c=0;c<r;++c){if(s=o,o=l,l=da(t,c+1),!o)continue;let f=o[e],h=o[i];s&&(a=(f-s[e])/3,o[`cp1${e}`]=f-a,o[`cp1${i}`]=h-a*n[c]),l&&(a=(l[e]-f)/3,o[`cp2${e}`]=f+a,o[`cp2${i}`]=h+a*n[c])}}function Yx(t,n="x"){let e=af(n),i=t.length,r=Array(i).fill(0),a=Array(i),s,o,l,c=da(t,0);for(s=0;s<i;++s)if(o=l,l=c,c=da(t,s+1),!!l){if(c){let f=c[n]-l[n];r[s]=f!==0?(c[e]-l[e])/f:0}a[s]=o?c?si(r[s-1])!==si(r[s])?0:(r[s-1]+r[s])/2:r[s-1]:r[s]}Gx(t,r,a),$x(t,a,n)}function yo(t,n,e){return Math.max(Math.min(t,e),n)}function Xx(t,n){let e,i,r,a,s,o=bi(t[0],n);for(e=0,i=t.length;e<i;++e)s=a,a=o,o=e<i-1&&bi(t[e+1],n),a&&(r=t[e],s&&(r.cp1x=yo(r.cp1x,n.left,n.right),r.cp1y=yo(r.cp1y,n.top,n.bottom)),o&&(r.cp2x=yo(r.cp2x,n.left,n.right),r.cp2y=yo(r.cp2y,n.top,n.bottom)))}function sf(t,n,e,i,r){let a,s,o,l;if(n.spanGaps&&(t=t.filter(c=>!c.skip)),n.cubicInterpolationMode==="monotone")Yx(t,r);else{let c=i?t[t.length-1]:t[0];for(a=0,s=t.length;a<s;++a)o=t[a],l=jx(c,o,t[Math.min(a+1,s-(i?0:1))%s],n.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}n.capBezierPoints&&Xx(t,e)}function Vo(){return typeof window<"u"&&typeof document<"u"}function No(t){let n=t.parentNode;return n&&n.toString()==="[object ShadowRoot]"&&(n=n.host),n}function Ao(t,n,e){let i;return typeof t=="string"?(i=parseInt(t,10),t.indexOf("%")!==-1&&(i=i/100*n.parentNode[e])):i=t,i}var Bo=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Kx(t,n){return Bo(t).getPropertyValue(n)}var qx=["top","right","bottom","left"];function Tr(t,n,e){let i={};e=e?"-"+e:"";for(let r=0;r<4;r++){let a=qx[r];i[a]=parseFloat(t[n+"-"+a+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}var Jx=(t,n,e)=>(t>0||n>0)&&(!e||!e.shadowRoot);function Qx(t,n){let e=t.touches,i=e&&e.length?e[0]:t,{offsetX:r,offsetY:a}=i,s=!1,o,l;if(Jx(r,a,t.target))o=r,l=a;else{let c=n.getBoundingClientRect();o=i.clientX-c.left,l=i.clientY-c.top,s=!0}return{x:o,y:l,box:s}}function ur(t,n){if("native"in t)return t;let{canvas:e,currentDevicePixelRatio:i}=n,r=Bo(e),a=r.boxSizing==="border-box",s=Tr(r,"padding"),o=Tr(r,"border","width"),{x:l,y:c,box:f}=Qx(t,e),h=s.left+(f&&o.left),m=s.top+(f&&o.top),{width:p,height:v}=n;return a&&(p-=s.width+o.width,v-=s.height+o.height),{x:Math.round((l-h)/p*e.width/i),y:Math.round((c-m)/v*e.height/i)}}function Zx(t,n,e){let i,r;if(n===void 0||e===void 0){let a=t&&No(t);if(!a)n=t.clientWidth,e=t.clientHeight;else{let s=a.getBoundingClientRect(),o=Bo(a),l=Tr(o,"border","width"),c=Tr(o,"padding");n=s.width-c.width-l.width,e=s.height-c.height-l.height,i=Ao(o.maxWidth,a,"clientWidth"),r=Ao(o.maxHeight,a,"clientHeight")}}return{width:n,height:e,maxWidth:i||Eo,maxHeight:r||Eo}}var So=t=>Math.round(t*10)/10;function of(t,n,e,i){let r=Bo(t),a=Tr(r,"margin"),s=Ao(r.maxWidth,t,"clientWidth")||Eo,o=Ao(r.maxHeight,t,"clientHeight")||Eo,l=Zx(t,n,e),{width:c,height:f}=l;if(r.boxSizing==="content-box"){let m=Tr(r,"border","width"),p=Tr(r,"padding");c-=p.width+m.width,f-=p.height+m.height}return c=Math.max(0,c-a.width),f=Math.max(0,i?c/i:f-a.height),c=So(Math.min(c,s,l.maxWidth)),f=So(Math.min(f,o,l.maxHeight)),c&&!f&&(f=So(c/2)),(n!==void 0||e!==void 0)&&i&&l.height&&f>l.height&&(f=l.height,c=So(Math.floor(f*i))),{width:c,height:f}}function h0(t,n,e){let i=n||1,r=Math.floor(t.height*i),a=Math.floor(t.width*i);t.height=Math.floor(t.height),t.width=Math.floor(t.width);let s=t.canvas;return s.style&&(e||!s.style.height&&!s.style.width)&&(s.style.height=`${t.height}px`,s.style.width=`${t.width}px`),t.currentDevicePixelRatio!==i||s.height!==r||s.width!==a?(t.currentDevicePixelRatio=i,s.height=r,s.width=a,t.ctx.setTransform(i,0,0,i,0,0),!0):!1}var lf=function(){let t=!1;try{let n={get passive(){return t=!0,!1}};Vo()&&(window.addEventListener("test",null,n),window.removeEventListener("test",null,n))}catch{}return t}();function m0(t,n){let e=Kx(t,n),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function or(t,n,e,i){return{x:t.x+e*(n.x-t.x),y:t.y+e*(n.y-t.y)}}function cf(t,n,e,i){return{x:t.x+e*(n.x-t.x),y:i==="middle"?e<.5?t.y:n.y:i==="after"?e<1?t.y:n.y:e>0?n.y:t.y}}function df(t,n,e,i){let r={x:t.cp2x,y:t.cp2y},a={x:n.cp1x,y:n.cp1y},s=or(t,r,e),o=or(r,a,e),l=or(a,n,e),c=or(s,o,e),f=or(o,l,e);return or(c,f,e)}var e2=function(t,n){return{x(e){return t+t+n-e},setWidth(e){n=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,i){return e-i},leftForLtr(e,i){return e-i}}},t2=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,n){return t+n},leftForLtr(t,n){return t}}};function Dr(t,n,e){return t?e2(n,e):t2()}function p0(t,n){let e,i;(n==="ltr"||n==="rtl")&&(e=t.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",n,"important"),t.prevTextDirection=i)}function g0(t,n){n!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",n[0],n[1]))}function ff(t){return t==="angle"?{between:ma,compare:_x,normalize:en}:{between:Si,compare:(n,e)=>n-e,normalize:n=>n}}function Od({start:t,end:n,count:e,loop:i,style:r}){return{start:t%e,end:n%e,loop:i&&(n-t+1)%e===0,style:r}}function n2(t,n,e){let{property:i,start:r,end:a}=e,{between:s,normalize:o}=ff(i),l=n.length,{start:c,end:f,loop:h}=t,m,p;if(h){for(c+=l,f+=l,m=0,p=l;m<p&&s(o(n[c%l][i]),r,a);++m)c--,f--;c%=l,f%=l}return f<c&&(f+=l),{start:c,end:f,loop:h,style:t.style}}function x0(t,n,e){if(!e)return[t];let{property:i,start:r,end:a}=e,s=n.length,{compare:o,between:l,normalize:c}=ff(i),{start:f,end:h,loop:m,style:p}=n2(t,n,e),v=[],_=!1,w=null,E,S,y,V=()=>l(r,y,E)&&o(r,y)!==0,H=()=>o(a,E)===0||l(a,y,E),I=()=>_||V(),T=()=>!_||H();for(let N=f,W=f;N<=h;++N)S=n[N%s],!S.skip&&(E=c(S[i]),E!==y&&(_=l(E,r,a),w===null&&I()&&(w=o(E,r)===0?N:W),w!==null&&T()&&(v.push(Od({start:w,end:N,loop:m,count:s,style:p})),w=null),W=N,y=E));return w!==null&&v.push(Od({start:w,end:h,loop:m,count:s,style:p})),v}function _0(t,n){let e=[],i=t.segments;for(let r=0;r<i.length;r++){let a=x0(i[r],t.points,n);a.length&&e.push(...a)}return e}function i2(t,n,e,i){let r=0,a=n-1;if(e&&!i)for(;r<n&&!t[r].skip;)r++;for(;r<n&&t[r].skip;)r++;for(r%=n,e&&(a+=r);a>r&&t[a%n].skip;)a--;return a%=n,{start:r,end:a}}function r2(t,n,e,i){let r=t.length,a=[],s=n,o=t[n],l;for(l=n+1;l<=e;++l){let c=t[l%r];c.skip||c.stop?o.skip||(i=!1,a.push({start:n%r,end:(l-1)%r,loop:i}),n=s=c.stop?l:null):(s=l,o.skip&&(n=l)),o=c}return s!==null&&a.push({start:n%r,end:s%r,loop:i}),a}function uf(t,n){let e=t.points,i=t.options.spanGaps,r=e.length;if(!r)return[];let a=!!t._loop,{start:s,end:o}=i2(e,r,a,i);if(i===!0)return Ld(t,[{start:s,end:o,loop:a}],e,n);let l=o<s?o+r:o,c=!!t._fullLoop&&s===0&&o===r-1;return Ld(t,r2(e,s,l,c),e,n)}function Ld(t,n,e,i){return!i||!i.setContext||!e?n:a2(t,n,e,i)}function a2(t,n,e,i){let r=t._chart.getContext(),a=Rd(t.options),{_datasetIndex:s,options:{spanGaps:o}}=t,l=e.length,c=[],f=a,h=n[0].start,m=h;function p(v,_,w,E){let S=o?-1:1;if(v!==_){for(v+=l;e[v%l].skip;)v-=S;for(;e[_%l].skip;)_+=S;v%l!==_%l&&(c.push({start:v%l,end:_%l,loop:w,style:E}),f=E,h=_%l)}}for(let v of n){h=o?h:v.start;let _=e[h%l],w;for(m=h+1;m<=v.end;m++){let E=e[m%l];w=Rd(i.setContext(Hi(r,{type:"segment",p0:_,p1:E,p0DataIndex:(m-1)%l,p1DataIndex:m%l,datasetIndex:s}))),s2(w,f)&&p(h,m-1,v.loop,f),_=E,f=w}h<m-1&&p(h,m-1,v.loop,f)}return c}function Rd(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function s2(t,n){if(!n)return!1;let e=[],i=function(r,a){return r0(a)?(e.includes(a)||e.push(a),e.indexOf(a)):a};return JSON.stringify(t,i)!==JSON.stringify(n,i)}function Co(t,n,e){return t.options.clip?t[e]:n[e]}function o2(t,n){let{xScale:e,yScale:i}=t;return e&&i?{left:Co(e,n,"left"),right:Co(e,n,"right"),top:Co(i,n,"top"),bottom:Co(i,n,"bottom")}:n}function v0(t,n){let e=n._clip;if(e.disabled)return!1;let i=o2(n,t.chartArea);return{left:e.left===!1?0:i.left-(e.left===!0?0:e.left),right:e.right===!1?t.width:i.right+(e.right===!0?0:e.right),top:e.top===!1?0:i.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?t.height:i.bottom+(e.bottom===!0?0:e.bottom)}}var F0=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(n,e,i,r){let a=e.listeners[r],s=e.duration;a.forEach(o=>o({chart:n,initial:e.initial,numSteps:s,currentStep:Math.min(i-e.start,s)}))}_refresh(){this._request||(this._running=!0,this._request=e0.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(n=Date.now()){let e=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;let a=i.items,s=a.length-1,o=!1,l;for(;s>=0;--s)l=a[s],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(n),o=!0):(a[s]=a[a.length-1],a.pop());o&&(r.draw(),this._notify(r,i,n,"progress")),a.length||(i.running=!1,this._notify(r,i,n,"complete"),i.initial=!1),e+=a.length}),this._lastDate=n,e===0&&(this._running=!1)}_getAnims(n){let e=this._charts,i=e.get(n);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(n,i)),i}listen(n,e,i){this._getAnims(n).listeners[e].push(i)}add(n,e){!e||!e.length||this._getAnims(n).items.push(...e)}has(n){return this._getAnims(n).items.length>0}start(n){let e=this._charts.get(n);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(n){if(!this._running)return!1;let e=this._charts.get(n);return!(!e||!e.running||!e.items.length)}stop(n){let e=this._charts.get(n);if(!e||!e.items.length)return;let i=e.items,r=i.length-1;for(;r>=0;--r)i[r].cancel();e.items=[],this._notify(n,e,Date.now(),"complete")}remove(n){return this._charts.delete(n)}},Ui=new F0,hf="transparent",l2={boolean(t,n,e){return e>.5?n:t},color(t,n,e){let i=a0(t||hf),r=i.valid&&a0(n||hf);return r&&r.valid?r.mix(i,e).hexString():n},number(t,n,e){return t+(n-t)*e}},I0=class{constructor(n,e,i,r){let a=e[i];r=xa([n.to,r,a,n.from]);let s=xa([n.from,a,r]);this._active=!0,this._fn=n.fn||l2[n.type||typeof s],this._easing=la[n.easing]||la.linear,this._start=Math.floor(Date.now()+(n.delay||0)),this._duration=this._total=Math.floor(n.duration),this._loop=!!n.loop,this._target=e,this._prop=i,this._from=s,this._to=r,this._promises=void 0}active(){return this._active}update(n,e,i){if(this._active){this._notify(!1);let r=this._target[this._prop],a=i-this._start,s=this._duration-a;this._start=i,this._duration=Math.floor(Math.max(s,n.duration)),this._total+=a,this._loop=!!n.loop,this._to=xa([n.to,e,r,n.from]),this._from=xa([n.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(n){let e=n-this._start,i=this._duration,r=this._prop,a=this._from,s=this._loop,o=this._to,l;if(this._active=a!==o&&(s||e<i),!this._active){this._target[r]=o,this._notify(!0);return}if(e<0){this._target[r]=a;return}l=e/i%2,l=s&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(a,o,l)}wait(){let n=this._promises||(this._promises=[]);return new Promise((e,i)=>{n.push({res:e,rej:i})})}_notify(n){let e=n?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][e]()}},Xo=class{constructor(n,e){this._chart=n,this._properties=new Map,this.configure(e)}configure(n){if(!Ke(n))return;let e=Object.keys(wt.animation),i=this._properties;Object.getOwnPropertyNames(n).forEach(r=>{let a=n[r];if(!Ke(a))return;let s={};for(let o of e)s[o]=a[o];(pt(a.properties)&&a.properties||[r]).forEach(o=>{(o===r||!i.has(o))&&i.set(o,s)})})}_animateOptions(n,e){let i=e.options,r=d2(n,i);if(!r)return[];let a=this._createAnimations(r,i);return i.$shared&&c2(n.options.$animations,i).then(()=>{n.options=i},()=>{}),a}_createAnimations(n,e){let i=this._properties,r=[],a=n.$animations||(n.$animations={}),s=Object.keys(e),o=Date.now(),l;for(l=s.length-1;l>=0;--l){let c=s[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(n,e));continue}let f=e[c],h=a[c],m=i.get(c);if(h)if(m&&h.active()){h.update(m,f,o);continue}else h.cancel();if(!m||!m.duration){n[c]=f;continue}a[c]=h=new I0(m,n,c,f),r.push(h)}return r}update(n,e){if(this._properties.size===0){Object.assign(n,e);return}let i=this._createAnimations(n,e);if(i.length)return Ui.add(this._chart,i),!0}};function c2(t,n){let e=[],i=Object.keys(n);for(let r=0;r<i.length;r++){let a=t[i[r]];a&&a.active()&&e.push(a.wait())}return Promise.all(e)}function d2(t,n){if(!n)return;let e=t.options;if(!e){t.options=n;return}return e.$shared&&(t.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function mf(t,n){let e=t&&t.options||{},i=e.reverse,r=e.min===void 0?n:0,a=e.max===void 0?n:0;return{start:i?a:r,end:i?r:a}}function f2(t,n,e){if(e===!1)return!1;let i=mf(t,e),r=mf(n,e);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function u2(t){let n,e,i,r;return Ke(t)?(n=t.top,e=t.right,i=t.bottom,r=t.left):n=e=i=r=t,{top:n,right:e,bottom:i,left:r,disabled:t===!1}}function hu(t,n){let e=[],i=t._getSortedDatasetMetas(n),r,a;for(r=0,a=i.length;r<a;++r)e.push(i[r].index);return e}function pf(t,n,e,i={}){let r=t.keys,a=i.mode==="single",s,o,l,c;if(n===null)return;let f=!1;for(s=0,o=r.length;s<o;++s){if(l=+r[s],l===e){if(f=!0,i.all)continue;break}c=t.values[l],Et(c)&&(a||n===0||si(n)===si(c))&&(n+=c)}return!f&&!i.all?0:n}function h2(t,n){let{iScale:e,vScale:i}=n,r=e.axis==="x"?"x":"y",a=i.axis==="x"?"x":"y",s=Object.keys(t),o=new Array(s.length),l,c,f;for(l=0,c=s.length;l<c;++l)f=s[l],o[l]={[r]:f,[a]:t[f]};return o}function w0(t,n){let e=t&&t.options.stacked;return e||e===void 0&&n.stack!==void 0}function m2(t,n,e){return`${t.id}.${n.id}.${e.stack||e.type}`}function p2(t){let{min:n,max:e,minDefined:i,maxDefined:r}=t.getUserBounds();return{min:i?n:Number.NEGATIVE_INFINITY,max:r?e:Number.POSITIVE_INFINITY}}function g2(t,n,e){let i=t[n]||(t[n]={});return i[e]||(i[e]={})}function gf(t,n,e,i){for(let r of n.getMatchingVisibleMetas(i).reverse()){let a=t[r.index];if(e&&a>0||!e&&a<0)return r.index}return null}function xf(t,n){let{chart:e,_cachedMeta:i}=t,r=e._stacks||(e._stacks={}),{iScale:a,vScale:s,index:o}=i,l=a.axis,c=s.axis,f=m2(a,s,i),h=n.length,m;for(let p=0;p<h;++p){let v=n[p],{[l]:_,[c]:w}=v,E=v._stacks||(v._stacks={});m=E[c]=g2(r,f,_),m[o]=w,m._top=gf(m,s,!0,i.type),m._bottom=gf(m,s,!1,i.type);let S=m._visualValues||(m._visualValues={});S[o]=w}}function b0(t,n){let e=t.scales;return Object.keys(e).filter(i=>e[i].axis===n).shift()}function x2(t,n){return Hi(t,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})}function _2(t,n,e){return Hi(t,{active:!1,dataIndex:n,parsed:void 0,raw:void 0,element:e,index:n,mode:"default",type:"data"})}function Za(t,n){let e=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){n=n||t._parsed;for(let r of n){let a=r._stacks;if(!a||a[i]===void 0||a[i][e]===void 0)return;delete a[i][e],a[i]._visualValues!==void 0&&a[i]._visualValues[e]!==void 0&&delete a[i]._visualValues[e]}}}var y0=t=>t==="reset"||t==="none",_f=(t,n)=>n?t:Object.assign({},t),v2=(t,n,e)=>t&&!n.hidden&&n._stacked&&{keys:hu(e,!0),values:null},mr=(()=>{class t{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=w0(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Za(this._cachedMeta),this.index=e}linkScales(){let e=this.chart,i=this._cachedMeta,r=this.getDataset(),a=(m,p,v,_)=>m==="x"?p:m==="r"?_:v,s=i.xAxisID=Be(r.xAxisID,b0(e,"x")),o=i.yAxisID=Be(r.yAxisID,b0(e,"y")),l=i.rAxisID=Be(r.rAxisID,b0(e,"r")),c=i.indexAxis,f=i.iAxisID=a(c,s,o,l),h=i.vAxisID=a(c,o,s,l);i.xScale=this.getScaleForId(s),i.yScale=this.getScaleForId(o),i.rScale=this.getScaleForId(l),i.iScale=this.getScaleForId(f),i.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){let i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){let e=this._cachedMeta;this._data&&Ql(this._data,this),e._stacked&&Za(e)}_dataCheck(){let e=this.getDataset(),i=e.data||(e.data=[]),r=this._data;if(Ke(i)){let a=this._cachedMeta;this._data=h2(i,a)}else if(r!==i){if(r){Ql(r,this);let a=this._cachedMeta;Za(a),a._parsed=[]}i&&Object.isExtensible(i)&&Yd(i,this),this._syncList=[],this._data=i}}addElements(){let e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){let i=this._cachedMeta,r=this.getDataset(),a=!1;this._dataCheck();let s=i._stacked;i._stacked=w0(i.vScale,i),i.stack!==r.stack&&(a=!0,Za(i),i.stack=r.stack),this._resyncElements(e),(a||s!==i._stacked)&&(xf(this,i._parsed),i._stacked=w0(i.vScale,i))}configure(){let e=this.chart.config,i=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){let{_cachedMeta:r,_data:a}=this,{iScale:s,_stacked:o}=r,l=s.axis,c=e===0&&i===a.length?!0:r._sorted,f=e>0&&r._parsed[e-1],h,m,p;if(this._parsing===!1)r._parsed=a,r._sorted=!0,p=a;else{pt(a[e])?p=this.parseArrayData(r,a,e,i):Ke(a[e])?p=this.parseObjectData(r,a,e,i):p=this.parsePrimitiveData(r,a,e,i);let v=()=>m[l]===null||f&&m[l]<f[l];for(h=0;h<i;++h)r._parsed[h+e]=m=p[h],c&&(v()&&(c=!1),f=m);r._sorted=c}o&&xf(this,p)}parsePrimitiveData(e,i,r,a){let{iScale:s,vScale:o}=e,l=s.axis,c=o.axis,f=s.getLabels(),h=s===o,m=new Array(a),p,v,_;for(p=0,v=a;p<v;++p)_=p+r,m[p]={[l]:h||s.parse(f[_],_),[c]:o.parse(i[_],_)};return m}parseArrayData(e,i,r,a){let{xScale:s,yScale:o}=e,l=new Array(a),c,f,h,m;for(c=0,f=a;c<f;++c)h=c+r,m=i[h],l[c]={x:s.parse(m[0],h),y:o.parse(m[1],h)};return l}parseObjectData(e,i,r,a){let{xScale:s,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,f=new Array(a),h,m,p,v;for(h=0,m=a;h<m;++h)p=h+r,v=i[p],f[h]={x:s.parse(Bi(v,l),p),y:o.parse(Bi(v,c),p)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,r){let a=this.chart,s=this._cachedMeta,o=i[e.axis],l={keys:hu(a,!0),values:i._stacks[e.axis]._visualValues};return pf(l,o,s.index,{mode:r})}updateRangeFromParsed(e,i,r,a){let s=r[i.axis],o=s===null?NaN:s,l=a&&r._stacks[i.axis];a&&l&&(a.values=l,o=pf(a,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,i){let r=this._cachedMeta,a=r._parsed,s=r._sorted&&e===r.iScale,o=a.length,l=this._getOtherScale(e),c=v2(i,r,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:m}=p2(l),p,v;function _(){v=a[p];let w=v[l.axis];return!Et(v[e.axis])||h>w||m<w}for(p=0;p<o&&!(!_()&&(this.updateRangeFromParsed(f,e,v,c),s));++p);if(s){for(p=o-1;p>=0;--p)if(!_()){this.updateRangeFromParsed(f,e,v,c);break}}return f}getAllParsedValues(e){let i=this._cachedMeta._parsed,r=[],a,s,o;for(a=0,s=i.length;a<s;++a)o=i[a][e.axis],Et(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){let i=this._cachedMeta,r=i.iScale,a=i.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:a?""+a.getLabelForValue(s[a.axis]):""}}_update(e){let i=this._cachedMeta;this.update(e||"default"),i._clip=u2(Be(this.options.clip,f2(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){let e=this._ctx,i=this.chart,r=this._cachedMeta,a=r.data||[],s=i.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||a.length-l,f=this.options.drawActiveElementsOnTop,h;for(r.dataset&&r.dataset.draw(e,s,l,c),h=l;h<l+c;++h){let m=a[h];m.hidden||(m.active&&f?o.push(m):m.draw(e,s))}for(h=0;h<o.length;++h)o[h].draw(e,s)}getStyle(e,i){let r=i?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,i,r){let a=this.getDataset(),s;if(e>=0&&e<this._cachedMeta.data.length){let o=this._cachedMeta.data[e];s=o.$context||(o.$context=_2(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=a.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=x2(this.chart.getContext(),this.index)),s.dataset=a,s.index=s.datasetIndex=this.index;return s.active=!!i,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",r){let a=i==="active",s=this._cachedDataOpts,o=e+"-"+i,l=s[o],c=this.enableOptionSharing&&ua(r);if(l)return _f(l,c);let f=this.chart.config,h=f.datasetElementScopeKeys(this._type,e),m=a?[`${e}Hover`,"hover",e,""]:[e,""],p=f.getOptionScopes(this.getDataset(),h),v=Object.keys(wt.elements[e]),_=()=>this.getContext(r,a,i),w=f.resolveNamedOptions(p,v,_,m);return w.$shared&&(w.$shared=c,s[o]=Object.freeze(_f(w,c))),w}_resolveAnimations(e,i,r){let a=this.chart,s=this._cachedDataOpts,o=`animation-${i}`,l=s[o];if(l)return l;let c;if(a.options.animation!==!1){let h=this.chart.config,m=h.datasetAnimationScopeKeys(this._type,i),p=h.getOptionScopes(this.getDataset(),m);c=h.createResolver(p,this.getContext(e,r,i))}let f=new Xo(a,c&&c.animations);return c&&c._cacheable&&(s[o]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||y0(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){let r=this.resolveDataElementOptions(e,i),a=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(i,s)||s!==a;return this.updateSharedOptions(s,i,r),{sharedOptions:s,includeOptions:o}}updateElement(e,i,r,a){y0(a)?Object.assign(e,r):this._resolveAnimations(i,a).update(e,r)}updateSharedOptions(e,i,r){e&&!y0(i)&&this._resolveAnimations(void 0,i).update(e,r)}_setStyle(e,i,r,a){e.active=a;let s=this.getStyle(i,a);this._resolveAnimations(i,r,a).update(e,{options:!a&&this.getSharedOptions(s)||s})}removeHoverStyle(e,i,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,i,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){let i=this._data,r=this._cachedMeta.data;for(let[l,c,f]of this._syncList)this[l](c,f);this._syncList=[];let a=r.length,s=i.length,o=Math.min(s,a);o&&this.parse(0,o),s>a?this._insertElements(a,s-a,e):s<a&&this._removeElements(s,a-s)}_insertElements(e,i,r=!0){let a=this._cachedMeta,s=a.data,o=e+i,l,c=f=>{for(f.length+=i,l=f.length-1;l>=o;l--)f[l]=f[l-i]};for(c(s),l=e;l<o;++l)s[l]=new this.dataElementType;this._parsing&&c(a._parsed),this.parse(e,i),r&&this.updateElements(s,e,i,"reset")}updateElements(e,i,r,a){}_removeElements(e,i){let r=this._cachedMeta;if(this._parsing){let a=r._parsed.splice(e,i);r._stacked&&Za(r,a)}r.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{let[i,r,a]=e;this[i](r,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){let e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);let r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return t})();function w2(t,n){if(!t._cache.$bar){let e=t.getMatchingVisibleMetas(n),i=[];for(let r=0,a=e.length;r<a;r++)i=i.concat(e[r].controller.getAllParsedValues(t));t._cache.$bar=Zl(i.sort((r,a)=>r-a))}return t._cache.$bar}function b2(t){let n=t.iScale,e=w2(n,t.type),i=n._length,r,a,s,o,l=()=>{s===32767||s===-32768||(ua(o)&&(i=Math.min(i,Math.abs(s-o)||i)),o=s)};for(r=0,a=e.length;r<a;++r)s=n.getPixelForValue(e[r]),l();for(o=void 0,r=0,a=n.ticks.length;r<a;++r)s=n.getPixelForTick(r),l();return i}function y2(t,n,e,i){let r=e.barThickness,a,s;return Ye(r)?(a=n.min*e.categoryPercentage,s=e.barPercentage):(a=r*i,s=1),{chunk:a/i,ratio:s,start:n.pixels[t]-a/2}}function S2(t,n,e,i){let r=n.pixels,a=r[t],s=t>0?r[t-1]:null,o=t<r.length-1?r[t+1]:null,l=e.categoryPercentage;s===null&&(s=a-(o===null?n.end-n.start:o-a)),o===null&&(o=a+a-s);let c=a-(a-Math.min(s,o))/2*l;return{chunk:Math.abs(o-s)/2*l/i,ratio:e.barPercentage,start:c}}function C2(t,n,e,i){let r=e.parse(t[0],i),a=e.parse(t[1],i),s=Math.min(r,a),o=Math.max(r,a),l=s,c=o;Math.abs(s)>Math.abs(o)&&(l=o,c=s),n[e.axis]=c,n._custom={barStart:l,barEnd:c,start:r,end:a,min:s,max:o}}function mu(t,n,e,i){return pt(t)?C2(t,n,e,i):n[e.axis]=e.parse(t,i),n}function vf(t,n,e,i){let r=t.iScale,a=t.vScale,s=r.getLabels(),o=r===a,l=[],c,f,h,m;for(c=e,f=e+i;c<f;++c)m=n[c],h={},h[r.axis]=o||r.parse(s[c],c),l.push(mu(m,h,a,c));return l}function S0(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function k2(t,n,e){return t!==0?si(t):(n.isHorizontal()?1:-1)*(n.min>=e?1:-1)}function E2(t){let n,e,i,r,a;return t.horizontal?(n=t.base>t.x,e="left",i="right"):(n=t.base<t.y,e="bottom",i="top"),n?(r="end",a="start"):(r="start",a="end"),{start:e,end:i,reverse:n,top:r,bottom:a}}function T2(t,n,e,i){let r=n.borderSkipped,a={};if(!r){t.borderSkipped=a;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:s,end:o,reverse:l,top:c,bottom:f}=E2(t);r==="middle"&&e&&(t.enableBorderRadius=!0,(e._top||0)===i?r=c:(e._bottom||0)===i?r=f:(a[wf(f,s,o,l)]=!0,r=c)),a[wf(r,s,o,l)]=!0,t.borderSkipped=a}function wf(t,n,e,i){return i?(t=A2(t,n,e),t=bf(t,e,n)):t=bf(t,n,e),t}function A2(t,n,e){return t===n?e:t===e?n:t}function bf(t,n,e){return t==="start"?n:t==="end"?e:t}function M2(t,{inflateAmount:n},e){t.inflateAmount=n==="auto"?e===1?.33:0:n}var D2=(()=>{class t extends mr{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,i,r,a){return vf(e,i,r,a)}parseArrayData(e,i,r,a){return vf(e,i,r,a)}parseObjectData(e,i,r,a){let{iScale:s,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,f=s.axis==="x"?l:c,h=o.axis==="x"?l:c,m=[],p,v,_,w;for(p=r,v=r+a;p<v;++p)w=i[p],_={},_[s.axis]=s.parse(Bi(w,f),p),m.push(mu(Bi(w,h),_,o,p));return m}updateRangeFromParsed(e,i,r,a){super.updateRangeFromParsed(e,i,r,a);let s=r._custom;s&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){let i=this._cachedMeta,{iScale:r,vScale:a}=i,s=this.getParsed(e),o=s._custom,l=S0(o)?"["+o.start+", "+o.end+"]":""+a.getLabelForValue(s[a.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();let e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){let i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,r,a){let s=a==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),f=l.isHorizontal(),h=this._getRuler(),{sharedOptions:m,includeOptions:p}=this._getSharedOptions(i,a);for(let v=i;v<i+r;v++){let _=this.getParsed(v),w=s||Ye(_[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(v),E=this._calculateBarIndexPixels(v,h),S=(_._stacks||{})[l.axis],y={horizontal:f,base:w.base,enableBorderRadius:!S||S0(_._custom)||o===S._top||o===S._bottom,x:f?w.head:E.center,y:f?E.center:w.head,height:f?E.size:Math.abs(w.size),width:f?Math.abs(w.size):E.size};p&&(y.options=m||this.resolveDataElementOptions(v,e[v].active?"active":a));let V=y.options||e[v].options;T2(y,V,S,o),M2(y,V,h.ratio),this.updateElement(e[v],v,y,a)}}_getStacks(e,i){let{iScale:r}=this._cachedMeta,a=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),s=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(i),c=l&&l[r.axis],f=h=>{let m=h._parsed.find(v=>v[r.axis]===c),p=m&&m[h.vScale.axis];if(Ye(p)||isNaN(p))return!0};for(let h of a)if(!(i!==void 0&&f(h))&&((s===!1||o.indexOf(h.stack)===-1||s===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){let e=this.chart.scales,i=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===i).shift()}_getAxis(){let e={},i=this.getFirstScaleIdForIndexAxis();for(let r of this.chart.data.datasets)e[Be(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,i)]=!0;return Object.keys(e)}_getStackIndex(e,i,r){let a=this._getStacks(e,r),s=i!==void 0?a.indexOf(i):-1;return s===-1?a.length-1:s}_getRuler(){let e=this.options,i=this._cachedMeta,r=i.iScale,a=[],s,o;for(s=0,o=i.data.length;s<o;++s)a.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));let l=e.barThickness;return{min:l||b2(i),pixels:a,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){let{_cachedMeta:{vScale:i,_stacked:r,index:a},options:{base:s,minBarLength:o}}=this,l=s||0,c=this.getParsed(e),f=c._custom,h=S0(f),m=c[i.axis],p=0,v=r?this.applyStack(i,c,r):m,_,w;v!==m&&(p=v-m,v=m),h&&(m=f.barStart,v=f.barEnd-f.barStart,m!==0&&si(m)!==si(f.barEnd)&&(p=0),p+=m);let E=!Ye(s)&&!h?s:p,S=i.getPixelForValue(E);if(this.chart.getDataVisibility(e)?_=i.getPixelForValue(p+v):_=S,w=_-S,Math.abs(w)<o){w=k2(w,i,l)*o,m===l&&(S-=w/2);let y=i.getPixelForDecimal(0),V=i.getPixelForDecimal(1),H=Math.min(y,V),I=Math.max(y,V);S=Math.max(Math.min(S,I),H),_=S+w,r&&!h&&(c._stacks[i.axis]._visualValues[a]=i.getValueForPixel(_)-i.getValueForPixel(S))}if(S===i.getPixelForValue(l)){let y=si(w)*i.getLineWidthForValue(l)/2;S+=y,w-=y}return{size:w,base:S,head:_,center:_+w/2}}_calculateBarIndexPixels(e,i){let r=i.scale,a=this.options,s=a.skipNull,o=Be(a.maxBarThickness,1/0),l,c,f=this._getAxisCount();if(i.grouped){let h=s?this._getStackCount(e):i.stackCount,m=a.barThickness==="flex"?S2(e,i,a,h*f):y2(e,i,a,h*f),p=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,v=this._getAxis().indexOf(Be(p,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+v;l=m.start+m.chunk*_+m.chunk/2,c=Math.min(o,m.chunk*m.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),c=Math.min(o,i.min*i.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){let e=this._cachedMeta,i=e.vScale,r=e.data,a=r.length,s=0;for(;s<a;++s)this.getParsed(s)[i.axis]!==null&&!r[s].hidden&&r[s].draw(this._ctx)}}return t})(),F2=(()=>{class t extends mr{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,r,a){let s=super.parsePrimitiveData(e,i,r,a);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+r).radius;return s}parseArrayData(e,i,r,a){let s=super.parseArrayData(e,i,r,a);for(let o=0;o<s.length;o++){let l=i[r+o];s[o]._custom=Be(l[2],this.resolveDataElementOptions(o+r).radius)}return s}parseObjectData(e,i,r,a){let s=super.parseObjectData(e,i,r,a);for(let o=0;o<s.length;o++){let l=i[r+o];s[o]._custom=Be(l&&l.r&&+l.r,this.resolveDataElementOptions(o+r).radius)}return s}getMaxOverflow(){let e=this._cachedMeta.data,i=0;for(let r=e.length-1;r>=0;--r)i=Math.max(i,e[r].size(this.resolveDataElementOptions(r))/2);return i>0&&i}getLabelAndValue(e){let i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:a,yScale:s}=i,o=this.getParsed(e),l=a.getLabelForValue(o.x),c=s.getLabelForValue(o.y),f=o._custom;return{label:r[e]||"",value:"("+l+", "+c+(f?", "+f:"")+")"}}update(e){let i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,r,a){let s=a==="reset",{iScale:o,vScale:l}=this._cachedMeta,{sharedOptions:c,includeOptions:f}=this._getSharedOptions(i,a),h=o.axis,m=l.axis;for(let p=i;p<i+r;p++){let v=e[p],_=!s&&this.getParsed(p),w={},E=w[h]=s?o.getPixelForDecimal(.5):o.getPixelForValue(_[h]),S=w[m]=s?l.getBasePixel():l.getPixelForValue(_[m]);w.skip=isNaN(E)||isNaN(S),f&&(w.options=c||this.resolveDataElementOptions(p,v.active?"active":a),s&&(w.options.radius=0)),this.updateElement(v,p,w,a)}}resolveDataElementOptions(e,i){let r=this.getParsed(e),a=super.resolveDataElementOptions(e,i);a.$shared&&(a=Object.assign({},a,{$shared:!1}));let s=a.radius;return i!=="active"&&(a.radius=0),a.radius+=Be(r&&r._custom,s),a}}return t})();function I2(t,n,e){let i=1,r=1,a=0,s=0;if(n<gt){let o=t,l=o+n,c=Math.cos(o),f=Math.sin(o),h=Math.cos(l),m=Math.sin(l),p=(y,V,H)=>ma(y,o,l,!0)?1:Math.max(V,V*e,H,H*e),v=(y,V,H)=>ma(y,o,l,!0)?-1:Math.min(V,V*e,H,H*e),_=p(0,c,h),w=p(Tt,f,m),E=v(et,c,h),S=v(et+Tt,f,m);i=(_-E)/2,r=(w-S)/2,a=-(_+E)/2,s=-(w+S)/2}return{ratioX:i,ratioY:r,offsetX:a,offsetY:s}}var Q0=(()=>{class t extends mr{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let i=e.data;if(i.labels.length&&i.datasets.length){let{labels:{pointStyle:r,color:a}}=e.legend.options;return i.labels.map((s,o)=>{let c=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:a,lineWidth:c.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}}};constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){let r=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=r;else{let s=c=>+r[c];if(Ke(r[e])){let{key:c="value"}=this._parsing;s=f=>+Bi(r[f],c)}let o,l;for(o=e,l=e+i;o<l;++o)a._parsed[o]=s(o)}}_getRotation(){return Jn(this.options.rotation-90)}_getCircumference(){return Jn(this.options.circumference)}_getRotationExtents(){let e=gt,i=-gt;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){let a=this.chart.getDatasetMeta(r).controller,s=a._getRotation(),o=a._getCircumference();e=Math.min(e,s),i=Math.max(i,s+o)}return{rotation:e,circumference:i-e}}update(e){let i=this.chart,{chartArea:r}=i,a=this._cachedMeta,s=a.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),c=Math.min(Nd(this.options.cutout,l),1),f=this._getRingWeight(this.index),{circumference:h,rotation:m}=this._getRotationExtents(),{ratioX:p,ratioY:v,offsetX:_,offsetY:w}=I2(m,h,c),E=(r.width-o)/p,S=(r.height-o)/v,y=Math.max(Math.min(E,S)/2,0),V=$l(this.options.radius,y),H=Math.max(V*c,0),I=(V-H)/this._getVisibleDatasetWeightTotal();this.offsetX=_*V,this.offsetY=w*V,a.total=this.calculateTotal(),this.outerRadius=V-I*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-I*f,0),this.updateElements(s,0,s.length,e)}_circumference(e,i){let r=this.options,a=this._cachedMeta,s=this._getCircumference();return i&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||a._parsed[e]===null||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*s/gt)}updateElements(e,i,r,a){let s=a==="reset",o=this.chart,l=o.chartArea,f=o.options.animation,h=(l.left+l.right)/2,m=(l.top+l.bottom)/2,p=s&&f.animateScale,v=p?0:this.innerRadius,_=p?0:this.outerRadius,{sharedOptions:w,includeOptions:E}=this._getSharedOptions(i,a),S=this._getRotation(),y;for(y=0;y<i;++y)S+=this._circumference(y,s);for(y=i;y<i+r;++y){let V=this._circumference(y,s),H=e[y],I={x:h+this.offsetX,y:m+this.offsetY,startAngle:S,endAngle:S+V,circumference:V,outerRadius:_,innerRadius:v};E&&(I.options=w||this.resolveDataElementOptions(y,H.active?"active":a)),S+=V,this.updateElement(H,y,I,a)}}calculateTotal(){let e=this._cachedMeta,i=e.data,r=0,a;for(a=0;a<i.length;a++){let s=e._parsed[a];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(a)&&!i[a].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){let i=this._cachedMeta.total;return i>0&&!isNaN(e)?gt*(Math.abs(e)/i):0}getLabelAndValue(e){let i=this._cachedMeta,r=this.chart,a=r.data.labels||[],s=pa(i._parsed[e],r.options.locale);return{label:a[e]||"",value:s}}getMaxBorderWidth(e){let i=0,r=this.chart,a,s,o,l,c;if(!e){for(a=0,s=r.data.datasets.length;a<s;++a)if(r.isDatasetVisible(a)){o=r.getDatasetMeta(a),e=o.data,l=o.controller;break}}if(!e)return 0;for(a=0,s=e.length;a<s;++a)c=l.resolveDataElementOptions(a),c.borderAlign!=="inner"&&(i=Math.max(i,c.borderWidth||0,c.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let r=0,a=e.length;r<a;++r){let s=this.resolveDataElementOptions(r);i=Math.max(i,s.offset||0,s.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(i+=this._getRingWeight(r));return i}_getRingWeight(e){return Math.max(Be(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return t})(),P2=(()=>{class t extends mr{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){let i=this._cachedMeta,{dataset:r,data:a=[],_dataset:s}=i,o=this.chart._animationsDisabled,{start:l,count:c}=n0(i,a,o);this._drawStart=l,this._drawCount=c,i0(i)&&(l=0,c=a.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=a;let f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:f},e),this.updateElements(a,l,c,e)}updateElements(e,i,r,a){let s=a==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:f}=this._cachedMeta,{sharedOptions:h,includeOptions:m}=this._getSharedOptions(i,a),p=o.axis,v=l.axis,{spanGaps:_,segment:w}=this.options,E=Mr(_)?_:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||s||a==="none",y=i+r,V=e.length,H=i>0&&this.getParsed(i-1);for(let I=0;I<V;++I){let T=e[I],N=S?T:{};if(I<i||I>=y){N.skip=!0;continue}let W=this.getParsed(I),ee=Ye(W[v]),te=N[p]=o.getPixelForValue(W[p],I),X=N[v]=s||ee?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,W,c):W[v],I);N.skip=isNaN(te)||isNaN(X)||ee,N.stop=I>0&&Math.abs(W[p]-H[p])>E,w&&(N.parsed=W,N.raw=f.data[I]),m&&(N.options=h||this.resolveDataElementOptions(I,T.active?"active":a)),S||this.updateElement(T,I,N,a),H=W}}getMaxOverflow(){let e=this._cachedMeta,i=e.dataset,r=i.options&&i.options.borderWidth||0,a=e.data||[];if(!a.length)return r;let s=a[0].size(this.resolveDataElementOptions(0)),o=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(r,s,o)/2}draw(){let e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}return t})(),pu=(()=>{class t extends mr{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let i=e.data;if(i.labels.length&&i.datasets.length){let{labels:{pointStyle:r,color:a}}=e.legend.options;return i.labels.map((s,o)=>{let c=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:a,lineWidth:c.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){let i=this._cachedMeta,r=this.chart,a=r.data.labels||[],s=pa(i._parsed[e].r,r.options.locale);return{label:a[e]||"",value:s}}parseObjectData(e,i,r,a){return u0.bind(this)(e,i,r,a)}update(e){let i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){let e=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((r,a)=>{let s=this.getParsed(a).r;!isNaN(s)&&this.chart.getDataVisibility(a)&&(s<i.min&&(i.min=s),s>i.max&&(i.max=s))}),i}_updateRadius(){let e=this.chart,i=e.chartArea,r=e.options,a=Math.min(i.right-i.left,i.bottom-i.top),s=Math.max(a/2,0),o=Math.max(r.cutoutPercentage?s/100*r.cutoutPercentage:1,0),l=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-l*this.index,this.innerRadius=this.outerRadius-l}updateElements(e,i,r,a){let s=a==="reset",o=this.chart,c=o.options.animation,f=this._cachedMeta.rScale,h=f.xCenter,m=f.yCenter,p=f.getIndexAngle(0)-.5*et,v=p,_,w=360/this.countVisibleElements();for(_=0;_<i;++_)v+=this._computeAngle(_,a,w);for(_=i;_<i+r;_++){let E=e[_],S=v,y=v+this._computeAngle(_,a,w),V=o.getDataVisibility(_)?f.getDistanceFromCenterForValue(this.getParsed(_).r):0;v=y,s&&(c.animateScale&&(V=0),c.animateRotate&&(S=y=p));let H={x:h,y:m,innerRadius:0,outerRadius:V,startAngle:S,endAngle:y,options:this.resolveDataElementOptions(_,E.active?"active":a)};this.updateElement(E,_,H,a)}}countVisibleElements(){let e=this._cachedMeta,i=0;return e.data.forEach((r,a)=>{!isNaN(this.getParsed(a).r)&&this.chart.getDataVisibility(a)&&i++}),i}_computeAngle(e,i,r){return this.chart.getDataVisibility(e)?Jn(this.resolveDataElementOptions(e,i).angle||r):0}}return t})(),O2=(()=>{class t extends Q0{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}return t})(),L2=(()=>{class t extends mr{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){let i=this._cachedMeta.vScale,r=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(r[i.axis])}}parseObjectData(e,i,r,a){return u0.bind(this)(e,i,r,a)}update(e){let i=this._cachedMeta,r=i.dataset,a=i.data||[],s=i.iScale.getLabels();if(r.points=a,e!=="resize"){let o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);let l={_loop:!0,_fullLoop:s.length===a.length,options:o};this.updateElement(r,void 0,l,e)}this.updateElements(a,0,a.length,e)}updateElements(e,i,r,a){let s=this._cachedMeta.rScale,o=a==="reset";for(let l=i;l<i+r;l++){let c=e[l],f=this.resolveDataElementOptions(l,c.active?"active":a),h=s.getPointPositionForValue(l,this.getParsed(l).r),m=o?s.xCenter:h.x,p=o?s.yCenter:h.y,v={x:m,y:p,angle:h.angle,skip:isNaN(m)||isNaN(p),options:f};this.updateElement(c,l,v,a)}}}return t})(),R2=(()=>{class t extends mr{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){let i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:a,yScale:s}=i,o=this.getParsed(e),l=a.getLabelForValue(o.x),c=s.getLabelForValue(o.y);return{label:r[e]||"",value:"("+l+", "+c+")"}}update(e){let i=this._cachedMeta,{data:r=[]}=i,a=this.chart._animationsDisabled,{start:s,count:o}=n0(i,r,a);if(this._drawStart=s,this._drawCount=o,i0(i)&&(s=0,o=r.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:l,_dataset:c}=i;l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!c._decimated,l.points=r;let f=this.resolveDatasetElementOptions(e);f.segment=this.options.segment,this.updateElement(l,void 0,{animated:!a,options:f},e)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(r,s,o,e)}addElements(){let{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,r,a){let s=a==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:f}=this._cachedMeta,h=this.resolveDataElementOptions(i,a),m=this.getSharedOptions(h),p=this.includeOptions(a,m),v=o.axis,_=l.axis,{spanGaps:w,segment:E}=this.options,S=Mr(w)?w:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||s||a==="none",V=i>0&&this.getParsed(i-1);for(let H=i;H<i+r;++H){let I=e[H],T=this.getParsed(H),N=y?I:{},W=Ye(T[_]),ee=N[v]=o.getPixelForValue(T[v],H),te=N[_]=s||W?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,T,c):T[_],H);N.skip=isNaN(ee)||isNaN(te)||W,N.stop=H>0&&Math.abs(T[v]-V[v])>S,E&&(N.parsed=T,N.raw=f.data[H]),p&&(N.options=m||this.resolveDataElementOptions(H,I.active?"active":a)),y||this.updateElement(I,H,N,a),V=T}this.updateSharedOptions(m,a,h)}getMaxOverflow(){let e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let l=0;for(let c=i.length-1;c>=0;--c)l=Math.max(l,i[c].size(this.resolveDataElementOptions(c))/2);return l>0&&l}let r=e.dataset,a=r.options&&r.options.borderWidth||0;if(!i.length)return a;let s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(a,s,o)/2}}return t})(),V2=Object.freeze({__proto__:null,BarController:D2,BubbleController:F2,DoughnutController:Q0,LineController:P2,PieController:O2,PolarAreaController:pu,RadarController:L2,ScatterController:R2});function Fr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var P0=class t{static override(n){Object.assign(t.prototype,n)}options;constructor(n){this.options=n||{}}init(){}formats(){return Fr()}parse(){return Fr()}format(){return Fr()}add(){return Fr()}diff(){return Fr()}startOf(){return Fr()}endOf(){return Fr()}},N2={_date:P0};function B2(t,n,e,i){let{controller:r,data:a,_sorted:s}=t,o=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&n===o.axis&&n!=="r"&&s&&a.length){let c=o._reversePixels?jd:wi;if(i){if(r._sharedOptions){let f=a[0],h=typeof f.getRange=="function"&&f.getRange(n);if(h){let m=c(a,n,e-h),p=c(a,n,e+h);return{lo:m.lo,hi:p.hi}}}}else{let f=c(a,n,e);if(l){let{vScale:h}=r._cachedMeta,{_parsed:m}=t,p=m.slice(0,f.lo+1).reverse().findIndex(_=>!Ye(_[h.axis]));f.lo-=Math.max(0,p);let v=m.slice(f.hi).findIndex(_=>!Ye(_[h.axis]));f.hi+=Math.max(0,v)}return f}}return{lo:0,hi:a.length-1}}function cs(t,n,e,i,r){let a=t.getSortedVisibleDatasetMetas(),s=e[n];for(let o=0,l=a.length;o<l;++o){let{index:c,data:f}=a[o],{lo:h,hi:m}=B2(a[o],n,s,r);for(let p=h;p<=m;++p){let v=f[p];v.skip||i(v,c,p)}}}function H2(t){let n=t.indexOf("x")!==-1,e=t.indexOf("y")!==-1;return function(i,r){let a=n?Math.abs(i.x-r.x):0,s=e?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(s,2))}}function C0(t,n,e,i,r){let a=[];return!r&&!t.isPointInArea(n)||cs(t,e,n,function(o,l,c){!r&&!bi(o,t.chartArea,0)||o.inRange(n.x,n.y,i)&&a.push({element:o,datasetIndex:l,index:c})},!0),a}function U2(t,n,e,i){let r=[];function a(s,o,l){let{startAngle:c,endAngle:f}=s.getProps(["startAngle","endAngle"],i),{angle:h}=Jl(s,{x:n.x,y:n.y});ma(h,c,f)&&r.push({element:s,datasetIndex:o,index:l})}return cs(t,e,n,a),r}function z2(t,n,e,i,r,a){let s=[],o=H2(e),l=Number.POSITIVE_INFINITY;function c(f,h,m){let p=f.inRange(n.x,n.y,r);if(i&&!p)return;let v=f.getCenterPoint(r);if(!(!!a||t.isPointInArea(v))&&!p)return;let w=o(n,v);w<l?(s=[{element:f,datasetIndex:h,index:m}],l=w):w===l&&s.push({element:f,datasetIndex:h,index:m})}return cs(t,e,n,c),s}function k0(t,n,e,i,r,a){return!a&&!t.isPointInArea(n)?[]:e==="r"&&!i?U2(t,n,e,r):z2(t,n,e,i,r,a)}function yf(t,n,e,i,r){let a=[],s=e==="x"?"inXRange":"inYRange",o=!1;return cs(t,e,n,(l,c,f)=>{l[s]&&l[s](n[e],r)&&(a.push({element:l,datasetIndex:c,index:f}),o=o||l.inRange(n.x,n.y,r))}),i&&!o?[]:a}var W2={evaluateInteractionItems:cs,modes:{index(t,n,e,i){let r=ur(n,t),a=e.axis||"x",s=e.includeInvisible||!1,o=e.intersect?C0(t,r,a,i,s):k0(t,r,a,!1,i,s),l=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{let f=o[0].index,h=c.data[f];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:f})}),l):[]},dataset(t,n,e,i){let r=ur(n,t),a=e.axis||"xy",s=e.includeInvisible||!1,o=e.intersect?C0(t,r,a,i,s):k0(t,r,a,!1,i,s);if(o.length>0){let l=o[0].datasetIndex,c=t.getDatasetMeta(l).data;o=[];for(let f=0;f<c.length;++f)o.push({element:c[f],datasetIndex:l,index:f})}return o},point(t,n,e,i){let r=ur(n,t),a=e.axis||"xy",s=e.includeInvisible||!1;return C0(t,r,a,i,s)},nearest(t,n,e,i){let r=ur(n,t),a=e.axis||"xy",s=e.includeInvisible||!1;return k0(t,r,a,e.intersect,i,s)},x(t,n,e,i){let r=ur(n,t);return yf(t,r,"x",e.intersect,i)},y(t,n,e,i){let r=ur(n,t);return yf(t,r,"y",e.intersect,i)}}},gu=["left","top","right","bottom"];function es(t,n){return t.filter(e=>e.pos===n)}function Sf(t,n){return t.filter(e=>gu.indexOf(e.pos)===-1&&e.box.axis===n)}function ts(t,n){return t.sort((e,i)=>{let r=n?i:e,a=n?e:i;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function j2(t){let n=[],e,i,r,a,s,o;for(e=0,i=(t||[]).length;e<i;++e)r=t[e],{position:a,options:{stack:s,stackWeight:o=1}}=r,n.push({index:e,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:s&&a+s,stackWeight:o});return n}function G2(t){let n={};for(let e of t){let{stack:i,pos:r,stackWeight:a}=e;if(!i||!gu.includes(r))continue;let s=n[i]||(n[i]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=a}return n}function $2(t,n){let e=G2(t),{vBoxMaxWidth:i,hBoxMaxHeight:r}=n,a,s,o;for(a=0,s=t.length;a<s;++a){o=t[a];let{fullSize:l}=o.box,c=e[o.stack],f=c&&o.stackWeight/c.weight;o.horizontal?(o.width=f?f*i:l&&n.availableWidth,o.height=r):(o.width=i,o.height=f?f*r:l&&n.availableHeight)}return e}function Y2(t){let n=j2(t),e=ts(n.filter(c=>c.box.fullSize),!0),i=ts(es(n,"left"),!0),r=ts(es(n,"right")),a=ts(es(n,"top"),!0),s=ts(es(n,"bottom")),o=Sf(n,"x"),l=Sf(n,"y");return{fullSize:e,leftAndTop:i.concat(a),rightAndBottom:r.concat(l).concat(s).concat(o),chartArea:es(n,"chartArea"),vertical:i.concat(r).concat(l),horizontal:a.concat(s).concat(o)}}function Cf(t,n,e,i){return Math.max(t[e],n[e])+Math.max(t[i],n[i])}function xu(t,n){t.top=Math.max(t.top,n.top),t.left=Math.max(t.left,n.left),t.bottom=Math.max(t.bottom,n.bottom),t.right=Math.max(t.right,n.right)}function X2(t,n,e,i){let{pos:r,box:a}=e,s=t.maxPadding;if(!Ke(r)){e.size&&(t[r]-=e.size);let h=i[e.stack]||{size:0,count:1};h.size=Math.max(h.size,e.horizontal?a.height:a.width),e.size=h.size/h.count,t[r]+=e.size}a.getPadding&&xu(s,a.getPadding());let o=Math.max(0,n.outerWidth-Cf(s,t,"left","right")),l=Math.max(0,n.outerHeight-Cf(s,t,"top","bottom")),c=o!==t.w,f=l!==t.h;return t.w=o,t.h=l,e.horizontal?{same:c,other:f}:{same:f,other:c}}function K2(t){let n=t.maxPadding;function e(i){let r=Math.max(n[i]-t[i],0);return t[i]+=r,r}t.y+=e("top"),t.x+=e("left"),e("right"),e("bottom")}function q2(t,n){let e=n.maxPadding;function i(r){let a={left:0,top:0,right:0,bottom:0};return r.forEach(s=>{a[s]=Math.max(n[s],e[s])}),a}return i(t?["left","right"]:["top","bottom"])}function rs(t,n,e,i){let r=[],a,s,o,l,c,f;for(a=0,s=t.length,c=0;a<s;++a){o=t[a],l=o.box,l.update(o.width||n.w,o.height||n.h,q2(o.horizontal,n));let{same:h,other:m}=X2(n,e,o,i);c|=h&&r.length,f=f||m,l.fullSize||r.push(o)}return c&&rs(r,n,e,i)||f}function Ho(t,n,e,i,r){t.top=e,t.left=n,t.right=n+i,t.bottom=e+r,t.width=i,t.height=r}function kf(t,n,e,i){let r=e.padding,{x:a,y:s}=n;for(let o of t){let l=o.box,c=i[o.stack]||{count:1,placed:0,weight:1},f=o.stackWeight/c.weight||1;if(o.horizontal){let h=n.w*f,m=c.size||l.height;ua(c.start)&&(s=c.start),l.fullSize?Ho(l,r.left,s,e.outerWidth-r.right-r.left,m):Ho(l,n.left+c.placed,s,h,m),c.start=s,c.placed+=h,s=l.bottom}else{let h=n.h*f,m=c.size||l.width;ua(c.start)&&(a=c.start),l.fullSize?Ho(l,a,r.top,m,e.outerHeight-r.bottom-r.top):Ho(l,a,n.top+c.placed,m,h),c.start=a,c.placed+=h,a=l.right}}n.x=a,n.y=s}var pn={addBox(t,n){t.boxes||(t.boxes=[]),n.fullSize=n.fullSize||!1,n.position=n.position||"top",n.weight=n.weight||0,n._layers=n._layers||function(){return[{z:0,draw(e){n.draw(e)}}]},t.boxes.push(n)},removeBox(t,n){let e=t.boxes?t.boxes.indexOf(n):-1;e!==-1&&t.boxes.splice(e,1)},configure(t,n,e){n.fullSize=e.fullSize,n.position=e.position,n.weight=e.weight},update(t,n,e,i){if(!t)return;let r=nn(t.options.layout.padding),a=Math.max(n-r.width,0),s=Math.max(e-r.height,0),o=Y2(t.boxes),l=o.vertical,c=o.horizontal;lt(t.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});let f=l.reduce((_,w)=>w.box.options&&w.box.options.display===!1?_:_+1,0)||1,h=Object.freeze({outerWidth:n,outerHeight:e,padding:r,availableWidth:a,availableHeight:s,vBoxMaxWidth:a/2/f,hBoxMaxHeight:s/2}),m=Object.assign({},r);xu(m,nn(i));let p=Object.assign({maxPadding:m,w:a,h:s,x:r.left,y:r.top},r),v=$2(l.concat(c),h);rs(o.fullSize,p,h,v),rs(l,p,h,v),rs(c,p,h,v)&&rs(l,p,h,v),K2(p),kf(o.leftAndTop,p,h,v),p.x+=p.w,p.y+=p.h,kf(o.rightAndBottom,p,h,v),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},lt(o.chartArea,_=>{let w=_.box;Object.assign(w,t.chartArea),w.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}},Ko=class{acquireContext(n,e){}releaseContext(n){return!1}addEventListener(n,e,i){}removeEventListener(n,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(n,e,i,r){return e=Math.max(0,e||n.width),i=i||n.height,{width:e,height:Math.max(0,r?Math.floor(e/r):i)}}isAttached(n){return!0}updateConfig(n){}},O0=class extends Ko{acquireContext(n){return n&&n.getContext&&n.getContext("2d")||null}updateConfig(n){n.options.animation=!1}},$o="$chartjs",J2={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ef=t=>t===null||t==="";function Q2(t,n){let e=t.style,i=t.getAttribute("height"),r=t.getAttribute("width");if(t[$o]={initial:{height:i,width:r,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Ef(r)){let a=m0(t,"width");a!==void 0&&(t.width=a)}if(Ef(i))if(t.style.height==="")t.height=t.width/(n||2);else{let a=m0(t,"height");a!==void 0&&(t.height=a)}return t}var _u=lf?{passive:!0}:!1;function Z2(t,n,e){t&&t.addEventListener(n,e,_u)}function e_(t,n,e){t&&t.canvas&&t.canvas.removeEventListener(n,e,_u)}function t_(t,n){let e=J2[t.type]||t.type,{x:i,y:r}=ur(t,n);return{type:e,chart:n,native:t,x:i!==void 0?i:null,y:r!==void 0?r:null}}function qo(t,n){for(let e of t)if(e===n||e.contains(n))return!0}function n_(t,n,e){let i=t.canvas,r=new MutationObserver(a=>{let s=!1;for(let o of a)s=s||qo(o.addedNodes,i),s=s&&!qo(o.removedNodes,i);s&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}function i_(t,n,e){let i=t.canvas,r=new MutationObserver(a=>{let s=!1;for(let o of a)s=s||qo(o.removedNodes,i),s=s&&!qo(o.addedNodes,i);s&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}var ss=new Map,Tf=0;function vu(){let t=window.devicePixelRatio;t!==Tf&&(Tf=t,ss.forEach((n,e)=>{e.currentDevicePixelRatio!==t&&n()}))}function r_(t,n){ss.size||window.addEventListener("resize",vu),ss.set(t,n)}function a_(t){ss.delete(t),ss.size||window.removeEventListener("resize",vu)}function s_(t,n,e){let i=t.canvas,r=i&&No(i);if(!r)return;let a=t0((o,l)=>{let c=r.clientWidth;e(o,l),c<r.clientWidth&&e()},window),s=new ResizeObserver(o=>{let l=o[0],c=l.contentRect.width,f=l.contentRect.height;c===0&&f===0||a(c,f)});return s.observe(r),r_(t,a),s}function E0(t,n,e){e&&e.disconnect(),n==="resize"&&a_(t)}function o_(t,n,e){let i=t.canvas,r=t0(a=>{t.ctx!==null&&e(t_(a,t))},t);return Z2(i,n,r),r}var L0=class extends Ko{acquireContext(n,e){let i=n&&n.getContext&&n.getContext("2d");return i&&i.canvas===n?(Q2(n,e),i):null}releaseContext(n){let e=n.canvas;if(!e[$o])return!1;let i=e[$o].initial;["height","width"].forEach(a=>{let s=i[a];Ye(s)?e.removeAttribute(a):e.setAttribute(a,s)});let r=i.style||{};return Object.keys(r).forEach(a=>{e.style[a]=r[a]}),e.width=e.width,delete e[$o],!0}addEventListener(n,e,i){this.removeEventListener(n,e);let r=n.$proxies||(n.$proxies={}),s={attach:n_,detach:i_,resize:s_}[e]||o_;r[e]=s(n,e,i)}removeEventListener(n,e){let i=n.$proxies||(n.$proxies={}),r=i[e];if(!r)return;({attach:E0,detach:E0,resize:E0}[e]||e_)(n,e,r),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(n,e,i,r){return of(n,e,i,r)}isAttached(n){let e=n&&No(n);return!!(e&&e.isConnected)}};function l_(t){return!Vo()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?O0:L0}var oi=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(n){let{x:e,y:i}=this.getProps(["x","y"],n);return{x:e,y:i}}hasValue(){return Mr(this.x)&&Mr(this.y)}getProps(n,e){let i=this.$animations;if(!e||!i)return this;let r={};return n.forEach(a=>{r[a]=i[a]&&i[a].active()?i[a]._to:this[a]}),r}};function c_(t,n){let e=t.options.ticks,i=d_(t),r=Math.min(e.maxTicksLimit||i,i),a=e.major.enabled?u_(n):[],s=a.length,o=a[0],l=a[s-1],c=[];if(s>r)return h_(n,c,a,s/r),c;let f=f_(a,n,r);if(s>0){let h,m,p=s>1?Math.round((l-o)/(s-1)):null;for(Uo(n,c,f,Ye(p)?0:o-p,o),h=0,m=s-1;h<m;h++)Uo(n,c,f,a[h],a[h+1]);return Uo(n,c,f,l,Ye(p)?n.length:l+p),c}return Uo(n,c,f),c}function d_(t){let n=t.options.offset,e=t._tickSize(),i=t._length/e+(n?0:1),r=t._maxLength/e;return Math.floor(Math.min(i,r))}function f_(t,n,e){let i=m_(t),r=n.length/e;if(!i)return Math.max(r,1);let a=Ud(i);for(let s=0,o=a.length-1;s<o;s++){let l=a[s];if(l>r)return l}return Math.max(r,1)}function u_(t){let n=[],e,i;for(e=0,i=t.length;e<i;e++)t[e].major&&n.push(e);return n}function h_(t,n,e,i){let r=0,a=e[0],s;for(i=Math.ceil(i),s=0;s<t.length;s++)s===a&&(n.push(t[s]),r++,a=e[r*i])}function Uo(t,n,e,i,r){let a=Be(i,0),s=Math.min(Be(r,t.length),t.length),o=0,l,c,f;for(e=Math.ceil(e),r&&(l=r-i,e=l/Math.floor(l/e)),f=a;f<0;)o++,f=Math.round(a+o*e);for(c=Math.max(a,0);c<s;c++)c===f&&(n.push(t[c]),o++,f=Math.round(a+o*e))}function m_(t){let n=t.length,e,i;if(n<2)return!1;for(i=t[0],e=1;e<n;++e)if(t[e]-t[e-1]!==i)return!1;return i}var p_=t=>t==="left"?"right":t==="right"?"left":t,Af=(t,n,e)=>n==="top"||n==="left"?t[n]+e:t[n]-e,Mf=(t,n)=>Math.min(n||t,t);function Df(t,n){let e=[],i=t.length/n,r=t.length,a=0;for(;a<r;a+=i)e.push(t[Math.floor(a)]);return e}function g_(t,n,e){let i=t.ticks.length,r=Math.min(n,i-1),a=t._startPixel,s=t._endPixel,o=1e-6,l=t.getPixelForTick(r),c;if(!(e&&(i===1?c=Math.max(l-a,s-l):n===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<n?c:-c,l<a-o||l>s+o)))return l}function x_(t,n){lt(t,e=>{let i=e.gc,r=i.length/2,a;if(r>n){for(a=0;a<r;++a)delete e.data[i[a]];i.splice(0,r)}})}function ns(t){return t.drawTicks?t.tickLength:0}function Ff(t,n){if(!t.display)return 0;let e=Nt(t.font,n),i=nn(t.padding);return(pt(t.text)?t.text.length:1)*e.lineHeight+i.height}function __(t,n){return Hi(t,{scale:n,type:"scale"})}function v_(t,n,e){return Hi(t,{tick:e,index:n,type:"tick"})}function w_(t,n,e){let i=Io(t);return(e&&n!=="right"||!e&&n==="right")&&(i=p_(i)),i}function b_(t,n,e,i){let{top:r,left:a,bottom:s,right:o,chart:l}=t,{chartArea:c,scales:f}=l,h=0,m,p,v,_=s-r,w=o-a;if(t.isHorizontal()){if(p=tn(i,a,o),Ke(e)){let E=Object.keys(e)[0],S=e[E];v=f[E].getPixelForValue(S)+_-n}else e==="center"?v=(c.bottom+c.top)/2+_-n:v=Af(t,e,n);m=o-a}else{if(Ke(e)){let E=Object.keys(e)[0],S=e[E];p=f[E].getPixelForValue(S)-w+n}else e==="center"?p=(c.left+c.right)/2-w+n:p=Af(t,e,n);v=tn(i,s,r),h=e==="left"?-Tt:Tt}return{titleX:p,titleY:v,maxWidth:m,rotation:h}}var Pr=class t extends oi{constructor(n){super(),this.id=n.id,this.type=n.type,this.options=void 0,this.ctx=n.ctx,this.chart=n.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(n){this.options=n.setContext(this.getContext()),this.axis=n.axis,this._userMin=this.parse(n.min),this._userMax=this.parse(n.max),this._suggestedMin=this.parse(n.suggestedMin),this._suggestedMax=this.parse(n.suggestedMax)}parse(n,e){return n}getUserBounds(){let{_userMin:n,_userMax:e,_suggestedMin:i,_suggestedMax:r}=this;return n=Vn(n,Number.POSITIVE_INFINITY),e=Vn(e,Number.NEGATIVE_INFINITY),i=Vn(i,Number.POSITIVE_INFINITY),r=Vn(r,Number.NEGATIVE_INFINITY),{min:Vn(n,i),max:Vn(e,r),minDefined:Et(n),maxDefined:Et(e)}}getMinMax(n){let{min:e,max:i,minDefined:r,maxDefined:a}=this.getUserBounds(),s;if(r&&a)return{min:e,max:i};let o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)s=o[l].controller.getMinMax(this,n),r||(e=Math.min(e,s.min)),a||(i=Math.max(i,s.max));return e=a&&e>i?i:e,i=r&&e>i?e:i,{min:Vn(e,Vn(i,e)),max:Vn(i,Vn(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let n=this.chart.data;return this.options.labels||(this.isHorizontal()?n.xLabels:n.yLabels)||n.labels||[]}getLabelItems(n=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(n))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ht(this.options.beforeUpdate,[this])}update(n,e,i){let{beginAtZero:r,grace:a,ticks:s}=this.options,o=s.sampleSize;this.beforeUpdate(),this.maxWidth=n,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=ef(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let l=o<this.ticks.length;this._convertTicksToLabels(l?Df(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||s.source==="auto")&&(this.ticks=c_(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let n=this.options.reverse,e,i;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,n=!n),this._startPixel=e,this._endPixel=i,this._reversePixels=n,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ht(this.options.afterUpdate,[this])}beforeSetDimensions(){ht(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ht(this.options.afterSetDimensions,[this])}_callHooks(n){this.chart.notifyPlugins(n,this.getContext()),ht(this.options[n],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ht(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(n){let e=this.options.ticks,i,r,a;for(i=0,r=n.length;i<r;i++)a=n[i],a.label=ht(e.callback,[a.value,i,n],this)}afterTickToLabelConversion(){ht(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ht(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let n=this.options,e=n.ticks,i=Mf(this.ticks.length,n.ticks.maxTicksLimit),r=e.minRotation||0,a=e.maxRotation,s=r,o,l,c;if(!this._isVisible()||!e.display||r>=a||i<=1||!this.isHorizontal()){this.labelRotation=r;return}let f=this._getLabelSizes(),h=f.widest.width,m=f.highest.height,p=jt(this.chart.width-h,0,this.maxWidth);o=n.offset?this.maxWidth/i:p/(i-1),h+6>o&&(o=p/(i-(n.offset?.5:1)),l=this.maxHeight-ns(n.grid)-e.padding-Ff(n.title,this.chart.options.font),c=Math.sqrt(h*h+m*m),s=Do(Math.min(Math.asin(jt((f.highest.height+6)/o,-1,1)),Math.asin(jt(l/c,-1,1))-Math.asin(jt(m/c,-1,1)))),s=Math.max(r,Math.min(a,s))),this.labelRotation=s}afterCalculateLabelRotation(){ht(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ht(this.options.beforeFit,[this])}fit(){let n={width:0,height:0},{chart:e,options:{ticks:i,title:r,grid:a}}=this,s=this._isVisible(),o=this.isHorizontal();if(s){let l=Ff(r,e.options.font);if(o?(n.width=this.maxWidth,n.height=ns(a)+l):(n.height=this.maxHeight,n.width=ns(a)+l),i.display&&this.ticks.length){let{first:c,last:f,widest:h,highest:m}=this._getLabelSizes(),p=i.padding*2,v=Jn(this.labelRotation),_=Math.cos(v),w=Math.sin(v);if(o){let E=i.mirror?0:w*h.width+_*m.height;n.height=Math.min(this.maxHeight,n.height+E+p)}else{let E=i.mirror?0:_*h.width+w*m.height;n.width=Math.min(this.maxWidth,n.width+E+p)}this._calculatePadding(c,f,w,_)}}this._handleMargins(),o?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=n.height):(this.width=n.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,e,i,r){let{ticks:{align:a,padding:s},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){let f=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1),m=0,p=0;l?c?(m=r*n.width,p=i*e.height):(m=i*n.height,p=r*e.width):a==="start"?p=e.width:a==="end"?m=n.width:a!=="inner"&&(m=n.width/2,p=e.width/2),this.paddingLeft=Math.max((m-f+s)*this.width/(this.width-f),0),this.paddingRight=Math.max((p-h+s)*this.width/(this.width-h),0)}else{let f=e.height/2,h=n.height/2;a==="start"?(f=0,h=n.height):a==="end"&&(f=e.height,h=0),this.paddingTop=f+s,this.paddingBottom=h+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ht(this.options.afterFit,[this])}isHorizontal(){let{axis:n,position:e}=this.options;return e==="top"||e==="bottom"||n==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(n){this.beforeTickToLabelConversion(),this.generateTickLabels(n);let e,i;for(e=0,i=n.length;e<i;e++)Ye(n[e].label)&&(n.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let n=this._labelSizes;if(!n){let e=this.options.ticks.sampleSize,i=this.ticks;e<i.length&&(i=Df(i,e)),this._labelSizes=n=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return n}_computeLabelSizes(n,e,i){let{ctx:r,_longestTextCache:a}=this,s=[],o=[],l=Math.floor(e/Mf(e,i)),c=0,f=0,h,m,p,v,_,w,E,S,y,V,H;for(h=0;h<e;h+=l){if(v=n[h].label,_=this._resolveTickFontOptions(h),r.font=w=_.string,E=a[w]=a[w]||{data:{},gc:[]},S=_.lineHeight,y=V=0,!Ye(v)&&!pt(v))y=Xa(r,E.data,E.gc,y,v),V=S;else if(pt(v))for(m=0,p=v.length;m<p;++m)H=v[m],!Ye(H)&&!pt(H)&&(y=Xa(r,E.data,E.gc,y,H),V+=S);s.push(y),o.push(V),c=Math.max(y,c),f=Math.max(V,f)}x_(a,e);let I=s.indexOf(c),T=o.indexOf(f),N=W=>({width:s[W]||0,height:o[W]||0});return{first:N(0),last:N(e-1),widest:N(I),highest:N(T),widths:s,heights:o}}getLabelForValue(n){return n}getPixelForValue(n,e){return NaN}getValueForPixel(n){}getPixelForTick(n){let e=this.ticks;return n<0||n>e.length-1?null:this.getPixelForValue(e[n].value)}getPixelForDecimal(n){this._reversePixels&&(n=1-n);let e=this._startPixel+n*this._length;return Wd(this._alignToPixels?cr(this.chart,e,0):e)}getDecimalForPixel(n){let e=(n-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:n,max:e}=this;return n<0&&e<0?e:n>0&&e>0?n:0}getContext(n){let e=this.ticks||[];if(n>=0&&n<e.length){let i=e[n];return i.$context||(i.$context=v_(this.getContext(),n,i))}return this.$context||(this.$context=__(this.chart.getContext(),this))}_tickSize(){let n=this.options.ticks,e=Jn(this.labelRotation),i=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),a=this._getLabelSizes(),s=n.autoSkipPadding||0,o=a?a.widest.width+s:0,l=a?a.highest.height+s:0;return this.isHorizontal()?l*i>o*r?o/i:l/r:l*r<o*i?l/i:o/r}_isVisible(){let n=this.options.display;return n!=="auto"?!!n:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(n){let e=this.axis,i=this.chart,r=this.options,{grid:a,position:s,border:o}=r,l=a.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),m=ns(a),p=[],v=o.setContext(this.getContext()),_=v.display?v.width:0,w=_/2,E=function(ke){return cr(i,ke,_)},S,y,V,H,I,T,N,W,ee,te,X,me;if(s==="top")S=E(this.bottom),T=this.bottom-m,W=S-w,te=E(n.top)+w,me=n.bottom;else if(s==="bottom")S=E(this.top),te=n.top,me=E(n.bottom)-w,T=S+w,W=this.top+m;else if(s==="left")S=E(this.right),I=this.right-m,N=S-w,ee=E(n.left)+w,X=n.right;else if(s==="right")S=E(this.left),ee=n.left,X=E(n.right)-w,I=S+w,N=this.left+m;else if(e==="x"){if(s==="center")S=E((n.top+n.bottom)/2+.5);else if(Ke(s)){let ke=Object.keys(s)[0],we=s[ke];S=E(this.chart.scales[ke].getPixelForValue(we))}te=n.top,me=n.bottom,T=S+w,W=T+m}else if(e==="y"){if(s==="center")S=E((n.left+n.right)/2);else if(Ke(s)){let ke=Object.keys(s)[0],we=s[ke];S=E(this.chart.scales[ke].getPixelForValue(we))}I=S-w,N=I-m,ee=n.left,X=n.right}let Ae=Be(r.ticks.maxTicksLimit,h),he=Math.max(1,Math.ceil(h/Ae));for(y=0;y<h;y+=he){let ke=this.getContext(y),we=a.setContext(ke),Ve=o.setContext(ke),ve=we.lineWidth,Ie=we.color,fe=Ve.dash||[],j=Ve.dashOffset,ne=we.tickWidth,Q=we.tickColor,K=we.tickBorderDash||[],de=we.tickBorderDashOffset;V=g_(this,y,l),V!==void 0&&(H=cr(i,V,ve),c?I=N=ee=X=H:T=W=te=me=H,p.push({tx1:I,ty1:T,tx2:N,ty2:W,x1:ee,y1:te,x2:X,y2:me,width:ve,color:Ie,borderDash:fe,borderDashOffset:j,tickWidth:ne,tickColor:Q,tickBorderDash:K,tickBorderDashOffset:de}))}return this._ticksLength=h,this._borderValue=S,p}_computeLabelItems(n){let e=this.axis,i=this.options,{position:r,ticks:a}=i,s=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:f,mirror:h}=a,m=ns(i.grid),p=m+f,v=h?-f:p,_=-Jn(this.labelRotation),w=[],E,S,y,V,H,I,T,N,W,ee,te,X,me="middle";if(r==="top")I=this.bottom-v,T=this._getXAxisLabelAlignment();else if(r==="bottom")I=this.top+v,T=this._getXAxisLabelAlignment();else if(r==="left"){let he=this._getYAxisLabelAlignment(m);T=he.textAlign,H=he.x}else if(r==="right"){let he=this._getYAxisLabelAlignment(m);T=he.textAlign,H=he.x}else if(e==="x"){if(r==="center")I=(n.top+n.bottom)/2+p;else if(Ke(r)){let he=Object.keys(r)[0],ke=r[he];I=this.chart.scales[he].getPixelForValue(ke)+p}T=this._getXAxisLabelAlignment()}else if(e==="y"){if(r==="center")H=(n.left+n.right)/2-p;else if(Ke(r)){let he=Object.keys(r)[0],ke=r[he];H=this.chart.scales[he].getPixelForValue(ke)}T=this._getYAxisLabelAlignment(m).textAlign}e==="y"&&(l==="start"?me="top":l==="end"&&(me="bottom"));let Ae=this._getLabelSizes();for(E=0,S=o.length;E<S;++E){y=o[E],V=y.label;let he=a.setContext(this.getContext(E));N=this.getPixelForTick(E)+a.labelOffset,W=this._resolveTickFontOptions(E),ee=W.lineHeight,te=pt(V)?V.length:1;let ke=te/2,we=he.color,Ve=he.textStrokeColor,ve=he.textStrokeWidth,Ie=T;s?(H=N,T==="inner"&&(E===S-1?Ie=this.options.reverse?"left":"right":E===0?Ie=this.options.reverse?"right":"left":Ie="center"),r==="top"?c==="near"||_!==0?X=-te*ee+ee/2:c==="center"?X=-Ae.highest.height/2-ke*ee+ee:X=-Ae.highest.height+ee/2:c==="near"||_!==0?X=ee/2:c==="center"?X=Ae.highest.height/2-ke*ee:X=Ae.highest.height-te*ee,h&&(X*=-1),_!==0&&!he.showLabelBackdrop&&(H+=ee/2*Math.sin(_))):(I=N,X=(1-te)*ee/2);let fe;if(he.showLabelBackdrop){let j=nn(he.backdropPadding),ne=Ae.heights[E],Q=Ae.widths[E],K=X-j.top,de=0-j.left;switch(me){case"middle":K-=ne/2;break;case"bottom":K-=ne;break}switch(T){case"center":de-=Q/2;break;case"right":de-=Q;break;case"inner":E===S-1?de-=Q:E>0&&(de-=Q/2);break}fe={left:de,top:K,width:Q+j.width,height:ne+j.height,color:he.backdropColor}}w.push({label:V,font:W,textOffset:X,options:{rotation:_,color:we,strokeColor:Ve,strokeWidth:ve,textAlign:Ie,textBaseline:me,translation:[H,I],backdrop:fe}})}return w}_getXAxisLabelAlignment(){let{position:n,ticks:e}=this.options;if(-Jn(this.labelRotation))return n==="top"?"left":"right";let r="center";return e.align==="start"?r="left":e.align==="end"?r="right":e.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(n){let{position:e,ticks:{crossAlign:i,mirror:r,padding:a}}=this.options,s=this._getLabelSizes(),o=n+a,l=s.widest.width,c,f;return e==="left"?r?(f=this.right+a,i==="near"?c="left":i==="center"?(c="center",f+=l/2):(c="right",f+=l)):(f=this.right-o,i==="near"?c="right":i==="center"?(c="center",f-=l/2):(c="left",f=this.left)):e==="right"?r?(f=this.left+a,i==="near"?c="right":i==="center"?(c="center",f-=l/2):(c="left",f-=l)):(f=this.left+o,i==="near"?c="left":i==="center"?(c="center",f+=l/2):(c="right",f=this.right)):c="right",{textAlign:c,x:f}}_computeLabelArea(){if(this.options.ticks.mirror)return;let n=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:n.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:n.width}}drawBackground(){let{ctx:n,options:{backgroundColor:e},left:i,top:r,width:a,height:s}=this;e&&(n.save(),n.fillStyle=e,n.fillRect(i,r,a,s),n.restore())}getLineWidthForValue(n){let e=this.options.grid;if(!this._isVisible()||!e.display)return 0;let r=this.ticks.findIndex(a=>a.value===n);return r>=0?e.setContext(this.getContext(r)).lineWidth:0}drawGrid(n){let e=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(n)),a,s,o=(l,c,f)=>{!f.width||!f.color||(i.save(),i.lineWidth=f.width,i.strokeStyle=f.color,i.setLineDash(f.borderDash||[]),i.lineDashOffset=f.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(e.display)for(a=0,s=r.length;a<s;++a){let l=r[a];e.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){let{chart:n,ctx:e,options:{border:i,grid:r}}=this,a=i.setContext(this.getContext()),s=i.display?a.width:0;if(!s)return;let o=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue,c,f,h,m;this.isHorizontal()?(c=cr(n,this.left,s)-s/2,f=cr(n,this.right,o)+o/2,h=m=l):(h=cr(n,this.top,s)-s/2,m=cr(n,this.bottom,o)+o/2,c=f=l),e.save(),e.lineWidth=a.width,e.strokeStyle=a.color,e.beginPath(),e.moveTo(c,h),e.lineTo(f,m),e.stroke(),e.restore()}drawLabels(n){if(!this.options.ticks.display)return;let i=this.ctx,r=this._computeLabelArea();r&&Ja(i,r);let a=this.getLabelItems(n);for(let s of a){let o=s.options,l=s.font,c=s.label,f=s.textOffset;dr(i,c,0,f,l,o)}r&&Qa(i)}drawTitle(){let{ctx:n,options:{position:e,title:i,reverse:r}}=this;if(!i.display)return;let a=Nt(i.font),s=nn(i.padding),o=i.align,l=a.lineHeight/2;e==="bottom"||e==="center"||Ke(e)?(l+=s.bottom,pt(i.text)&&(l+=a.lineHeight*(i.text.length-1))):l+=s.top;let{titleX:c,titleY:f,maxWidth:h,rotation:m}=b_(this,l,e,o);dr(n,i.text,0,0,a,{color:i.color,maxWidth:h,rotation:m,textAlign:w_(o,e,r),textBaseline:"middle",translation:[c,f]})}draw(n){this._isVisible()&&(this.drawBackground(),this.drawGrid(n),this.drawBorder(),this.drawTitle(),this.drawLabels(n))}_layers(){let n=this.options,e=n.ticks&&n.ticks.z||0,i=Be(n.grid&&n.grid.z,-1),r=Be(n.border&&n.border.z,0);return!this._isVisible()||this.draw!==t.prototype.draw?[{z:e,draw:a=>{this.draw(a)}}]:[{z:i,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(n){let e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[],a,s;for(a=0,s=e.length;a<s;++a){let o=e[a];o[i]===this.id&&(!n||o.type===n)&&r.push(o)}return r}_resolveTickFontOptions(n){let e=this.options.ticks.setContext(this.getContext(n));return Nt(e.font)}_maxDigits(){let n=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/n}},va=class{constructor(n,e,i){this.type=n,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(n){return Object.prototype.isPrototypeOf.call(this.type.prototype,n.prototype)}register(n){let e=Object.getPrototypeOf(n),i;C_(e)&&(i=this.register(e));let r=this.items,a=n.id,s=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+n);return a in r||(r[a]=n,y_(n,s,i),this.override&&wt.override(n.id,n.overrides)),s}get(n){return this.items[n]}unregister(n){let e=this.items,i=n.id,r=this.scope;i in e&&delete e[i],r&&i in wt[r]&&(delete wt[r][i],this.override&&delete lr[i])}};function y_(t,n,e){let i=ca(Object.create(null),[e?wt.get(e):{},wt.get(n),t.defaults]);wt.set(n,i),t.defaultRoutes&&S_(n,t.defaultRoutes),t.descriptors&&wt.describe(n,t.descriptors)}function S_(t,n){Object.keys(n).forEach(e=>{let i=e.split("."),r=i.pop(),a=[t].concat(i).join("."),s=n[e].split("."),o=s.pop(),l=s.join(".");wt.route(a,r,l,o)})}function C_(t){return"id"in t&&"defaults"in t}var R0=class{constructor(){this.controllers=new va(mr,"datasets",!0),this.elements=new va(oi,"elements"),this.plugins=new va(Object,"plugins"),this.scales=new va(Pr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...n){this._each("register",n)}remove(...n){this._each("unregister",n)}addControllers(...n){this._each("register",n,this.controllers)}addElements(...n){this._each("register",n,this.elements)}addPlugins(...n){this._each("register",n,this.plugins)}addScales(...n){this._each("register",n,this.scales)}getController(n){return this._get(n,this.controllers,"controller")}getElement(n){return this._get(n,this.elements,"element")}getPlugin(n){return this._get(n,this.plugins,"plugin")}getScale(n){return this._get(n,this.scales,"scale")}removeControllers(...n){this._each("unregister",n,this.controllers)}removeElements(...n){this._each("unregister",n,this.elements)}removePlugins(...n){this._each("unregister",n,this.plugins)}removeScales(...n){this._each("unregister",n,this.scales)}_each(n,e,i){[...e].forEach(r=>{let a=i||this._getRegistryForType(r);i||a.isForType(r)||a===this.plugins&&r.id?this._exec(n,a,r):lt(r,s=>{let o=i||this._getRegistryForType(s);this._exec(n,o,s)})})}_exec(n,e,i){let r=Mo(n);ht(i["before"+r],[],i),e[n](i),ht(i["after"+r],[],i)}_getRegistryForType(n){for(let e=0;e<this._typedRegistries.length;e++){let i=this._typedRegistries[e];if(i.isForType(n))return i}return this.plugins}_get(n,e,i){let r=e.get(n);if(r===void 0)throw new Error('"'+n+'" is not a registered '+i+".");return r}},ki=new R0,V0=class{constructor(){this._init=[]}notify(n,e,i,r){e==="beforeInit"&&(this._init=this._createDescriptors(n,!0),this._notify(this._init,n,"install"));let a=r?this._descriptors(n).filter(r):this._descriptors(n),s=this._notify(a,n,e,i);return e==="afterDestroy"&&(this._notify(a,n,"stop"),this._notify(this._init,n,"uninstall")),s}_notify(n,e,i,r){r=r||{};for(let a of n){let s=a.plugin,o=s[i],l=[e,r,a.options];if(ht(o,l,s)===!1&&r.cancelable)return!1}return!0}invalidate(){Ye(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(n){if(this._cache)return this._cache;let e=this._cache=this._createDescriptors(n);return this._notifyStateChanges(n),e}_createDescriptors(n,e){let i=n&&n.config,r=Be(i.options&&i.options.plugins,{}),a=k_(i);return r===!1&&!e?[]:T_(n,a,r,e)}_notifyStateChanges(n){let e=this._oldCache||[],i=this._cache,r=(a,s)=>a.filter(o=>!s.some(l=>o.plugin.id===l.plugin.id));this._notify(r(e,i),n,"stop"),this._notify(r(i,e),n,"start")}};function k_(t){let n={},e=[],i=Object.keys(ki.plugins.items);for(let a=0;a<i.length;a++)e.push(ki.getPlugin(i[a]));let r=t.plugins||[];for(let a=0;a<r.length;a++){let s=r[a];e.indexOf(s)===-1&&(e.push(s),n[s.id]=!0)}return{plugins:e,localIds:n}}function E_(t,n){return!n&&t===!1?null:t===!0?{}:t}function T_(t,{plugins:n,localIds:e},i,r){let a=[],s=t.getContext();for(let o of n){let l=o.id,c=E_(i[l],r);c!==null&&a.push({plugin:o,options:A_(t.config,{plugin:o,local:e[l]},c,s)})}return a}function A_(t,{plugin:n,local:e},i,r){let a=t.pluginScopeKeys(n),s=t.getOptionScopes(i,a);return e&&n.defaults&&s.push(n.defaults),t.createResolver(s,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function N0(t,n){let e=wt.datasets[t]||{};return((n.datasets||{})[t]||{}).indexAxis||n.indexAxis||e.indexAxis||"x"}function M_(t,n){let e=t;return t==="_index_"?e=n:t==="_value_"&&(e=n==="x"?"y":"x"),e}function D_(t,n){return t===n?"_index_":"_value_"}function If(t){if(t==="x"||t==="y"||t==="r")return t}function F_(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function B0(t,...n){if(If(t))return t;for(let e of n){let i=e.axis||F_(e.position)||t.length>1&&If(t[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Pf(t,n,e){if(e[n+"AxisID"]===t)return{axis:n}}function I_(t,n){if(n.data&&n.data.datasets){let e=n.data.datasets.filter(i=>i.xAxisID===t||i.yAxisID===t);if(e.length)return Pf(t,"x",e[0])||Pf(t,"y",e[0])}return{}}function P_(t,n){let e=lr[t.type]||{scales:{}},i=n.scales||{},r=N0(t.type,n),a=Object.create(null);return Object.keys(i).forEach(s=>{let o=i[s];if(!Ke(o))return console.error(`Invalid scale configuration for scale: ${s}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${s}`);let l=B0(s,o,I_(s,t),wt.scales[o.type]),c=D_(l,r),f=e.scales||{};a[s]=fa(Object.create(null),[{axis:l},o,f[l],f[c]])}),t.data.datasets.forEach(s=>{let o=s.type||t.type,l=s.indexAxis||N0(o,n),f=(lr[o]||{}).scales||{};Object.keys(f).forEach(h=>{let m=M_(h,l),p=s[m+"AxisID"]||m;a[p]=a[p]||Object.create(null),fa(a[p],[{axis:m},i[p],f[h]])})}),Object.keys(a).forEach(s=>{let o=a[s];fa(o,[wt.scales[o.type],wt.scale])}),a}function wu(t){let n=t.options||(t.options={});n.plugins=Be(n.plugins,{}),n.scales=P_(t,n)}function bu(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function O_(t){return t=t||{},t.data=bu(t.data),wu(t),t}var Of=new Map,yu=new Set;function zo(t,n){let e=Of.get(t);return e||(e=n(),Of.set(t,e),yu.add(e)),e}var is=(t,n,e)=>{let i=Bi(n,e);i!==void 0&&t.add(i)},H0=class{constructor(n){this._config=O_(n),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(n){this._config.type=n}get data(){return this._config.data}set data(n){this._config.data=bu(n)}get options(){return this._config.options}set options(n){this._config.options=n}get plugins(){return this._config.plugins}update(){let n=this._config;this.clearCache(),wu(n)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(n){return zo(n,()=>[[`datasets.${n}`,""]])}datasetAnimationScopeKeys(n,e){return zo(`${n}.transition.${e}`,()=>[[`datasets.${n}.transitions.${e}`,`transitions.${e}`],[`datasets.${n}`,""]])}datasetElementScopeKeys(n,e){return zo(`${n}-${e}`,()=>[[`datasets.${n}.elements.${e}`,`datasets.${n}`,`elements.${e}`,""]])}pluginScopeKeys(n){let e=n.id,i=this.type;return zo(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...n.additionalOptionScopes||[]]])}_cachedScopes(n,e){let i=this._scopeCache,r=i.get(n);return(!r||e)&&(r=new Map,i.set(n,r)),r}getOptionScopes(n,e,i){let{options:r,type:a}=this,s=this._cachedScopes(n,i),o=s.get(e);if(o)return o;let l=new Set;e.forEach(f=>{n&&(l.add(n),f.forEach(h=>is(l,n,h))),f.forEach(h=>is(l,r,h)),f.forEach(h=>is(l,lr[a]||{},h)),f.forEach(h=>is(l,wt,h)),f.forEach(h=>is(l,Po,h))});let c=Array.from(l);return c.length===0&&c.push(Object.create(null)),yu.has(e)&&s.set(e,c),c}chartOptionScopes(){let{options:n,type:e}=this;return[n,lr[e]||{},wt.datasets[e]||{},{type:e},wt,Po]}resolveNamedOptions(n,e,i,r=[""]){let a={$shared:!0},{resolver:s,subPrefixes:o}=Lf(this._resolverCache,n,r),l=s;if(R_(s,e)){a.$shared=!1,i=Vi(i)?i():i;let c=this.createResolver(n,i,o);l=Ar(s,i,c)}for(let c of e)a[c]=l[c];return a}createResolver(n,e,i=[""],r){let{resolver:a}=Lf(this._resolverCache,n,i);return Ke(e)?Ar(a,e,void 0,r):a}};function Lf(t,n,e){let i=t.get(n);i||(i=new Map,t.set(n,i));let r=e.join(),a=i.get(r);return a||(a={resolver:Ro(n,e),subPrefixes:e.filter(o=>!o.toLowerCase().includes("hover"))},i.set(r,a)),a}var L_=t=>Ke(t)&&Object.getOwnPropertyNames(t).some(n=>Vi(t[n]));function R_(t,n){let{isScriptable:e,isIndexable:i}=c0(t);for(let r of n){let a=e(r),s=i(r),o=(s||a)&&t[r];if(a&&(Vi(o)||L_(o))||s&&pt(o))return!0}return!1}var V_="4.5.0",N_=["top","bottom","left","right","chartArea"];function Rf(t,n){return t==="top"||t==="bottom"||N_.indexOf(t)===-1&&n==="x"}function Vf(t,n){return function(e,i){return e[t]===i[t]?e[n]-i[n]:e[t]-i[t]}}function Nf(t){let n=t.chart,e=n.options.animation;n.notifyPlugins("afterRender"),ht(e&&e.onComplete,[t],n)}function B_(t){let n=t.chart,e=n.options.animation;ht(e&&e.onProgress,[t],n)}function Su(t){return Vo()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}var Yo={},Bf=t=>{let n=Su(t);return Object.values(Yo).filter(e=>e.canvas===n).pop()};function H_(t,n,e){let i=Object.keys(t);for(let r of i){let a=+r;if(a>=n){let s=t[r];delete t[r],(e>0||a>n)&&(t[a+e]=s)}}}function U_(t,n,e,i){return!e||t.type==="mouseout"?null:i?n:t}var ds=(()=>{class t{static defaults=wt;static instances=Yo;static overrides=lr;static registry=ki;static version=V_;static getChart=Bf;static register(...e){ki.add(...e),Hf()}static unregister(...e){ki.remove(...e),Hf()}constructor(e,i){let r=this.config=new H0(i),a=Su(e),s=Bf(a);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");let o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||l_(a)),this.platform.updateConfig(r);let l=this.platform.acquireContext(a,o.aspectRatio),c=l&&l.canvas,f=c&&c.height,h=c&&c.width;if(this.id=Vd(),this.ctx=l,this.canvas=c,this.width=h,this.height=f,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new V0,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Xd(m=>this.update(m),o.resizeDelay||0),this._dataChanges=[],Yo[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Ui.listen(this,"complete",Nf),Ui.listen(this,"progress",B_),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:e,maintainAspectRatio:i},width:r,height:a,_aspectRatio:s}=this;return Ye(e)?i&&s?s:a?r/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ki}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():h0(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return s0(this.canvas,this.ctx),this}stop(){return Ui.stop(this),this}resize(e,i){Ui.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){let r=this.options,a=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(a,e,i,s),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,h0(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),ht(r.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){let i=this.options.scales||{};lt(i,(r,a)=>{r.id=a})}buildOrUpdateScales(){let e=this.options,i=e.scales,r=this.scales,a=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{}),s=[];i&&(s=s.concat(Object.keys(i).map(o=>{let l=i[o],c=B0(o,l),f=c==="r",h=c==="x";return{options:l,dposition:f?"chartArea":h?"bottom":"left",dtype:f?"radialLinear":h?"category":"linear"}}))),lt(s,o=>{let l=o.options,c=l.id,f=B0(c,l),h=Be(l.type,o.dtype);(l.position===void 0||Rf(l.position,f)!==Rf(o.dposition))&&(l.position=o.dposition),a[c]=!0;let m=null;if(c in r&&r[c].type===h)m=r[c];else{let p=ki.getScale(h);m=new p({id:c,type:h,ctx:this.ctx,chart:this}),r[m.id]=m}m.init(l,e)}),lt(a,(o,l)=>{o||delete r[l]}),lt(r,o=>{pn.configure(this,o,o.options),pn.addBox(this,o)})}_updateMetasets(){let e=this._metasets,i=this.data.datasets.length,r=e.length;if(e.sort((a,s)=>a.index-s.index),r>i){for(let a=i;a<r;++a)this._destroyDatasetMeta(a);e.splice(i,r-i)}this._sortedMetasets=e.slice(0).sort(Vf("order","index"))}_removeUnreferencedMetasets(){let{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((r,a)=>{i.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){let e=[],i=this.data.datasets,r,a;for(this._removeUnreferencedMetasets(),r=0,a=i.length;r<a;r++){let s=i[r],o=this.getDatasetMeta(r),l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=s.indexAxis||N0(l,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{let c=ki.getController(l),{datasetElementType:f,dataElementType:h}=wt.datasets[l];Object.assign(c,{dataElementType:ki.getElement(h),datasetElementType:f&&ki.getElement(f)}),o.controller=new c(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){lt(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){let i=this.config;i.update();let r=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;let s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let f=0,h=this.data.datasets.length;f<h;f++){let{controller:m}=this.getDatasetMeta(f),p=!a&&s.indexOf(m)===-1;m.buildOrUpdateElements(p),o=Math.max(+m.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),a||lt(s,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Vf("z","_idx"));let{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){lt(this.scales,e=>{pn.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let e=this.options,i=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Yl(i,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(let{method:r,start:a,count:s}of i){let o=r==="_removeElements"?-s:s;H_(e,a,o)}}_getUniformDataChanges(){let e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];let i=this.data.datasets.length,r=s=>new Set(e.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),a=r(0);for(let s=1;s<i;s++)if(!Yl(a,r(s)))return;return Array.from(a).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;pn.update(this,this.width,this.height,e);let i=this.chartArea,r=i.width<=0||i.height<=0;this._layers=[],lt(this.boxes,a=>{r&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,s)=>{a._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let i=0,r=this.data.datasets.length;i<r;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,r=this.data.datasets.length;i<r;++i)this._updateDataset(i,Vi(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){let r=this.getDatasetMeta(e),a={meta:r,index:e,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(r.controller._update(i),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ui.has(this)?this.attached&&!Ui.running(this)&&Ui.start(this):(this.draw(),Nf({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){let{width:r,height:a}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,a)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;let i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){let i=this._sortedMetasets,r=[],a,s;for(a=0,s=i.length;a<s;++a){let o=i[a];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;let e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){let i=this.ctx,r={meta:e,index:e.index,cancelable:!0},a=v0(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(a&&Ja(i,a),e.controller.draw(),a&&Qa(i),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return bi(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,r,a){let s=W2.modes[i];return typeof s=="function"?s(this,e,r,a):[]}getDatasetMeta(e){let i=this.data.datasets[e],r=this._metasets,a=r.filter(s=>s&&s._dataset===i).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},r.push(a)),a}getContext(){return this.$context||(this.$context=Hi(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){let i=this.data.datasets[e];if(!i)return!1;let r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!i.hidden}setDatasetVisibility(e,i){let r=this.getDatasetMeta(e);r.hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,r){let a=r?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,a);ua(i)?(s.data[i].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(s,{visible:r}),this.update(l=>l.datasetIndex===e?a:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){let i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),Ui.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),s0(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete Yo[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let e=this._listeners,i=this.platform,r=(s,o)=>{i.addEventListener(this,s,o),e[s]=o},a=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};lt(this.options.events,s=>r(s,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});let e=this._responsiveListeners,i=this.platform,r=(c,f)=>{i.addEventListener(this,c,f),e[c]=f},a=(c,f)=>{e[c]&&(i.removeEventListener(this,c,f),delete e[c])},s=(c,f)=>{this.canvas&&this.resize(c,f)},o,l=()=>{a("attach",l),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,a("resize",s),this._stop(),this._resize(0,0),r("attach",l)},i.isAttached(this.canvas)?l():o()}unbindEvents(){lt(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},lt(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,r){let a=r?"set":"remove",s,o,l,c;for(i==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+a+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];let f=o&&this.getDatasetMeta(o.datasetIndex).controller;f&&f[a+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){let i=this._active||[],r=e.map(({datasetIndex:s,index:o})=>{let l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!Ka(r,i)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,i))}notifyPlugins(e,i,r){return this._plugins.notify(this,e,i,r)}isPluginEnabled(e){return this._plugins._cache.filter(i=>i.plugin.id===e).length===1}_updateHoverStyles(e,i,r){let a=this.options.hover,s=(c,f)=>c.filter(h=>!f.some(m=>h.datasetIndex===m.datasetIndex&&h.index===m.index)),o=s(i,e),l=r?e:s(e,i);o.length&&this.updateHoverStyle(o,a.mode,!1),l.length&&a.mode&&this.updateHoverStyle(l,a.mode,!0)}_eventHandler(e,i){let r={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},a=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,a)===!1)return;let s=this._handleEvent(e,i,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,a),(s||r.changed)&&this.render(),this}_handleEvent(e,i,r){let{_active:a=[],options:s}=this,o=i,l=this._getActiveElements(e,a,r,o),c=Hd(e),f=U_(e,this._lastEvent,r,c);r&&(this._lastEvent=null,ht(s.onHover,[e,l,this],this),c&&ht(s.onClick,[e,l,this],this));let h=!Ka(l,a);return(h||i)&&(this._active=l,this._updateHoverStyles(l,a,i)),this._lastEvent=f,h}_getActiveElements(e,i,r,a){if(e.type==="mouseout")return[];if(!r)return i;let s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,a)}}return t})();function Hf(){return lt(ds.instances,t=>t._plugins.invalidate())}function z_(t,n,e){let{startAngle:i,x:r,y:a,outerRadius:s,innerRadius:o,options:l}=n,{borderWidth:c,borderJoinStyle:f}=l,h=Math.min(c/s,en(i-e));if(t.beginPath(),t.arc(r,a,s-c/2,i+h/2,e-h/2),o>0){let m=Math.min(c/o,en(i-e));t.arc(r,a,o+c/2,e-m/2,i+m/2,!0)}else{let m=Math.min(c/2,s*en(i-e));if(f==="round")t.arc(r,a,m,e-et/2,i+et/2,!0);else if(f==="bevel"){let p=2*m*m,v=-p*Math.cos(e+et/2)+r,_=-p*Math.sin(e+et/2)+a,w=p*Math.cos(i+et/2)+r,E=p*Math.sin(i+et/2)+a;t.lineTo(v,_),t.lineTo(w,E)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function W_(t,n,e){let{startAngle:i,pixelMargin:r,x:a,y:s,outerRadius:o,innerRadius:l}=n,c=r/o;t.beginPath(),t.arc(a,s,o,i-c,e+c),l>r?(c=r/l,t.arc(a,s,l,e+c,i-c,!0)):t.arc(a,s,r,e+Tt,i-Tt),t.closePath(),t.clip()}function j_(t){return Lo(t,["outerStart","outerEnd","innerStart","innerEnd"])}function G_(t,n,e,i){let r=j_(t.options.borderRadius),a=(e-n)/2,s=Math.min(a,i*n/2),o=l=>{let c=(e-Math.min(a,l))*i/2;return jt(l,0,Math.min(a,c))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:jt(r.innerStart,0,s),innerEnd:jt(r.innerEnd,0,s)}}function _a(t,n,e,i){return{x:e+t*Math.cos(n),y:i+t*Math.sin(n)}}function Jo(t,n,e,i,r,a){let{x:s,y:o,startAngle:l,pixelMargin:c,innerRadius:f}=n,h=Math.max(n.outerRadius+i+e-c,0),m=f>0?f+i+e+c:0,p=0,v=r-l;if(i){let he=f>0?f-i:0,ke=h>0?h-i:0,we=(he+ke)/2,Ve=we!==0?v*we/(we+i):v;p=(v-Ve)/2}let _=Math.max(.001,v*h-e/et)/h,w=(v-_)/2,E=l+w+p,S=r-w-p,{outerStart:y,outerEnd:V,innerStart:H,innerEnd:I}=G_(n,m,h,S-E),T=h-y,N=h-V,W=E+y/T,ee=S-V/N,te=m+H,X=m+I,me=E+H/te,Ae=S-I/X;if(t.beginPath(),a){let he=(W+ee)/2;if(t.arc(s,o,h,W,he),t.arc(s,o,h,he,ee),V>0){let ve=_a(N,ee,s,o);t.arc(ve.x,ve.y,V,ee,S+Tt)}let ke=_a(X,S,s,o);if(t.lineTo(ke.x,ke.y),I>0){let ve=_a(X,Ae,s,o);t.arc(ve.x,ve.y,I,S+Tt,Ae+Math.PI)}let we=(S-I/m+(E+H/m))/2;if(t.arc(s,o,m,S-I/m,we,!0),t.arc(s,o,m,we,E+H/m,!0),H>0){let ve=_a(te,me,s,o);t.arc(ve.x,ve.y,H,me+Math.PI,E-Tt)}let Ve=_a(T,E,s,o);if(t.lineTo(Ve.x,Ve.y),y>0){let ve=_a(T,W,s,o);t.arc(ve.x,ve.y,y,E-Tt,W)}}else{t.moveTo(s,o);let he=Math.cos(W)*h+s,ke=Math.sin(W)*h+o;t.lineTo(he,ke);let we=Math.cos(ee)*h+s,Ve=Math.sin(ee)*h+o;t.lineTo(we,Ve)}t.closePath()}function $_(t,n,e,i,r){let{fullCircles:a,startAngle:s,circumference:o}=n,l=n.endAngle;if(a){Jo(t,n,e,i,l,r);for(let c=0;c<a;++c)t.fill();isNaN(o)||(l=s+(o%gt||gt))}return Jo(t,n,e,i,l,r),t.fill(),l}function Y_(t,n,e,i,r){let{fullCircles:a,startAngle:s,circumference:o,options:l}=n,{borderWidth:c,borderJoinStyle:f,borderDash:h,borderDashOffset:m,borderRadius:p}=l,v=l.borderAlign==="inner";if(!c)return;t.setLineDash(h||[]),t.lineDashOffset=m,v?(t.lineWidth=c*2,t.lineJoin=f||"round"):(t.lineWidth=c,t.lineJoin=f||"bevel");let _=n.endAngle;if(a){Jo(t,n,e,i,_,r);for(let w=0;w<a;++w)t.stroke();isNaN(o)||(_=s+(o%gt||gt))}v&&W_(t,n,_),l.selfJoin&&_-s>=et&&p===0&&f!=="miter"&&z_(t,n,_),a||(Jo(t,n,e,i,_,r),t.stroke())}var U0=class extends oi{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(n){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,e,i){let r=this.getProps(["x","y"],i),{angle:a,distance:s}=Jl(r,{x:n,y:e}),{startAngle:o,endAngle:l,innerRadius:c,outerRadius:f,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),m=(this.options.spacing+this.options.borderWidth)/2,p=Be(h,l-o),v=ma(a,o,l)&&o!==l,_=p>=gt||v,w=Si(s,c+m,f+m);return _&&w}getCenterPoint(n){let{x:e,y:i,startAngle:r,endAngle:a,innerRadius:s,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:l,spacing:c}=this.options,f=(r+a)/2,h=(s+o+c+l)/2;return{x:e+Math.cos(f)*h,y:i+Math.sin(f)*h}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){let{options:e,circumference:i}=this,r=(e.offset||0)/4,a=(e.spacing||0)/2,s=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=i>gt?Math.floor(i/gt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;n.save();let o=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(o)*r,Math.sin(o)*r);let l=1-Math.sin(Math.min(et,i||0)),c=r*l;n.fillStyle=e.backgroundColor,n.strokeStyle=e.borderColor,$_(n,this,c,a,s),Y_(n,this,c,a,s),n.restore()}};function Cu(t,n,e=n){t.lineCap=Be(e.borderCapStyle,n.borderCapStyle),t.setLineDash(Be(e.borderDash,n.borderDash)),t.lineDashOffset=Be(e.borderDashOffset,n.borderDashOffset),t.lineJoin=Be(e.borderJoinStyle,n.borderJoinStyle),t.lineWidth=Be(e.borderWidth,n.borderWidth),t.strokeStyle=Be(e.borderColor,n.borderColor)}function X_(t,n,e){t.lineTo(e.x,e.y)}function K_(t){return t.stepped?Qd:t.tension||t.cubicInterpolationMode==="monotone"?Zd:X_}function ku(t,n,e={}){let i=t.length,{start:r=0,end:a=i-1}=e,{start:s,end:o}=n,l=Math.max(r,s),c=Math.min(a,o),f=r<s&&a<s||r>o&&a>o;return{count:i,start:l,loop:n.loop,ilen:c<l&&!f?i+c-l:c-l}}function q_(t,n,e,i){let{points:r,options:a}=n,{count:s,start:o,loop:l,ilen:c}=ku(r,e,i),f=K_(a),{move:h=!0,reverse:m}=i||{},p,v,_;for(p=0;p<=c;++p)v=r[(o+(m?c-p:p))%s],!v.skip&&(h?(t.moveTo(v.x,v.y),h=!1):f(t,_,v,m,a.stepped),_=v);return l&&(v=r[(o+(m?c:0))%s],f(t,_,v,m,a.stepped)),!!l}function J_(t,n,e,i){let r=n.points,{count:a,start:s,ilen:o}=ku(r,e,i),{move:l=!0,reverse:c}=i||{},f=0,h=0,m,p,v,_,w,E,S=V=>(s+(c?o-V:V))%a,y=()=>{_!==w&&(t.lineTo(f,w),t.lineTo(f,_),t.lineTo(f,E))};for(l&&(p=r[S(0)],t.moveTo(p.x,p.y)),m=0;m<=o;++m){if(p=r[S(m)],p.skip)continue;let V=p.x,H=p.y,I=V|0;I===v?(H<_?_=H:H>w&&(w=H),f=(h*f+V)/++h):(y(),t.lineTo(V,H),v=I,h=0,_=w=H),E=H}y()}function z0(t){let n=t.options,e=n.borderDash&&n.borderDash.length;return!t._decimated&&!t._loop&&!n.tension&&n.cubicInterpolationMode!=="monotone"&&!n.stepped&&!e?J_:q_}function Q_(t){return t.stepped?cf:t.tension||t.cubicInterpolationMode==="monotone"?df:or}function Z_(t,n,e,i){let r=n._path;r||(r=n._path=new Path2D,n.path(r,e,i)&&r.closePath()),Cu(t,n.options),t.stroke(r)}function ev(t,n,e,i){let{segments:r,options:a}=n,s=z0(n);for(let o of r)Cu(t,a,o.style),t.beginPath(),s(t,n,o,{start:e,end:e+i-1})&&t.closePath(),t.stroke()}var tv=typeof Path2D=="function";function nv(t,n,e,i){tv&&!n.options.segment?Z_(t,n,e,i):ev(t,n,e,i)}var el=(()=>{class t extends oi{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){let r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){let a=r.spanGaps?this._loop:this._fullLoop;sf(this._points,r,e,a,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=uf(this,this.options.segment))}first(){let e=this.segments,i=this.points;return e.length&&i[e[0].start]}last(){let e=this.segments,i=this.points,r=e.length;return r&&i[e[r-1].end]}interpolate(e,i){let r=this.options,a=e[i],s=this.points,o=_0(this,{property:i,start:a,end:a});if(!o.length)return;let l=[],c=Q_(r),f,h;for(f=0,h=o.length;f<h;++f){let{start:m,end:p}=o[f],v=s[m],_=s[p];if(v===_){l.push(v);continue}let w=Math.abs((a-v[i])/(_[i]-v[i])),E=c(v,_,w,r.stepped);E[i]=e[i],l.push(E)}return l.length===1?l[0]:l}pathSegment(e,i,r){return z0(this)(e,this,i,r)}path(e,i,r){let a=this.segments,s=z0(this),o=this._loop;i=i||0,r=r||this.points.length-i;for(let l of a)o&=s(e,this,l,{start:i,end:i+r-1});return!!o}draw(e,i,r,a){let s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),nv(e,this,r,a),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return t})();function Uf(t,n,e,i){let r=t.options,{[e]:a}=t.getProps([e],i);return Math.abs(n-a)<r.radius+r.hitRadius}var iv=(()=>{class t extends oi{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,i,r){let a=this.options,{x:s,y:o}=this.getProps(["x","y"],r);return Math.pow(e-s,2)+Math.pow(i-o,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(e,i){return Uf(this,e,"x",i)}inYRange(e,i){return Uf(this,e,"y",i)}getCenterPoint(e){let{x:i,y:r}=this.getProps(["x","y"],e);return{x:i,y:r}}size(e){e=e||this.options||{};let i=e.radius||0;i=Math.max(i,i&&e.hoverRadius||0);let r=i&&e.borderWidth||0;return(i+r)*2}draw(e,i){let r=this.options;this.skip||r.radius<.1||!bi(this,i,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,Oo(e,r,this.x,this.y))}getRange(){let e=this.options||{};return e.radius+e.hitRadius}}return t})();function Eu(t,n){let{x:e,y:i,base:r,width:a,height:s}=t.getProps(["x","y","base","width","height"],n),o,l,c,f,h;return t.horizontal?(h=s/2,o=Math.min(e,r),l=Math.max(e,r),c=i-h,f=i+h):(h=a/2,o=e-h,l=e+h,c=Math.min(i,r),f=Math.max(i,r)),{left:o,top:c,right:l,bottom:f}}function hr(t,n,e,i){return t?0:jt(n,e,i)}function rv(t,n,e){let i=t.options.borderWidth,r=t.borderSkipped,a=l0(i);return{t:hr(r.top,a.top,0,e),r:hr(r.right,a.right,0,n),b:hr(r.bottom,a.bottom,0,e),l:hr(r.left,a.left,0,n)}}function av(t,n,e){let{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,a=fr(r),s=Math.min(n,e),o=t.borderSkipped,l=i||Ke(r);return{topLeft:hr(!l||o.top||o.left,a.topLeft,0,s),topRight:hr(!l||o.top||o.right,a.topRight,0,s),bottomLeft:hr(!l||o.bottom||o.left,a.bottomLeft,0,s),bottomRight:hr(!l||o.bottom||o.right,a.bottomRight,0,s)}}function sv(t){let n=Eu(t),e=n.right-n.left,i=n.bottom-n.top,r=rv(t,e/2,i/2),a=av(t,e/2,i/2);return{outer:{x:n.left,y:n.top,w:e,h:i,radius:a},inner:{x:n.left+r.l,y:n.top+r.t,w:e-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,a.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(r.b,r.r))}}}}function T0(t,n,e,i){let r=n===null,a=e===null,o=t&&!(r&&a)&&Eu(t,i);return o&&(r||Si(n,o.left,o.right))&&(a||Si(e,o.top,o.bottom))}function ov(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function lv(t,n){t.rect(n.x,n.y,n.w,n.h)}function A0(t,n,e={}){let i=t.x!==e.x?-n:0,r=t.y!==e.y?-n:0,a=(t.x+t.w!==e.x+e.w?n:0)-i,s=(t.y+t.h!==e.y+e.h?n:0)-r;return{x:t.x+i,y:t.y+r,w:t.w+a,h:t.h+s,radius:t.radius}}var W0=class extends oi{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,n&&Object.assign(this,n)}draw(n){let{inflateAmount:e,options:{borderColor:i,backgroundColor:r}}=this,{inner:a,outer:s}=sv(this),o=ov(s.radius)?ga:lv;n.save(),(s.w!==a.w||s.h!==a.h)&&(n.beginPath(),o(n,A0(s,e,a)),n.clip(),o(n,A0(a,-e,s)),n.fillStyle=i,n.fill("evenodd")),n.beginPath(),o(n,A0(a,e)),n.fillStyle=r,n.fill(),n.restore()}inRange(n,e,i){return T0(this,n,e,i)}inXRange(n,e){return T0(this,n,null,e)}inYRange(n,e){return T0(this,null,n,e)}getCenterPoint(n){let{x:e,y:i,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],n);return{x:a?(e+r)/2:e,y:a?i:(i+r)/2}}getRange(n){return n==="x"?this.width/2:this.height/2}},cv=Object.freeze({__proto__:null,ArcElement:U0,BarElement:W0,LineElement:el,PointElement:iv}),j0=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],zf=j0.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function Tu(t){return j0[t%j0.length]}function Au(t){return zf[t%zf.length]}function dv(t,n){return t.borderColor=Tu(n),t.backgroundColor=Au(n),++n}function fv(t,n){return t.backgroundColor=t.data.map(()=>Tu(n++)),n}function uv(t,n){return t.backgroundColor=t.data.map(()=>Au(n++)),n}function hv(t){let n=0;return(e,i)=>{let r=t.getDatasetMeta(i).controller;r instanceof Q0?n=fv(e,n):r instanceof pu?n=uv(e,n):r&&(n=dv(e,n))}}function Wf(t){let n;for(n in t)if(t[n].borderColor||t[n].backgroundColor)return!0;return!1}function mv(t){return t&&(t.borderColor||t.backgroundColor)}function pv(){return wt.borderColor!=="rgba(0,0,0,0.1)"||wt.backgroundColor!=="rgba(0,0,0,0.1)"}var gv={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,n,e){if(!e.enabled)return;let{data:{datasets:i},options:r}=t.config,{elements:a}=r,s=Wf(i)||mv(r)||a&&Wf(a)||pv();if(!e.forceOverride&&s)return;let o=hv(t);i.forEach(o)}};function xv(t,n,e,i,r){let a=r.samples||i;if(a>=e)return t.slice(n,n+e);let s=[],o=(e-2)/(a-2),l=0,c=n+e-1,f=n,h,m,p,v,_;for(s[l++]=t[f],h=0;h<a-2;h++){let w=0,E=0,S,y=Math.floor((h+1)*o)+1+n,V=Math.min(Math.floor((h+2)*o)+1,e)+n,H=V-y;for(S=y;S<V;S++)w+=t[S].x,E+=t[S].y;w/=H,E/=H;let I=Math.floor(h*o)+1+n,T=Math.min(Math.floor((h+1)*o)+1,e)+n,{x:N,y:W}=t[f];for(p=v=-1,S=I;S<T;S++)v=.5*Math.abs((N-w)*(t[S].y-W)-(N-t[S].x)*(E-W)),v>p&&(p=v,m=t[S],_=S);s[l++]=m,f=_}return s[l++]=t[c],s}function _v(t,n,e,i){let r=0,a=0,s,o,l,c,f,h,m,p,v,_,w=[],E=n+e-1,S=t[n].x,V=t[E].x-S;for(s=n;s<n+e;++s){o=t[s],l=(o.x-S)/V*i,c=o.y;let H=l|0;if(H===f)c<v?(v=c,h=s):c>_&&(_=c,m=s),r=(a*r+o.x)/++a;else{let I=s-1;if(!Ye(h)&&!Ye(m)){let T=Math.min(h,m),N=Math.max(h,m);T!==p&&T!==I&&w.push(qr(Kr({},t[T]),{x:r})),N!==p&&N!==I&&w.push(qr(Kr({},t[N]),{x:r}))}s>0&&I!==p&&w.push(t[I]),w.push(o),f=H,a=0,v=_=c,h=m=p=s}}return w}function Mu(t){if(t._decimated){let n=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:n})}}function jf(t){t.data.datasets.forEach(n=>{Mu(n)})}function vv(t,n){let e=n.length,i=0,r,{iScale:a}=t,{min:s,max:o,minDefined:l,maxDefined:c}=a.getUserBounds();return l&&(i=jt(wi(n,a.axis,s).lo,0,e-1)),c?r=jt(wi(n,a.axis,o).hi+1,i,e)-i:r=e-i,{start:i,count:r}}var wv={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,n,e)=>{if(!e.enabled){jf(t);return}let i=t.width;t.data.datasets.forEach((r,a)=>{let{_data:s,indexAxis:o}=r,l=t.getDatasetMeta(a),c=s||r.data;if(xa([o,t.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;let f=t.scales[l.xAxisID];if(f.type!=="linear"&&f.type!=="time"||t.options.parsing)return;let{start:h,count:m}=vv(l,c),p=e.threshold||4*i;if(m<=p){Mu(r);return}Ye(s)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(_){this._data=_}}));let v;switch(e.algorithm){case"lttb":v=xv(c,h,m,i,e);break;case"min-max":v=_v(c,h,m,i);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}r._decimated=v})},destroy(t){jf(t)}};function bv(t,n,e){let i=t.segments,r=t.points,a=n.points,s=[];for(let o of i){let{start:l,end:c}=o;c=tl(l,c,r);let f=G0(e,r[l],r[c],o.loop);if(!n.segments){s.push({source:o,target:f,start:r[l],end:r[c]});continue}let h=_0(n,f);for(let m of h){let p=G0(e,a[m.start],a[m.end],m.loop),v=x0(o,r,p);for(let _ of v)s.push({source:_,target:m,start:{[e]:Gf(f,p,"start",Math.max)},end:{[e]:Gf(f,p,"end",Math.min)}})}}return s}function G0(t,n,e,i){if(i)return;let r=n[t],a=e[t];return t==="angle"&&(r=en(r),a=en(a)),{property:t,start:r,end:a}}function yv(t,n){let{x:e=null,y:i=null}=t||{},r=n.points,a=[];return n.segments.forEach(({start:s,end:o})=>{o=tl(s,o,r);let l=r[s],c=r[o];i!==null?(a.push({x:l.x,y:i}),a.push({x:c.x,y:i})):e!==null&&(a.push({x:e,y:l.y}),a.push({x:e,y:c.y}))}),a}function tl(t,n,e){for(;n>t;n--){let i=e[n];if(!isNaN(i.x)&&!isNaN(i.y))break}return n}function Gf(t,n,e,i){return t&&n?i(t[e],n[e]):t?t[e]:n?n[e]:0}function Du(t,n){let e=[],i=!1;return pt(t)?(i=!0,e=t):e=yv(t,n),e.length?new el({points:e,options:{tension:0},_loop:i,_fullLoop:i}):null}function $f(t){return t&&t.fill!==!1}function Sv(t,n,e){let r=t[n].fill,a=[n],s;if(!e)return r;for(;r!==!1&&a.indexOf(r)===-1;){if(!Et(r))return r;if(s=t[r],!s)return!1;if(s.visible)return r;a.push(r),r=s.fill}return!1}function Cv(t,n,e){let i=Av(t);if(Ke(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return Et(r)&&Math.floor(r)===r?kv(i[0],n,r,e):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function kv(t,n,e,i){return(t==="-"||t==="+")&&(e=n+e),e===n||e<0||e>=i?!1:e}function Ev(t,n){let e=null;return t==="start"?e=n.bottom:t==="end"?e=n.top:Ke(t)?e=n.getPixelForValue(t.value):n.getBasePixel&&(e=n.getBasePixel()),e}function Tv(t,n,e){let i;return t==="start"?i=e:t==="end"?i=n.options.reverse?n.min:n.max:Ke(t)?i=t.value:i=n.getBaseValue(),i}function Av(t){let n=t.options,e=n.fill,i=Be(e&&e.target,e);return i===void 0&&(i=!!n.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function Mv(t){let{scale:n,index:e,line:i}=t,r=[],a=i.segments,s=i.points,o=Dv(n,e);o.push(Du({x:null,y:n.bottom},i));for(let l=0;l<a.length;l++){let c=a[l];for(let f=c.start;f<=c.end;f++)Fv(r,s[f],o)}return new el({points:r,options:{}})}function Dv(t,n){let e=[],i=t.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){let a=i[r];if(a.index===n)break;a.hidden||e.unshift(a.dataset)}return e}function Fv(t,n,e){let i=[];for(let r=0;r<e.length;r++){let a=e[r],{first:s,last:o,point:l}=Iv(a,n,"x");if(!(!l||s&&o)){if(s)i.unshift(l);else if(t.push(l),!o)break}}t.push(...i)}function Iv(t,n,e){let i=t.interpolate(n,e);if(!i)return{};let r=i[e],a=t.segments,s=t.points,o=!1,l=!1;for(let c=0;c<a.length;c++){let f=a[c],h=s[f.start][e],m=s[f.end][e];if(Si(r,h,m)){o=r===h,l=r===m;break}}return{first:o,last:l,point:i}}var Qo=class{constructor(n){this.x=n.x,this.y=n.y,this.radius=n.radius}pathSegment(n,e,i){let{x:r,y:a,radius:s}=this;return e=e||{start:0,end:gt},n.arc(r,a,s,e.end,e.start,!0),!i.bounds}interpolate(n){let{x:e,y:i,radius:r}=this,a=n.angle;return{x:e+Math.cos(a)*r,y:i+Math.sin(a)*r,angle:a}}};function Pv(t){let{chart:n,fill:e,line:i}=t;if(Et(e))return Ov(n,e);if(e==="stack")return Mv(t);if(e==="shape")return!0;let r=Lv(t);return r instanceof Qo?r:Du(r,i)}function Ov(t,n){let e=t.getDatasetMeta(n);return e&&t.isDatasetVisible(n)?e.dataset:null}function Lv(t){return(t.scale||{}).getPointPositionForValue?Vv(t):Rv(t)}function Rv(t){let{scale:n={},fill:e}=t,i=Ev(e,n);if(Et(i)){let r=n.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function Vv(t){let{scale:n,fill:e}=t,i=n.options,r=n.getLabels().length,a=i.reverse?n.max:n.min,s=Tv(e,n,a),o=[];if(i.grid.circular){let l=n.getPointPositionForValue(0,a);return new Qo({x:l.x,y:l.y,radius:n.getDistanceFromCenterForValue(s)})}for(let l=0;l<r;++l)o.push(n.getPointPositionForValue(l,s));return o}function M0(t,n,e){let i=Pv(n),{chart:r,index:a,line:s,scale:o,axis:l}=n,c=s.options,f=c.fill,h=c.backgroundColor,{above:m=h,below:p=h}=f||{},v=r.getDatasetMeta(a),_=v0(r,v);i&&s.points.length&&(Ja(t,e),Nv(t,{line:s,target:i,above:m,below:p,area:e,scale:o,axis:l,clip:_}),Qa(t))}function Nv(t,n){let{line:e,target:i,above:r,below:a,area:s,scale:o,clip:l}=n,c=e._loop?"angle":n.axis;t.save();let f=a;a!==r&&(c==="x"?(Yf(t,i,s.top),D0(t,{line:e,target:i,color:r,scale:o,property:c,clip:l}),t.restore(),t.save(),Yf(t,i,s.bottom)):c==="y"&&(Xf(t,i,s.left),D0(t,{line:e,target:i,color:a,scale:o,property:c,clip:l}),t.restore(),t.save(),Xf(t,i,s.right),f=r)),D0(t,{line:e,target:i,color:f,scale:o,property:c,clip:l}),t.restore()}function Yf(t,n,e){let{segments:i,points:r}=n,a=!0,s=!1;t.beginPath();for(let o of i){let{start:l,end:c}=o,f=r[l],h=r[tl(l,c,r)];a?(t.moveTo(f.x,f.y),a=!1):(t.lineTo(f.x,e),t.lineTo(f.x,f.y)),s=!!n.pathSegment(t,o,{move:s}),s?t.closePath():t.lineTo(h.x,e)}t.lineTo(n.first().x,e),t.closePath(),t.clip()}function Xf(t,n,e){let{segments:i,points:r}=n,a=!0,s=!1;t.beginPath();for(let o of i){let{start:l,end:c}=o,f=r[l],h=r[tl(l,c,r)];a?(t.moveTo(f.x,f.y),a=!1):(t.lineTo(e,f.y),t.lineTo(f.x,f.y)),s=!!n.pathSegment(t,o,{move:s}),s?t.closePath():t.lineTo(e,h.y)}t.lineTo(e,n.first().y),t.closePath(),t.clip()}function D0(t,n){let{line:e,target:i,property:r,color:a,scale:s,clip:o}=n,l=bv(e,i,r);for(let{source:c,target:f,start:h,end:m}of l){let{style:{backgroundColor:p=a}={}}=c,v=i!==!0;t.save(),t.fillStyle=p,Bv(t,s,o,v&&G0(r,h,m)),t.beginPath();let _=!!e.pathSegment(t,c),w;if(v){_?t.closePath():Kf(t,i,m,r);let E=!!i.pathSegment(t,f,{move:_,reverse:!0});w=_&&E,w||Kf(t,i,h,r)}t.closePath(),t.fill(w?"evenodd":"nonzero"),t.restore()}}function Bv(t,n,e,i){let r=n.chart.chartArea,{property:a,start:s,end:o}=i||{};if(a==="x"||a==="y"){let l,c,f,h;a==="x"?(l=s,c=r.top,f=o,h=r.bottom):(l=r.left,c=s,f=r.right,h=o),t.beginPath(),e&&(l=Math.max(l,e.left),f=Math.min(f,e.right),c=Math.max(c,e.top),h=Math.min(h,e.bottom)),t.rect(l,c,f-l,h-c),t.clip()}}function Kf(t,n,e,i){let r=n.interpolate(e,i);r&&t.lineTo(r.x,r.y)}var Hv={id:"filler",afterDatasetsUpdate(t,n,e){let i=(t.data.datasets||[]).length,r=[],a,s,o,l;for(s=0;s<i;++s)a=t.getDatasetMeta(s),o=a.dataset,l=null,o&&o.options&&o instanceof el&&(l={visible:t.isDatasetVisible(s),index:s,fill:Cv(o,s,i),chart:t,axis:a.controller.options.indexAxis,scale:a.vScale,line:o}),a.$filler=l,r.push(l);for(s=0;s<i;++s)l=r[s],!(!l||l.fill===!1)&&(l.fill=Sv(r,s,e.propagate))},beforeDraw(t,n,e){let i=e.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),a=t.chartArea;for(let s=r.length-1;s>=0;--s){let o=r[s].$filler;o&&(o.line.updateControlPoints(a,o.axis),i&&o.fill&&M0(t.ctx,o,a))}},beforeDatasetsDraw(t,n,e){if(e.drawTime!=="beforeDatasetsDraw")return;let i=t.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){let a=i[r].$filler;$f(a)&&M0(t.ctx,a,t.chartArea)}},beforeDatasetDraw(t,n,e){let i=n.meta.$filler;!$f(i)||e.drawTime!=="beforeDatasetDraw"||M0(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},qf=(t,n)=>{let{boxHeight:e=n,boxWidth:i=n}=t;return t.usePointStyle&&(e=Math.min(e,n),i=t.pointStyleWidth||Math.min(i,n)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(n,e)}},Uv=(t,n)=>t!==null&&n!==null&&t.datasetIndex===n.datasetIndex&&t.index===n.index,Zo=class extends oi{constructor(n){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,e,i){this.maxWidth=n,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let n=this.options.labels||{},e=ht(n.generateLabels,[this.chart],this)||[];n.filter&&(e=e.filter(i=>n.filter(i,this.chart.data))),n.sort&&(e=e.sort((i,r)=>n.sort(i,r,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){let{options:n,ctx:e}=this;if(!n.display){this.width=this.height=0;return}let i=n.labels,r=Nt(i.font),a=r.size,s=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=qf(i,a),c,f;e.font=r.string,this.isHorizontal()?(c=this.maxWidth,f=this._fitRows(s,a,o,l)+10):(f=this.maxHeight,c=this._fitCols(s,r,o,l)+10),this.width=Math.min(c,n.maxWidth||this.maxWidth),this.height=Math.min(f,n.maxHeight||this.maxHeight)}_fitRows(n,e,i,r){let{ctx:a,maxWidth:s,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],f=r+o,h=n;a.textAlign="left",a.textBaseline="middle";let m=-1,p=-f;return this.legendItems.forEach((v,_)=>{let w=i+e/2+a.measureText(v.text).width;(_===0||c[c.length-1]+w+2*o>s)&&(h+=f,c[c.length-(_>0?0:1)]=0,p+=f,m++),l[_]={left:0,top:p,row:m,width:w,height:r},c[c.length-1]+=w+o}),h}_fitCols(n,e,i,r){let{ctx:a,maxHeight:s,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],f=s-n,h=o,m=0,p=0,v=0,_=0;return this.legendItems.forEach((w,E)=>{let{itemWidth:S,itemHeight:y}=zv(i,e,a,w,r);E>0&&p+y+2*o>f&&(h+=m+o,c.push({width:m,height:p}),v+=m+o,_++,m=p=0),l[E]={left:v,top:p,col:_,width:S,height:y},m=Math.max(m,S),p+=y+o}),h+=m,c.push({width:m,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;let n=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:r},rtl:a}}=this,s=Dr(a,this.left,this.width);if(this.isHorizontal()){let o=0,l=tn(i,this.left+r,this.right-this.lineWidths[o]);for(let c of e)o!==c.row&&(o=c.row,l=tn(i,this.left+r,this.right-this.lineWidths[o])),c.top+=this.top+n+r,c.left=s.leftForLtr(s.x(l),c.width),l+=c.width+r}else{let o=0,l=tn(i,this.top+n+r,this.bottom-this.columnSizes[o].height);for(let c of e)c.col!==o&&(o=c.col,l=tn(i,this.top+n+r,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+r,c.left=s.leftForLtr(s.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){let n=this.ctx;Ja(n,this),this._draw(),Qa(n)}}_draw(){let{options:n,columnSizes:e,lineWidths:i,ctx:r}=this,{align:a,labels:s}=n,o=wt.color,l=Dr(n.rtl,this.left,this.width),c=Nt(s.font),{padding:f}=s,h=c.size,m=h/2,p;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;let{boxWidth:v,boxHeight:_,itemHeight:w}=qf(s,h),E=function(I,T,N){if(isNaN(v)||v<=0||isNaN(_)||_<0)return;r.save();let W=Be(N.lineWidth,1);if(r.fillStyle=Be(N.fillStyle,o),r.lineCap=Be(N.lineCap,"butt"),r.lineDashOffset=Be(N.lineDashOffset,0),r.lineJoin=Be(N.lineJoin,"miter"),r.lineWidth=W,r.strokeStyle=Be(N.strokeStyle,o),r.setLineDash(Be(N.lineDash,[])),s.usePointStyle){let ee={radius:_*Math.SQRT2/2,pointStyle:N.pointStyle,rotation:N.rotation,borderWidth:W},te=l.xPlus(I,v/2),X=T+m;o0(r,ee,te,X,s.pointStyleWidth&&v)}else{let ee=T+Math.max((h-_)/2,0),te=l.leftForLtr(I,v),X=fr(N.borderRadius);r.beginPath(),Object.values(X).some(me=>me!==0)?ga(r,{x:te,y:ee,w:v,h:_,radius:X}):r.rect(te,ee,v,_),r.fill(),W!==0&&r.stroke()}r.restore()},S=function(I,T,N){dr(r,N.text,I,T+w/2,c,{strikethrough:N.hidden,textAlign:l.textAlign(N.textAlign)})},y=this.isHorizontal(),V=this._computeTitleHeight();y?p={x:tn(a,this.left+f,this.right-i[0]),y:this.top+f+V,line:0}:p={x:this.left+f,y:tn(a,this.top+V+f,this.bottom-e[0].height),line:0},p0(this.ctx,n.textDirection);let H=w+f;this.legendItems.forEach((I,T)=>{r.strokeStyle=I.fontColor,r.fillStyle=I.fontColor;let N=r.measureText(I.text).width,W=l.textAlign(I.textAlign||(I.textAlign=s.textAlign)),ee=v+m+N,te=p.x,X=p.y;l.setWidth(this.width),y?T>0&&te+ee+f>this.right&&(X=p.y+=H,p.line++,te=p.x=tn(a,this.left+f,this.right-i[p.line])):T>0&&X+H>this.bottom&&(te=p.x=te+e[p.line].width+f,p.line++,X=p.y=tn(a,this.top+V+f,this.bottom-e[p.line].height));let me=l.x(te);if(E(me,X,I),te=Kd(W,te+v+m,y?te+ee:this.right,n.rtl),S(l.x(te),X,I),y)p.x+=ee+f;else if(typeof I.text!="string"){let Ae=c.lineHeight;p.y+=Fu(I,Ae)+f}else p.y+=H}),g0(this.ctx,n.textDirection)}drawTitle(){let n=this.options,e=n.title,i=Nt(e.font),r=nn(e.padding);if(!e.display)return;let a=Dr(n.rtl,this.left,this.width),s=this.ctx,o=e.position,l=i.size/2,c=r.top+l,f,h=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),f=this.top+c,h=tn(n.align,h,this.right-m);else{let v=this.columnSizes.reduce((_,w)=>Math.max(_,w.height),0);f=c+tn(n.align,this.top,this.bottom-v-n.labels.padding-this._computeTitleHeight())}let p=tn(o,h,h+m);s.textAlign=a.textAlign(Io(o)),s.textBaseline="middle",s.strokeStyle=e.color,s.fillStyle=e.color,s.font=i.string,dr(s,e.text,p,f,i)}_computeTitleHeight(){let n=this.options.title,e=Nt(n.font),i=nn(n.padding);return n.display?e.lineHeight+i.height:0}_getLegendItemAt(n,e){let i,r,a;if(Si(n,this.left,this.right)&&Si(e,this.top,this.bottom)){for(a=this.legendHitBoxes,i=0;i<a.length;++i)if(r=a[i],Si(n,r.left,r.left+r.width)&&Si(e,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(n){let e=this.options;if(!Gv(n.type,e))return;let i=this._getLegendItemAt(n.x,n.y);if(n.type==="mousemove"||n.type==="mouseout"){let r=this._hoveredItem,a=Uv(r,i);r&&!a&&ht(e.onLeave,[n,r,this],this),this._hoveredItem=i,i&&!a&&ht(e.onHover,[n,i,this],this)}else i&&ht(e.onClick,[n,i,this],this)}};function zv(t,n,e,i,r){let a=Wv(i,t,n,e),s=jv(r,i,n.lineHeight);return{itemWidth:a,itemHeight:s}}function Wv(t,n,e,i){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((a,s)=>a.length>s.length?a:s)),n+e.size/2+i.measureText(r).width}function jv(t,n,e){let i=t;return typeof n.text!="string"&&(i=Fu(n,e)),i}function Fu(t,n){let e=t.text?t.text.length:0;return n*e}function Gv(t,n){return!!((t==="mousemove"||t==="mouseout")&&(n.onHover||n.onLeave)||n.onClick&&(t==="click"||t==="mouseup"))}var $v={id:"legend",_element:Zo,start(t,n,e){let i=t.legend=new Zo({ctx:t.ctx,options:e,chart:t});pn.configure(t,i,e),pn.addBox(t,i)},stop(t){pn.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,n,e){let i=t.legend;pn.configure(t,i,e),i.options=e},afterUpdate(t){let n=t.legend;n.buildLabels(),n.adjustHitBoxes()},afterEvent(t,n){n.replay||t.legend.handleEvent(n.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,n,e){let i=n.datasetIndex,r=e.chart;r.isDatasetVisible(i)?(r.hide(i),n.hidden=!0):(r.show(i),n.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){let n=t.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:r,color:a,useBorderRadius:s,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{let c=l.controller.getStyle(e?0:void 0),f=nn(c.borderWidth);return{text:n[l.index].label,fillStyle:c.backgroundColor,fontColor:a,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(f.width+f.height)/4,strokeStyle:c.borderColor,pointStyle:i||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:s&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}},os=class extends oi{constructor(n){super(),this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,e){let i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=n,this.height=this.bottom=e;let r=pt(i.text)?i.text.length:1;this._padding=nn(i.padding);let a=r*Nt(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){let n=this.options.position;return n==="top"||n==="bottom"}_drawArgs(n){let{top:e,left:i,bottom:r,right:a,options:s}=this,o=s.align,l=0,c,f,h;return this.isHorizontal()?(f=tn(o,i,a),h=e+n,c=a-i):(s.position==="left"?(f=i+n,h=tn(o,r,e),l=et*-.5):(f=a-n,h=tn(o,e,r),l=et*.5),c=r-e),{titleX:f,titleY:h,maxWidth:c,rotation:l}}draw(){let n=this.ctx,e=this.options;if(!e.display)return;let i=Nt(e.font),a=i.lineHeight/2+this._padding.top,{titleX:s,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(a);dr(n,e.text,0,0,i,{color:e.color,maxWidth:l,rotation:c,textAlign:Io(e.align),textBaseline:"middle",translation:[s,o]})}};function Yv(t,n){let e=new os({ctx:t.ctx,options:n,chart:t});pn.configure(t,e,n),pn.addBox(t,e),t.titleBlock=e}var Xv={id:"title",_element:os,start(t,n,e){Yv(t,e)},stop(t){let n=t.titleBlock;pn.removeBox(t,n),delete t.titleBlock},beforeUpdate(t,n,e){let i=t.titleBlock;pn.configure(t,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Wo=new WeakMap,Kv={id:"subtitle",start(t,n,e){let i=new os({ctx:t.ctx,options:e,chart:t});pn.configure(t,i,e),pn.addBox(t,i),Wo.set(t,i)},stop(t){pn.removeBox(t,Wo.get(t)),Wo.delete(t)},beforeUpdate(t,n,e){let i=Wo.get(t);pn.configure(t,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},as={average(t){if(!t.length)return!1;let n,e,i=new Set,r=0,a=0;for(n=0,e=t.length;n<e;++n){let o=t[n].element;if(o&&o.hasValue()){let l=o.tooltipPosition();i.add(l.x),r+=l.y,++a}}return a===0||i.size===0?!1:{x:[...i].reduce((o,l)=>o+l)/i.size,y:r/a}},nearest(t,n){if(!t.length)return!1;let e=n.x,i=n.y,r=Number.POSITIVE_INFINITY,a,s,o;for(a=0,s=t.length;a<s;++a){let l=t[a].element;if(l&&l.hasValue()){let c=l.getCenterPoint(),f=To(n,c);f<r&&(r=f,o=l)}}if(o){let l=o.tooltipPosition();e=l.x,i=l.y}return{x:e,y:i}}};function Ci(t,n){return n&&(pt(n)?Array.prototype.push.apply(t,n):t.push(n)),t}function zi(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function qv(t,n){let{element:e,datasetIndex:i,index:r}=n,a=t.getDatasetMeta(i).controller,{label:s,value:o}=a.getLabelAndValue(r);return{chart:t,label:s,parsed:a.getParsed(r),raw:t.data.datasets[i].data[r],formattedValue:o,dataset:a.getDataset(),dataIndex:r,datasetIndex:i,element:e}}function Jf(t,n){let e=t.chart.ctx,{body:i,footer:r,title:a}=t,{boxWidth:s,boxHeight:o}=n,l=Nt(n.bodyFont),c=Nt(n.titleFont),f=Nt(n.footerFont),h=a.length,m=r.length,p=i.length,v=nn(n.padding),_=v.height,w=0,E=i.reduce((V,H)=>V+H.before.length+H.lines.length+H.after.length,0);if(E+=t.beforeBody.length+t.afterBody.length,h&&(_+=h*c.lineHeight+(h-1)*n.titleSpacing+n.titleMarginBottom),E){let V=n.displayColors?Math.max(o,l.lineHeight):l.lineHeight;_+=p*V+(E-p)*l.lineHeight+(E-1)*n.bodySpacing}m&&(_+=n.footerMarginTop+m*f.lineHeight+(m-1)*n.footerSpacing);let S=0,y=function(V){w=Math.max(w,e.measureText(V).width+S)};return e.save(),e.font=c.string,lt(t.title,y),e.font=l.string,lt(t.beforeBody.concat(t.afterBody),y),S=n.displayColors?s+2+n.boxPadding:0,lt(i,V=>{lt(V.before,y),lt(V.lines,y),lt(V.after,y)}),S=0,e.font=f.string,lt(t.footer,y),e.restore(),w+=v.width,{width:w,height:_}}function Jv(t,n){let{y:e,height:i}=n;return e<i/2?"top":e>t.height-i/2?"bottom":"center"}function Qv(t,n,e,i){let{x:r,width:a}=i,s=e.caretSize+e.caretPadding;if(t==="left"&&r+a+s>n.width||t==="right"&&r-a-s<0)return!0}function Zv(t,n,e,i){let{x:r,width:a}=e,{width:s,chartArea:{left:o,right:l}}=t,c="center";return i==="center"?c=r<=(o+l)/2?"left":"right":r<=a/2?c="left":r>=s-a/2&&(c="right"),Qv(c,t,n,e)&&(c="center"),c}function Qf(t,n,e){let i=e.yAlign||n.yAlign||Jv(t,e);return{xAlign:e.xAlign||n.xAlign||Zv(t,n,e,i),yAlign:i}}function ew(t,n){let{x:e,width:i}=t;return n==="right"?e-=i:n==="center"&&(e-=i/2),e}function tw(t,n,e){let{y:i,height:r}=t;return n==="top"?i+=e:n==="bottom"?i-=r+e:i-=r/2,i}function Zf(t,n,e,i){let{caretSize:r,caretPadding:a,cornerRadius:s}=t,{xAlign:o,yAlign:l}=e,c=r+a,{topLeft:f,topRight:h,bottomLeft:m,bottomRight:p}=fr(s),v=ew(n,o),_=tw(n,l,c);return l==="center"?o==="left"?v+=c:o==="right"&&(v-=c):o==="left"?v-=Math.max(f,m)+r:o==="right"&&(v+=Math.max(h,p)+r),{x:jt(v,0,i.width-n.width),y:jt(_,0,i.height-n.height)}}function jo(t,n,e){let i=nn(e.padding);return n==="center"?t.x+t.width/2:n==="right"?t.x+t.width-i.right:t.x+i.left}function eu(t){return Ci([],zi(t))}function nw(t,n,e){return Hi(t,{tooltip:n,tooltipItems:e,type:"tooltip"})}function tu(t,n){let e=n&&n.dataset&&n.dataset.tooltip&&n.dataset.tooltip.callbacks;return e?t.override(e):t}var Iu={beforeTitle:yi,title(t){if(t.length>0){let n=t[0],e=n.chart.data.labels,i=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return n.dataset.label||"";if(n.label)return n.label;if(i>0&&n.dataIndex<i)return e[n.dataIndex]}return""},afterTitle:yi,beforeBody:yi,beforeLabel:yi,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let n=t.dataset.label||"";n&&(n+=": ");let e=t.formattedValue;return Ye(e)||(n+=e),n},labelColor(t){let e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){let e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:yi,afterBody:yi,beforeFooter:yi,footer:yi,afterFooter:yi};function Nn(t,n,e,i){let r=t[n].call(e,i);return typeof r>"u"?Iu[n].call(e,i):r}var nu=(()=>{class t extends oi{static positioners=as;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let e=this._cachedAnimations;if(e)return e;let i=this.chart,r=this.options.setContext(this.getContext()),a=r.enabled&&i.options.animation&&r.animations,s=new Xo(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=nw(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){let{callbacks:r}=i,a=Nn(r,"beforeTitle",this,e),s=Nn(r,"title",this,e),o=Nn(r,"afterTitle",this,e),l=[];return l=Ci(l,zi(a)),l=Ci(l,zi(s)),l=Ci(l,zi(o)),l}getBeforeBody(e,i){return eu(Nn(i.callbacks,"beforeBody",this,e))}getBody(e,i){let{callbacks:r}=i,a=[];return lt(e,s=>{let o={before:[],lines:[],after:[]},l=tu(r,s);Ci(o.before,zi(Nn(l,"beforeLabel",this,s))),Ci(o.lines,Nn(l,"label",this,s)),Ci(o.after,zi(Nn(l,"afterLabel",this,s))),a.push(o)}),a}getAfterBody(e,i){return eu(Nn(i.callbacks,"afterBody",this,e))}getFooter(e,i){let{callbacks:r}=i,a=Nn(r,"beforeFooter",this,e),s=Nn(r,"footer",this,e),o=Nn(r,"afterFooter",this,e),l=[];return l=Ci(l,zi(a)),l=Ci(l,zi(s)),l=Ci(l,zi(o)),l}_createItems(e){let i=this._active,r=this.chart.data,a=[],s=[],o=[],l=[],c,f;for(c=0,f=i.length;c<f;++c)l.push(qv(this.chart,i[c]));return e.filter&&(l=l.filter((h,m,p)=>e.filter(h,m,p,r))),e.itemSort&&(l=l.sort((h,m)=>e.itemSort(h,m,r))),lt(l,h=>{let m=tu(e.callbacks,h);a.push(Nn(m,"labelColor",this,h)),s.push(Nn(m,"labelPointStyle",this,h)),o.push(Nn(m,"labelTextColor",this,h))}),this.labelColors=a,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(e,i){let r=this.options.setContext(this.getContext()),a=this._active,s,o=[];if(!a.length)this.opacity!==0&&(s={opacity:0});else{let l=as[r.position].call(this,a,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);let c=this._size=Jf(this,r),f=Object.assign({},l,c),h=Qf(this.chart,r,f),m=Zf(r,f,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,s={opacity:1,x:m.x,y:m.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,r,a){let s=this.getCaretPosition(e,r,a);i.lineTo(s.x1,s.y1),i.lineTo(s.x2,s.y2),i.lineTo(s.x3,s.y3)}getCaretPosition(e,i,r){let{xAlign:a,yAlign:s}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:c,topRight:f,bottomLeft:h,bottomRight:m}=fr(l),{x:p,y:v}=e,{width:_,height:w}=i,E,S,y,V,H,I;return s==="center"?(H=v+w/2,a==="left"?(E=p,S=E-o,V=H+o,I=H-o):(E=p+_,S=E+o,V=H-o,I=H+o),y=E):(a==="left"?S=p+Math.max(c,h)+o:a==="right"?S=p+_-Math.max(f,m)-o:S=this.caretX,s==="top"?(V=v,H=V-o,E=S-o,y=S+o):(V=v+w,H=V+o,E=S+o,y=S-o),I=V),{x1:E,x2:S,x3:y,y1:V,y2:H,y3:I}}drawTitle(e,i,r){let a=this.title,s=a.length,o,l,c;if(s){let f=Dr(r.rtl,this.x,this.width);for(e.x=jo(this,r.titleAlign,r),i.textAlign=f.textAlign(r.titleAlign),i.textBaseline="middle",o=Nt(r.titleFont),l=r.titleSpacing,i.fillStyle=r.titleColor,i.font=o.string,c=0;c<s;++c)i.fillText(a[c],f.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===s&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,i,r,a,s){let o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:c,boxWidth:f}=s,h=Nt(s.bodyFont),m=jo(this,"left",s),p=a.x(m),v=c<h.lineHeight?(h.lineHeight-c)/2:0,_=i.y+v;if(s.usePointStyle){let w={radius:Math.min(f,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},E=a.leftForLtr(p,f)+f/2,S=_+c/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Oo(e,w,E,S),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Oo(e,w,E,S)}else{e.lineWidth=Ke(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;let w=a.leftForLtr(p,f),E=a.leftForLtr(a.xPlus(p,1),f-2),S=fr(o.borderRadius);Object.values(S).some(y=>y!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,ga(e,{x:w,y:_,w:f,h:c,radius:S}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),ga(e,{x:E,y:_+1,w:f-2,h:c-2,radius:S}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(w,_,f,c),e.strokeRect(w,_,f,c),e.fillStyle=o.backgroundColor,e.fillRect(E,_+1,f-2,c-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,i,r){let{body:a}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:f,boxPadding:h}=r,m=Nt(r.bodyFont),p=m.lineHeight,v=0,_=Dr(r.rtl,this.x,this.width),w=function(W){i.fillText(W,_.x(e.x+v),e.y+p/2),e.y+=p+s},E=_.textAlign(o),S,y,V,H,I,T,N;for(i.textAlign=o,i.textBaseline="middle",i.font=m.string,e.x=jo(this,E,r),i.fillStyle=r.bodyColor,lt(this.beforeBody,w),v=l&&E!=="right"?o==="center"?f/2+h:f+2+h:0,H=0,T=a.length;H<T;++H){for(S=a[H],y=this.labelTextColors[H],i.fillStyle=y,lt(S.before,w),V=S.lines,l&&V.length&&(this._drawColorBox(i,e,H,_,r),p=Math.max(m.lineHeight,c)),I=0,N=V.length;I<N;++I)w(V[I]),p=m.lineHeight;lt(S.after,w)}v=0,p=m.lineHeight,lt(this.afterBody,w),e.y-=s}drawFooter(e,i,r){let a=this.footer,s=a.length,o,l;if(s){let c=Dr(r.rtl,this.x,this.width);for(e.x=jo(this,r.footerAlign,r),e.y+=r.footerMarginTop,i.textAlign=c.textAlign(r.footerAlign),i.textBaseline="middle",o=Nt(r.footerFont),i.fillStyle=r.footerColor,i.font=o.string,l=0;l<s;++l)i.fillText(a[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,i,r,a){let{xAlign:s,yAlign:o}=this,{x:l,y:c}=e,{width:f,height:h}=r,{topLeft:m,topRight:p,bottomLeft:v,bottomRight:_}=fr(a.cornerRadius);i.fillStyle=a.backgroundColor,i.strokeStyle=a.borderColor,i.lineWidth=a.borderWidth,i.beginPath(),i.moveTo(l+m,c),o==="top"&&this.drawCaret(e,i,r,a),i.lineTo(l+f-p,c),i.quadraticCurveTo(l+f,c,l+f,c+p),o==="center"&&s==="right"&&this.drawCaret(e,i,r,a),i.lineTo(l+f,c+h-_),i.quadraticCurveTo(l+f,c+h,l+f-_,c+h),o==="bottom"&&this.drawCaret(e,i,r,a),i.lineTo(l+v,c+h),i.quadraticCurveTo(l,c+h,l,c+h-v),o==="center"&&s==="left"&&this.drawCaret(e,i,r,a),i.lineTo(l,c+m),i.quadraticCurveTo(l,c,l+m,c),i.closePath(),i.fill(),a.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){let i=this.chart,r=this.$animations,a=r&&r.x,s=r&&r.y;if(a||s){let o=as[e.position].call(this,this._active,this._eventPosition);if(!o)return;let l=this._size=Jf(this,e),c=Object.assign({},o,this._size),f=Qf(i,e,c),h=Zf(e,c,f,i);(a._to!==h.x||s._to!==h.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){let i=this.options.setContext(this.getContext()),r=this.opacity;if(!r)return;this._updateAnimationTarget(i);let a={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;let o=nn(i.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,a,i),p0(e,i.textDirection),s.y+=o.top,this.drawTitle(s,e,i),this.drawBody(s,e,i),this.drawFooter(s,e,i),g0(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){let r=this._active,a=e.map(({datasetIndex:l,index:c})=>{let f=this.chart.getDatasetMeta(l);if(!f)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:f.data[c],index:c}}),s=!Ka(r,a),o=this._positionChanged(a,i);(s||o)&&(this._active=a,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,r=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let a=this.options,s=this._active||[],o=this._getActiveElements(e,s,i,r),l=this._positionChanged(o,e),c=i||!Ka(o,s)||l;return c&&(this._active=o,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),c}_getActiveElements(e,i,r,a){let s=this.options;if(e.type==="mouseout")return[];if(!a)return i.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);let o=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(e,i){let{caretX:r,caretY:a,options:s}=this,o=as[s.position].call(this,e,i);return o!==!1&&(r!==o.x||a!==o.y)}}return t})(),iw={id:"tooltip",_element:nu,positioners:as,afterInit(t,n,e){e&&(t.tooltip=new nu({chart:t,options:e}))},beforeUpdate(t,n,e){t.tooltip&&t.tooltip.initialize(e)},reset(t,n,e){t.tooltip&&t.tooltip.initialize(e)},afterDraw(t){let n=t.tooltip;if(n&&n._willRender()){let e={tooltip:n};if(t.notifyPlugins("beforeTooltipDraw",qr(Kr({},e),{cancelable:!0}))===!1)return;n.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",e)}},afterEvent(t,n){if(t.tooltip){let e=n.replay;t.tooltip.handleEvent(n.event,e,n.inChartArea)&&(n.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,n)=>n.bodyFont.size,boxWidth:(t,n)=>n.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Iu},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},rw=Object.freeze({__proto__:null,Colors:gv,Decimation:wv,Filler:Hv,Legend:$v,SubTitle:Kv,Title:Xv,Tooltip:iw}),aw=(t,n,e,i)=>(typeof n=="string"?(e=t.push(n)-1,i.unshift({index:e,label:n})):isNaN(n)&&(e=null),e);function sw(t,n,e,i){let r=t.indexOf(n);if(r===-1)return aw(t,n,e,i);let a=t.lastIndexOf(n);return r!==a?e:r}var ow=(t,n)=>t===null?null:jt(Math.round(t),0,n);function iu(t){let n=this.getLabels();return t>=0&&t<n.length?n[t]:t}var lw=(()=>{class t extends Pr{static id="category";static defaults={ticks:{callback:iu}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){let i=this._addedLabels;if(i.length){let r=this.getLabels();for(let{index:a,label:s}of i)r[a]===s&&r.splice(a,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(Ye(e))return null;let r=this.getLabels();return i=isFinite(i)&&r[i]===e?i:sw(r,e,Be(i,e),this._addedLabels),ow(i,r.length-1)}determineDataLimits(){let{minDefined:e,maxDefined:i}=this.getUserBounds(),{min:r,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),i||(a=this.getLabels().length-1)),this.min=r,this.max=a}buildTicks(){let e=this.min,i=this.max,r=this.options.offset,a=[],s=this.getLabels();s=e===0&&i===s.length-1?s:s.slice(e,i+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=i;o++)a.push({value:o});return a}getLabelForValue(e){return iu.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){let i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}return t})();function cw(t,n){let e=[],{bounds:r,step:a,min:s,max:o,precision:l,count:c,maxTicks:f,maxDigits:h,includeBounds:m}=t,p=a||1,v=f-1,{min:_,max:w}=n,E=!Ye(s),S=!Ye(o),y=!Ye(c),V=(w-_)/(h+1),H=Xl((w-_)/v/p)*p,I,T,N,W;if(H<1e-14&&!E&&!S)return[{value:_},{value:w}];W=Math.ceil(w/H)-Math.floor(_/H),W>v&&(H=Xl(W*H/v/p)*p),Ye(l)||(I=Math.pow(10,l),H=Math.ceil(H*I)/I),r==="ticks"?(T=Math.floor(_/H)*H,N=Math.ceil(w/H)*H):(T=_,N=w),E&&S&&a&&zd((o-s)/a,H/1e3)?(W=Math.round(Math.min((o-s)/H,f)),H=(o-s)/W,T=s,N=o):y?(T=E?s:T,N=S?o:N,W=c-1,H=(N-T)/W):(W=(N-T)/H,ha(W,Math.round(W),H/1e3)?W=Math.round(W):W=Math.ceil(W));let ee=Math.max(ql(H),ql(T));I=Math.pow(10,Ye(l)?ee:l),T=Math.round(T*I)/I,N=Math.round(N*I)/I;let te=0;for(E&&(m&&T!==s?(e.push({value:s}),T<s&&te++,ha(Math.round((T+te*H)*I)/I,s,ru(s,V,t))&&te++):T<s&&te++);te<W;++te){let X=Math.round((T+te*H)*I)/I;if(S&&X>o)break;e.push({value:X})}return S&&m&&N!==o?e.length&&ha(e[e.length-1].value,o,ru(o,V,t))?e[e.length-1].value=o:e.push({value:o}):(!S||N===o)&&e.push({value:N}),e}function ru(t,n,{horizontal:e,minRotation:i}){let r=Jn(i),a=(e?Math.sin(r):Math.cos(r))||.001,s=.75*n*(""+t).length;return Math.min(n/a,s)}var wa=class extends Pr{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(n,e){return Ye(n)||(typeof n=="number"||n instanceof Number)&&!isFinite(+n)?null:+n}handleTickRangeOptions(){let{beginAtZero:n}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds(),{min:r,max:a}=this,s=l=>r=e?r:l,o=l=>a=i?a:l;if(n){let l=si(r),c=si(a);l<0&&c<0?o(0):l>0&&c>0&&s(0)}if(r===a){let l=a===0?1:Math.abs(a*.05);o(a+l),n||s(r-l)}this.min=r,this.max=a}getTickLimit(){let n=this.options.ticks,{maxTicksLimit:e,stepSize:i}=n,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),e=e||11),e&&(r=Math.min(e,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){let n=this.options,e=n.ticks,i=this.getTickLimit();i=Math.max(2,i);let r={maxTicks:i,bounds:n.bounds,min:n.min,max:n.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},a=this._range||this,s=cw(r,a);return n.bounds==="ticks"&&Kl(s,this,"value"),n.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}configure(){let n=this.ticks,e=this.min,i=this.max;if(super.configure(),this.options.offset&&n.length){let r=(i-e)/Math.max(n.length-1,1)/2;e-=r,i+=r}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(n){return pa(n,this.chart.options.locale,this.options.ticks.format)}},$0=class extends wa{static id="linear";static defaults={ticks:{callback:qa.formatters.numeric}};determineDataLimits(){let{min:n,max:e}=this.getMinMax(!0);this.min=Et(n)?n:0,this.max=Et(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){let n=this.isHorizontal(),e=n?this.width:this.height,i=Jn(this.options.ticks.minRotation),r=(n?Math.sin(i):Math.cos(i))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,a.lineHeight/r))}getPixelForValue(n){return n===null?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getValueForPixel(n){return this._startValue+this.getDecimalForPixel(n)*this._valueRange}},ls=t=>Math.floor(Ni(t)),Ir=(t,n)=>Math.pow(10,ls(t)+n);function au(t){return t/Math.pow(10,ls(t))===1}function su(t,n,e){let i=Math.pow(10,e),r=Math.floor(t/i);return Math.ceil(n/i)-r}function dw(t,n){let e=n-t,i=ls(e);for(;su(t,n,i)>10;)i++;for(;su(t,n,i)<10;)i--;return Math.min(i,ls(t))}function fw(t,{min:n,max:e}){n=Vn(t.min,n);let i=[],r=ls(n),a=dw(n,e),s=a<0?Math.pow(10,Math.abs(a)):1,o=Math.pow(10,a),l=r>a?Math.pow(10,r):0,c=Math.round((n-l)*s)/s,f=Math.floor((n-l)/o/10)*o*10,h=Math.floor((c-f)/Math.pow(10,a)),m=Vn(t.min,Math.round((l+f+h*Math.pow(10,a))*s)/s);for(;m<e;)i.push({value:m,major:au(m),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(a++,h=2,s=a>=0?1:s),m=Math.round((l+f+h*Math.pow(10,a))*s)/s;let p=Vn(t.max,m);return i.push({value:p,major:au(p),significand:h}),i}var Y0=class extends Pr{static id="logarithmic";static defaults={ticks:{callback:qa.formatters.logarithmic,major:{enabled:!0}}};constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(n,e){let i=wa.prototype.parse.apply(this,[n,e]);if(i===0){this._zero=!0;return}return Et(i)&&i>0?i:null}determineDataLimits(){let{min:n,max:e}=this.getMinMax(!0);this.min=Et(n)?Math.max(0,n):null,this.max=Et(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Et(this._userMin)&&(this.min=n===Ir(this.min,0)?Ir(this.min,-1):Ir(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:n,maxDefined:e}=this.getUserBounds(),i=this.min,r=this.max,a=o=>i=n?i:o,s=o=>r=e?r:o;i===r&&(i<=0?(a(1),s(10)):(a(Ir(i,-1)),s(Ir(r,1)))),i<=0&&a(Ir(r,-1)),r<=0&&s(Ir(i,1)),this.min=i,this.max=r}buildTicks(){let n=this.options,e={min:this._userMin,max:this._userMax},i=fw(e,this);return n.bounds==="ticks"&&Kl(i,this,"value"),n.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(n){return n===void 0?"0":pa(n,this.chart.options.locale,this.options.ticks.format)}configure(){let n=this.min;super.configure(),this._startValue=Ni(n),this._valueRange=Ni(this.max)-Ni(n)}getPixelForValue(n){return(n===void 0||n===0)&&(n=this.min),n===null||isNaN(n)?NaN:this.getPixelForDecimal(n===this.min?0:(Ni(n)-this._startValue)/this._valueRange)}getValueForPixel(n){let e=this.getDecimalForPixel(n);return Math.pow(10,this._startValue+e*this._valueRange)}};function X0(t){let n=t.ticks;if(n.display&&t.display){let e=nn(n.backdropPadding);return Be(n.font&&n.font.size,wt.font.size)+e.height}return 0}function uw(t,n,e){return e=pt(e)?e:[e],{w:Jd(t,n.string,e),h:e.length*n.lineHeight}}function ou(t,n,e,i,r){return t===i||t===r?{start:n-e/2,end:n+e/2}:t<i||t>r?{start:n-e,end:n}:{start:n,end:n+e}}function hw(t){let n={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},e=Object.assign({},n),i=[],r=[],a=t._pointLabels.length,s=t.options.pointLabels,o=s.centerPointLabels?et/a:0;for(let l=0;l<a;l++){let c=s.setContext(t.getPointLabelContext(l));r[l]=c.padding;let f=t.getPointPosition(l,t.drawingArea+r[l],o),h=Nt(c.font),m=uw(t.ctx,h,t._pointLabels[l]);i[l]=m;let p=en(t.getIndexAngle(l)+o),v=Math.round(Do(p)),_=ou(v,f.x,m.w,0,180),w=ou(v,f.y,m.h,90,270);mw(e,n,p,_,w)}t.setCenterPoint(n.l-e.l,e.r-n.r,n.t-e.t,e.b-n.b),t._pointLabelItems=xw(t,i,r)}function mw(t,n,e,i,r){let a=Math.abs(Math.sin(e)),s=Math.abs(Math.cos(e)),o=0,l=0;i.start<n.l?(o=(n.l-i.start)/a,t.l=Math.min(t.l,n.l-o)):i.end>n.r&&(o=(i.end-n.r)/a,t.r=Math.max(t.r,n.r+o)),r.start<n.t?(l=(n.t-r.start)/s,t.t=Math.min(t.t,n.t-l)):r.end>n.b&&(l=(r.end-n.b)/s,t.b=Math.max(t.b,n.b+l))}function pw(t,n,e){let i=t.drawingArea,{extra:r,additionalAngle:a,padding:s,size:o}=e,l=t.getPointPosition(n,i+r+s,a),c=Math.round(Do(en(l.angle+Tt))),f=ww(l.y,o.h,c),h=_w(c),m=vw(l.x,o.w,h);return{visible:!0,x:l.x,y:f,textAlign:h,left:m,top:f,right:m+o.w,bottom:f+o.h}}function gw(t,n){if(!n)return!0;let{left:e,top:i,right:r,bottom:a}=t;return!(bi({x:e,y:i},n)||bi({x:e,y:a},n)||bi({x:r,y:i},n)||bi({x:r,y:a},n))}function xw(t,n,e){let i=[],r=t._pointLabels.length,a=t.options,{centerPointLabels:s,display:o}=a.pointLabels,l={extra:X0(a)/2,additionalAngle:s?et/r:0},c;for(let f=0;f<r;f++){l.padding=e[f],l.size=n[f];let h=pw(t,f,l);i.push(h),o==="auto"&&(h.visible=gw(h,c),h.visible&&(c=h))}return i}function _w(t){return t===0||t===180?"center":t<180?"left":"right"}function vw(t,n,e){return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function ww(t,n,e){return e===90||e===270?t-=n/2:(e>270||e<90)&&(t-=n),t}function bw(t,n,e){let{left:i,top:r,right:a,bottom:s}=e,{backdropColor:o}=n;if(!Ye(o)){let l=fr(n.borderRadius),c=nn(n.backdropPadding);t.fillStyle=o;let f=i-c.left,h=r-c.top,m=a-i+c.width,p=s-r+c.height;Object.values(l).some(v=>v!==0)?(t.beginPath(),ga(t,{x:f,y:h,w:m,h:p,radius:l}),t.fill()):t.fillRect(f,h,m,p)}}function yw(t,n){let{ctx:e,options:{pointLabels:i}}=t;for(let r=n-1;r>=0;r--){let a=t._pointLabelItems[r];if(!a.visible)continue;let s=i.setContext(t.getPointLabelContext(r));bw(e,s,a);let o=Nt(s.font),{x:l,y:c,textAlign:f}=a;dr(e,t._pointLabels[r],l,c+o.lineHeight/2,o,{color:s.color,textAlign:f,textBaseline:"middle"})}}function Pu(t,n,e,i){let{ctx:r}=t;if(e)r.arc(t.xCenter,t.yCenter,n,0,gt);else{let a=t.getPointPosition(0,n);r.moveTo(a.x,a.y);for(let s=1;s<i;s++)a=t.getPointPosition(s,n),r.lineTo(a.x,a.y)}}function Sw(t,n,e,i,r){let a=t.ctx,s=n.circular,{color:o,lineWidth:l}=n;!s&&!i||!o||!l||e<0||(a.save(),a.strokeStyle=o,a.lineWidth=l,a.setLineDash(r.dash||[]),a.lineDashOffset=r.dashOffset,a.beginPath(),Pu(t,e,s,i),a.closePath(),a.stroke(),a.restore())}function Cw(t,n,e){return Hi(t,{label:e,index:n,type:"pointLabel"})}var K0=class extends wa{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:qa.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(n){return n},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(n){super(n),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let n=this._padding=nn(X0(this.options)/2),e=this.width=this.maxWidth-n.width,i=this.height=this.maxHeight-n.height;this.xCenter=Math.floor(this.left+e/2+n.left),this.yCenter=Math.floor(this.top+i/2+n.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){let{min:n,max:e}=this.getMinMax(!1);this.min=Et(n)&&!isNaN(n)?n:0,this.max=Et(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/X0(this.options))}generateTickLabels(n){wa.prototype.generateTickLabels.call(this,n),this._pointLabels=this.getLabels().map((e,i)=>{let r=ht(this.options.pointLabels.callback,[e,i],this);return r||r===0?r:""}).filter((e,i)=>this.chart.getDataVisibility(i))}fit(){let n=this.options;n.display&&n.pointLabels.display?hw(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(n,e,i,r){this.xCenter+=Math.floor((n-e)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(n,e,i,r))}getIndexAngle(n){let e=gt/(this._pointLabels.length||1),i=this.options.startAngle||0;return en(n*e+Jn(i))}getDistanceFromCenterForValue(n){if(Ye(n))return NaN;let e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-n)*e:(n-this.min)*e}getValueForDistanceFromCenter(n){if(Ye(n))return NaN;let e=n/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(n){let e=this._pointLabels||[];if(n>=0&&n<e.length){let i=e[n];return Cw(this.getContext(),n,i)}}getPointPosition(n,e,i=0){let r=this.getIndexAngle(n)-Tt+i;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(n,e){return this.getPointPosition(n,this.getDistanceFromCenterForValue(e))}getBasePosition(n){return this.getPointPositionForValue(n||0,this.getBaseValue())}getPointLabelPosition(n){let{left:e,top:i,right:r,bottom:a}=this._pointLabelItems[n];return{left:e,top:i,right:r,bottom:a}}drawBackground(){let{backgroundColor:n,grid:{circular:e}}=this.options;if(n){let i=this.ctx;i.save(),i.beginPath(),Pu(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=n,i.fill(),i.restore()}}drawGrid(){let n=this.ctx,e=this.options,{angleLines:i,grid:r,border:a}=e,s=this._pointLabels.length,o,l,c;if(e.pointLabels.display&&yw(this,s),r.display&&this.ticks.forEach((f,h)=>{if(h!==0||h===0&&this.min<0){l=this.getDistanceFromCenterForValue(f.value);let m=this.getContext(h),p=r.setContext(m),v=a.setContext(m);Sw(this,p,l,s,v)}}),i.display){for(n.save(),o=s-1;o>=0;o--){let f=i.setContext(this.getPointLabelContext(o)),{color:h,lineWidth:m}=f;!m||!h||(n.lineWidth=m,n.strokeStyle=h,n.setLineDash(f.borderDash),n.lineDashOffset=f.borderDashOffset,l=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),c=this.getPointPosition(o,l),n.beginPath(),n.moveTo(this.xCenter,this.yCenter),n.lineTo(c.x,c.y),n.stroke())}n.restore()}}drawBorder(){}drawLabels(){let n=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;let r=this.getIndexAngle(0),a,s;n.save(),n.translate(this.xCenter,this.yCenter),n.rotate(r),n.textAlign="center",n.textBaseline="middle",this.ticks.forEach((o,l)=>{if(l===0&&this.min>=0&&!e.reverse)return;let c=i.setContext(this.getContext(l)),f=Nt(c.font);if(a=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){n.font=f.string,s=n.measureText(o.label).width,n.fillStyle=c.backdropColor;let h=nn(c.backdropPadding);n.fillRect(-s/2-h.left,-a-f.size/2-h.top,s+h.width,f.size+h.height)}dr(n,o.label,0,-a,f,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),n.restore()}drawTitle(){}},nl={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Bn=Object.keys(nl);function lu(t,n){return t-n}function cu(t,n){if(Ye(n))return null;let e=t._adapter,{parser:i,round:r,isoWeekday:a}=t._parseOpts,s=n;return typeof i=="function"&&(s=i(s)),Et(s)||(s=typeof i=="string"?e.parse(s,i):e.parse(s)),s===null?null:(r&&(s=r==="week"&&(Mr(a)||a===!0)?e.startOf(s,"isoWeek",a):e.startOf(s,r)),+s)}function du(t,n,e,i){let r=Bn.length;for(let a=Bn.indexOf(t);a<r-1;++a){let s=nl[Bn[a]],o=s.steps?s.steps:Number.MAX_SAFE_INTEGER;if(s.common&&Math.ceil((e-n)/(o*s.size))<=i)return Bn[a]}return Bn[r-1]}function kw(t,n,e,i,r){for(let a=Bn.length-1;a>=Bn.indexOf(e);a--){let s=Bn[a];if(nl[s].common&&t._adapter.diff(r,i,s)>=n-1)return s}return Bn[e?Bn.indexOf(e):0]}function Ew(t){for(let n=Bn.indexOf(t)+1,e=Bn.length;n<e;++n)if(nl[Bn[n]].common)return Bn[n]}function fu(t,n,e){if(!e)t[n]=!0;else if(e.length){let{lo:i,hi:r}=Fo(e,n),a=e[i]>=n?e[i]:e[r];t[a]=!0}}function Tw(t,n,e,i){let r=t._adapter,a=+r.startOf(n[0].value,i),s=n[n.length-1].value,o,l;for(o=a;o<=s;o=+r.add(o,1,i))l=e[o],l>=0&&(n[l].major=!0);return n}function uu(t,n,e){let i=[],r={},a=n.length,s,o;for(s=0;s<a;++s)o=n[s],r[o]=s,i.push({value:o,major:!1});return a===0||!e?i:Tw(t,i,r,e)}var q0=(()=>{class t extends Pr{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){let r=e.time||(e.time={}),a=this._adapter=new N2._date(e.adapters.date);a.init(i),fa(r.displayFormats,a.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return e===void 0?null:cu(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let e=this.options,i=this._adapter,r=e.time.unit||"day",{min:a,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function c(f){!o&&!isNaN(f.min)&&(a=Math.min(a,f.min)),!l&&!isNaN(f.max)&&(s=Math.max(s,f.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),a=Et(a)&&!isNaN(a)?a:+i.startOf(Date.now(),r),s=Et(s)&&!isNaN(s)?s:+i.endOf(Date.now(),r)+1,this.min=Math.min(a,s-1),this.max=Math.max(a+1,s)}_getLabelBounds(){let e=this.getLabelTimestamps(),i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],r=e[e.length-1]),{min:i,max:r}}buildTicks(){let e=this.options,i=e.time,r=e.ticks,a=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);let s=this.min,o=this.max,l=Gd(a,s,o);return this._unit=i.unit||(r.autoSkip?du(i.minUnit,this.min,this.max,this._getLabelCapacity(s)):kw(this,l.length,i.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:Ew(this._unit),this.initOffsets(a),e.reverse&&l.reverse(),uu(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let i=0,r=0,a,s;this.options.offset&&e.length&&(a=this.getDecimalForValue(e[0]),e.length===1?i=1-a:i=(this.getDecimalForValue(e[1])-a)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);let o=e.length<3?.5:.25;i=jt(i,0,o),r=jt(r,0,o),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){let e=this._adapter,i=this.min,r=this.max,a=this.options,s=a.time,o=s.unit||du(s.minUnit,i,r,this._getLabelCapacity(i)),l=Be(a.ticks.stepSize,1),c=o==="week"?s.isoWeekday:!1,f=Mr(c)||c===!0,h={},m=i,p,v;if(f&&(m=+e.startOf(m,"isoWeek",c)),m=+e.startOf(m,f?"day":o),e.diff(r,i,o)>1e5*l)throw new Error(i+" and "+r+" are too far apart with stepSize of "+l+" "+o);let _=a.ticks.source==="data"&&this.getDataTimestamps();for(p=m,v=0;p<r;p=+e.add(p,l,o),v++)fu(h,p,_);return(p===r||a.bounds==="ticks"||v===1)&&fu(h,p,_),Object.keys(h).sort(lu).map(w=>+w)}getLabelForValue(e){let i=this._adapter,r=this.options.time;return r.tooltipFormat?i.format(e,r.tooltipFormat):i.format(e,r.displayFormats.datetime)}format(e,i){let a=this.options.time.displayFormats,s=this._unit,o=i||a[s];return this._adapter.format(e,o)}_tickFormatFunction(e,i,r,a){let s=this.options,o=s.ticks.callback;if(o)return ht(o,[e,i,r],this);let l=s.time.displayFormats,c=this._unit,f=this._majorUnit,h=c&&l[c],m=f&&l[f],p=r[i],v=f&&m&&p&&p.major;return this._adapter.format(e,a||(v?m:h))}generateTickLabels(e){let i,r,a;for(i=0,r=e.length;i<r;++i)a=e[i],a.label=this._tickFormatFunction(a.value,i,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){let i=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+r)*i.factor)}getValueForPixel(e){let i=this._offsets,r=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){let i=this.options.ticks,r=this.ctx.measureText(e).width,a=Jn(this.isHorizontal()?i.maxRotation:i.minRotation),s=Math.cos(a),o=Math.sin(a),l=this._resolveTickFontOptions(0).size;return{w:r*s+l*o,h:r*o+l*s}}_getLabelCapacity(e){let i=this.options.time,r=i.displayFormats,a=r[i.unit]||r.millisecond,s=this._tickFormatFunction(e,0,uu(this,[e],this._majorUnit),a),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],i,r;if(e.length)return e;let a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(i=0,r=a.length;i<r;++i)e=e.concat(a[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){let e=this._cache.labels||[],i,r;if(e.length)return e;let a=this.getLabels();for(i=0,r=a.length;i<r;++i)e.push(cu(this,a[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Zl(e.sort(lu))}}return t})();function Go(t,n,e){let i=0,r=t.length-1,a,s,o,l;e?(n>=t[i].pos&&n<=t[r].pos&&({lo:i,hi:r}=wi(t,"pos",n)),{pos:a,time:o}=t[i],{pos:s,time:l}=t[r]):(n>=t[i].time&&n<=t[r].time&&({lo:i,hi:r}=wi(t,"time",n)),{time:a,pos:o}=t[i],{time:s,pos:l}=t[r]);let c=s-a;return c?o+(l-o)*(n-a)/c:o}var J0=class extends q0{static id="timeseries";static defaults=q0.defaults;constructor(n){super(n),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let n=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(n);this._minPos=Go(e,this.min),this._tableRange=Go(e,this.max)-this._minPos,super.initOffsets(n)}buildLookupTable(n){let{min:e,max:i}=this,r=[],a=[],s,o,l,c,f;for(s=0,o=n.length;s<o;++s)c=n[s],c>=e&&c<=i&&r.push(c);if(r.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(s=0,o=r.length;s<o;++s)f=r[s+1],l=r[s-1],c=r[s],Math.round((f+l)/2)!==c&&a.push({time:c,pos:s/(o-1)});return a}_generate(){let n=this.min,e=this.max,i=super.getDataTimestamps();return(!i.includes(n)||!i.length)&&i.splice(0,0,n),(!i.includes(e)||i.length===1)&&i.push(e),i.sort((r,a)=>r-a)}_getTimestampsForTable(){let n=this._cache.all||[];if(n.length)return n;let e=this.getDataTimestamps(),i=this.getLabelTimestamps();return e.length&&i.length?n=this.normalize(e.concat(i)):n=e.length?e:i,n=this._cache.all=n,n}getDecimalForValue(n){return(Go(this._table,n)-this._minPos)/this._tableRange}getValueForPixel(n){let e=this._offsets,i=this.getDecimalForPixel(n)/e.factor-e.end;return Go(this._table,i*this._tableRange+this._minPos,!0)}},Aw=Object.freeze({__proto__:null,CategoryScale:lw,LinearScale:$0,LogarithmicScale:Y0,RadialLinearScale:K0,TimeScale:q0,TimeSeriesScale:J0}),Ou=[V2,cv,rw,Aw];var Mw=["dateInput"],Dw=t=>["/locations",t],Fw=t=>["/assets/preview",t],Iw=()=>["all","category","location","department","manufacturer","parent","children","siblings","similar"];function Pw(t,n){if(t&1){let e=ue();d(0,"div",28)(1,"button",29),Y("click",function(){U(e);let r=b();return r.transferAsset(),z(r.showActionsDropdown=!1)}),B(),d(2,"svg",30),D(3,"path",31),u(),q(),d(4,"span",32),g(5,"Transfer Asset"),u()(),d(6,"button",29),Y("click",function(){U(e);let r=b();return r.duplicateAsset(),z(r.showActionsDropdown=!1)}),B(),d(7,"svg",30),D(8,"path",33),u(),q(),d(9,"span",32),g(10,"Duplicate"),u()(),D(11,"div",34),d(12,"button",29),Y("click",function(){U(e);let r=b();return r.printAsset(),z(r.showActionsDropdown=!1)}),B(),d(13,"svg",30),D(14,"path",35),u(),q(),d(15,"span",32),g(16,"Print"),u()(),d(17,"button",29),Y("click",function(){U(e);let r=b();return r.exportAsset(),z(r.showActionsDropdown=!1)}),B(),d(18,"svg",30),D(19,"path",36),u(),q(),d(20,"span",32),g(21,"Export"),u()(),d(22,"button",29),Y("click",function(){U(e);let r=b();return r.sharePublicUrl(),z(r.showActionsDropdown=!1)}),B(),d(23,"svg",30),D(24,"path",37),u(),q(),d(25,"span",32),g(26,"Share Public URL"),u()()()}}function Ow(t,n){t&1&&(d(0,"div",38)(1,"div",39)(2,"div",40),B(),d(3,"svg",41),D(4,"circle",42)(5,"path",43),u()(),q(),d(6,"h3",44),g(7,"Loading Asset"),u(),d(8,"p",45),g(9,"Please wait while we fetch the asset details..."),u()()())}function Lw(t,n){if(t&1){let e=ue();d(0,"div",38)(1,"div",39)(2,"div",46),B(),d(3,"svg",47),D(4,"path",48),u()(),q(),d(5,"h3",44),g(6,"Error Loading Asset"),u(),d(7,"p",49),g(8),u(),d(9,"button",50),Y("click",function(){U(e);let r=b();return z(r.goBack())}),g(10," Back to Assets "),u()()()}if(t&2){let e=b();x(8),oe(e.error)}}function Rw(t,n){if(t&1&&(d(0,"span",175),g(1),u()),t&2){let e=b(2);yt("background-color",e.asset.asset_status.color+"20")("color",e.asset.asset_status.color),x(),xe(" ",e.asset.asset_status.name," ")}}function Vw(t,n){if(t&1){let e=ue();d(0,"div",7)(1,"span",45),g(2,"Serial:"),u(),d(3,"button",62),Y("click",function(){U(e);let r=b(2);return z(r.copySerialNumber())}),d(4,"span"),g(5),u(),B(),d(6,"svg",63),D(7,"path",33),u()()()}if(t&2){let e=b(2);x(5),oe(e.asset.serial_number)}}function Nw(t,n){if(t&1){let e=ue();d(0,"button",183),Y("click",function(){U(e);let r=b(3);return z(r.previousImage())}),B(),d(1,"svg",18),D(2,"path",184),u()()}}function Bw(t,n){if(t&1){let e=ue();d(0,"button",185),Y("click",function(){U(e);let r=b(3);return z(r.nextImage())}),B(),d(1,"svg",18),D(2,"path",10),u()()}}function Hw(t,n){if(t&1){let e=ue();d(0,"div",188),Y("click",function(){let r=U(e).index,a=b(4);return z(a.selectImage(r))}),d(1,"img",189),Y("error",function(r){U(e);let a=b(4);return z(a.onImageError(r))}),u()()}if(t&2){let e=n.$implicit,i=n.index,r=b(4);ge("border-blue-500",i===r.currentImageIndex)("border-gray-200",i!==r.currentImageIndex),x(),C("src",e.image_url,kt)("alt","Asset image "+(i+1))}}function Uw(t,n){if(t&1&&(d(0,"div",186),J(1,Hw,2,6,"div",187),u()),t&2){let e=b(3);x(),C("ngForOf",e.asset.images)}}function zw(t,n){if(t&1){let e=ue();d(0,"div")(1,"div",176)(2,"div",177)(3,"img",178),Y("click",function(){U(e);let r=b(2);return z(r.viewFullImage(r.selectedImageUrl||r.asset.images[0].image_url))})("error",function(r){U(e);let a=b(2);return z(a.onImageError(r))}),u(),J(4,Nw,3,0,"button",179)(5,Bw,3,0,"button",180),d(6,"div",181),g(7),u()()(),J(8,Uw,2,1,"div",182),u()}if(t&2){let e=b(2);x(3),C("src",e.selectedImageUrl||e.asset.images[0].image_url,kt)("alt",e.asset.name),x(),C("ngIf",e.asset.images.length>1),x(),C("ngIf",e.asset.images.length>1),x(2),Ft(" ",e.currentImageIndex+1," / ",e.asset.images.length," "),x(),C("ngIf",e.asset.images.length>1)}}function Ww(t,n){t&1&&(d(0,"div",190),B(),d(1,"svg",191),D(2,"path",70),u(),q(),d(3,"h3",44),g(4,"No Images Available"),u(),d(5,"p",192),g(6,"No images have been uploaded for this asset."),u()())}function jw(t,n){if(t&1){let e=ue();d(0,"button",193),Y("click",function(){U(e);let r=b(2);return z(r.descriptionExpanded=!r.descriptionExpanded)}),g(1),u()}if(t&2){let e=b(2);x(),xe(" ",e.descriptionExpanded?"Show Less":"Show More"," ")}}function Gw(t,n){if(t&1){let e=ue();d(0,"img",194),Y("error",function(r){U(e);let a=b(2);return z(a.onCategoryIconError(r,a.asset.category))}),u()}if(t&2){let e=b(2);C("src",e.asset.category.icon,kt)("alt",e.asset.category.name)}}function $w(t,n){t&1&&(B(),d(0,"svg",159),D(1,"path",195),u())}function Yw(t,n){if(t&1&&(d(0,"div",7)(1,"span",196),g(2),u()()),t&2){let e=b(2);x(),yt("background-color",e.asset.asset_status.color+"20")("color",e.asset.asset_status.color),x(),xe(" ",e.asset.asset_status.name," ")}}function Xw(t,n){t&1&&(d(0,"span",90),g(1,"Not specified"),u())}function Kw(t,n){if(t&1&&(d(0,"a",197),g(1),u()),t&2){let e=b(2);C("routerLink",Ji(2,Dw,e.asset.location.id)),x(),xe(" ",e.asset.location.name," ")}}function qw(t,n){if(t&1&&(d(0,"span",90),g(1),u()),t&2){let e=b(2);x(),oe((e.asset==null||e.asset.location==null?null:e.asset.location.name)||"No location assigned")}}function Jw(t,n){if(t&1&&(d(0,"div")(1,"h4",76),g(2,"Parent Asset"),u(),d(3,"a",197),g(4),u()()),t&2){let e=b(2);x(3),C("routerLink",Ji(3,Fw,e.asset.parent.id)),x(),Ft(" ",e.asset.parent.name," (",e.asset.parent.asset_id,") ")}}function Qw(t,n){if(t&1&&D(0,"img",198),t&2){let e=b(2);C("src",e.qrCodeDataUrl,kt)}}function Zw(t,n){if(t&1&&D(0,"img",198),t&2){let e=b(2);C("src",e.asset.qr_code_url,kt)}}function eb(t,n){t&1&&(d(0,"div",199),D(1,"div",200),u())}function tb(t,n){if(t&1&&(d(0,"div",39),B(),d(1,"svg",201),D(2,"path",202),u(),q(),d(3,"p",203),g(4),u()()),t&2){let e=b(2);x(4),oe(e.asset.asset_id||e.asset.id)}}function nb(t,n){t&1&&(d(0,"div",204),B(),d(1,"svg",205),D(2,"path",48),u(),q(),d(3,"p",206),g(4,"No Asset ID"),u()())}function ib(t,n){if(t&1){let e=ue();d(0,"button",207),Y("click",function(){U(e);let r=b(2);return z(r.downloadQRCode())}),g(1," Download "),u()}}function rb(t,n){if(t&1){let e=ue();d(0,"button",208),Y("click",function(){U(e);let r=b(2);return z(r.copyPublicUrl())}),g(1," Copy URL "),u()}}function ab(t,n){if(t&1&&D(0,"img",209),t&2){let e=b(2);C("src",e.asset.barcode_url,kt)}}function sb(t,n){if(t&1&&D(0,"img",209),t&2){let e=b(2);C("src",e.barcodeDataUrl,kt)}}function ob(t,n){t&1&&(d(0,"div",210),D(1,"div",200),u())}function lb(t,n){if(t&1&&(d(0,"div",211),B(),d(1,"svg",212),D(2,"path",74),u(),q(),d(3,"p",203),g(4),u()()),t&2){let e=b(2);x(4),oe(e.asset.asset_id)}}function cb(t,n){t&1&&(d(0,"div",213),B(),d(1,"svg",205),D(2,"path",48),u(),q(),d(3,"p",206),g(4,"No Asset ID"),u()())}function db(t,n){if(t&1){let e=ue();d(0,"button",207),Y("click",function(){U(e);let r=b(2);return z(r.downloadBarcode())}),g(1," Download "),u()}}function fb(t,n){if(t&1){let e=ue();d(0,"button",208),Y("click",function(){U(e);let r=b(2);return z(r.copyAssetId())}),g(1," Copy ID "),u()}}function ub(t,n){if(t&1&&(d(0,"p",214),g(1),u()),t&2){let e=b(2);x(),oe(e.asset.asset_id)}}function hb(t,n){if(t&1&&(d(0,"span",215),g(1),u()),t&2){let e=b(3);x(),xe(" ",e.asset.asset_status.description," ")}}function mb(t,n){if(t&1&&(d(0,"div",7)(1,"span",196),g(2),u(),J(3,hb,2,1,"span",174),u()),t&2){let e=b(2);x(),yt("background-color",e.asset.asset_status.color+"20")("color",e.asset.asset_status.color),x(),xe(" ",e.asset.asset_status.name," "),x(),C("ngIf",e.asset.asset_status.description)}}function pb(t,n){t&1&&(d(0,"span",90),g(1,"Not specified"),u())}function gb(t,n){if(t&1){let e=ue();d(0,"div")(1,"h4",113),g(2,"Serial Number"),u(),d(3,"div",7)(4,"span",216),g(5),u(),d(6,"button",217),Y("click",function(){U(e);let r=b(2);return z(r.copySerialNumber())}),B(),d(7,"svg",14),D(8,"path",33),u()()()()}if(t&2){let e=b(2);x(5),oe(e.asset.serial_number)}}function xb(t,n){if(t&1&&(d(0,"div",221)(1,"span",143),g(2),u(),d(3,"span",222),g(4),u()()),t&2){let e=n.$implicit;x(2),xe("",e.key,":"),x(2),oe(e.value)}}function _b(t,n){if(t&1&&(d(0,"div",218)(1,"h4",168),g(2,"Additional Specifications"),u(),d(3,"div",219),J(4,xb,5,2,"div",220),kn(5,"keyvalue"),u()()),t&2){let e=b(2);x(4),C("ngForOf",td(5,1,e.asset.specifications))}}function vb(t,n){if(t&1&&(d(0,"div",223)(1,"div",155)(2,"div",137),g(3,"Average Health Score"),u(),d(4,"div",224),g(5),u()(),d(6,"div",139)(7,"div",137),g(8,"Average Performance"),u(),d(9,"div",140),g(10),u()(),d(11,"div",172)(12,"div",137),g(13,"Total Maintenance"),u(),d(14,"div",225),g(15),u()()()),t&2){let e=b(2);x(5),xe("",e.healthPerformanceChartData.chart_data.metrics.average_health_score,"%"),x(5),xe("",e.healthPerformanceChartData.chart_data.metrics.average_performance_score,"%"),x(5),oe(e.healthPerformanceChartData.chart_data.metrics.total_maintenance_count)}}function wb(t,n){t&1&&(d(0,"div",226)(1,"div",39)(2,"div",227),B(),d(3,"svg",228),D(4,"circle",42)(5,"path",43),u()(),q(),d(6,"p",45),g(7,"Loading health & performance data..."),u()()())}function bb(t,n){if(t&1){let e=ue();d(0,"div",229)(1,"div",39)(2,"div",230),g(3),u(),d(4,"button",148),Y("click",function(){U(e);let r=b(2);return z(r.loadHealthPerformanceChart())}),g(5," Try Again "),u()()()}if(t&2){let e=b(2);x(3),oe(e.healthPerformanceChartError)}}function yb(t,n){t&1&&(d(0,"div",231),D(1,"canvas",232),u())}function Sb(t,n){t&1&&(d(0,"div",233),g(1," Green: Health Score | Blue: Performance Score | Orange: Maintenance Count "),u())}function Cb(t,n){if(t&1&&(d(0,"div",234)(1,"div",142)(2,"div",143),g(3,"Health Trend"),u(),d(4,"div",235),g(5),u()(),d(6,"div",142)(7,"div",143),g(8,"Performance Trend"),u(),d(9,"div",235),g(10),u()()()),t&2){let e=b(2);x(4),C("ngClass",e.healthPerformanceChartData.chart_data.metrics.health_trend>=0?"text-green-600":"text-red-600"),x(),Ft(" ",e.healthPerformanceChartData.chart_data.metrics.health_trend>=0?"+":"","",e.healthPerformanceChartData.chart_data.metrics.health_trend,"% "),x(4),C("ngClass",e.healthPerformanceChartData.chart_data.metrics.performance_trend>=0?"text-green-600":"text-red-600"),x(),Ft(" ",e.healthPerformanceChartData.chart_data.metrics.performance_trend>=0?"+":"","",e.healthPerformanceChartData.chart_data.metrics.performance_trend,"% ")}}function kb(t,n){t&1&&(d(0,"div",226)(1,"div",39)(2,"div",236),B(),d(3,"svg",237),D(4,"circle",42)(5,"path",43),u()(),q(),d(6,"p",45),g(7,"Loading chart data..."),u()()())}function Eb(t,n){if(t&1){let e=ue();d(0,"div",229)(1,"div",39)(2,"div",230),g(3),u(),d(4,"button",148),Y("click",function(){U(e);let r=b(2);return z(r.loadDepreciationChart())}),g(5," Try Again "),u()()()}if(t&2){let e=b(2);x(3),oe(e.depreciationChartError)}}function Tb(t,n){t&1&&(d(0,"div",231),D(1,"canvas",238),u())}function Ab(t,n){t&1&&(d(0,"div",233),g(1," Blue line: Asset Value | Red line: Accumulated Depreciation "),u())}function Mb(t,n){t&1&&(d(0,"div",239)(1,"div",39)(2,"div",236),B(),d(3,"svg",237),D(4,"circle",42)(5,"path",43),u()(),q(),d(6,"p",45),g(7,"Loading activities..."),u()()())}function Db(t,n){if(t&1){let e=ue();d(0,"div",240)(1,"div",230),g(2),u(),d(3,"button",148),Y("click",function(){U(e);let r=b(2);return z(r.loadActivityHistory())}),g(4," Try Again "),u()()}if(t&2){let e=b(2);x(2),oe(e.activityError)}}function Fb(t,n){if(t&1&&(d(0,"div",249),g(1),u()),t&2){let e=b().$implicit,i=b(3);x(),xe(" ",i.formatActivityBeforeAfter(e.before,e.after)," ")}}function Ib(t,n){if(t&1&&(d(0,"div",250)(1,"strong"),g(2,"By:"),u(),g(3),u()),t&2){let e=b().$implicit,i=b(3);x(3),xe(" ",i.getUserDisplayName(e.user)," ")}}function Pb(t,n){if(t&1&&(d(0,"div",242)(1,"div",243),B(),d(2,"svg",14),D(3,"path",56),u()(),q(),d(4,"div",244)(5,"div",245)(6,"h4",246),g(7),u(),d(8,"span",215),g(9),u()(),d(10,"p",137),g(11),u(),J(12,Fb,2,1,"div",247)(13,Ib,4,1,"div",248),u()()),t&2){let e=n.$implicit,i=b(3);x(),C("ngClass",i.getActivityColor(e.action)),x(2),Us("d",i.getActivityIcon(e.action)),x(4),oe(e.action),x(2),oe(e.time_ago),x(2),oe(e.comment||"No comment"),x(),C("ngIf",i.formatActivityBeforeAfter(e.before,e.after)),x(),C("ngIf",e.user)}}function Ob(t,n){t&1&&(d(0,"div",240),B(),d(1,"svg",251),D(2,"path",92),u(),q(),d(3,"h3",44),g(4,"No Recent Activity"),u(),d(5,"p",192),g(6,"No activity has been recorded for this asset yet."),u()())}function Lb(t,n){if(t&1&&(d(0,"div",112),J(1,Pb,14,7,"div",241)(2,Ob,7,0,"div",145),u()),t&2){let e=b(2);x(),C("ngForOf",e.activities),x(),C("ngIf",e.activities.length===0)}}function Rb(t,n){if(t&1){let e=ue();d(0,"button",253),Y("click",function(){let r=U(e).$implicit,a=b(3);return a.onRelatedFilterChange(r),z(a.showRelatedFilterDropdown=!1)}),d(1,"span",254),g(2),u()()}if(t&2){let e=n.$implicit,i=b(3);ge("text-blue-600",i.selectedRelatedFilter===e)("bg-blue-50",i.selectedRelatedFilter===e),x(2),oe(i.getRelatedFilterDisplayName(e))}}function Vb(t,n){t&1&&(d(0,"div",28),J(1,Rb,3,5,"button",252),u()),t&2&&(x(),C("ngForOf",Zr(1,Iw)))}function Nb(t,n){t&1&&(d(0,"div",239)(1,"div",39)(2,"div",236),B(),d(3,"svg",237),D(4,"circle",42)(5,"path",43),u()(),q(),d(6,"p",45),g(7,"Loading related assets..."),u()()())}function Bb(t,n){if(t&1){let e=ue();d(0,"div",240)(1,"div",230),g(2),u(),d(3,"button",148),Y("click",function(){U(e);let r=b(2);return z(r.loadRelatedAssets())}),g(4," Try Again "),u()()}if(t&2){let e=b(2);x(2),oe(e.relatedAssetsError)}}function Hb(t,n){if(t&1){let e=ue();d(0,"img",267),Y("error",function(r){U(e);let a=b(4);return z(a.onImageError(r))}),u()}if(t&2){let e=b().$implicit;C("src",e.images[0].image_url,kt)("alt",e.name)}}function Ub(t,n){t&1&&(B(),d(0,"svg",268),D(1,"path",269),u())}function zb(t,n){if(t&1&&(d(0,"span",215),g(1),u()),t&2){let e=b().$implicit;x(),xe(" Health: ",e.health_score,"% ")}}function Wb(t,n){if(t&1){let e=ue();d(0,"div",257),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.navigateToRelatedAsset(r.id))}),d(1,"div",258),J(2,Hb,1,2,"img",259)(3,Ub,2,0,"svg",260),u(),d(4,"div",261)(5,"div",245)(6,"h4",262),g(7),u(),d(8,"span",215),g(9),u()(),d(10,"div",263)(11,"span",170),g(12),u(),d(13,"span",264),g(14,"\u2022"),u(),d(15,"span",170),g(16),u()(),d(17,"div",7)(18,"span",265),g(19),u(),J(20,zb,2,1,"span",174),u()(),B(),d(21,"svg",266),D(22,"path",10),u()()}if(t&2){let e=n.$implicit,i=b(3);x(2),C("ngIf",e.images&&e.images.length>0),x(),C("ngIf",!e.images||e.images.length===0),x(4),oe(e.name),x(2),oe(e.asset_id),x(3),oe((e.category==null?null:e.category.name)||"General"),x(4),oe((e.asset_type==null?null:e.asset_type.name)||e.type),x(2),C("ngClass",i.getRelatedAssetStatusColor(e.asset_status||e.status)),x(),xe(" ",(e.asset_status==null?null:e.asset_status.name)||e.status," "),x(),C("ngIf",e.health_score)}}function jb(t,n){t&1&&(d(0,"div",240),B(),d(1,"svg",251),D(2,"path",269),u(),q(),d(3,"h3",44),g(4,"No Related Assets"),u(),d(5,"p",192),g(6,"No related assets found for this item."),u()())}function Gb(t,n){if(t&1&&(d(0,"div",255),J(1,Wb,23,9,"div",256)(2,jb,7,0,"div",145),u()),t&2){let e=b(2);x(),C("ngForOf",e.relatedAssets),x(),C("ngIf",e.relatedAssets.length===0)}}function $b(t,n){t&1&&(d(0,"div",270)(1,"div",271),B(),d(2,"svg",272),D(3,"circle",42)(4,"path",43),u()(),q(),d(5,"p",250),g(6,"Loading..."),u()())}function Yb(t,n){if(t&1&&(d(0,"div",284),g(1),u()),t&2){let e=b().$implicit;x(),xe(" ",e.notes," ")}}function Xb(t,n){if(t&1){let e=ue();d(0,"div",274)(1,"div",275)(2,"h4",276),g(3),u(),d(4,"div",277)(5,"span"),g(6),u(),d(7,"button",278),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.editMaintenanceSchedule(r))}),B(),d(8,"svg",63),D(9,"path",15),u()(),q(),d(10,"button",279),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.deleteMaintenanceSchedule(r))}),B(),d(11,"svg",63),D(12,"path",280),u()()()(),q(),d(13,"div",281)(14,"div")(15,"span",192),g(16,"Next Due:"),u(),d(17,"span",282),g(18),u()(),d(19,"div")(20,"span",192),g(21,"Frequency:"),u(),d(22,"span",282),g(23),u()()(),J(24,Yb,2,1,"div",283),u()}if(t&2){let e=n.$implicit,i=b(3);x(3),oe(e.schedule_type),x(2),Ot("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-"+i.getScheduleStatusColor(e.status)+"-100 text-"+i.getScheduleStatusColor(e.status)+"-800"),x(),xe(" ",e.status," "),x(12),oe(i.formatDate(e.next_due)),x(5),oe(e.frequency||"Not specified"),x(),C("ngIf",e.notes)}}function Kb(t,n){if(t&1&&(d(0,"div",255),J(1,Xb,25,7,"div",273),u()),t&2){let e=b(2);x(),C("ngForOf",e.maintenanceSchedules)}}function qb(t,n){if(t&1){let e=ue();d(0,"div",270),B(),d(1,"svg",285),D(2,"path",91),u(),q(),d(3,"h3",286),g(4,"No Maintenance Schedules"),u(),d(5,"p",287),g(6,"Create maintenance schedules to track asset upkeep."),u(),d(7,"button",288),Y("click",function(){U(e);let r=b(2);return z(r.addMaintenanceSchedule())}),g(8," Add First Schedule "),u()()}}function Jb(t,n){if(t&1&&(d(0,"span",215),g(1),kn(2,"date"),u()),t&2){let e=b(2);x(),xe(" (Expires: ",Qi(2,1,e.asset.warranty,"MMM d, y"),") ")}}function Qb(t,n){if(t&1){let e=ue();d(0,"div",51)(1,"div",52)(2,"div",53)(3,"div",5)(4,"div",54),B(),d(5,"svg",55),D(6,"path",56),u()(),q(),d(7,"div")(8,"h1",57),g(9),u(),d(10,"div",5),J(11,Rw,2,5,"span",58),d(12,"span",59),g(13),u(),d(14,"span",59),g(15,"\u2022"),u(),d(16,"span",59),g(17),u()()()(),d(18,"div",60)(19,"div",61)(20,"span",45),g(21,"Asset ID:"),u(),d(22,"button",62),Y("click",function(){U(e);let r=b();return z(r.copyAssetId())}),d(23,"span"),g(24),u(),B(),d(25,"svg",63),D(26,"path",33),u()()(),J(27,Vw,8,1,"div",64),u()()(),q(),d(28,"div",65)(29,"div",66)(30,"div",67)(31,"div",68),B(),d(32,"svg",69),D(33,"path",70),u(),q(),d(34,"h2",71),g(35,"Asset Images"),u()(),J(36,zw,9,7,"div",72)(37,Ww,7,0,"ng-template",null,0,nd),u(),d(39,"div",67)(40,"div",73),B(),d(41,"svg",69),D(42,"path",74),u(),q(),d(43,"h2",71),g(44,"Basic Information"),u()(),d(45,"div",65)(46,"div",75)(47,"div")(48,"h4",76),g(49,"Asset Name"),u(),d(50,"p",71),g(51),u()(),d(52,"div")(53,"h4",76),g(54,"Description"),u(),d(55,"div",77)(56,"p",78),g(57),u(),J(58,jw,2,1,"button",79),u()(),d(59,"div")(60,"h4",76),g(61,"Category"),u(),d(62,"div",12)(63,"div",80),J(64,Gw,1,2,"img",81)(65,$w,2,0,"svg",82),u(),d(66,"span",11),g(67),u()()(),d(68,"div")(69,"h4",76),g(70,"Status"),u(),J(71,Yw,3,5,"div",64)(72,Xw,2,0,"span",83),u()(),d(73,"div",75)(74,"div")(75,"h4",76),g(76,"Asset ID"),u(),d(77,"div",7)(78,"span",84),g(79),u(),d(80,"button",85),Y("click",function(){U(e);let r=b();return z(r.copyAssetId())}),B(),d(81,"svg",14),D(82,"path",33),u()()()(),q(),d(83,"div")(84,"h4",76),g(85,"Location"),u(),d(86,"div",7),B(),d(87,"svg",86),D(88,"path",87)(89,"path",88),u(),J(90,Kw,2,4,"a",89)(91,qw,2,1,"span",83),u()(),q(),d(92,"div")(93,"h4",76),g(94,"Department"),u(),d(95,"span",90),g(96),u()(),d(97,"div")(98,"h4",76),g(99,"Created"),u(),d(100,"div",7),B(),d(101,"svg",86),D(102,"path",91),u(),q(),d(103,"span",90),g(104),kn(105,"date"),u()()(),d(106,"div")(107,"h4",76),g(108,"Last Modified"),u(),d(109,"div",7),B(),d(110,"svg",86),D(111,"path",92),u(),q(),d(112,"span",90),g(113),kn(114,"date"),u()()(),J(115,Jw,5,5,"div",93),u(),d(116,"div",75)(117,"div")(118,"h4",76),g(119,"QR Code"),u(),d(120,"div",94)(121,"div",95),J(122,Qw,1,1,"img",96)(123,Zw,1,1,"img",96)(124,eb,2,0,"div",97)(125,tb,5,1,"div",98)(126,nb,5,0,"div",99),u(),d(127,"div",100),J(128,ib,2,0,"button",101)(129,rb,2,0,"button",102),u(),d(130,"div",103)(131,"p"),g(132,"Scan to access public page"),u()()()(),d(133,"div")(134,"h4",76),g(135,"Barcode"),u(),d(136,"div",94)(137,"div",104),J(138,ab,1,1,"img",105)(139,sb,1,1,"img",105)(140,ob,2,0,"div",106)(141,lb,5,1,"div",107)(142,cb,5,0,"div",108),u(),d(143,"div",100),J(144,db,2,0,"button",101)(145,fb,2,0,"button",102),u(),d(146,"div",103)(147,"p"),g(148,"Scan for asset identification"),u(),J(149,ub,2,1,"p",109),u()()()()()(),d(150,"div",67)(151,"div",68),B(),d(152,"svg",69),D(153,"path",110),u(),q(),d(154,"h2",71),g(155,"Technical Specifications"),u()(),d(156,"div",111)(157,"div",112)(158,"div")(159,"h4",113),g(160,"Asset Status"),u(),J(161,mb,4,6,"div",64)(162,pb,2,0,"span",83),u(),d(163,"div")(164,"h4",113),g(165,"Manufacturer"),u(),d(166,"span",90),g(167),u()(),d(168,"div")(169,"h4",113),g(170,"Model"),u(),d(171,"span",90),g(172),u()(),J(173,gb,9,1,"div",93),d(174,"div")(175,"h4",113),g(176,"Brand"),u(),d(177,"span",90),g(178),u()(),d(179,"div")(180,"h4",113),g(181,"Capacity"),u(),d(182,"span",90),g(183),u()()(),d(184,"div",112)(185,"div")(186,"h4",113),g(187,"Dimensions"),u(),d(188,"span",90),g(189),u()(),d(190,"div")(191,"h4",113),g(192,"Weight"),u(),d(193,"span",90),g(194),u()(),d(195,"div")(196,"h4",113),g(197,"Power Requirements"),u(),d(198,"span",90),g(199),u()(),d(200,"div")(201,"h4",113),g(202,"Operating Conditions"),u(),d(203,"span",90),g(204),u()()()(),J(205,_b,6,3,"div",114),u(),d(206,"div",67)(207,"div",115)(208,"div",7)(209,"div",116),B(),d(210,"svg",117),D(211,"path",118),u()(),q(),d(212,"h2",71),g(213,"Health & Performance"),u()(),d(214,"div",7)(215,"button",119),Y("click",function(){U(e);let r=b();return z(r.refreshHealthPerformanceChart())}),B(),d(216,"svg",14),D(217,"path",120),u(),q(),d(218,"span"),g(219,"Refresh"),u()(),d(220,"button",121),Y("click",function(){U(e);let r=b();return z(r.forceCreateHealthPerformanceChart())}),B(),d(221,"svg",14),D(222,"path",122),u(),q(),d(223,"span"),g(224,"Debug"),u()()()(),J(225,vb,16,3,"div",123),d(226,"div",112)(227,"div",39)(228,"h3",124),g(229,"Health & Performance Timeline (Last 12 Months)"),u()(),J(230,wb,8,0,"div",125)(231,bb,6,1,"div",126)(232,yb,2,0,"div",127)(233,Sb,2,0,"div",128)(234,Cb,11,6,"div",129),u()(),d(235,"div",67)(236,"div",130)(237,"div",7)(238,"div",131),B(),d(239,"svg",132),D(240,"path",133),u()(),q(),d(241,"h2",71),g(242,"Asset Depreciation"),u()(),d(243,"div",7)(244,"button",134),Y("click",function(){U(e);let r=b();return z(r.refreshDepreciationChart())}),B(),d(245,"svg",14),D(246,"path",120),u(),q(),d(247,"span"),g(248,"Refresh"),u()(),d(249,"button",121),Y("click",function(){U(e);let r=b();return z(r.forceCreateChart())}),B(),d(250,"svg",14),D(251,"path",122),u(),q(),d(252,"span"),g(253,"Debug"),u()()()(),d(254,"div",135)(255,"div",136)(256,"div",137),g(257,"Original Value"),u(),d(258,"div",138),g(259),u()(),d(260,"div",139)(261,"div",137),g(262,"Current Value"),u(),d(263,"div",140),g(264),u()()(),d(265,"div",112)(266,"div",39)(267,"h3",124),g(268,"Depreciation Timeline (straight-line method)"),u()(),J(269,kb,8,0,"div",125)(270,Eb,6,1,"div",126)(271,Tb,2,0,"div",127)(272,Ab,2,0,"div",128),d(273,"div",141)(274,"div",142)(275,"div",143),g(276,"Annual Depreciation"),u(),d(277,"div",71),g(278),u()(),d(279,"div",142)(280,"div",143),g(281,"Depreciation Rate"),u(),d(282,"div",71),g(283),u()(),d(284,"div",142)(285,"div",143),g(286,"Years Remaining"),u(),d(287,"div",71),g(288),u()()()()()(),d(289,"div",75)(290,"div",67)(291,"div",68),B(),d(292,"svg",69),D(293,"path",92),u(),q(),d(294,"h2",71),g(295,"Recent Activity"),u()(),J(296,Mb,8,0,"div",144)(297,Db,5,1,"div",145)(298,Lb,3,2,"div",146),d(299,"div",147)(300,"button",148),Y("click",function(){U(e);let r=b();return z(r.showFullActivityHistory())}),g(301," View Full Activity History "),u()()(),d(302,"div",67)(303,"div",130)(304,"div",7),B(),d(305,"svg",69),D(306,"path",149),u(),q(),d(307,"h2",71),g(308,"Related Assets"),u()(),d(309,"div",77)(310,"button",150),Y("click",function(){U(e);let r=b();return z(r.showRelatedFilterDropdown=!r.showRelatedFilterDropdown)}),d(311,"span"),g(312),u(),B(),d(313,"svg",14),D(314,"path",151),u()(),J(315,Vb,2,2,"div",22),u()(),J(316,Nb,8,0,"div",144)(317,Bb,5,1,"div",145)(318,Gb,3,2,"div",152),u(),q(),d(319,"div",67)(320,"div",130)(321,"div",7),B(),d(322,"svg",69),D(323,"path",91),u(),q(),d(324,"h2",71),g(325,"Maintenance Schedule"),u()(),d(326,"button",121),Y("click",function(){U(e);let r=b();return z(r.addMaintenanceSchedule())}),B(),d(327,"svg",14),D(328,"path",153),u(),q(),d(329,"span"),g(330,"Add"),u()()(),d(331,"div",154)(332,"div",155)(333,"div",7),B(),d(334,"svg",156),D(335,"path",122),u(),q(),d(336,"div")(337,"div",157),g(338,"Last Maintenance"),u(),d(339,"div",158),g(340),u()()()(),d(341,"div",139)(342,"div",7),B(),d(343,"svg",159),D(344,"path",92),u(),q(),d(345,"div")(346,"div",160),g(347,"Next Due"),u(),d(348,"div",161),g(349),u()()()(),d(350,"div",162)(351,"div",7),B(),d(352,"svg",163),D(353,"path",120),u(),q(),d(354,"div")(355,"div",164),g(356,"Frequency"),u(),d(357,"div",165),g(358),u()()()()(),J(359,$b,7,0,"div",166)(360,Kb,2,1,"div",152)(361,qb,9,0,"div",166),u(),d(362,"div",67)(363,"div",68),B(),d(364,"svg",69),D(365,"path",167),u(),q(),d(366,"h2",71),g(367,"Financial Information"),u()(),d(368,"div",112)(369,"div",136)(370,"h4",168),g(371,"Purchase Details"),u(),d(372,"div",169)(373,"div")(374,"span",170),g(375,"Purchase Price"),u(),d(376,"div",71),g(377),kn(378,"currency"),u()(),d(379,"div")(380,"span",170),g(381,"Purchase Date"),u(),d(382,"div",171),g(383),kn(384,"date"),u()()()(),d(385,"div",139)(386,"h4",168),g(387,"Current Value"),u(),d(388,"div",169)(389,"div")(390,"span",170),g(391,"Book Value"),u(),d(392,"div",71),g(393),kn(394,"currency"),u()(),d(395,"div")(396,"span",170),g(397,"Market Value"),u(),d(398,"div",171),g(399),kn(400,"currency"),u()()()(),d(401,"div",172)(402,"h4",168),g(403,"Depreciation"),u(),d(404,"div",169)(405,"div")(406,"span",170),g(407,"Method"),u(),d(408,"div",171),g(409),u()(),d(410,"div")(411,"span",170),g(412,"Useful Life"),u(),d(413,"div",171),g(414),u()(),d(415,"div")(416,"span",170),g(417,"Annual Rate"),u(),d(418,"div",171),g(419),u()()()(),d(420,"div",155)(421,"h4",168),g(422,"Performance"),u(),d(423,"div",169)(424,"div")(425,"span",170),g(426,"Total Cost of Ownership"),u(),d(427,"div",71),g(428),kn(429,"currency"),u()(),d(430,"div")(431,"span",170),g(432,"ROI"),u(),d(433,"div",171),g(434),u()()()(),d(435,"div",162)(436,"h4",168),g(437,"Warranty & Insurance"),u(),d(438,"div",169)(439,"div")(440,"span",170),g(441,"Warranty Status"),u(),d(442,"div",173)(443,"span"),g(444),u(),J(445,Jb,3,4,"span",174),u()(),d(446,"div")(447,"span",170),g(448,"Insurance Value"),u(),d(449,"div",171),g(450),u()()()()()()()()()}if(t&2){let e=zs(38),i=b();x(6),Us("d",i.getAssetTypeIcon()),x(3),oe(i.asset.name),x(2),C("ngIf",i.asset.asset_status),x(2),oe(i.getAssetTypeName(i.asset.type)),x(4),oe((i.asset.category==null?null:i.asset.category.name)||"General"),x(7),oe(i.asset.asset_id||i.asset.id),x(3),C("ngIf",i.asset.serial_number),x(9),C("ngIf",i.asset.images&&i.asset.images.length>0)("ngIfElse",e),x(15),oe((i.asset==null?null:i.asset.name)||"Unnamed Asset"),x(5),ge("line-clamp-3",!i.descriptionExpanded),x(),xe(" ",(i.asset==null?null:i.asset.description)||"No description available"," "),x(),C("ngIf",(i.asset==null?null:i.asset.description)&&i.asset.description.length>150),x(6),C("ngIf",(i.asset==null||i.asset.category==null?null:i.asset.category.icon)&&!i.asset.category.iconError),x(),C("ngIf",!(!(i.asset==null||i.asset.category==null)&&i.asset.category.icon)||i.asset.category.iconError),x(2),oe((i.asset==null||i.asset.category==null?null:i.asset.category.name)||"Uncategorized"),x(4),C("ngIf",i.asset.asset_status),x(),C("ngIf",!i.asset.asset_status),x(7),oe((i.asset==null?null:i.asset.asset_id)||"N/A"),x(11),C("ngIf",i.asset==null||i.asset.location==null?null:i.asset.location.id),x(),C("ngIf",!(!(i.asset==null||i.asset.location==null)&&i.asset.location.id)),x(5),oe((i.asset==null||i.asset.department==null?null:i.asset.department.name)||"Not assigned"),x(8),oe(Qi(105,100,i.asset==null?null:i.asset.created_at,"MMM d, y")),x(9),oe(Qi(114,103,i.asset==null?null:i.asset.updated_at,"MMM d, y")),x(2),C("ngIf",i.asset==null?null:i.asset.parent),x(7),C("ngIf",i.qrCodeDataUrl),x(),C("ngIf",!i.qrCodeDataUrl&&(i.asset==null?null:i.asset.qr_code_url)),x(),C("ngIf",i.qrCodeLoading),x(),C("ngIf",!i.qrCodeDataUrl&&!(i.asset!=null&&i.asset.qr_code_url)&&!i.qrCodeLoading&&(i.asset==null?null:i.asset.id)),x(),C("ngIf",!i.qrCodeDataUrl&&!(i.asset!=null&&i.asset.qr_code_url)&&!i.qrCodeLoading&&!(i.asset!=null&&i.asset.id)),x(2),C("ngIf",i.asset==null?null:i.asset.id),x(),C("ngIf",i.asset==null?null:i.asset.id),x(9),C("ngIf",i.asset==null?null:i.asset.barcode_url),x(),C("ngIf",!(i.asset!=null&&i.asset.barcode_url)&&i.barcodeDataUrl),x(),C("ngIf",i.barcodeLoading),x(),C("ngIf",!(i.asset!=null&&i.asset.barcode_url)&&!i.barcodeDataUrl&&!i.barcodeLoading&&(i.asset==null?null:i.asset.asset_id)),x(),C("ngIf",!(i.asset!=null&&i.asset.barcode_url)&&!i.barcodeDataUrl&&!i.barcodeLoading&&!(i.asset!=null&&i.asset.asset_id)),x(2),C("ngIf",i.asset==null?null:i.asset.asset_id),x(),C("ngIf",i.asset==null?null:i.asset.asset_id),x(4),C("ngIf",i.asset==null?null:i.asset.asset_id),x(12),C("ngIf",i.asset.asset_status),x(),C("ngIf",!i.asset.asset_status),x(5),oe(i.asset.manufacturer||"Not specified"),x(5),oe(i.asset.model||"Not specified"),x(),C("ngIf",i.asset.serial_number),x(5),oe(i.asset.brand||"Not specified"),x(5),oe(i.asset.capacity||"Not specified"),x(6),oe(i.asset.dimensions||"Not specified"),x(5),oe(i.asset.weight||"Not specified"),x(5),oe(i.asset.power_requirements||"Not specified"),x(5),oe(i.asset.operating_conditions||"Standard conditions"),x(),C("ngIf",i.asset.specifications),x(20),C("ngIf",i.healthPerformanceChartData==null||i.healthPerformanceChartData.chart_data==null?null:i.healthPerformanceChartData.chart_data.metrics),x(5),C("ngIf",i.healthPerformanceChartLoading),x(),C("ngIf",i.healthPerformanceChartError&&!i.healthPerformanceChartLoading),x(),C("ngIf",!i.healthPerformanceChartLoading&&!i.healthPerformanceChartError),x(),C("ngIf",!i.healthPerformanceChartLoading&&!i.healthPerformanceChartError),x(),C("ngIf",i.healthPerformanceChartData==null||i.healthPerformanceChartData.chart_data==null?null:i.healthPerformanceChartData.chart_data.metrics),x(25),xe("$",i.formatCurrency((i.asset==null?null:i.asset.purchase_price)||0),""),x(5),xe("$",i.formatCurrency(i.calculateCurrentValue()),""),x(5),C("ngIf",i.depreciationChartLoading),x(),C("ngIf",i.depreciationChartError&&!i.depreciationChartLoading),x(),C("ngIf",!i.depreciationChartLoading&&!i.depreciationChartError),x(),C("ngIf",!i.depreciationChartLoading&&!i.depreciationChartError),x(6),xe("$",i.formatCurrency(i.calculateAnnualDepreciation()),""),x(5),xe("",i.calculateDepreciationRate(),"%"),x(5),oe(i.calculateRemainingYears()),x(8),C("ngIf",i.activityLoading),x(),C("ngIf",i.activityError&&!i.activityLoading),x(),C("ngIf",!i.activityLoading&&!i.activityError),x(14),oe(i.getRelatedFilterDisplayName(i.selectedRelatedFilter)),x(3),C("ngIf",i.showRelatedFilterDropdown),x(),C("ngIf",i.relatedAssetsLoading),x(),C("ngIf",i.relatedAssetsError&&!i.relatedAssetsLoading),x(),C("ngIf",!i.relatedAssetsLoading&&!i.relatedAssetsError),x(22),oe(i.mockMaintenanceData.lastMaintenance||"Not recorded"),x(9),oe(i.mockMaintenanceData.nextMaintenance||"Not scheduled"),x(9),oe(i.mockMaintenanceData.interval),x(),C("ngIf",i.maintenanceLoading),x(),C("ngIf",!i.maintenanceLoading&&i.maintenanceSchedules.length>0),x(),C("ngIf",!i.maintenanceLoading&&i.maintenanceSchedules.length===0),x(16),xe(" ",Zi(378,106,i.mockFinancialData.purchaseCost,"USD","symbol","1.2-2")," "),x(6),oe(Qi(384,111,i.asset.purchase_date,"MMM d, y")),x(10),xe(" ",Zi(394,114,i.mockFinancialData.currentValue,"USD","symbol","1.2-2")," "),x(6),oe(Zi(400,119,i.mockFinancialData.currentValue*.95,"USD","symbol","1.2-2")),x(10),oe(i.mockFinancialData.depreciationMethod),x(5),xe("",i.mockFinancialData.usefulLife," years"),x(5),xe("",i.calculateDepreciationRate(),"%"),x(9),xe(" ",Zi(429,124,i.calculateTotalCostOfOwnership(),"USD","symbol","1.2-2")," "),x(5),ge("text-green-600",i.calculateROI()>0)("text-red-600",i.calculateROI()<0),x(),xe(" ",i.calculateROI(),"% "),x(9),Ot(i.getWarrantyStatusClass(i.asset.warranty)),x(),xe(" ",i.getWarrantyStatus(i.asset.warranty)," "),x(),C("ngIf",i.asset.warranty),x(5),oe(i.asset.insurance_value||"Not specified")}}function Zb(t,n){if(t&1){let e=ue();d(0,"div",289)(1,"div",290)(2,"div",130)(3,"h3",71),g(4,"Add Maintenance Schedule"),u(),d(5,"button",291),Y("click",function(){U(e);let r=b();return z(r.closeMaintenanceModals())}),B(),d(6,"svg",292),D(7,"path",293),u()()(),q(),d(8,"form",294),Y("ngSubmit",function(){U(e);let r=b();return z(r.saveMaintenanceSchedule())}),d(9,"div",112)(10,"div")(11,"label",295),g(12,"Schedule Type"),u(),d(13,"select",296)(14,"option",297),g(15,"Select type"),u(),d(16,"option",298),g(17,"Preventive Maintenance"),u(),d(18,"option",299),g(19,"Inspection"),u(),d(20,"option",300),g(21,"Calibration"),u(),d(22,"option",301),g(23,"Cleaning"),u()()(),d(24,"div")(25,"label",295),g(26,"Next Due Date"),u(),D(27,"input",302,1),u(),d(29,"div")(30,"label",295),g(31,"Last Done Date"),u(),D(32,"input",303,1),u(),d(34,"div")(35,"label",295),g(36,"Frequency"),u(),d(37,"select",304)(38,"option",297),g(39,"Select frequency"),u(),d(40,"option",305),g(41,"Weekly"),u(),d(42,"option",306),g(43,"Monthly"),u(),d(44,"option",307),g(45,"Quarterly"),u(),d(46,"option",308),g(47,"Semi-Annual"),u(),d(48,"option",309),g(49,"Annual"),u()()(),d(50,"div")(51,"label",295),g(52,"Notes"),u(),D(53,"textarea",310),u()(),d(54,"div",311)(55,"button",312),Y("click",function(){U(e);let r=b();return z(r.closeMaintenanceModals())}),g(56," Cancel "),u(),d(57,"button",313),g(58," Save Schedule "),u()()()()()}if(t&2){let e=b();x(8),C("formGroup",e.maintenanceForm),x(49),C("disabled",e.maintenanceForm.invalid)}}function ey(t,n){if(t&1){let e=ue();d(0,"div",289)(1,"div",290)(2,"div",130)(3,"h3",71),g(4,"Edit Maintenance Schedule"),u(),d(5,"button",291),Y("click",function(){U(e);let r=b();return z(r.closeMaintenanceModals())}),B(),d(6,"svg",292),D(7,"path",293),u()()(),q(),d(8,"form",294),Y("ngSubmit",function(){U(e);let r=b();return z(r.saveMaintenanceSchedule())}),d(9,"div",112)(10,"div")(11,"label",295),g(12,"Schedule Type"),u(),d(13,"select",296)(14,"option",297),g(15,"Select type"),u(),d(16,"option",298),g(17,"Preventive Maintenance"),u(),d(18,"option",299),g(19,"Inspection"),u(),d(20,"option",300),g(21,"Calibration"),u(),d(22,"option",301),g(23,"Cleaning"),u()()(),d(24,"div")(25,"label",295),g(26,"Next Due Date"),u(),D(27,"input",302,1),u(),d(29,"div")(30,"label",295),g(31,"Last Done Date"),u(),D(32,"input",303,1),u(),d(34,"div")(35,"label",295),g(36,"Frequency"),u(),d(37,"select",304)(38,"option",297),g(39,"Select frequency"),u(),d(40,"option",305),g(41,"Weekly"),u(),d(42,"option",306),g(43,"Monthly"),u(),d(44,"option",307),g(45,"Quarterly"),u(),d(46,"option",308),g(47,"Semi-Annual"),u(),d(48,"option",309),g(49,"Annual"),u()()(),d(50,"div")(51,"label",295),g(52,"Status"),u(),d(53,"select",314)(54,"option",315),g(55,"Scheduled"),u(),d(56,"option",316),g(57,"In Progress"),u(),d(58,"option",317),g(59,"Completed"),u(),d(60,"option",318),g(61,"Overdue"),u()()(),d(62,"div")(63,"label",295),g(64,"Notes"),u(),D(65,"textarea",310),u()(),d(66,"div",311)(67,"button",312),Y("click",function(){U(e);let r=b();return z(r.closeMaintenanceModals())}),g(68," Cancel "),u(),d(69,"button",313),g(70," Update Schedule "),u()()()()()}if(t&2){let e=b();x(8),C("formGroup",e.maintenanceForm),x(61),C("disabled",e.maintenanceForm.invalid)}}function ty(t,n){t&1&&(d(0,"div",347)(1,"div",39)(2,"div",348),B(),d(3,"svg",349),D(4,"circle",42)(5,"path",43),u()(),q(),d(6,"p",59),g(7,"Loading activity history..."),u()()())}function ny(t,n){if(t&1){let e=ue();d(0,"div",350)(1,"div",351),g(2),u(),d(3,"button",50),Y("click",function(){U(e);let r=b(2);return z(r.loadFullActivityHistory())}),g(4," Try Again "),u()()}if(t&2){let e=b(2);x(2),oe(e.activityHistoryError)}}function iy(t,n){if(t&1&&(d(0,"div",361)(1,"div",362),g(2,"Changes:"),u(),d(3,"div",192),g(4),u()()),t&2){let e=b().$implicit,i=b(3);x(4),xe(" ",i.formatActivityBeforeAfter(e.before,e.after)," ")}}function ry(t,n){if(t&1&&(d(0,"div",363)(1,"strong"),g(2,"By:"),u(),g(3),u()),t&2){let e=b().$implicit,i=b(3);x(3),xe(" ",i.getUserDisplayName(e.user)," ")}}function ay(t,n){if(t&1&&(d(0,"div",354)(1,"div",355),B(),d(2,"svg",18),D(3,"path",56),u()(),q(),d(4,"div",244)(5,"div",275)(6,"h4",356),g(7),u(),d(8,"span",357),g(9),u()(),d(10,"p",358),g(11),u(),J(12,iy,5,1,"div",359)(13,ry,4,1,"div",360),u()()),t&2){let e=n.$implicit,i=b(3);x(),C("ngClass",i.getActivityColor(e.action)),x(2),Us("d",i.getActivityIcon(e.action)),x(4),oe(e.action),x(2),oe(e.time_ago),x(2),oe(e.comment||"No comment"),x(),C("ngIf",i.formatActivityBeforeAfter(e.before,e.after)),x(),C("ngIf",e.user)}}function sy(t,n){t&1&&(d(0,"div",350),B(),d(1,"svg",191),D(2,"path",92),u(),q(),d(3,"h3",44),g(4,"No Activity Found"),u(),d(5,"p",192),g(6,"No activity matches your current filters."),u()())}function oy(t,n){if(t&1&&(d(0,"div",352),J(1,ay,14,7,"div",353)(2,sy,7,0,"div",342),u()),t&2){let e=b(2);x(),C("ngForOf",e.fullActivityHistory),x(),C("ngIf",e.fullActivityHistory.length===0)}}function ly(t,n){if(t&1){let e=ue();d(0,"button",367),Y("click",function(){U(e);let r=b(3);return z(r.onActivityHistoryPageChange(r.activityHistoryPagination.current_page-1))}),g(1," Previous "),u()}}function cy(t,n){if(t&1){let e=ue();d(0,"button",367),Y("click",function(){U(e);let r=b(3);return z(r.onActivityHistoryPageChange(r.activityHistoryPagination.current_page+1))}),g(1," Next "),u()}}function dy(t,n){if(t&1&&(d(0,"div",364)(1,"div",143),g(2),u(),d(3,"div",365),J(4,ly,2,0,"button",366)(5,cy,2,0,"button",366),u()()),t&2){let e=b(2);x(2),ed(" Showing ",e.activityHistoryPagination.from||0," to ",e.activityHistoryPagination.to||0," of ",e.activityHistoryPagination.total||0," activities "),x(2),C("ngIf",e.activityHistoryPagination.prev_page_url),x(),C("ngIf",e.activityHistoryPagination.next_page_url)}}function fy(t,n){if(t&1){let e=ue();d(0,"div",319)(1,"div",320)(2,"div",321)(3,"div",12),B(),d(4,"svg",322),D(5,"path",92),u(),q(),d(6,"h3",323),g(7,"Full Activity History"),u()(),d(8,"button",291),Y("click",function(){U(e);let r=b();return z(r.closeActivityHistoryModal())}),B(),d(9,"svg",292),D(10,"path",293),u()()(),q(),d(11,"div",324)(12,"div",325)(13,"div",326)(14,"div",244)(15,"input",327),Y("input",function(r){U(e);let a=b();return z(a.onActivityHistorySearch(r.target.value))}),u()(),d(16,"button",328),Y("click",function(){U(e);let r=b();return z(r.clearActivityHistoryFilters())}),g(17," Clear Filters "),u()(),d(18,"div",329)(19,"div")(20,"label",330),g(21,"Action Type"),u(),d(22,"select",331),Y("change",function(r){U(e);let a=b();return z(a.onActivityHistoryFilter("action",r.target.value))}),d(23,"option",297),g(24,"All Actions"),u(),d(25,"option",332),g(26,"Created"),u(),d(27,"option",333),g(28,"Updated"),u(),d(29,"option",334),g(30,"Deleted"),u(),d(31,"option",335),g(32,"Transferred"),u(),d(33,"option",336),g(34,"Maintenance"),u(),d(35,"option",337),g(36,"Imported"),u()()(),d(37,"div")(38,"label",330),g(39,"Date From"),u(),d(40,"input",338),Y("change",function(r){U(e);let a=b();return z(a.onActivityHistoryFilter("date_from",r.target.value))}),u()(),d(41,"div")(42,"label",330),g(43,"Date To"),u(),d(44,"input",338),Y("change",function(r){U(e);let a=b();return z(a.onActivityHistoryFilter("date_to",r.target.value))}),u()(),d(45,"div")(46,"label",330),g(47,"Sort By"),u(),d(48,"select",331),Y("change",function(r){U(e);let a=b();return z(a.onActivityHistorySort("created_at",r.target.value))}),d(49,"option",339),g(50,"Newest First"),u(),d(51,"option",340),g(52,"Oldest First"),u()()()()(),J(53,ty,8,0,"div",341)(54,ny,5,1,"div",342)(55,oy,3,2,"div",343)(56,dy,6,5,"div",344),u(),d(57,"div",345)(58,"div",143),g(59),u(),d(60,"button",346),Y("click",function(){U(e);let r=b();return z(r.closeActivityHistoryModal())}),g(61," Close "),u()()()()}if(t&2){let e=b();x(53),C("ngIf",e.activityHistoryLoading),x(),C("ngIf",e.activityHistoryError&&!e.activityHistoryLoading),x(),C("ngIf",!e.activityHistoryLoading&&!e.activityHistoryError),x(),C("ngIf",e.activityHistoryPagination&&e.fullActivityHistory.length>0),x(3),xe(" Total Activities: ",(e.activityHistoryPagination==null?null:e.activityHistoryPagination.total)||e.fullActivityHistory.length," ")}}ds.register(...Ou);var ba=class t{constructor(n,e,i,r,a,s,o){this.route=n;this.router=e;this.assetService=i;this.angularLocation=r;this.pdfExportService=a;this.fb=s;this.cdr=o;this.maintenanceForm=this.fb.group({schedule_type:["",ai.required],next_due:[""],last_done:[""],frequency:[""],notes:[""],status:["Scheduled"]}),this.activities=[],this.fullActivityHistory=[]}destroy$=new Jr;dateInputs;asset=null;loading=!0;error="";currentImageIndex=0;selectedImageUrl=null;descriptionExpanded=!1;showActionsDropdown=!1;showTransferModal=!1;showActivityHistoryModal=!1;maintenanceSchedules=[];maintenanceLoading=!1;showAddMaintenanceModal=!1;showEditMaintenanceModal=!1;selectedSchedule=null;maintenanceForm;flatpickrInstances=[];healthMetrics={lastUpdated:new Date,performanceTrend:[{month:"Jan",value:82},{month:"Feb",value:84},{month:"Mar",value:88},{month:"Apr",value:85}]};mockFinancialData={purchaseCost:0,currentValue:0,depreciationMethod:"Straight Line",usefulLife:10,originalValue:0};mockMaintenanceData={status:"Current",lastMaintenance:null,nextMaintenance:null,interval:"Every 6 months"};activities=[];fullActivityHistory=[];activityLoading=!1;activityHistoryLoading=!1;activityError="";activityHistoryError="";activityHistoryParams={page:1,per_page:15,sort_by:"created_at",sort_dir:"desc",search:"",action:"",user_id:"",date_from:"",date_to:""};activityHistoryPagination=null;qrCodeDataUrl=null;qrCodeLoading=!1;barcodeDataUrl=null;barcodeLoading=!1;relatedAssets=[];relatedAssetsLoading=!1;relatedAssetsError="";selectedRelatedFilter="all";showRelatedFilterDropdown=!1;relatedAssetsParams={type:"all",limit:10};depreciationChart=null;depreciationChartLoading=!1;depreciationChartError="";depreciationChartData=null;healthPerformanceChart=null;healthPerformanceChartLoading=!1;healthPerformanceChartError="";healthPerformanceChartData=null;ngOnInit(){this.route.params.pipe(rt(this.destroy$)).subscribe(n=>{let e=n.id;e&&this.loadAsset(e)})}ngAfterViewInit(){this.initializeDatePickers(),setTimeout(()=>{this.asset&&!this.depreciationChart&&this.createDepreciationChart()},500)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.flatpickrInstances.forEach(n=>{n&&n.destroy()}),this.depreciationChart&&this.depreciationChart.destroy(),this.healthPerformanceChart&&this.healthPerformanceChart.destroy()}loadAsset(n){this.loading=!0,this.error="",this.assetService.getAsset(n).pipe(rt(this.destroy$)).subscribe({next:e=>{e.success?(this.asset=e.data.asset||e.data,this.updateMockData(),this.loadMaintenanceSchedules(),this.loadActivityHistory(),this.generateQRCode(),!this.asset.barcode_url&&this.asset.asset_id&&this.generateBarcode(),this.loadRelatedAssets(),this.loadDepreciationChart(),this.loadHealthPerformanceChart()):this.error=e.message||"Failed to load asset",this.loading=!1},error:e=>{this.error=e.error?.message||"An error occurred while loading the asset",this.loading=!1}})}loadMaintenanceSchedules(){this.asset&&(this.maintenanceLoading=!0,this.assetService.listMaintenanceSchedules(this.asset.id).pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&(this.maintenanceSchedules=n.data||[]),this.maintenanceLoading=!1},error:n=>{console.error("Error loading maintenance schedules:",n),this.maintenanceLoading=!1}}))}updateMockData(){this.asset&&(this.mockFinancialData={purchaseCost:this.asset.purchase_price||0,currentValue:this.asset.current_value||this.asset.purchase_price||0,depreciationMethod:"Straight Line",usefulLife:this.asset.depreciation||10,originalValue:this.asset.purchase_price||0},this.healthMetrics.lastUpdated=new Date,this.mockMaintenanceData={status:this.asset.status||"Active",lastMaintenance:this.asset.last_maintenance_date||null,nextMaintenance:this.asset.next_maintenance_date||null,interval:this.asset.maintenance_interval||"Every 6 months"},this.asset.images&&this.asset.images.length>0&&(this.selectedImageUrl=this.asset.images[0].image_url,this.currentImageIndex=0))}goBack(){this.angularLocation.back()}editAsset(){this.asset&&this.router.navigate(["/assets",this.asset.id,"edit"])}exportAsset(){this.asset&&this.pdfExportService.exportSingleAssetToPdf(this.asset)}printAsset(){let n=window.open("","_blank");if(!n){alert("Please allow popups to print this asset");return}let e=this.generatePrintContent();n.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Asset Details - ${this.asset?.name||"Asset"}</title>
          <style>
            @media print {
              body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
              .no-print { display: none !important; }
              .print-only { display: block !important; }
              .page-break { page-break-before: always; }
              .avoid-break { page-break-inside: avoid; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f8f9fa; font-weight: bold; }
              .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
              .section { margin-bottom: 25px; }
              .section-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #333; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
              .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
              .info-item { margin-bottom: 15px; }
              .info-label { font-weight: bold; color: #666; font-size: 14px; }
              .info-value { font-size: 16px; margin-top: 5px; }
              .status-badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
              .qr-section { text-align: center; margin: 20px 0; }
              .qr-code { max-width: 200px; margin: 0 auto; }
              .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; border-top: 1px solid #ddd; padding-top: 20px; }
              @page { margin: 1in; }
            }
            @media screen {
              body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
              .no-print { display: none; }
              .print-only { display: block; }
              .page-break { border-top: 2px solid #333; margin-top: 30px; padding-top: 30px; }
              .avoid-break { }
              table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f8f9fa; font-weight: bold; }
              .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
              .section { margin-bottom: 25px; }
              .section-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #333; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
              .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
              .info-item { margin-bottom: 15px; }
              .info-label { font-weight: bold; color: #666; font-size: 14px; }
              .info-value { font-size: 16px; margin-top: 5px; }
              .status-badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
              .qr-section { text-align: center; margin: 20px 0; }
              .qr-code { max-width: 200px; margin: 0 auto; }
              .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; border-top: 1px solid #ddd; padding-top: 20px; }
            }
          </style>
        </head>
        <body>
          ${e}
        </body>
      </html>
    `),n.document.close(),n.onload=()=>{n.print(),n.close()}}generatePrintContent(){if(!this.asset)return"<p>Asset not found</p>";let n=this.asset,e=new Date().toLocaleDateString();return`
      <div class="header">
        <h1>Asset Details Report</h1>
        <p>Generated on: ${e}</p>
      </div>

      <div class="section">
        <div class="section-title">Asset Overview</div>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">Asset Name</div>
            <div class="info-value">${n.name||"N/A"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Asset ID</div>
            <div class="info-value">${n.asset_id||n.id||"N/A"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Category</div>
            <div class="info-value">${n.category?.name||"General"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Status</div>
            <div class="info-value">
              <span class="status-badge" style="background-color: ${n.asset_status?.color||"#6B7280"}20; color: ${n.asset_status?.color||"#6B7280"}">
                ${n.asset_status?.name||"Not specified"}
              </span>
            </div>
          </div>
          <div class="info-item">
            <div class="info-label">Type</div>
            <div class="info-value">${this.getAssetTypeName(n.type)}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Location</div>
            <div class="info-value">${n.location?.name||"No location assigned"}</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Description</div>
        <p>${n.description||"No description available"}</p>
      </div>

      <div class="section">
        <div class="section-title">Technical Specifications</div>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">Manufacturer</div>
            <div class="info-value">${n.manufacturer||"Not specified"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Model</div>
            <div class="info-value">${n.model||"Not specified"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Serial Number</div>
            <div class="info-value">${n.serial_number||"Not specified"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Brand</div>
            <div class="info-value">${n.brand||"Not specified"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Dimensions</div>
            <div class="info-value">${n.dimensions||"Not specified"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Weight</div>
            <div class="info-value">${n.weight||"Not specified"}</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Financial Information</div>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">Purchase Price</div>
            <div class="info-value">$${this.formatCurrency(n.purchase_price||0)}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Current Value</div>
            <div class="info-value">$${this.formatCurrency(this.calculateCurrentValue())}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Purchase Date</div>
            <div class="info-value">${n.purchase_date?new Date(n.purchase_date).toLocaleDateString():"Not specified"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Warranty Status</div>
            <div class="info-value">${this.getWarrantyStatus(n.warranty)}</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Performance Metrics</div>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">Health Score</div>
            <div class="info-value">${n.health_score||0}%</div>
          </div>
          <div class="info-item">
            <div class="info-label">Utilization Rate</div>
            <div class="info-value">${this.getUtilizationRate()}%</div>
          </div>
          <div class="info-item">
            <div class="info-label">Asset Age</div>
            <div class="info-value">${this.getAssetAge()}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Total Cost of Ownership</div>
            <div class="info-value">$${this.formatCurrency(this.calculateTotalCostOfOwnership())}</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Timeline Information</div>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">Created Date</div>
            <div class="info-value">${n.created_at?new Date(n.created_at).toLocaleDateString():"Not specified"}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Last Modified</div>
            <div class="info-value">${n.updated_at?new Date(n.updated_at).toLocaleDateString():"Not specified"}</div>
          </div>
        </div>
      </div>

      <div class="qr-section">
        <div class="section-title">Asset Identification</div>
        <div class="qr-code">
          ${this.qrCodeDataUrl?`<img src="${this.qrCodeDataUrl}" alt="QR Code" style="max-width: 100%; height: auto;">`:"<p>QR Code not available</p>"}
        </div>
        <p><strong>Asset ID:</strong> ${n.asset_id||n.id||"N/A"}</p>
      </div>

      <div class="footer">
        <p>AssetGo - Asset Management System</p>
        <p>This report was generated automatically on ${e}</p>
      </div>
    `}getStatusColor(n){return{Active:"green",Maintenance:"orange",Inactive:"gray",Retired:"red"}[n]||"gray"}getAssetStatusColor(n){return!n||!n.color?"#6B7280":n.color}getAssetStatusBackgroundColor(n){return!n||!n.color?"#F3F4F6":n.color+"20"}getAssetTypeIcon(){if(!this.asset?.type)return"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4";let n={fixed:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4","semi-fixed":"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4a2 2 0 001-1.73z",mobile:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z",fleet:"M3 13l2-5a2 2 0 012-2h10a2 2 0 012 2l2 5M5 13v6a2 2 0 002 2h10a2 2 0 002-2v-6M5 13h14"};return n[this.asset.type]||n.fixed}generateSmartDescription(){console.log("Generate smart description")}analyzeAssetImage(){console.log("Analyze asset image")}addMaintenanceSchedule(){this.showAddMaintenanceModal=!0,this.maintenanceForm.reset({schedule_type:"",next_due:"",last_done:"",frequency:"",notes:"",status:"Scheduled"}),setTimeout(()=>{this.initializeDatePickers()},100)}editMaintenanceSchedule(n){this.selectedSchedule=n,this.showEditMaintenanceModal=!0,this.maintenanceForm.patchValue({schedule_type:n.schedule_type,next_due:n.next_due,last_done:n.last_done,frequency:n.frequency,notes:n.notes,status:n.status}),setTimeout(()=>{this.initializeDatePickers()},100)}deleteMaintenanceSchedule(n){confirm("Are you sure you want to delete this maintenance schedule?")&&this.assetService.deleteMaintenanceSchedule(this.asset.id,n.id).pipe(rt(this.destroy$)).subscribe({next:e=>{e.success&&this.loadMaintenanceSchedules()},error:e=>{console.error("Error deleting maintenance schedule:",e)}})}saveMaintenanceSchedule(){if(this.maintenanceForm.valid&&this.asset){let n=this.maintenanceForm.value;this.selectedSchedule?this.assetService.updateMaintenanceSchedule(this.asset.id,this.selectedSchedule.id,n).pipe(rt(this.destroy$)).subscribe({next:e=>{e.success&&(this.loadMaintenanceSchedules(),this.closeMaintenanceModals())},error:e=>{console.error("Error updating maintenance schedule:",e)}}):this.assetService.addMaintenanceSchedule(this.asset.id,n).pipe(rt(this.destroy$)).subscribe({next:e=>{e.success&&(this.loadMaintenanceSchedules(),this.closeMaintenanceModals())},error:e=>{console.error("Error adding maintenance schedule:",e)}})}}closeMaintenanceModals(){this.showAddMaintenanceModal=!1,this.showEditMaintenanceModal=!1,this.selectedSchedule=null,this.maintenanceForm.reset(),this.flatpickrInstances.forEach(n=>{n&&n.destroy()}),this.flatpickrInstances=[]}initializeDatePickers(){this.flatpickrInstances.forEach(n=>{n&&n.destroy()}),this.flatpickrInstances=[],setTimeout(()=>{this.dateInputs&&this.dateInputs.forEach((n,e)=>{if(n?.nativeElement){let i=rr(n.nativeElement,{dateFormat:"Y-m-d",allowInput:!0,clickOpens:!0,onChange:(r,a)=>{let s=n.nativeElement.getAttribute("formControlName");s&&this.maintenanceForm.get(s)&&this.maintenanceForm.get(s).setValue(a)}});this.flatpickrInstances.push(i)}})},50)}getScheduleStatusColor(n){return{Scheduled:"blue",Overdue:"red",Completed:"green","In Progress":"yellow"}[n]||"gray"}formatDate(n){return n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Not set"}getAssetTypeName(n){return n?{1:"Fixed Asset",2:"Semi-Fixed Asset",3:"Mobile Asset",4:"Fleet Asset",5:"IT Equipment"}[n.toString()]||`Type ${n}`:"Standard Asset"}navigateToPrevious(){console.log("Navigate to previous asset")}navigateToNext(){console.log("Navigate to next asset")}loadRelatedAssets(){this.asset?.id&&(this.relatedAssetsLoading=!0,this.relatedAssetsError="",this.assetService.getRelatedAssets(this.asset.id,this.relatedAssetsParams).pipe(rt(this.destroy$)).subscribe({next:n=>{n.success?this.relatedAssets=n.data.related_assets||[]:this.relatedAssetsError=n.message||"Failed to load related assets",this.relatedAssetsLoading=!1},error:n=>{this.relatedAssetsError=n.error?.message||"An error occurred while loading related assets",this.relatedAssetsLoading=!1}}))}loadDepreciationChart(){this.asset?.id&&(this.depreciationChartLoading=!0,this.depreciationChartError="",console.log("Loading depreciation chart for asset:",this.asset.id),this.assetService.getAssetDepreciationChart(this.asset.id).pipe(rt(this.destroy$)).subscribe({next:n=>{console.log("Chart API Response:",n),n.success?(this.depreciationChartData=n.data,console.log("Chart data set:",this.depreciationChartData),this.createDepreciationChart()):(this.depreciationChartError=n.message||"Failed to load depreciation chart data",console.log("API returned error, using mock data"),this.createDepreciationChartWithMockData()),this.depreciationChartLoading=!1},error:n=>{console.error("Chart API Error:",n),this.depreciationChartError=n.error?.message||"An error occurred while loading depreciation chart data",this.depreciationChartLoading=!1,this.createDepreciationChartWithMockData()}}))}createDepreciationChart(){console.log("Creating depreciation chart..."),this.depreciationChart&&(console.log("Destroying existing chart"),this.depreciationChart.destroy()),setTimeout(()=>{let n=document.getElementById("depreciationChart");if(console.log("Canvas element:",n),!n){console.error("Depreciation chart canvas not found");return}let e=this.processChartData(this.depreciationChartData)||this.generateMockDepreciationData();console.log("Chart data to use:",e);try{this.depreciationChart=new ds(n,{type:"line",data:{labels:e.labels,datasets:[{label:"Asset Value",data:e.values,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Accumulated Depreciation",data:e.depreciation,borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderWidth:2,fill:!1,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Asset Depreciation Over Time",font:{size:16,weight:"bold"}},legend:{display:!0,position:"top"},tooltip:{mode:"index",intersect:!1,callbacks:{label:i=>{let r=i.dataset.label||"",a=i.parsed.y;return`${r}: $${a.toLocaleString()}`}}}},scales:{x:{title:{display:!0,text:"Month"}},y:{title:{display:!0,text:"Value ($)"},beginAtZero:!0,ticks:{callback:i=>`$${Number(i).toLocaleString()}`}}},interaction:{mode:"nearest",axis:"x",intersect:!1}}}),console.log("Chart created successfully"),this.cdr.detectChanges()}catch(i){console.error("Error creating chart:",i)}},100)}processChartData(n){if(!n||!n.chart_data||!n.chart_data.has_data)return null;let e=n.chart_data,i=e.depreciation_months.map(o=>`Month ${o}`),r=e.depreciation_values.map(o=>parseFloat(o)),a=parseFloat(n.asset.purchase_price),s=r.map(o=>a-o);return{labels:i,values:r,depreciation:s}}createDepreciationChartWithMockData(){let n=this.generateMockDepreciationData();this.depreciationChartData=n,this.createDepreciationChart()}generateMockDepreciationData(){let n=parseFloat(this.asset?.purchase_price)||1e4,e=parseFloat(this.asset?.depreciation)||10,i=this.asset?.depreciation_life||10,r=[],a=[],s=[],o=i||e;for(let l=1;l<=o;l++){r.push(`Month ${l}`);let f=n/o*(l-1),h=Math.max(0,n-f);a.push(h),s.push(f)}return{labels:r,values:a,depreciation:s}}onRelatedFilterChange(n){this.selectedRelatedFilter=n,this.relatedAssetsParams.type=n,this.loadRelatedAssets()}getRelatedFilterDisplayName(n){return{all:"All Related",category:"Same Category",location:"Same Location",department:"Same Department",manufacturer:"Same Manufacturer",parent:"Same Parent",children:"Child Assets",siblings:"Sibling Assets",similar:"Similar Assets"}[n]||n}getRelatedAssetStatusColor(n){if(n?.color)return`bg-${this.getColorFromHex(n.color)}-100 text-${this.getColorFromHex(n.color)}-700`;let e=n?.name||n;return{Active:"bg-green-100 text-green-700",Inactive:"bg-gray-100 text-gray-700",Maintenance:"bg-orange-100 text-orange-700",Retired:"bg-red-100 text-red-700"}[e]||"bg-gray-100 text-gray-700"}getColorFromHex(n){return{"#10B981":"green","#EF4444":"red","#F59E0B":"yellow","#3B82F6":"blue","#8B5CF6":"purple","#F97316":"orange","#6B7280":"gray"}[n]||"gray"}navigateToRelatedAsset(n){this.router.navigate(["/assets",n])}loadActivityHistory(){if(!this.asset?.id)return;this.activityLoading=!0,this.activityError="";let n={page:1,per_page:5,sort_by:"created_at",sort_dir:"desc"};this.assetService.getActivityHistory(this.asset.id,n).pipe(rt(this.destroy$)).subscribe({next:e=>{e.success?this.activities=e.data.data||[]:this.activityError=e.message||"Failed to load activity history",this.activityLoading=!1},error:e=>{this.activityError=e.error?.message||"An error occurred while loading activity history",this.activityLoading=!1}})}loadPerformanceMetrics(){console.log("Load performance metrics")}refreshHealthMetrics(){this.loadPerformanceMetrics(),console.log("Refreshing health metrics")}refreshDepreciationChart(){console.log("Refreshing depreciation chart..."),this.loadDepreciationChart()}forceCreateChart(){console.log("Force creating chart..."),this.createDepreciationChart()}loadHealthPerformanceChart(){if(!this.asset?.id){console.log("No asset ID available for health performance chart");return}this.healthPerformanceChartLoading=!0,this.healthPerformanceChartError="",console.log("Loading health performance chart for asset:",this.asset.id),this.assetService.getAssetHealthPerformanceChart(this.asset.id,{months:12}).pipe(rt(this.destroy$)).subscribe({next:n=>{console.log("Health performance chart API response:",n),this.healthPerformanceChartLoading=!1,n.success&&n.data?(this.healthPerformanceChartData=n.data,setTimeout(()=>{this.createHealthPerformanceChart()},100)):(this.healthPerformanceChartError="Failed to load health performance data",console.error("Health performance chart API error:",n))},error:n=>{console.error("Health performance chart API error:",n),this.healthPerformanceChartLoading=!1,this.healthPerformanceChartError="Failed to load health performance data"}})}createHealthPerformanceChart(){console.log("Creating health performance chart..."),console.log("Health performance chart data:",this.healthPerformanceChartData),this.healthPerformanceChart&&(this.healthPerformanceChart.destroy(),this.healthPerformanceChart=null);let n=document.getElementById("healthPerformanceChart");if(console.log("Canvas element:",n),!n){console.error("Health performance chart canvas not found");return}setTimeout(()=>{try{console.log("Processing health performance data...");let e=this.processHealthPerformanceData(this.healthPerformanceChartData);console.log("Processed chart data:",e);let i={type:"line",data:{labels:e.labels,datasets:[{label:"Health Score",data:e.healthScores,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!1,tension:.4,pointBackgroundColor:"#10B981",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6},{label:"Performance Score",data:e.performanceScores,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!1,tension:.4,pointBackgroundColor:"#3B82F6",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6},{label:"Maintenance Count",data:e.maintenanceCounts,borderColor:"#F59E0B",backgroundColor:"rgba(245, 158, 11, 0.1)",borderWidth:2,fill:!1,tension:.4,pointBackgroundColor:"#F59E0B",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6,yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#374151",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(r){let a=r.dataset.label||"",s=r.parsed.y;return a==="Maintenance Count"?`${a}: ${s} activities`:`${a}: ${s}%`}}}},scales:{x:{display:!0,title:{display:!0,text:"Month",font:{size:12,weight:"bold"}},grid:{display:!0,color:"rgba(0, 0, 0, 0.1)"}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Score (%)",font:{size:12,weight:"bold"}},min:0,max:100,grid:{display:!0,color:"rgba(0, 0, 0, 0.1)"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Maintenance Count",font:{size:12,weight:"bold"}},min:0,grid:{drawOnChartArea:!1,color:"rgba(0, 0, 0, 0.1)"}}}}};this.healthPerformanceChart=new ds(n,i),console.log("Health performance chart created successfully"),this.cdr.detectChanges()}catch(e){console.error("Error creating health performance chart:",e),setTimeout(()=>{console.log("Retrying health performance chart creation..."),this.createHealthPerformanceChart()},500)}},100)}processHealthPerformanceData(n){if(!n?.chart_data)return console.log("No chart data available, using mock data"),this.generateMockHealthPerformanceData();let e=n.chart_data;return console.log("Processing health performance data:",e),{labels:(e.dates||[]).map(r=>{if(r&&r.includes("-")){let[a,s]=r.split("-");return new Date(parseInt(a),parseInt(s)-1).toLocaleDateString("en-US",{month:"short",year:"2-digit"})}return r}),healthScores:e.health_scores||[],performanceScores:e.performance_scores||[],maintenanceCounts:e.maintenance_counts||[],metrics:e.metrics||{}}}generateMockHealthPerformanceData(){let e=[],i=[],r=[],a=[];for(let s=0;s<12;s++){let o=new Date;o.setMonth(o.getMonth()-(11-s)),e.push(o.toLocaleDateString("en-US",{month:"short",year:"2-digit"}));let l=85,c=s*2+Math.random()*5;i.push(Math.max(60,Math.round(l-c)));let f=90,h=(Math.random()-.5)*10;r.push(Math.max(75,Math.round(f+h))),a.push(Math.floor(Math.random()*5)+1)}return{labels:e,healthScores:i,performanceScores:r,maintenanceCounts:a,metrics:{average_health_score:Math.round(i.reduce((s,o)=>s+o,0)/i.length),average_performance_score:Math.round(r.reduce((s,o)=>s+o,0)/r.length),total_maintenance_count:a.reduce((s,o)=>s+o,0),health_trend:i[i.length-1]-i[0],performance_trend:r[r.length-1]-r[0]}}}refreshHealthPerformanceChart(){this.loadHealthPerformanceChart()}forceCreateHealthPerformanceChart(){if(console.log("Force creating health performance chart..."),console.log("Current health performance chart data:",this.healthPerformanceChartData),!this.healthPerformanceChartData){console.log("No data available, loading health performance chart..."),this.loadHealthPerformanceChart();return}this.createHealthPerformanceChart()}getHealthScoreColor(n){return n?n>=80?"text-green-600":n>=60?"text-yellow-600":n>=40?"text-orange-600":"text-red-600":"text-gray-400"}getHealthStatusColor(n){return n?n>=80?"text-green-600":n>=60?"text-yellow-600":n>=40?"text-orange-600":"text-red-600":"text-gray-600"}getHealthStatusText(n){return n?n>=80?"Excellent":n>=60?"Good":n>=40?"Fair":"Poor":"Unknown"}getAssetAge(){if(!this.asset?.purchase_date)return"Unknown";let n=new Date(this.asset.purchase_date),i=Math.abs(new Date().getTime()-n.getTime()),r=Math.ceil(i/(1e3*60*60*24));if(r<365)return`${Math.floor(r/30)} months`;{let a=Math.floor(r/365);return`${a} year${a>1?"s":""}`}}getUtilizationRate(){let n=this.asset?.health_score||0;return n>=80?95:n>=60?85:n>=40?70:50}getUptimePercentage(){let n=this.asset?.health_score||0;return n>=80?99.5:n>=60?98:n>=40?95:90}getMaintenanceFrequency(){let n=this.asset?.health_score||0;return n>=80?"Low":n>=60?"Medium":n>=40?"High":"Very High"}getMaintenanceFrequencyPercentage(){let n=this.asset?.health_score||0;return n>=80?20:n>=60?40:n>=40?60:80}getCostEfficiency(){let n=parseFloat(this.asset?.purchase_price)||0,e=this.calculateCurrentValue();if(n===0)return 85;let i=e/n*100;return Math.min(Math.max(i,0),100)}formatCurrency(n){return n.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})}calculateCurrentValue(){let n=parseFloat(this.asset?.purchase_price)||0,e=this.calculateDepreciation();return Math.round(Math.max(n-e,0)*100)/100}getROIColor(n){return n>=0?"text-green-600":"text-red-600"}getPerformanceTrend(){let n=this.asset?.health_score||0;return n>=80?"Improving":n>=60?"Stable":n>=40?"Declining":"Critical"}getCostEfficiencyTrend(){let n=this.getCostEfficiency();return n>=80?"Optimal":n>=60?"Good":n>=40?"Fair":"Poor"}getMaintenanceTrend(){let n=this.asset?.health_score||0;return n>=80?"Low":n>=60?"Stable":n>=40?"Increasing":"High"}getTrendColor(n){switch(n.toLowerCase()){case"improving":case"optimal":case"low":return"text-green-600";case"stable":case"good":return"text-blue-600";case"declining":case"fair":case"increasing":return"text-yellow-600";case"critical":case"poor":case"high":return"text-red-600";default:return"text-gray-600"}}getTrendIcon(n){switch(n.toLowerCase()){case"improving":case"optimal":return"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6";case"declining":case"critical":return"M13 17h8m0 0v-8m0 8l-8-8-4 4-6-6";case"stable":case"good":case"fair":case"low":case"increasing":case"high":default:return"M20 12H4"}}getFinancialAlerts(){let n=[],e=this.asset?.health_score||0,i=this.calculateCurrentValue(),r=parseFloat(this.asset?.purchase_price)||0;return e<40&&n.push({message:"Asset health is critical - consider replacement",class:"bg-red-50 text-red-700"}),i<r*.3&&n.push({message:"Asset value has depreciated significantly",class:"bg-orange-50 text-orange-700"}),(this.asset?.warranty==="None"||!this.asset?.warranty)&&n.push({message:"No warranty coverage - maintenance costs may increase",class:"bg-yellow-50 text-yellow-700"}),n}getPredictiveAlerts(){let n=[],e=this.asset?.health_score||0,i=this.getAssetAge();return e<60&&n.push({title:"Maintenance Alert",message:"Schedule preventive maintenance within 30 days",class:"bg-orange-50 text-orange-700"}),e<40&&n.push({title:"Critical Alert",message:"Asset requires immediate attention",class:"bg-red-50 text-red-700"}),i.includes("year")&&parseInt(i)>5&&n.push({title:"Age Alert",message:"Asset is aging - consider replacement planning",class:"bg-blue-50 text-blue-700"}),n}uploadDocument(){console.log("Upload document")}downloadDocument(n){console.log("Download document:",n)}compareWithSimilar(){console.log("Compare with similar assets")}scrollToSection(n){let e=document.getElementById(n);e&&e.scrollIntoView({behavior:"smooth"})}exportFinancialData(){console.log("Export financial data")}exportMaintenanceHistory(){console.log("Export maintenance history")}generateMaintenanceRecommendations(){console.log("Generate maintenance recommendations")}addMaintenanceCost(){console.log("Add maintenance cost")}viewCostHistory(){console.log("View cost history")}getWarrantyStatus(n){if(!n)return"No warranty";let e=new Date,i=new Date(n);if(i<e)return"Expired";{let r=Math.ceil((i.getTime()-e.getTime())/864e5);return r<=30?`Expires in ${r} days`:"Active"}}getWarrantyStatusClass(n){let e=this.getWarrantyStatus(n);return e==="Expired"?"text-red-600 font-medium":e.includes("Expires in")?"text-orange-600 font-medium":e==="Active"?"text-green-600 font-medium":"text-gray-500"}selectImage(n){this.asset.images&&n>=0&&n<this.asset.images.length&&(this.currentImageIndex=n,this.selectedImageUrl=this.asset.images[n].image_url)}previousImage(){if(this.asset.images&&this.asset.images.length>1){let n=this.currentImageIndex>0?this.currentImageIndex-1:this.asset.images.length-1;this.selectImage(n)}}nextImage(){if(this.asset.images&&this.asset.images.length>1){let n=this.currentImageIndex<this.asset.images.length-1?this.currentImageIndex+1:0;this.selectImage(n)}}copyAssetId(){let n=this.asset?.asset_id||this.asset?.id;n&&navigator.clipboard.writeText(n.toString()).then(()=>{console.log("Asset ID copied to clipboard")}).catch(e=>{console.error("Failed to copy asset ID:",e)})}copySerialNumber(){this.asset?.serial_number&&navigator.clipboard.writeText(this.asset.serial_number).then(()=>{console.log("Serial number copied to clipboard")}).catch(n=>{console.error("Failed to copy serial number:",n)})}calculateDepreciation(){if(!this.asset?.purchase_price)return 0;let n=this.asset.current_value||this.asset.purchase_price;return Math.round((this.asset.purchase_price-n)*100)/100}calculateDepreciationRate(){let n=this.asset?.depreciation||10;return Math.round(1/n*100)}getMaxDepreciationValue(){return this.asset?.purchase_price||1e4}getDepreciationPath(){let n=this.getMaxDepreciationValue(),e=this.asset?.purchase_date?new Date(this.asset.purchase_date):new Date,i=new Date,r=10,a=new Date(e.getTime()+r*365.25*24*60*60*1e3),s=[],o=(a.getTime()-e.getTime())/(1e3*60*60*24);for(let l=0;l<=12;l++){let c=o*l/12,h=(new Date(e.getTime()+c*24*60*60*1e3).getTime()-e.getTime())/(1e3*60*60*24*365.25),m=n/r,p=Math.min(m*h,n),v=Math.max(0,n-p),_=l/12*100,w=100-v/n*100;s.push(`${_},${w}`)}return`M ${s.join(" L ")}`}getCurrentPeriodX(){if(!this.asset?.purchase_date)return 0;let n=new Date(this.asset.purchase_date),e=new Date,i=10,a=(new Date(n.getTime()+i*365.25*24*60*60*1e3).getTime()-n.getTime())/(1e3*60*60*24),s=(e.getTime()-n.getTime())/(1e3*60*60*24);return Math.min(100,Math.max(0,s/a*100))}getCurrentPeriodY(){let n=this.calculateCurrentValue(),e=this.getMaxDepreciationValue();return 100-n/e*100}getDepreciationDates(){let n=this.asset?.purchase_date?new Date(this.asset.purchase_date):new Date,e=10,i=new Date(n.getTime()+e*365.25*24*60*60*1e3),r=[];for(let a=0;a<=12;a++){let s=(i.getTime()-n.getTime())/864e5*a/12;r.push(new Date(n.getTime()+s*24*60*60*1e3))}return r}calculateAnnualDepreciation(){return this.getMaxDepreciationValue()/10}calculateRemainingYears(){if(!this.asset?.purchase_date)return 10;let n=new Date(this.asset.purchase_date),e=new Date,i=10,r=(e.getTime()-n.getTime())/(1e3*60*60*24*365.25);return Math.round(Math.max(0,i-r)*100)/100}calculateTotalCostOfOwnership(){let n=this.asset?.purchase_price||0,e=this.asset?.total_maintenance_cost||0,i=this.asset?.operating_cost||0;return n+e+i}calculateROI(){let n=this.calculateTotalCostOfOwnership(),e=this.asset?.current_value||this.asset?.purchase_price||0;return n===0?0:Math.round((e-n)/n*100)}createWorkOrder(){console.log("Create work order for asset:",this.asset?.id)}transferAsset(){this.showTransferModal=!0}onTransferComplete(n){console.log("Transfer completed:",n),this.asset?.id&&this.loadAsset(this.asset.id.toString())}onTransferModalClose(){this.showTransferModal=!1}duplicateAsset(){this.asset&&this.router.navigate(["/assets/create"],{queryParams:{duplicate:!0,sourceId:this.asset.id}})}onImageError(n){console.warn("Asset image failed to load:",n.target.src),n.target.onerror=null,n.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xMiA5VjEzTTEyIDE3SDE2TTE2IDlIMTJNMTIgOUw4IDEzTDEyIDE3IiBzdHJva2U9IiM5Q0EzQUYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjwvc3ZnPgo="}onCategoryIconError(n,e){e&&(e.iconError=!0)}downloadQRCode(){if(this.qrCodeDataUrl){let n=document.createElement("a");n.href=this.qrCodeDataUrl,n.download=`asset-${this.asset.id}-qr.png`,n.click()}else if(this.asset?.qr_code_url){let n=document.createElement("a");n.href=this.asset.qr_code_url,n.download=`asset-${this.asset.id}-qr.png`,n.click()}else this.generateQRCode()}downloadBarcode(){if(this.asset?.barcode_url){let n=document.createElement("a");n.href=this.asset.barcode_url,n.download=`asset-${this.asset.asset_id||this.asset.id}-barcode.png`,n.click()}else if(this.barcodeDataUrl){let n=document.createElement("a");n.href=this.barcodeDataUrl,n.download=`asset-${this.asset.asset_id||this.asset.id}-barcode.png`,n.click()}else this.generateBarcode()}generateQRCode(){if(!this.asset)return;this.qrCodeLoading=!0;let n=`${window.location.origin}/public/asset/${this.asset.id}`;Lu.toDataURL(n,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}}).then(e=>{this.qrCodeDataUrl=e,this.qrCodeLoading=!1}).catch(e=>{console.error("Error generating QR code:",e),this.qrCodeLoading=!1})}generateBarcode(){if(!this.asset?.asset_id)return;this.barcodeLoading=!0;let n=this.asset.asset_id,e=`https://quickchart.io/barcode?c=${encodeURIComponent(n)}&chs=300x100&chld=L%7C0&choe=UTF-8`;fetch(e).then(i=>i.blob()).then(i=>{let r=new FileReader;r.onloadend=()=>{this.barcodeDataUrl=r.result,this.barcodeLoading=!1},r.readAsDataURL(i)}).catch(i=>{console.error("Error generating barcode:",i),this.barcodeLoading=!1})}copyQRCodeUrl(){this.asset?.qr_code_url&&navigator.clipboard.writeText(this.asset.qr_code_url).then(()=>{console.log("QR code URL copied to clipboard")})}copyPublicUrl(){let n=`${window.location.origin}/public/asset/${this.asset.id}`;navigator.clipboard.writeText(n).then(()=>{console.log("Public URL copied to clipboard")})}get windowLocation(){return window.location.origin}showFullActivityHistory(){this.loadFullActivityHistory(),this.showActivityHistoryModal=!0}closeActivityHistoryModal(){this.showActivityHistoryModal=!1,this.activityHistoryParams={page:1,per_page:15,sort_by:"created_at",sort_dir:"desc",search:"",action:"",user_id:"",date_from:"",date_to:""},this.activityHistoryPagination=null}onActivityHistoryPageChange(n){this.activityHistoryParams.page=n,this.loadFullActivityHistory()}onActivityHistorySearch(n){this.activityHistoryParams.search=n,this.activityHistoryParams.page=1,this.loadFullActivityHistory()}onActivityHistoryFilter(n,e){this.activityHistoryParams[n]=e,this.activityHistoryParams.page=1,this.loadFullActivityHistory()}onActivityHistorySort(n,e){this.activityHistoryParams.sort_by=n,this.activityHistoryParams.sort_dir=e,this.loadFullActivityHistory()}clearActivityHistoryFilters(){this.activityHistoryParams={page:1,per_page:15,sort_by:"created_at",sort_dir:"desc",search:"",action:"",user_id:"",date_from:"",date_to:""},this.loadFullActivityHistory()}loadFullActivityHistory(){this.asset?.id&&(this.activityHistoryLoading=!0,this.activityHistoryError="",this.assetService.getActivityHistory(this.asset.id,this.activityHistoryParams).pipe(rt(this.destroy$)).subscribe({next:n=>{n.success?(this.fullActivityHistory=n.data.data||[],this.activityHistoryPagination=n.data):this.activityHistoryError=n.message||"Failed to load full activity history",this.activityHistoryLoading=!1},error:n=>{this.activityHistoryError=n.error?.message||"An error occurred while loading full activity history",this.activityHistoryLoading=!1}}))}viewFullImage(n){window.open(n,"_blank")}formatActivityBeforeAfter(n,e){if(!n&&!e)return"";let i=[];if(n&&e){let r=Object.keys(n),a=Object.keys(e);for(let s of a)if(n[s]!==e[s]){let o=this.getFieldDisplayName(s);o&&i.push(`${o}: ${this.formatFieldValue(n[s])} \u2192 ${this.formatFieldValue(e[s])}`)}}else if(e){let r=["name","type","status","location_id","department_id","purchase_price"];for(let a of r)if(e[a]!==void 0&&e[a]!==null){let s=this.getFieldDisplayName(a);s&&i.push(`${s}: ${this.formatFieldValue(e[a])}`)}}else if(n){let r=["name","type","status"];for(let a of r)if(n[a]!==void 0&&n[a]!==null){let s=this.getFieldDisplayName(a);s&&i.push(`${s}: ${this.formatFieldValue(n[a])} (deleted)`)}}return i.length>0?i.join(", "):""}getFieldDisplayName(n){return{name:"Asset Name",type:"Type",model:"Model",status:"Status",description:"Description",location_id:"Location",department_id:"Department",purchase_price:"Purchase Price",purchase_date:"Purchase Date",serial_number:"Serial Number",asset_id:"Asset ID",warranty:"Warranty",insurance:"Insurance",depreciation:"Depreciation",health_score:"Health Score",manufacturer:"Manufacturer",category_id:"Category"}[n]||n.replace(/_/g," ").replace(/\b\w/g,i=>i.toUpperCase())}formatFieldValue(n){return n==null?"N/A":typeof n=="boolean"?n?"Yes":"No":typeof n=="number"?n.toString().includes(".")?`$${n.toFixed(2)}`:n.toString():typeof n=="string"?n.match(/^\d{4}-\d{2}-\d{2}/)?new Date(n).toLocaleDateString():n:JSON.stringify(n)}getUserDisplayName(n){return n?n.name?n.name:n.email?n.email.split("@")[0]:"Unknown User":"System"}getActivityIcon(n){return{created:"M12 6v6m0 0v6m0-6h6m-6 0H6",updated:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",deleted:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",transferred:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4",maintenance:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z",imported:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"}[n]||"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}getActivityColor(n){return{created:"bg-green-100 text-green-600",updated:"bg-blue-100 text-blue-600",deleted:"bg-red-100 text-red-600",transferred:"bg-purple-100 text-purple-600",maintenance:"bg-orange-100 text-orange-600",imported:"bg-indigo-100 text-indigo-600"}[n]||"bg-gray-100 text-gray-600"}sharePublicUrl(){if(this.asset?.id){let n=`${window.location.origin}/public/asset/${this.asset.id}`;navigator.clipboard.writeText(n).then(()=>{console.log("Public URL copied to clipboard:",n),alert("Public URL copied to clipboard!")}).catch(e=>{console.error("Failed to copy URL:",e),alert("Failed to copy URL to clipboard")})}}static \u0275fac=function(e){return new(e||t)(ft(ea),ft(_i),ft(Kn),ft(Ws),ft(ro),ft(no),ft(id))};static \u0275cmp=Yt({type:t,selectors:[["app-asset-view"]],viewQuery:function(e,i){if(e&1&&pi(Mw,5),e&2){let r;gi(r=xi())&&(i.dateInputs=r)}},decls:34,vars:10,consts:[["noImages",""],["dateInput",""],[1,"min-h-screen","bg-gray-50","asset-view-container"],[1,"bg-white","border-b","border-gray-200","px-6","py-4","print-hide"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],["aria-label","Breadcrumb",1,"flex"],[1,"flex","items-center","space-x-2"],["routerLink","/assets/list",1,"text-gray-500","hover:text-gray-700","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400","mx-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"text-gray-900","font-medium"],[1,"flex","items-center","space-x-3"],[1,"flex","items-center","space-x-2","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"relative",3,"click"],[1,"flex","items-center","justify-center","w-10","h-10","text-gray-600","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["cx","12","cy","5","r","2"],["cx","12","cy","12","r","2"],["cx","12","cy","19","r","2"],["class","absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",4,"ngIf"],["class","flex items-center justify-center py-20",4,"ngIf"],["class","px-6 py-6",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",4,"ngIf"],["class","fixed inset-0 bg-[#00000085] flex items-center justify-center z-50 p-4",4,"ngIf"],[3,"closeModal","transferComplete","isOpen","asset"],[1,"absolute","right-0","mt-2","w-48","bg-white","rounded-lg","shadow-lg","border","border-gray-200","py-2","z-50"],[1,"w-full","flex","items-center","space-x-3","px-4","py-2","text-left","hover:bg-gray-50","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"],[1,"text-gray-700"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"border-t","border-gray-100","my-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","rounded-full","mb-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-8","h-8","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-red-100","rounded-full","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-sm","text-gray-500","mb-4"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"px-6","py-6"],[1,"bg-white","rounded-lg","p-6","mb-6","shadow-sm","border","border-gray-200"],[1,"flex","items-start","justify-between","mb-4"],[1,"w-16","h-16","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],["class","inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",3,"background-color","color",4,"ngIf"],[1,"text-gray-500"],[1,"text-right"],[1,"flex","items-center","space-x-2","mb-2"],[1,"flex","items-center","space-x-1","px-2","py-1","text-sm","font-mono","bg-gray-100","rounded","hover:bg-gray-200","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["class","flex items-center space-x-2",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-6"],[1,"bg-white","rounded-lg","p-6","shadow-sm","border","border-gray-200"],[1,"flex","items-center","space-x-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-lg","font-semibold","text-gray-900"],[4,"ngIf","ngIfElse"],[1,"flex","items-center","space-x-2","mb-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"space-y-6"],[1,"text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],[1,"text-gray-600","leading-relaxed"],["class","text-blue-600 hover:text-blue-700 text-sm font-medium mt-2",3,"click",4,"ngIf"],[1,"w-8","h-8","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["class","w-5 h-5",3,"src","alt","error",4,"ngIf"],["class","w-5 h-5 text-blue-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","text-gray-900",4,"ngIf"],[1,"text-gray-900","font-mono","text-lg"],["title","Copy Asset ID",1,"p-1","text-gray-400","hover:text-gray-600","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],["class","text-blue-600 hover:underline cursor-pointer",3,"routerLink",4,"ngIf"],[1,"text-gray-900"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[4,"ngIf"],[1,"bg-gray-50","rounded-lg","p-4","flex","flex-col","items-center"],[1,"w-32","h-32","bg-white","rounded-lg","p-2","shadow-sm","border","border-gray-200","flex","items-center","justify-center"],["alt","QR Code","class","w-full h-full object-contain",3,"src",4,"ngIf"],["class","flex items-center justify-center",4,"ngIf"],["class","text-center",4,"ngIf"],["class","text-center text-gray-400",4,"ngIf"],[1,"mt-3","flex","space-x-2"],["class","text-sm text-blue-600 hover:text-blue-700 font-medium",3,"click",4,"ngIf"],["class","text-sm text-green-600 hover:text-green-700 font-medium",3,"click",4,"ngIf"],[1,"mt-2","text-xs","text-gray-500","text-center"],[1,"w-full","bg-white","rounded-lg","p-2","shadow-sm","border","border-gray-200","flex","items-center","justify-center"],["alt","Barcode","class","w-full h-20 object-contain",3,"src",4,"ngIf"],["class","flex items-center justify-center py-4",4,"ngIf"],["class","text-center py-4",4,"ngIf"],["class","text-center text-gray-400 py-4",4,"ngIf"],["class","mt-1 font-mono",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-700","mb-1"],["class","mt-6 pt-6 border-t border-gray-200",4,"ngIf"],[1,"flex","items-center","justify-between","mb-6"],[1,"w-8","h-8","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"flex","items-center","space-x-2","px-3","py-2","text-green-600","hover:bg-green-50","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"flex","items-center","space-x-2","px-3","py-2","text-blue-600","hover:bg-blue-50","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["class","grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",4,"ngIf"],[1,"text-sm","font-medium","text-gray-700"],["class","flex items-center justify-center h-64 bg-gray-50 rounded-lg",4,"ngIf"],["class","flex items-center justify-center h-64 bg-red-50 rounded-lg",4,"ngIf"],["class","relative h-64 bg-white border border-gray-200 rounded-lg p-4",4,"ngIf"],["class","text-center text-xs text-gray-500",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",4,"ngIf"],[1,"flex","items-center","justify-between","mb-4"],[1,"w-8","h-8","bg-orange-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"],[1,"flex","items-center","space-x-2","px-3","py-2","text-orange-600","hover:bg-orange-50","rounded-lg","transition-colors",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"text-sm","text-gray-600","mb-1"],[1,"text-2xl","font-bold","text-gray-900"],[1,"bg-blue-50","rounded-lg","p-4"],[1,"text-2xl","font-bold","text-blue-600"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mt-4"],[1,"text-center","p-3","bg-gray-50","rounded-lg"],[1,"text-sm","text-gray-600"],["class","flex items-center justify-center py-8",4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"text-center","mt-6"],[1,"text-blue-600","hover:text-blue-700","text-sm","font-medium",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"],[1,"flex","items-center","space-x-2","px-3","py-1","text-sm","text-gray-600","hover:text-gray-800","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","space-y-3",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"grid","grid-cols-1","gap-4","mb-6"],[1,"bg-green-50","rounded-lg","p-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],[1,"text-sm","text-green-600"],[1,"font-semibold","text-green-800"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],[1,"text-sm","text-blue-600"],[1,"font-semibold","text-blue-800"],[1,"bg-purple-50","rounded-lg","p-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-600"],[1,"text-sm","text-purple-600"],[1,"font-semibold","text-purple-800"],["class","text-center py-6",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"],[1,"text-sm","font-medium","text-gray-700","mb-3"],[1,"space-y-2"],[1,"text-xs","text-gray-600"],[1,"text-sm","text-gray-900"],[1,"bg-orange-50","rounded-lg","p-4"],[1,"flex","items-center","space-x-2","mt-1"],["class","text-xs text-gray-500",4,"ngIf"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-sm","font-medium"],[1,"mb-4"],[1,"relative","bg-gray-100","rounded-lg","overflow-hidden",2,"height","400px"],[1,"w-full","h-full","object-contain","bg-white","cursor-pointer",3,"click","error","src","alt"],["class","absolute left-2 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-black bg-opacity-50 text-white rounded-full flex items-center justify-center hover:bg-opacity-70 transition-all",3,"click",4,"ngIf"],["class","absolute right-2 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-black bg-opacity-50 text-white rounded-full flex items-center justify-center hover:bg-opacity-70 transition-all",3,"click",4,"ngIf"],[1,"absolute","bottom-4","right-4","bg-black","bg-opacity-50","text-white","px-3","py-1","rounded-full","text-sm"],["class","grid grid-cols-6 gap-2",4,"ngIf"],[1,"absolute","left-2","top-1/2","transform","-translate-y-1/2","w-10","h-10","bg-black","bg-opacity-50","text-white","rounded-full","flex","items-center","justify-center","hover:bg-opacity-70","transition-all",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"absolute","right-2","top-1/2","transform","-translate-y-1/2","w-10","h-10","bg-black","bg-opacity-50","text-white","rounded-full","flex","items-center","justify-center","hover:bg-opacity-70","transition-all",3,"click"],[1,"grid","grid-cols-6","gap-2"],["class","relative aspect-square bg-gray-100 rounded-lg overflow-hidden cursor-pointer border-2 transition-all",3,"border-blue-500","border-gray-200","click",4,"ngFor","ngForOf"],[1,"relative","aspect-square","bg-gray-100","rounded-lg","overflow-hidden","cursor-pointer","border-2","transition-all",3,"click"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"text-center","py-12","bg-gray-50","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-400","mx-auto","mb-4"],[1,"text-gray-600"],[1,"text-blue-600","hover:text-blue-700","text-sm","font-medium","mt-2",3,"click"],[1,"w-5","h-5",3,"error","src","alt"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-sm","font-medium"],[1,"text-blue-600","hover:underline","cursor-pointer",3,"routerLink"],["alt","QR Code",1,"w-full","h-full","object-contain",3,"src"],[1,"flex","items-center","justify-center"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],["fill","currentColor","viewBox","0 0 24 24",1,"w-24","h-24","text-gray-400"],["d","M3 3h6v6H3V3zm2 2v2h2V5H5zm8-2h6v6h-6V3zm2 2v2h2V5h-2zM3 11h6v6H3v-6zm2 2v2h2v-2H5zm8 2h6v6h-6v-6zm2 2v2h2v-2h-2z"],[1,"text-xs","text-gray-500","mt-2","font-mono"],[1,"text-center","text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto"],[1,"text-xs","mt-2"],[1,"text-sm","text-blue-600","hover:text-blue-700","font-medium",3,"click"],[1,"text-sm","text-green-600","hover:text-green-700","font-medium",3,"click"],["alt","Barcode",1,"w-full","h-20","object-contain",3,"src"],[1,"flex","items-center","justify-center","py-4"],[1,"text-center","py-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-400","mx-auto"],[1,"text-center","text-gray-400","py-4"],[1,"mt-1","font-mono"],[1,"text-xs","text-gray-500"],[1,"text-gray-900","font-mono"],[1,"p-1","text-gray-400","hover:text-gray-600","transition-colors",3,"click"],[1,"mt-6","pt-6","border-t","border-gray-200"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","flex justify-between",4,"ngFor","ngForOf"],[1,"flex","justify-between"],[1,"text-sm","text-gray-900","font-medium"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-6"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-orange-600"],[1,"flex","items-center","justify-center","h-64","bg-gray-50","rounded-lg"],[1,"inline-flex","items-center","justify-center","w-8","h-8","bg-green-100","rounded-full","mb-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-4","h-4","text-green-600"],[1,"flex","items-center","justify-center","h-64","bg-red-50","rounded-lg"],[1,"text-red-600","text-sm","mb-2"],[1,"relative","h-64","bg-white","border","border-gray-200","rounded-lg","p-4"],["id","healthPerformanceChart","width","400","height","200"],[1,"text-center","text-xs","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mt-4"],[1,"text-lg","font-semibold",3,"ngClass"],[1,"inline-flex","items-center","justify-center","w-8","h-8","bg-blue-100","rounded-full","mb-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-4","h-4","text-blue-600"],["id","depreciationChart","width","400","height","200"],[1,"flex","items-center","justify-center","py-8"],[1,"text-center","py-8"],["class","flex items-start space-x-3",4,"ngFor","ngForOf"],[1,"flex","items-start","space-x-3"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center","flex-shrink-0",3,"ngClass"],[1,"flex-1"],[1,"flex","items-center","justify-between","mb-1"],[1,"font-medium","text-gray-900","capitalize"],["class","text-xs text-gray-500 bg-gray-50 p-2 rounded border",4,"ngIf"],["class","text-xs text-gray-500 mt-1",4,"ngIf"],[1,"text-xs","text-gray-500","bg-gray-50","p-2","rounded","border"],[1,"text-xs","text-gray-500","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-400","mx-auto","mb-4"],["class","w-full flex items-center px-4 py-2 text-left hover:bg-gray-50 transition-colors",3,"text-blue-600","bg-blue-50","click",4,"ngFor","ngForOf"],[1,"w-full","flex","items-center","px-4","py-2","text-left","hover:bg-gray-50","transition-colors",3,"click"],[1,"text-sm"],[1,"space-y-3"],["class","flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-3","p-3","bg-gray-50","rounded-lg","hover:bg-gray-100","transition-colors","cursor-pointer",3,"click"],[1,"w-12","h-12","bg-blue-100","rounded-lg","flex","items-center","justify-center","flex-shrink-0"],["class","w-full h-full object-cover rounded-lg",3,"src","alt","error",4,"ngIf"],["class","w-6 h-6 text-blue-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"font-medium","text-gray-900","truncate"],[1,"flex","items-center","space-x-2","mb-1"],[1,"text-gray-400"],[1,"text-xs","px-2","py-1","rounded-full","font-medium",3,"ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400","flex-shrink-0"],[1,"w-full","h-full","object-cover","rounded-lg",3,"error","src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"text-center","py-6"],[1,"inline-flex","items-center","justify-center","w-6","h-6","bg-blue-100","rounded-full"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-3","h-3","text-blue-600"],["class","border border-gray-200 rounded-lg p-3",4,"ngFor","ngForOf"],[1,"border","border-gray-200","rounded-lg","p-3"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-medium","text-gray-900","text-sm"],[1,"flex","items-center","space-x-1"],[1,"p-1","text-gray-400","hover:text-blue-600","transition-colors",3,"click"],[1,"p-1","text-gray-400","hover:text-red-600","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"space-y-1","text-xs"],[1,"ml-1","text-gray-900"],["class","mt-2 text-xs text-gray-600",4,"ngIf"],[1,"mt-2","text-xs","text-gray-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400","mx-auto","mb-2"],[1,"text-sm","font-medium","text-gray-900","mb-1"],[1,"text-xs","text-gray-600","mb-3"],[1,"px-3","py-1","bg-blue-600","text-white","rounded","text-xs","hover:bg-blue-700","transition-colors",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","rounded-lg","max-w-md","w-full","p-6"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["formControlName","schedule_type",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["value",""],["value","Preventive"],["value","Inspection"],["value","Calibration"],["value","Cleaning"],["type","text","formControlName","next_due","placeholder","Select date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","text","formControlName","last_done","placeholder","Select date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["formControlName","frequency",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["value","Weekly"],["value","Monthly"],["value","Quarterly"],["value","Semi-Annual"],["value","Annual"],["formControlName","notes","rows","3","placeholder","Additional notes...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],[1,"flex","items-center","justify-end","space-x-3","mt-6"],["type","button",1,"px-4","py-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","transition-colors",3,"disabled"],["formControlName","status",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["value","Scheduled"],["value","In Progress"],["value","Completed"],["value","Overdue"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","rounded-lg","max-w-4xl","w-full","max-h-[90vh]","flex","flex-col"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-gray-600"],[1,"text-xl","font-semibold","text-gray-900"],[1,"flex-1","overflow-auto","p-6"],[1,"mb-6","space-y-4"],[1,"flex","space-x-4"],["type","text","placeholder","Search activities...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"change"],["value","created"],["value","updated"],["value","deleted"],["value","transferred"],["value","maintenance"],["value","imported"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"change"],["value","desc"],["value","asc"],["class","flex items-center justify-center py-12",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-4 max-h-[60vh] overflow-y-auto",4,"ngIf"],["class","mt-6 flex items-center justify-between",4,"ngIf"],[1,"flex","items-center","justify-between","p-6","border-t","border-gray-200","bg-gray-50"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700","transition-colors",3,"click"],[1,"flex","items-center","justify-center","py-12"],[1,"inline-flex","items-center","justify-center","w-12","h-12","bg-blue-100","rounded-full","mb-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-6","h-6","text-blue-600"],[1,"text-center","py-12"],[1,"text-red-600","mb-4"],[1,"space-y-4","max-h-[60vh]","overflow-y-auto"],["class","flex items-start space-x-4 p-4 bg-gray-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","items-start","space-x-4","p-4","bg-gray-50","rounded-lg"],[1,"w-10","h-10","rounded-full","flex","items-center","justify-center","flex-shrink-0",3,"ngClass"],[1,"font-semibold","text-gray-900","capitalize"],[1,"text-xs","text-gray-500","bg-white","px-2","py-1","rounded-full"],[1,"text-sm","text-gray-600","mb-2"],["class","text-xs text-gray-500 bg-white p-3 rounded border",4,"ngIf"],["class","text-xs text-gray-500 mt-2",4,"ngIf"],[1,"text-xs","text-gray-500","bg-white","p-3","rounded","border"],[1,"font-medium","mb-1"],[1,"text-xs","text-gray-500","mt-2"],[1,"mt-6","flex","items-center","justify-between"],[1,"flex","space-x-2"],["class","px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 transition-colors",3,"click",4,"ngIf"],[1,"px-3","py-1","text-sm","border","border-gray-300","rounded","hover:bg-gray-50","transition-colors",3,"click"]],template:function(e,i){e&1&&(d(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"nav",6)(5,"ol",7)(6,"li")(7,"a",8),g(8,"Assets"),u()(),d(9,"li"),B(),d(10,"svg",9),D(11,"path",10),u()(),q(),d(12,"li",11),g(13),u()()()(),d(14,"div",12)(15,"button",13),Y("click",function(){return i.editAsset()}),B(),d(16,"svg",14),D(17,"path",15),u(),q(),d(18,"span"),g(19,"Edit Asset"),u()(),d(20,"div",16),Y("click",function(a){return a.stopPropagation()}),d(21,"button",17),Y("click",function(){return i.showActionsDropdown=!i.showActionsDropdown}),B(),d(22,"svg",18),D(23,"circle",19)(24,"circle",20)(25,"circle",21),u()(),J(26,Pw,27,0,"div",22),u()()()(),J(27,Ow,10,0,"div",23)(28,Lw,11,1,"div",23)(29,Qb,451,129,"div",24)(30,Zb,59,2,"div",25)(31,ey,71,2,"div",25)(32,fy,62,5,"div",26),q(),d(33,"app-transfer-asset-modal",27),Y("closeModal",function(){return i.onTransferModalClose()})("transferComplete",function(a){return i.onTransferComplete(a)}),u()()),e&2&&(x(13),oe((i.asset==null?null:i.asset.name)||"Asset Details"),x(13),C("ngIf",i.showActionsDropdown),x(),C("ngIf",i.loading),x(),C("ngIf",i.error&&!i.loading),x(),C("ngIf",i.asset&&!i.loading),x(),C("ngIf",i.showAddMaintenanceModal),x(),C("ngIf",i.showEditMaintenanceModal),x(),C("ngIf",i.showActivityHistoryModal),x(),C("isOpen",i.showTransferModal)("asset",i.asset))},dependencies:[ln,js,Yn,Xt,$s,Gs,rd,Oi,Ys,io,tr,cd,dd,cn,ld,dn,er,Js,Qs,sa],styles:[".asset-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9)}.asset-image-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-radius:.5rem;min-height:16rem;display:flex;align-items:center;justify-content:center}.info-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.info-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.health-score-bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#10b981,#059669);transition:width .3s ease-in-out}.chart-placeholder[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f9fafb,#f3f4f6);border:2px dashed #d1d5db;border-radius:.5rem}.chart-placeholder[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:linear-gradient(135deg,#eff6ff,#dbeafe)}.ai-button[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.ai-button[_ngcontent-%COMP%]:hover{transform:scale(1.02)}.ai-button[_ngcontent-%COMP%]:active{transform:scale(.98)}.action-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.action-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;border-radius:.5rem;padding:.5rem 1rem;margin:-.5rem -1rem}.status-badge[_ngcontent-%COMP%]{font-weight:600;font-size:.75rem;padding:.25rem .5rem;border-radius:9999px}.section-icon[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.section-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.empty-state[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f9fafb,#f3f4f6);border:2px dashed #d1d5db;border-radius:1rem}.empty-state[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:linear-gradient(135deg,#eff6ff,#dbeafe)}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.grid-cols-2[_ngcontent-%COMP%]{grid-template-columns:1fr}.lg\\:col-span-2[_ngcontent-%COMP%]{grid-column:span 1}.asset-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.action-buttons[_ngcontent-%COMP%]{width:100%;justify-content:space-between}}@media print{.bg-white.border-b[_ngcontent-%COMP%], .flex.items-center.justify-between[_ngcontent-%COMP%], .bg-white.rounded-lg.p-6.shadow-sm.border.border-gray-200[_ngcontent-%COMP%]:has(button), button[_ngcontent-%COMP%], .relative[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%], .fixed[_ngcontent-%COMP%], nav[_ngcontent-%COMP%], .breadcrumb[_ngcontent-%COMP%], .actions-dropdown[_ngcontent-%COMP%], .quick-actions[_ngcontent-%COMP%], .print-hide[_ngcontent-%COMP%]{display:none!important}.bg-white.rounded-lg.p-6.shadow-sm.border.border-gray-200[_ngcontent-%COMP%]{border:1px solid #ddd!important;box-shadow:none!important;margin-bottom:20px!important;page-break-inside:avoid}.grid.grid-cols-1.lg\\\\[_ngcontent-%COMP%]:grid-cols-3{display:block!important}.lg\\\\[_ngcontent-%COMP%]:col-span-2{width:100%!important}body[_ngcontent-%COMP%]{margin:0!important;padding:20px!important;background:#fff!important}*[_ngcontent-%COMP%]{color:#000!important;background:#fff!important}.asset-image-container[_ngcontent-%COMP%]{border:1px solid #000!important;background:#fff!important;max-width:100%!important}.qr-section[_ngcontent-%COMP%], .barcode-section[_ngcontent-%COMP%]{text-align:center!important;page-break-inside:avoid}table[_ngcontent-%COMP%]{width:100%!important;border-collapse:collapse!important}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd!important;padding:8px!important}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{color:#000!important;page-break-after:avoid}.status-badge[_ngcontent-%COMP%]{border:1px solid #000!important;background:#fff!important;color:#000!important}}button[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}*[_ngcontent-%COMP%]{transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.asset-view[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9}.asset-view[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.asset-view[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.asset-view[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.asset-view[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}[_nghost-%COMP%]     .flatpickr-calendar{border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;border:1px solid #e5e7eb}[_nghost-%COMP%]     .flatpickr-day{border-radius:.375rem}[_nghost-%COMP%]     .flatpickr-day:hover{background-color:#eff6ff;border-color:#3b82f6}[_nghost-%COMP%]     .flatpickr-day.selected{background-color:#3b82f6;border-color:#3b82f6}[_nghost-%COMP%]     .flatpickr-day.today{border-color:#3b82f6;color:#3b82f6}[_nghost-%COMP%]     .flatpickr-months{background-color:#f8fafc;border-radius:.5rem .5rem 0 0}[_nghost-%COMP%]     .flatpickr-current-month{color:#1f2937;font-weight:600}[_nghost-%COMP%]     .flatpickr-weekday{color:#6b7280;font-weight:500}.value-display[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums}.section-header[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6;padding-bottom:.75rem;margin-bottom:1rem}.info-grid[_ngcontent-%COMP%]{display:grid;gap:1.5rem}@media (min-width: 768px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.ai-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#faf5ff,#f3e8ff);border:1px solid #e9d5ff}.financial-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border:1px solid #bbf7d0}.technical-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#eff6ff,#dbeafe);border:1px solid #bfdbfe}"]})};var uy=["fileInput"],hy=["dateInput"],my=()=>({standalone:!0});function py(t,n){t&1&&(d(0,"div",14)(1,"div",15)(2,"div",16),B(),d(3,"svg",17),D(4,"circle",18)(5,"path",19),u()(),q(),d(6,"h3",20),g(7,"Loading Asset"),u(),d(8,"p",21),g(9,"Please wait while we fetch the asset details..."),u()()())}function gy(t,n){if(t&1){let e=ue();d(0,"div",14)(1,"div",15)(2,"div",22),B(),d(3,"svg",23),D(4,"path",24),u()(),q(),d(5,"h3",20),g(6,"Error Loading Asset"),u(),d(7,"p",25),g(8),u(),d(9,"button",26),Y("click",function(){U(e);let r=b();return z(r.goBack())}),g(10," Back to Assets "),u()()()}if(t&2){let e=b();x(8),oe(e.error)}}function xy(t,n){if(t&1&&(d(0,"div",116),B(),d(1,"svg",117),D(2,"path",24),u(),g(3),u()),t&2){let e=b(2);x(3),xe(" ",e.nameError," ")}}function _y(t,n){t&1&&(d(0,"span",94),g(1,"Select parent asset"),u())}function vy(t,n){if(t&1&&(d(0,"span",118),g(1),u()),t&2){let e=b(2);x(),Ft(" ",e.getSelectedParent().name," (",e.getSelectedParent().asset_id,") ")}}function wy(t,n){if(t&1){let e=ue();d(0,"button",122),Y("click",function(){let r,a=U(e).$implicit,s=b(3);return(r=s.assetForm.get("parent_id"))==null||r.setValue(a.id),z(s.showParentDropdown=!1)}),d(1,"div",40)(2,"div",124),B(),d(3,"svg",125),D(4,"path",66),u()(),q(),d(5,"div")(6,"div",126),g(7),u(),d(8,"div",127),g(9),u()()()()}if(t&2){let e,i=n.$implicit,r=b(3);ge("bg-blue-50",((e=r.assetForm.get("parent_id"))==null?null:e.value)===i.id),x(7),oe(i.name),x(2),oe(i.asset_id)}}function by(t,n){if(t&1){let e=ue();d(0,"div",119)(1,"div",120)(2,"div",121),g(3,"Select parent asset"),u(),d(4,"button",122),Y("click",function(){let r;U(e);let a=b(2);return(r=a.assetForm.get("parent_id"))==null||r.setValue(null),z(a.showParentDropdown=!1)}),g(5," -- None -- "),u(),J(6,wy,10,4,"button",123),u()()}if(t&2){let e,i=b(2);x(4),ge("bg-blue-50",!((e=i.assetForm.get("parent_id"))!=null&&e.value)),x(2),C("ngForOf",i.possibleParents)}}function yy(t,n){t&1&&(d(0,"span",94),g(1,"Select asset type"),u())}function Sy(t,n){if(t&1){let e=ue();d(0,"img",131),Y("error",function(r){U(e);let a=b(3);return z(a.onAssetTypeIconError(r,a.selectedAssetType))}),u()}if(t&2){let e=b(3);C("src",e.selectedAssetType.icon,kt)("alt",e.selectedAssetType.name||e.selectedAssetType.label)}}function Cy(t,n){if(t&1&&(B(),d(0,"svg",132),D(1,"path",133),u()),t&2){let e=b(3);yt("color",e.selectedAssetType.color)}}function ky(t,n){if(t&1&&(d(0,"div",40)(1,"div",128),J(2,Sy,1,2,"img",129)(3,Cy,2,2,"svg",130),u(),d(4,"span",118),g(5),u()()),t&2){let e=b(2);x(),yt("background-color",e.selectedAssetType.color+"20"),x(),C("ngIf",e.selectedAssetType.icon&&!e.selectedAssetType.iconError),x(),C("ngIf",!e.selectedAssetType.icon||e.selectedAssetType.iconError),x(2),oe(e.selectedAssetType.label)}}function Ey(t,n){if(t&1){let e=ue();d(0,"img",138),Y("error",function(r){U(e);let a=b().$implicit,s=b(3);return z(s.onAssetTypeIconError(r,a))}),u()}if(t&2){let e=b().$implicit;C("src",e.icon,kt)("alt",e.name||e.label)}}function Ty(t,n){t&1&&(B(),d(0,"svg",31),D(1,"path",133),u())}function Ay(t,n){if(t&1){let e=ue();d(0,"button",122),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.selectAssetType(r))}),d(1,"div",40)(2,"div",135),J(3,Ey,1,2,"img",136)(4,Ty,2,0,"svg",137),u(),d(5,"div")(6,"div",126),g(7),u(),d(8,"div",21),g(9),u()()()()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",(i.selectedAssetType==null?null:i.selectedAssetType.id)===e.id)("text-blue-700",(i.selectedAssetType==null?null:i.selectedAssetType.id)===e.id),x(3),C("ngIf",e.icon&&!e.iconError),x(),C("ngIf",!e.icon||e.iconError),x(3),oe(e.label||e.name),x(2),oe(e.description)}}function My(t,n){if(t&1&&(d(0,"div",119)(1,"div",120)(2,"div",121),g(3,"Select asset type"),u(),J(4,Ay,10,8,"button",134),u()()),t&2){let e=b(2);x(4),C("ngForOf",e.assetTypes)}}function Dy(t,n){if(t&1&&(d(0,"div",116),B(),d(1,"svg",117),D(2,"path",24),u(),g(3),u()),t&2){let e=b(2);x(3),xe(" ",e.assetTypeError," ")}}function Fy(t,n){t&1&&(d(0,"span",94),g(1,"Select category"),u())}function Iy(t,n){if(t&1&&(d(0,"span",118),g(1),u()),t&2){let e=b(2);x(),oe(e.selectedCategory.name)}}function Py(t,n){if(t&1){let e=ue();d(0,"img",138),Y("error",function(r){U(e);let a=b().$implicit,s=b(3);return z(s.onCategoryIconError(r,a))}),u()}if(t&2){let e=b().$implicit;C("src",e.icon,kt)("alt",e.name)}}function Oy(t,n){t&1&&(B(),d(0,"svg",125),D(1,"path",66),u())}function Ly(t,n){if(t&1&&(d(0,"div",21),g(1),u()),t&2){let e=b().$implicit;x(),oe(e.description)}}function Ry(t,n){if(t&1){let e=ue();d(0,"button",122),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.selectCategory(r))}),d(1,"div",40)(2,"div",124),J(3,Py,1,2,"img",136)(4,Oy,2,0,"svg",139),u(),d(5,"div")(6,"div",126),g(7),u(),J(8,Ly,2,1,"div",96),u()()()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",(i.selectedCategory==null?null:i.selectedCategory.id)===e.id)("text-blue-700",(i.selectedCategory==null?null:i.selectedCategory.id)===e.id),x(3),C("ngIf",e.icon),x(),C("ngIf",!e.icon||e.iconError),x(3),oe(e.name),x(),C("ngIf",e.description)}}function Vy(t,n){if(t&1&&(d(0,"div",119)(1,"div",120)(2,"div",121),g(3,"Select category"),u(),J(4,Ry,9,8,"button",134),u()()),t&2){let e=b(2);x(4),C("ngForOf",e.categories)}}function Ny(t,n){if(t&1&&(d(0,"div",116),B(),d(1,"svg",117),D(2,"path",24),u(),g(3),u()),t&2){let e=b(2);x(3),xe(" ",e.categoryError," ")}}function By(t,n){if(t&1&&(d(0,"div",116),B(),d(1,"svg",117),D(2,"path",24),u(),g(3),u()),t&2){let e=b(2);x(3),xe(" ",e.serialNumberError," ")}}function Hy(t,n){t&1&&(d(0,"span",94),g(1,"Select location"),u())}function Uy(t,n){if(t&1&&(d(0,"div",40)(1,"div",140),B(),d(2,"svg",141),D(3,"path",90)(4,"path",91),u()(),q(),d(5,"span",118),g(6),u()()),t&2){let e=b(2);x(6),oe(e.selectedLocation.name)}}function zy(t,n){if(t&1&&(d(0,"div",21),g(1),u()),t&2){let e=b().$implicit;x(),oe(e.type.name)}}function Wy(t,n){if(t&1){let e=ue();d(0,"button",122),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.selectLocation(r))}),d(1,"div",40)(2,"div",142),B(),d(3,"svg",89),D(4,"path",90)(5,"path",91),u()(),q(),d(6,"div")(7,"div",126),g(8),u(),J(9,zy,2,1,"div",96),u()()()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",(i.selectedLocation==null?null:i.selectedLocation.id)===e.id)("text-blue-700",(i.selectedLocation==null?null:i.selectedLocation.id)===e.id),x(8),oe(e.name),x(),C("ngIf",e.type)}}function jy(t,n){if(t&1&&(d(0,"div",119)(1,"div",120)(2,"div",121),g(3,"Select location"),u(),J(4,Wy,10,6,"button",134),u()()),t&2){let e=b(2);x(4),C("ngForOf",e.locations)}}function Gy(t,n){t&1&&(d(0,"span",94),g(1,"Select department"),u())}function $y(t,n){if(t&1&&(d(0,"div",40)(1,"div",143),B(),d(2,"svg",144),D(3,"path",145),u()(),q(),d(4,"span",118),g(5),u()()),t&2){let e=b(2);x(5),oe(e.selectedDepartment.name)}}function Yy(t,n){if(t&1&&(d(0,"div",21),g(1),u()),t&2){let e=b().$implicit;x(),oe(e.description)}}function Xy(t,n){if(t&1&&(d(0,"div",148),g(1),u()),t&2){let e=b().$implicit;x(),xe("Code: ",e.code,"")}}function Ky(t,n){if(t&1){let e=ue();d(0,"button",122),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.selectDepartment(r))}),d(1,"div",40)(2,"div",146),B(),d(3,"svg",65),D(4,"path",145),u()(),q(),d(5,"div")(6,"div",126),g(7),u(),J(8,Yy,2,1,"div",96)(9,Xy,2,1,"div",147),u()()()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",(i.selectedDepartment==null?null:i.selectedDepartment.id)===e.id)("text-blue-700",(i.selectedDepartment==null?null:i.selectedDepartment.id)===e.id),x(7),oe(e.name),x(),C("ngIf",e.description),x(),C("ngIf",e.code)}}function qy(t,n){if(t&1&&(d(0,"div",119)(1,"div",120)(2,"div",121),g(3,"Select department"),u(),J(4,Ky,10,7,"button",134),u()()),t&2){let e=b(2);x(4),C("ngForOf",e.departments)}}function Jy(t,n){if(t&1&&(d(0,"div",40),D(1,"div",149),d(2,"span",118),g(3),u()()),t&2){let e=b(2);x(),yt("background-color",e.selectedStatus.hexColor||"#6B7280"),x(2),oe(e.selectedStatus.label)}}function Qy(t,n){if(t&1){let e=ue();d(0,"button",122),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.selectStatus(r))}),d(1,"div",40)(2,"div"),D(3,"div",149),u(),d(4,"div")(5,"div",126),g(6),u(),d(7,"div",21),g(8),u()()()()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",(i.selectedStatus==null?null:i.selectedStatus.value)===e.value)("text-blue-700",(i.selectedStatus==null?null:i.selectedStatus.value)===e.value),x(2),Ot("w-6 h-6 bg-"+e.color+"-100 rounded-lg flex items-center justify-center"),x(),yt("background-color",e.hexColor||"#6B7280"),x(3),oe(e.label),x(2),oe(e.description)}}function Zy(t,n){if(t&1&&(d(0,"div",150)(1,"div",120)(2,"div",121),g(3,"Select status"),u(),J(4,Qy,9,10,"button",134),u()()),t&2){let e=b(2);x(4),C("ngForOf",e.statusOptions)}}function e4(t,n){if(t&1){let e=ue();d(0,"span"),g(1),d(2,"button",154),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.removeTag(r))}),B(),d(3,"svg",155),D(4,"path",156),u()()()}if(t&2){let e=n.$implicit;Ot("inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-"+e.color+"-100 text-"+e.color+"-800"),x(),xe(" ",e.name," ")}}function t4(t,n){if(t&1&&(d(0,"div",151)(1,"div",152),J(2,e4,5,3,"span",153),u()()),t&2){let e=b(2);x(2),C("ngForOf",e.selectedTags)}}function n4(t,n){if(t&1&&(d(0,"span",21),g(1),u()),t&2){let e=b(2);x(),xe(" ",e.selectedTags.length," selected ")}}function i4(t,n){t&1&&(d(0,"div",161),B(),d(1,"svg",132),D(2,"path",162),u()())}function r4(t,n){if(t&1){let e=ue();d(0,"button",122),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.toggleTag(r))}),d(1,"div",46)(2,"div",40)(3,"div"),D(4,"div"),u(),d(5,"span",126),g(6),u()(),J(7,i4,3,0,"div",160),u()()}if(t&2){let e=n.$implicit,i=b(3);ge("bg-blue-50",i.isTagSelected(e)),x(3),Ot("w-6 h-6 bg-"+e.color+"-100 rounded-full flex items-center justify-center"),x(),Ot("w-3 h-3 rounded-full bg-"+e.color+"-500"),x(2),oe(e.name),x(),C("ngIf",i.isTagSelected(e))}}function a4(t,n){if(t&1){let e=ue();d(0,"div",119)(1,"div",120)(2,"div",157)(3,"div",79)(4,"input",158),ot("ngModelChange",function(r){U(e);let a=b(2);return st(a.newTagInput,r)||(a.newTagInput=r),z(r)}),Y("keydown",function(r){U(e);let a=b(2);return z(a.onTagInputKeydown(r))})("click",function(r){return U(e),z(r.stopPropagation())}),u(),d(5,"div",159),g(6," Press Enter "),u()()(),d(7,"div",121),g(8,"Select tags"),u(),J(9,r4,8,8,"button",123),u()()}if(t&2){let e=b(2);x(4),at("ngModel",e.newTagInput),C("ngModelOptions",Zr(3,my)),x(5),C("ngForOf",e.availableTags)}}function s4(t,n){if(t&1){let e=ue();d(0,"div",172)(1,"div",173)(2,"img",174),Y("error",function(r){let a=U(e).index,s=b(3);return z(s.onImageError(r,a))}),u(),d(3,"div",175)(4,"div",176)(5,"button",177),Y("click",function(){let r=U(e).$implicit,a=b(3);return z(a.viewFullImage(r.image_url))}),B(),d(6,"svg",132),D(7,"path",178)(8,"path",179),u()()()(),q(),d(9,"button",180),Y("click",function(){let r=U(e).index,a=b(3);return z(a.removeExistingImage(r))}),B(),d(10,"svg",132),D(11,"path",156),u()(),q(),d(12,"div",181),g(13," Existing "),u()(),d(14,"div",182)(15,"p",183),g(16),u(),d(17,"p",127),g(18,"Existing Image"),u()()()}if(t&2){let e=n.$implicit,i=n.index;x(2),C("src",e.image_url,kt)("alt","Existing Asset Image "+(i+1)),x(14),oe(e.image_path.split("/").pop())}}function o4(t,n){if(t&1){let e=ue();d(0,"button",177),Y("click",function(){U(e);let r=b().index,a=b(3);return z(a.moveImageUp(r))}),B(),d(1,"svg",132),D(2,"path",188),u()()}}function l4(t,n){if(t&1){let e=ue();d(0,"button",177),Y("click",function(){U(e);let r=b().index,a=b(3);return z(a.moveImageDown(r))}),B(),d(1,"svg",132),D(2,"path",50),u()()}}function c4(t,n){if(t&1){let e=ue();d(0,"div",172)(1,"div",173)(2,"img",184),Y("error",function(r){let a=U(e).index,s=b(3);return z(s.onImageError(r,s.existingImages.length+a))})("load",function(r){let a=U(e).index,s=b(3);return z(s.onImageLoad(r,s.existingImages.length+a))}),u(),d(3,"div",185)(4,"div",176),J(5,o4,3,0,"button",186)(6,l4,3,0,"button",186),u()(),d(7,"button",180),Y("click",function(){let r=U(e).index,a=b(3);return z(a.removeImage(r))}),B(),d(8,"svg",132),D(9,"path",156),u()(),q(),d(10,"div",187),g(11," New "),u()(),d(12,"div",182)(13,"p",183),g(14),u(),d(15,"p",127),g(16),u()()()}if(t&2){let e,i=n.$implicit,r=n.index,a=b(3);x(2),C("src",i,kt)("alt","Asset Image "+(r+1)),x(3),C("ngIf",r>0),x(),C("ngIf",r<a.imagePreviewUrls.length-1),x(8),oe(a.images[r]==null?null:a.images[r].name),x(2),xe("",(((e=a.images[r]==null?null:a.images[r].size)!==null&&e!==void 0?e:0)/1024/1024).toFixed(1)," MB")}}function d4(t,n){if(t&1){let e=ue();d(0,"div",163)(1,"div",164)(2,"h4",165),g(3),u(),d(4,"button",166),Y("click",function(){U(e);let r=b(2);return r.removeAllImages(),z(r.removeAllExistingImages())}),g(5," Remove All "),u()(),d(6,"div",167),J(7,s4,19,3,"div",168)(8,c4,17,6,"div",168),u(),d(9,"div",169)(10,"div",95),B(),d(11,"svg",170),D(12,"path",98),u(),q(),d(13,"p",171)(14,"strong"),g(15,"Gallery Tips:"),u(),g(16," Existing images are preserved. New images can be reordered. Green badges indicate existing images, blue badges indicate new uploads. "),u()()()()}if(t&2){let e=b(2);x(3),xe("Asset Images (",e.existingImages.length+e.imagePreviewUrls.length,")"),x(4),C("ngForOf",e.existingImages),x(),C("ngForOf",e.imagePreviewUrls)}}function f4(t,n){if(t&1&&(d(0,"div",189)(1,"div",95),B(),d(2,"svg",190),D(3,"path",24),u(),q(),d(4,"p",191),g(5),u()()()),t&2){let e=b(2);x(5),oe(e.submitError)}}function u4(t,n){if(t&1&&(d(0,"div",192)(1,"div",95),B(),d(2,"svg",70),D(3,"path",162),u(),q(),d(4,"p",193),g(5),u()()()),t&2){let e=b(2);x(5),oe(e.submitSuccess)}}function h4(t,n){t&1&&(d(0,"span",95),B(),d(1,"svg",194),D(2,"path",162),u(),q(),d(3,"span"),g(4,"Update Asset"),u()())}function m4(t,n){t&1&&(d(0,"span",95),B(),d(1,"svg",195),D(2,"circle",18)(3,"path",19),u(),q(),d(4,"span"),g(5,"Updating Asset..."),u()())}function p4(t,n){if(t&1){let e=ue();d(0,"div")(1,"form",27),Y("ngSubmit",function(){U(e);let r=b();return z(r.onSubmit())}),d(2,"div",28)(3,"div",29)(4,"div",30),B(),d(5,"svg",31),D(6,"path",32),u()(),q(),d(7,"h2",33),g(8,"Basic Information"),u()(),d(9,"div",34)(10,"div")(11,"label",35),g(12," Asset Name "),d(13,"span",36),g(14,"*"),u()(),D(15,"input",37),J(16,xy,4,1,"div",38),d(17,"div",39),g(18,"Maximum 100 characters"),u()(),d(19,"div")(20,"label",35),g(21,"Asset ID"),u(),d(22,"div",40),D(23,"input",41),d(24,"span",42),g(25," auto-generated "),u()(),d(26,"p",39),g(27,"Unique identifier automatically assigned"),u()()(),d(28,"div",43)(29,"label",35),g(30,"Parent Asset"),u(),d(31,"div",44),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(32,"button",45),Y("click",function(){U(e);let r=b();return z(r.showParentDropdown=!r.showParentDropdown)}),d(33,"div",46),J(34,_y,2,0,"span",47)(35,vy,2,2,"span",48),B(),d(36,"svg",49),D(37,"path",50),u()()(),J(38,by,7,3,"div",51),u(),q(),d(39,"div",39),g(40,"Optional: Select a parent asset if this asset is a child of another."),u()(),d(41,"div",43)(42,"label",35),g(43,"Description"),u(),D(44,"textarea",52),d(45,"div",39),g(46,"Maximum 500 characters"),u()(),d(47,"div")(48,"label",53),g(49,"Health Score"),u(),d(50,"div",54)(51,"div",55)(52,"span",56),g(53,"Current Score"),u(),d(54,"span",57),g(55),u()(),d(56,"div",58),D(57,"div",59)(58,"div",60)(59,"input",61)(60,"div",62),u(),d(61,"div",63)(62,"span"),g(63,"Poor (0%)"),u(),d(64,"span"),g(65,"Fair (25%)"),u(),d(66,"span"),g(67,"Good (50%)"),u(),d(68,"span"),g(69,"Very Good (75%)"),u(),d(70,"span"),g(71,"Excellent (100%)"),u()()()()(),d(72,"div",28)(73,"div",29)(74,"div",64),B(),d(75,"svg",65),D(76,"path",66),u()(),q(),d(77,"h2",33),g(78,"Asset Classification"),u()(),d(79,"div",67)(80,"div")(81,"label",35),g(82," Asset Type "),d(83,"span",36),g(84,"*"),u()(),d(85,"div",44),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(86,"button",45),Y("click",function(){U(e);let r=b();return z(r.toggleAssetTypeDropdown())}),d(87,"div",46),J(88,yy,2,0,"span",47)(89,ky,6,5,"div",68),B(),d(90,"svg",49),D(91,"path",50),u()()(),J(92,My,5,1,"div",51),u(),J(93,Dy,4,1,"div",38),u(),q(),d(94,"div")(95,"label",35),g(96," Category "),d(97,"span",36),g(98,"*"),u()(),d(99,"div",44),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(100,"button",45),Y("click",function(){U(e);let r=b();return z(r.toggleCategoryDropdown())}),d(101,"div",46),J(102,Fy,2,0,"span",47)(103,Iy,2,1,"span",48),B(),d(104,"svg",49),D(105,"path",50),u()()(),J(106,Vy,5,1,"div",51),u(),J(107,Ny,4,1,"div",38),u()()(),q(),d(108,"div",28)(109,"div",29)(110,"div",69),B(),d(111,"svg",70),D(112,"path",71),u()(),q(),d(113,"h2",33),g(114,"Technical Details"),u()(),d(115,"div",72)(116,"div")(117,"label",35),g(118,"Manufacturer"),u(),D(119,"input",73),d(120,"div",39),g(121,"Maximum 100 characters"),u()(),d(122,"div")(123,"label",35),g(124,"Model"),u(),D(125,"input",74),d(126,"div",39),g(127,"Maximum 100 characters"),u()(),d(128,"div")(129,"label",35),g(130," Serial Number "),d(131,"span",36),g(132,"*"),u()(),D(133,"input",75),J(134,By,4,1,"div",38),d(135,"div",39),g(136,"Required, max 100 chars, must be unique within your company"),u()()()(),d(137,"div",28)(138,"div",29)(139,"div",76),B(),d(140,"svg",77),D(141,"path",78),u()(),q(),d(142,"h2",33),g(143,"Financial Information"),u()(),d(144,"div",34)(145,"div")(146,"label",35),g(147,"Purchase Value (USD)"),u(),d(148,"div",79)(149,"div",80)(150,"span",81),g(151,"$ "),u()(),D(152,"input",82),u(),d(153,"div",39),g(154,"Must be a non-negative number"),u()(),d(155,"div")(156,"label",35),g(157,"Purchase Date"),u(),D(158,"input",83,0),d(160,"div",39),g(161,"Cannot be in the future"),u()()(),d(162,"div",34)(163,"div")(164,"label",35),g(165,"Depreciation Rate (%)"),u(),D(166,"input",84),d(167,"div",39),g(168,"Annual depreciation rate (0-100%)"),u()(),d(169,"div")(170,"label",35),g(171,"Depreciation Life (Years)"),u(),D(172,"input",85),d(173,"div",39),g(174,"Useful life for depreciation calculation (1-100 years)"),u()()(),d(175,"div",34)(176,"div")(177,"label",35),g(178,"Warranty Information"),u(),D(179,"input",86),d(180,"div",39),g(181,"Warranty details (max 255 characters)"),u()(),d(182,"div")(183,"label",35),g(184,"Insurance Information"),u(),D(185,"input",87),d(186,"div",39),g(187,"Insurance details (max 255 characters)"),u()()()(),d(188,"div",28)(189,"div",29)(190,"div",88),B(),d(191,"svg",89),D(192,"path",90)(193,"path",91),u()(),q(),d(194,"h2",33),g(195,"Location & Assignment"),u()(),d(196,"div",67)(197,"div")(198,"label",35),g(199,"Location"),u(),d(200,"div",44),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(201,"button",45),Y("click",function(){U(e);let r=b();return z(r.toggleLocationDropdown())}),d(202,"div",46),J(203,Hy,2,0,"span",47)(204,Uy,7,1,"div",68),B(),d(205,"svg",49),D(206,"path",50),u()()(),J(207,jy,5,1,"div",51),u()(),q(),d(208,"div")(209,"label",35),g(210,"Department ID"),u(),d(211,"div",44),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(212,"button",45),Y("click",function(){U(e);let r=b();return z(r.toggleDepartmentDropdown())}),d(213,"div",46),J(214,Gy,2,0,"span",47)(215,$y,6,1,"div",68),B(),d(216,"svg",49),D(217,"path",50),u()()(),J(218,qy,5,1,"div",51),u(),q(),d(219,"div",39),g(220,"Optional department assignment"),u()(),d(221,"div")(222,"label",35),g(223,"Status"),u(),d(224,"div",44),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(225,"button",45),Y("click",function(){U(e);let r=b();return z(r.toggleStatusDropdown())}),d(226,"div",46),J(227,Jy,4,3,"div",68),B(),d(228,"svg",49),D(229,"path",50),u()()(),J(230,Zy,5,1,"div",92),u(),q(),d(231,"div",39),g(232,"Current operational status of the asset"),u()(),d(233,"div")(234,"label",35),g(235,"Tags"),u(),J(236,t4,3,1,"div",93),d(237,"div",44),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(238,"button",45),Y("click",function(){U(e);let r=b();return z(r.toggleTagsDropdown())}),d(239,"div",46)(240,"span",94),g(241),u(),d(242,"div",95),J(243,n4,2,1,"span",96),B(),d(244,"svg",49),D(245,"path",50),u()()()(),J(246,a4,10,4,"div",51),u(),q(),d(247,"div",39),B(),d(248,"svg",97),D(249,"path",98),u(),g(250," Select existing tags or type to create new ones. Press Enter to add custom tags. "),u()()()(),q(),d(251,"div",28)(252,"div",29)(253,"div",99),B(),d(254,"svg",100),D(255,"path",101),u()(),q(),d(256,"h2",33),g(257,"Asset Image"),u()(),d(258,"div")(259,"label",35),g(260,"Upload Image"),u(),d(261,"div",102),Y("click",function(){U(e);let r=b();return z(r.triggerFileInput())})("dragover",function(r){U(e);let a=b();return z(a.onDragOver(r))})("dragleave",function(r){U(e);let a=b();return z(a.onDragLeave(r))})("drop",function(r){U(e);let a=b();return z(a.onDrop(r))}),d(262,"div",103)(263,"div",104),B(),d(264,"svg",105),D(265,"path",106),u()(),q(),d(266,"p",107),g(267),u(),d(268,"input",108,1),Y("change",function(r){U(e);let a=b();return z(a.onFileChange(r))}),u()()(),J(270,d4,17,3,"div",109),u()(),J(271,f4,6,1,"div",110)(272,u4,6,1,"div",111),d(273,"div",112)(274,"button",113),Y("click",function(){U(e);let r=b();return z(r.goBack())}),g(275," Cancel "),u(),d(276,"button",114),J(277,h4,5,0,"span",115)(278,m4,6,0,"span",115),u()()()()}if(t&2){let e,i,r,a,s,o,l,c,f,h,m,p=b();x(),C("formGroup",p.assetForm),x(14),ge("border-red-300",p.nameError),x(),C("ngIf",p.nameError),x(7),C("value",(p.asset==null?null:p.asset.asset_id)||(p.asset==null?null:p.asset.id)),x(9),ge("border-blue-500",p.showParentDropdown),x(2),C("ngIf",!((e=p.assetForm.get("parent_id"))!=null&&e.value)),x(),C("ngIf",((i=p.assetForm.get("parent_id"))==null?null:i.value)&&p.getSelectedParent()),x(),ge("rotate-180",p.showParentDropdown),x(2),C("ngIf",p.showParentDropdown),x(16),ge("text-red-600",(((r=p.assetForm.get("health_score"))==null?null:r.value)||85)<50)("text-green-600",(((a=p.assetForm.get("health_score"))==null?null:a.value)||85)>=50),x(),xe("",((s=p.assetForm.get("health_score"))==null?null:s.value)||85,"%"),x(3),yt("width",((o=p.assetForm.get("health_score"))==null?null:o.value)||85,"%"),ge("bg-red-500",(((l=p.assetForm.get("health_score"))==null?null:l.value)||85)<50)("bg-green-500",(((c=p.assetForm.get("health_score"))==null?null:c.value)||85)>=50),x(2),yt("left",((f=p.assetForm.get("health_score"))==null?null:f.value)||85,"%"),ge("bg-red-500",(((h=p.assetForm.get("health_score"))==null?null:h.value)||85)<50)("bg-green-500",(((m=p.assetForm.get("health_score"))==null?null:m.value)||85)>=50),x(26),ge("border-red-300",p.assetTypeError)("border-blue-500",p.showAssetTypeDropdown),x(2),C("ngIf",!p.selectedAssetType),x(),C("ngIf",p.selectedAssetType),x(),ge("rotate-180",p.showAssetTypeDropdown),x(2),C("ngIf",p.showAssetTypeDropdown),x(),C("ngIf",p.assetTypeError),x(7),ge("border-red-300",p.categoryError)("border-blue-500",p.showCategoryDropdown),x(2),C("ngIf",!p.selectedCategory),x(),C("ngIf",p.selectedCategory),x(),ge("rotate-180",p.showCategoryDropdown),x(2),C("ngIf",p.showCategoryDropdown),x(),C("ngIf",p.categoryError),x(26),ge("border-red-300",p.serialNumberError),x(),C("ngIf",p.serialNumberError),x(67),ge("border-blue-500",p.showLocationDropdown),x(2),C("ngIf",!p.selectedLocation),x(),C("ngIf",p.selectedLocation),x(),ge("rotate-180",p.showLocationDropdown),x(2),C("ngIf",p.showLocationDropdown),x(5),ge("border-blue-500",p.showDepartmentDropdown),x(2),C("ngIf",!p.selectedDepartment),x(),C("ngIf",p.selectedDepartment),x(),ge("rotate-180",p.showDepartmentDropdown),x(2),C("ngIf",p.showDepartmentDropdown),x(7),ge("border-blue-500",p.showStatusDropdown),x(2),C("ngIf",p.selectedStatus),x(),ge("rotate-180",p.showStatusDropdown),x(2),C("ngIf",p.showStatusDropdown),x(6),C("ngIf",p.selectedTags.length>0),x(2),ge("border-blue-500",p.showTagsDropdown),x(3),xe(" ",p.selectedTags.length===0?"Select tags":"Add more tags"," "),x(2),C("ngIf",p.selectedTags.length>0),x(),ge("rotate-180",p.showTagsDropdown),x(2),C("ngIf",p.showTagsDropdown),x(15),ge("border-gray-300",!p.isDragOver)("border-blue-500",p.isDragOver)("bg-blue-50",p.isDragOver)("hover:border-blue-400",!p.isDragOver),x(3),ge("text-gray-400",!p.isDragOver)("text-blue-500",p.isDragOver),x(2),ge("text-gray-500",!p.isDragOver)("text-blue-600",p.isDragOver),x(),xe(" ",p.isDragOver?"Release to upload images":"PNG, JPG, GIF up to 10MB - click to browse or drag and drop files here"," "),x(3),C("ngIf",p.existingImages.length>0||p.imagePreviewUrls.length>0),x(),C("ngIf",p.submitError),x(),C("ngIf",p.submitSuccess),x(2),C("disabled",p.saving),x(2),C("disabled",p.saving||!p.isFormValid()),x(),C("ngIf",!p.saving),x(),C("ngIf",p.saving)}}var ya=class t{constructor(n,e,i,r,a){this.fb=n;this.route=e;this.router=i;this.assetService=r;this.angularLocation=a;this.assetForm=this.fb.group({name:["",[ai.required,ai.minLength(2)]],description:[""],serial_number:["",[ai.required,ai.minLength(3)]],model:[""],manufacturer:[""],purchase_date:[""],purchase_price:[null],depreciation:[null],depreciation_life:[null],location_id:[null],department_id:[null],parent_id:[null],warranty:[""],insurance:[""],health_score:[85,[ai.min(0),ai.max(100)]],status:[null],type:[null,ai.required],category_id:[null,ai.required],tags:[[]]})}destroy$=new Jr;dateInputs;fileInput;flatpickrInstances=[];asset=null;assetForm;loading=!0;saving=!1;error="";successMessage="";categories=[];locations=[];departments=[];availableTags=[];statusOptionsFromAPI=[];showAssetTypeDropdown=!1;showCategoryDropdown=!1;showLocationDropdown=!1;showStatusDropdown=!1;showTagsDropdown=!1;showDepartmentDropdown=!1;showParentDropdown=!1;selectedAssetType=null;selectedCategory=null;selectedLocation=null;selectedStatus=null;selectedDepartment=null;selectedTags=[];newTagInput="";assetTypes=[];assetTypesFromAPI=[];statusOptions=[{value:1,label:"Active",color:"green",description:"Asset is operational and in use",sort_order:1},{value:2,label:"Maintenance",color:"orange",description:"Asset is under maintenance or repair",sort_order:2},{value:3,label:"Inactive",color:"gray",description:"Asset is not currently in use",sort_order:3},{value:4,label:"Retired",color:"red",description:"Asset is retired and no longer in service",sort_order:4}];previewImage=null;selectedFile=null;images=[];imagePreviewUrls=[];existingImages=[];removedImageIds=[];isDragOver=!1;nameError="";assetTypeError="";categoryError="";serialNumberError="";submitError="";submitSuccess="";possibleParents=[];ngOnInit(){this.route.params.pipe(rt(this.destroy$)).subscribe(n=>{let e=n.id;e&&(this.loadAsset(e),this.assetService.getPossibleParents(e).subscribe(i=>{i.success&&i.data?.possible_parents&&(this.possibleParents=i.data.possible_parents)}))}),this.loadAssetTypes(),this.loadCategories(),this.loadLocations(),this.loadDepartments(),this.loadAvailableTags(),this.loadAssetStatuses()}ngAfterViewInit(){setTimeout(()=>{this.initializeFlatpickr()},100)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.flatpickrInstances.forEach(n=>{n&&n.destroy()})}initializeFlatpickr(){this.flatpickrInstances.forEach(n=>{n&&n.destroy()}),this.flatpickrInstances=[],setTimeout(()=>{this.dateInputs&&this.dateInputs.forEach((n,e)=>{if(n?.nativeElement){let i=n.nativeElement,r=i.getAttribute("formControlName");if(console.log("Processing date input:",r),r==="purchase_date"){console.log("Initializing Flatpickr for purchase_date");let a={dateFormat:"d M, Y",allowInput:!0,clickOpens:!0,maxDate:"today",defaultDate:null,onChange:(l,c)=>{console.log("Date selected:",c),this.assetForm.get("purchase_date")?.setValue(c)}},s=this.assetForm.get("purchase_date")?.value;s&&(a.defaultDate=this.convertDisplayDateToDate(s));let o=rr(i,a);this.flatpickrInstances.push(o),console.log("Flatpickr initialized successfully for purchase_date")}}})},50)}loadAsset(n){this.loading=!0,this.error="",this.assetService.getAsset(n).pipe(rt(this.destroy$)).subscribe({next:e=>{e.success?(this.asset=e.data.asset||e.data,this.populateForm()):this.error=e.message||"Failed to load asset",this.loading=!1},error:e=>{this.error=e.error?.message||"An error occurred while loading the asset",this.loading=!1}})}populateForm(){if(this.asset){let n=this.asset.purchase_date?this.convertBackendDateToDisplay(this.asset.purchase_date):"",e=this.asset.warranty?this.convertBackendDateToDisplay(this.asset.warranty):"";this.assetForm.patchValue({name:this.asset.name||"",description:this.asset.description||"",serial_number:this.asset.serial_number||"",model:this.asset.model||"",manufacturer:this.asset.manufacturer||"",purchase_date:n,purchase_price:this.asset.purchase_price||null,depreciation:this.asset.depreciation||null,depreciation_life:this.asset.depreciation_life||null,location_id:this.asset.location_id||null,department_id:this.asset.department_id||null,warranty:e,insurance:this.asset.insurance||"",health_score:this.asset.health_score||85,status:this.asset.status||null,type:this.asset.type||"",category_id:this.asset.category_id||null,tags:this.asset.tags||[],parent_id:this.asset.parent_id||null}),this.asset.images&&Array.isArray(this.asset.images)&&(this.existingImages=this.asset.images),setTimeout(()=>{this.selectedAssetType=this.assetTypes.find(i=>i.id==this.asset.type)||null,this.selectedCategory=this.categories.find(i=>i.id===this.asset.category_id)||null,this.selectedLocation=this.locations.find(i=>i.id===this.asset.location_id)||null,this.selectedDepartment=this.departments.find(i=>i.id===this.asset.department_id)||null,this.selectedStatus=this.statusOptions.find(i=>i.value===this.asset.status||i.label===this.asset.status||i.id===this.asset.status)||null,this.selectedStatus&&this.assetForm.patchValue({status:this.selectedStatus.value}),this.asset.tags&&Array.isArray(this.asset.tags)&&(this.selectedTags=this.asset.tags.map(i=>this.availableTags.find(r=>r.id===i.id)||i)),this.assetForm.markAllAsTouched(),this.assetForm.updateValueAndValidity(),setTimeout(()=>{this.initializeFlatpickr()},100)},100)}}loadAssetTypes(){this.assetService.getAssetTypes().pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&n.data&&(this.assetTypesFromAPI=n.data,this.assetTypes=this.assetTypesFromAPI.map(e=>({id:e.id,name:e.name,label:e.name,value:e.name,icon:e.icon,color:this.getColorForType(e.name),description:`${e.name} asset type`,iconError:!1})),this.asset&&this.populateForm())},error:n=>{console.error("Error loading asset types:",n)}})}loadCategories(){this.assetService.getAssetCategories().pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&n.data?.categories&&(this.categories=n.data.categories,this.asset&&this.populateForm())},error:n=>{console.error("Error loading categories:",n)}})}loadLocations(){this.assetService.getLocations().pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&n.data&&(this.locations=n.data.locations||n.data,this.asset&&this.populateForm())},error:n=>{console.error("Error loading locations:",n)}})}loadDepartments(){this.assetService.getDepartments().pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&n.data&&(this.departments=n.data,this.asset&&this.populateForm())},error:n=>{console.error("Error loading departments:",n)}})}loadAvailableTags(){this.availableTags=[{id:1,name:"Critical",color:"red"},{id:2,name:"High Priority",color:"orange"},{id:3,name:"Equipment",color:"blue"},{id:4,name:"IT Hardware",color:"purple"},{id:5,name:"Furniture",color:"green"},{id:6,name:"Vehicle",color:"yellow"},{id:7,name:"Safety Equipment",color:"red"},{id:8,name:"Office Supplies",color:"gray"}]}loadAssetStatuses(){this.assetService.getAssetStatuses().pipe(rt(this.destroy$)).subscribe({next:n=>{n.success&&n.data&&(this.statusOptionsFromAPI=n.data,this.statusOptions=this.statusOptionsFromAPI.map(e=>({id:e.id,value:e.id,label:e.name,color:this.hexToTailwindColor(e.color),description:e.description||`Asset is ${e.name.toLowerCase()}`,hexColor:e.color,sort_order:e.sort_order})),this.statusOptions.sort((e,i)=>e.sort_order-i.sort_order),this.asset&&this.populateForm())},error:n=>{console.error("Error loading asset statuses:",n)}})}hexToTailwindColor(n){return{"#10B981":"green","#F59E0B":"orange","#9CA3AF":"gray","#EF4444":"red","#6B7280":"gray","#22C55E":"green","#3B82F6":"blue","#8B5CF6":"purple","#F97316":"orange"}[n.toUpperCase()]||"gray"}getColorForType(n){return{"Fixed Asset":"#2563eb","Semi-Fixed Asset":"#22c55e","Mobile Asset":"#f59e42","Fleet Asset":"#a855f7","IT Equipment":"#3b82f6",Furniture:"#10b981",Vehicle:"#f59e0b",Machinery:"#ef4444",Electronics:"#8b5cf6",Tools:"#f97316"}[n]||"#6b7280"}onAssetTypeIconError(n,e){console.warn("Asset type icon failed to load:",e.name,e.icon),e.iconError=!0,n.target.style.display="none"}toggleAssetTypeDropdown(){this.showAssetTypeDropdown=!this.showAssetTypeDropdown,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showTagsDropdown=!1,this.showDepartmentDropdown=!1}toggleCategoryDropdown(){this.showCategoryDropdown=!this.showCategoryDropdown,this.showAssetTypeDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showTagsDropdown=!1,this.showDepartmentDropdown=!1}toggleLocationDropdown(){this.showLocationDropdown=!this.showLocationDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showStatusDropdown=!1,this.showTagsDropdown=!1,this.showDepartmentDropdown=!1}toggleStatusDropdown(){this.showStatusDropdown=!this.showStatusDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showTagsDropdown=!1,this.showDepartmentDropdown=!1}toggleTagsDropdown(){this.showTagsDropdown=!this.showTagsDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showDepartmentDropdown=!1}toggleDepartmentDropdown(){this.showDepartmentDropdown=!this.showDepartmentDropdown,this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showTagsDropdown=!1}selectAssetType(n){this.selectedAssetType=n,this.assetForm.patchValue({type:n.id}),this.showAssetTypeDropdown=!1,this.clearErrors()}selectCategory(n){this.selectedCategory=n,this.assetForm.patchValue({category_id:n.id}),this.showCategoryDropdown=!1,this.clearErrors()}selectLocation(n){this.selectedLocation=n,this.assetForm.patchValue({location_id:n.id}),this.showLocationDropdown=!1}selectStatus(n){this.selectedStatus=n,this.assetForm.patchValue({status:n.value}),this.showStatusDropdown=!1}selectDepartment(n){this.selectedDepartment=n,this.assetForm.patchValue({department_id:n.id}),this.showDepartmentDropdown=!1}toggleTag(n){let e=this.selectedTags.findIndex(i=>i.id===n.id);e>-1?this.selectedTags.splice(e,1):this.selectedTags.push(n)}isTagSelected(n){return this.selectedTags.some(e=>e.id===n.id)}onTagInputKeydown(n){n.key==="Enter"&&(n.preventDefault(),this.createNewTag())}createNewTag(){let n=this.newTagInput.trim();if(n&&!this.selectedTags.some(e=>e.name.toLowerCase()===n.toLowerCase())){let e=["red","blue","green","yellow","purple","pink","indigo","gray"],i=e[Math.floor(Math.random()*e.length)],r={id:Date.now(),name:n,color:i,isNew:!0};this.selectedTags.push(r),this.newTagInput=""}}removeTag(n){let e=this.selectedTags.findIndex(i=>i.id===n.id);e>-1&&this.selectedTags.splice(e,1)}onFileChange(n){if(n.target.files&&n.target.files.length){let e=Array.from(n.target.files);this.processFiles(e),n.target.value=""}}onDragOver(n){n.preventDefault(),n.stopPropagation(),this.isDragOver=!0}onDragLeave(n){n.preventDefault(),n.stopPropagation(),this.isDragOver=!1}onDrop(n){n.preventDefault(),n.stopPropagation(),this.isDragOver=!1;let e=n.dataTransfer?.files;if(e&&e.length>0){let i=Array.from(e).filter(r=>r.type.startsWith("image/"));i.length>0&&this.processFiles(i)}}processFiles(n){let i=["image/jpeg","image/png","image/gif","image/webp"],r=[];for(let a of n){if(!i.includes(a.type)){console.warn("Invalid file type:",a.name);continue}if(a.size>10*1024*1024){console.warn("File too large:",a.name);continue}if(this.images.some(l=>l.name===a.name&&l.size===a.size)){console.warn("Duplicate file skipped:",a.name);continue}if(this.images.length+r.length>=10){console.warn("Max image count exceeded:",a.name);break}r.push(a);let o=new FileReader;o.onload=l=>{l.target?.result&&this.imagePreviewUrls.push(l.target.result)},o.onerror=l=>{console.error("Preview failed for:",a.name,l)},o.readAsDataURL(a)}this.images=[...this.images,...r]}removeImage(n){this.images.splice(n,1),this.imagePreviewUrls.splice(n,1)}removeAllImages(){this.images=[],this.imagePreviewUrls=[]}removeExistingImage(n){let e=this.existingImages[n];e&&e.id&&this.removedImageIds.push(e.id),this.existingImages.splice(n,1)}removeAllExistingImages(){this.existingImages.forEach(n=>{n&&n.id&&this.removedImageIds.push(n.id)}),this.existingImages=[]}moveImage(n,e){if(e>=0&&e<this.images.length){let i=this.images.splice(n,1)[0];this.images.splice(e,0,i);let r=this.imagePreviewUrls.splice(n,1)[0];this.imagePreviewUrls.splice(e,0,r)}}moveImageUp(n){n>0&&this.moveImage(n,n-1)}moveImageDown(n){n<this.images.length-1&&this.moveImage(n,n+1)}triggerFileInput(){this.fileInput.nativeElement.click()}onImageError(n,e){console.warn("Image failed to load at index:",e),n.target.onerror=null,n.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xMiA5VjEzTTEyIDE3SDE2TTE2IDlIMTJNMTIgOUw4IDEzTDEyIDE3IiBzdHJva2U9IiM5Q0EzQUYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjwvc3ZnPgo="}onImageLoad(n,e){console.log("Image loaded successfully at index:",e)}viewFullImage(n){window.open(n,"_blank")}convertImagesToBase64(){return Promise.all(this.images.map(n=>new Promise((e,i)=>{let r=new FileReader;r.onload=()=>{r.result?e(r.result):i(new Error("Failed to read file"))},r.onerror=()=>i(r.error),r.readAsDataURL(n)})))}onCategoryIconError(n,e){console.warn("Category icon failed to load:",e.name,e.icon),e.iconError=!0,n.target.style.display="none"}validateForm(){let n=!0;this.clearErrors(),!this.assetForm.get("name")?.value||this.assetForm.get("name")?.value.trim().length===0?(this.nameError="Asset name is required",n=!1):this.assetForm.get("name")?.value.trim().length>100&&(this.nameError="Asset name cannot exceed 100 characters",n=!1),this.selectedAssetType||(this.assetTypeError="Asset type is required",n=!1),this.selectedCategory||(this.categoryError="Category is required",n=!1);let e=this.assetForm.get("serial_number")?.value;return e&&e.trim().length===0?(this.serialNumberError="Serial number cannot be empty if provided",n=!1):e&&e.length>255&&(this.serialNumberError="Serial number cannot exceed 255 characters",n=!1),n}clearErrors(){this.nameError="",this.assetTypeError="",this.categoryError="",this.serialNumberError="",this.submitError="",this.submitSuccess=""}onSubmit(){!this.validateForm()||this.saving||!this.asset||this.assetForm.valid&&!this.saving&&this.asset&&(this.saving=!0,this.error="",this.successMessage="",this.submitError="",this.submitSuccess="",this.convertImagesToBase64().then(n=>{let e=this.assetForm.value;e.tags=this.selectedTags.map(i=>i.name),e.purchase_date&&(e.purchase_date=this.convertDateToBackendFormat(e.purchase_date)),e.warranty&&(e.warranty=this.convertDateToBackendFormat(e.warranty)),e.images=n,e.existing_images=this.existingImages.map(i=>i.id||i.image_url),this.removedImageIds.length>0&&(e.remove_image_ids=this.removedImageIds),this.assetService.updateAsset(this.asset.id,e).pipe(rt(this.destroy$)).subscribe({next:i=>{i.success?(this.submitSuccess="Asset updated successfully!",setTimeout(()=>{this.router.navigate(["/assets/preview",this.asset.id])},2e3)):this.submitError=i.message||"Failed to update asset",this.saving=!1},error:i=>{this.submitError=i.error?.message||"An error occurred while updating the asset",this.saving=!1}})}).catch(n=>{this.saving=!1,this.submitError="Failed to process images. Please try again.",console.error("Image conversion error:",n)}))}goBack(){this.angularLocation.back()}onDocumentClick(n){this.showAssetTypeDropdown=!1,this.showCategoryDropdown=!1,this.showLocationDropdown=!1,this.showStatusDropdown=!1,this.showTagsDropdown=!1,this.showDepartmentDropdown=!1}isFormValid(){return this.assetForm.valid&&this.selectedAssetType!==null&&this.selectedCategory!==null&&!this.nameError&&!this.assetTypeError&&!this.categoryError&&!this.serialNumberError}getSelectedParent(){return this.possibleParents.find(n=>n.id===this.assetForm.get("parent_id")?.value)}convertDateToBackendFormat(n){if(!n)return"";try{let e=new Date(n);if(isNaN(e.getTime()))return n;let i=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${i}-${r}-${a}`}catch(e){return console.error("Date conversion error:",e),n}}convertBackendDateToDisplay(n){if(!n)return"";try{let e=new Date(n);if(isNaN(e.getTime()))return n;let i={day:"2-digit",month:"short",year:"numeric"};return e.toLocaleDateString("en-GB",i).replace(/,/g,",")}catch(e){return console.error("Date conversion error:",e),n}}convertDisplayDateToDate(n){if(!n)return null;try{let e=new Date(n);return isNaN(e.getTime())?null:e}catch(e){return console.error("Date conversion error:",e),null}}static \u0275fac=function(e){return new(e||t)(ft(no),ft(ea),ft(_i),ft(Kn),ft(Ws))};static \u0275cmp=Yt({type:t,selectors:[["app-asset-edit"]],viewQuery:function(e,i){if(e&1&&(pi(uy,5),pi(hy,5)),e&2){let r;gi(r=xi())&&(i.fileInput=r.first),gi(r=xi())&&(i.dateInputs=r)}},hostBindings:function(e,i){e&1&&Y("click",function(a){return i.onDocumentClick(a)},!1,Qr)},decls:16,vars:3,consts:[["dateInput",""],["fileInput",""],[1,"min-h-screen","bg-gray-50","p-6"],[1,"asset-edit-page"],[1,"mb-8"],[1,"flex","items-center","space-x-4","mb-4"],["type","button",1,"flex","items-center","space-x-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"font-medium"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],["class","flex items-center justify-center py-20",4,"ngIf"],[4,"ngIf"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-blue-100","rounded-full","mb-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-8","h-8","text-blue-600"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-red-100","rounded-full","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-sm","text-gray-500","mb-4"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[3,"ngSubmit","formGroup"],[1,"section-card"],[1,"flex","items-center","space-x-3","mb-6"],[1,"w-10","h-10","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"section-title"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mb-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","text","placeholder","e.g., Main Server Room AC Unit","formControlName","name",1,"input"],["class","text-red-600 text-sm mt-1",4,"ngIf"],[1,"text-xs","text-gray-500","mt-1"],[1,"flex","items-center","space-x-3"],["type","text","readonly","",1,"input","flex-1",3,"value"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"mb-6"],[1,"relative",3,"click"],["type","button",1,"w-full","px-4","py-3","text-left","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white","transition-all",3,"click"],[1,"flex","items-center","justify-between"],["class","text-gray-400",4,"ngIf"],["class","text-gray-900",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",4,"ngIf"],["rows","3","placeholder","Brief description of the asset and its purpose...","formControlName","description","maxlength","500",1,"input","resize-none"],[1,"block","text-sm","font-medium","text-gray-700","mb-3"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-sm","text-gray-600"],[1,"text-2xl","font-bold"],[1,"relative","w-full","h-6","mb-3"],[1,"absolute","top-1/2","transform","-translate-y-1/2","w-full","h-2","bg-gray-200","rounded-lg"],[1,"absolute","top-1/2","transform","-translate-y-1/2","h-2","rounded-lg","transition-all","duration-300"],["type","range","min","0","max","100","formControlName","health_score",1,"absolute","top-1/2","transform","-translate-y-1/2","w-full","h-6","bg-transparent","appearance-none","cursor-pointer","slider-input"],[1,"absolute","top-1/2","transform","-translate-y-1/2","w-4","h-4","rounded-full","border-2","border-white","shadow-md","pointer-events-none","transition-all","duration-300",2,"margin-left","-8px"],[1,"flex","justify-between","text-xs","text-gray-500","mt-2"],[1,"w-10","h-10","bg-purple-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["class","flex items-center space-x-3",4,"ngIf"],[1,"w-10","h-10","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["type","text","placeholder","e.g., Dell, HP, Toyota","formControlName","manufacturer","maxlength","100",1,"input"],["type","text","placeholder","e.g., PowerEdge R730","formControlName","model","maxlength","100",1,"input"],["type","text","placeholder","e.g., SN123456789","formControlName","serial_number","required","","maxlength","100",1,"input"],[1,"w-10","h-10","bg-yellow-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"text-gray-500","sm:text-sm"],["type","number","placeholder","5,000.00","formControlName","purchase_price","step","0.01","min","0",1,"input",2,"padding-left","24px"],["type","text","formControlName","purchase_date","placeholder","Select purchase date","readonly","",1,"input"],["type","number","formControlName","depreciation","placeholder","e.g., 20","min","0","max","100","step","0.01",1,"input"],["type","number","formControlName","depreciation_life","placeholder","e.g., 5","min","1","max","100",1,"input"],["type","text","formControlName","warranty","placeholder","e.g., 2 years manufacturer warranty","maxlength","255",1,"input"],["type","text","formControlName","insurance","placeholder","e.g., Policy #12345, expires 2025-12-31","maxlength","255",1,"input"],[1,"w-10","h-10","bg-indigo-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"text-gray-400"],[1,"flex","items-center","space-x-2"],["class","text-sm text-gray-500",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"w-10","h-10","bg-pink-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-pink-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"mt-1","flex","justify-center","px-6","pt-8","pb-8","border-2","border-dashed","rounded-lg","transition-all","duration-200",3,"click","dragover","dragleave","drop"],[1,"space-y-1","text-center"],[1,"w-16","h-16","bg-gray-100","rounded-lg","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"text-sm","transition-colors"],["id","file-upload","name","file-upload","type","file","accept","image/*","multiple","",1,"sr-only",3,"change"],["class","mt-6",4,"ngIf"],["class","mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],["class","mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",4,"ngIf"],[1,"flex","items-center","justify-between","pt-6","border-t","border-gray-200"],["type","button",1,"px-6","py-3","border","border-gray-300","rounded-lg","text-gray-700","font-medium","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","submit",1,"px-8","py-3","bg-blue-600","text-white","font-medium","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed","shadow-sm",3,"disabled"],["class","flex items-center space-x-2",4,"ngIf"],[1,"text-red-600","text-sm","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-1"],[1,"text-gray-900"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-200","rounded-lg","shadow-lg","max-h-60","overflow-auto"],[1,"py-1"],[1,"px-3","py-2","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","bg-gray-50"],["type","button",1,"w-full","px-3","py-3","text-left","hover:bg-blue-50","focus:bg-blue-50","focus:outline-none","transition-colors",3,"click"],["type","button","class","w-full px-3 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors",3,"bg-blue-50","click",4,"ngFor","ngForOf"],[1,"w-8","h-8","bg-gray-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"w-6","h-6","rounded","flex","items-center","justify-center"],["class","w-4 h-4",3,"src","alt","error",4,"ngIf"],["class","w-4 h-4","fill","none","stroke","currentColor","viewBox","0 0 24 24",3,"color",4,"ngIf"],[1,"w-4","h-4",3,"error","src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],["type","button","class","w-full px-3 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors",3,"bg-blue-50","text-blue-700","click",4,"ngFor","ngForOf"],[1,"w-8","h-8","rounded-lg","flex","items-center","justify-center","bg-blue-100"],["class","w-5 h-5",3,"src","alt","error",4,"ngIf"],["class","w-5 h-5 text-blue-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"w-5","h-5",3,"error","src","alt"],["class","w-5 h-5 text-gray-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"w-6","h-6","bg-indigo-100","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-indigo-600"],[1,"w-8","h-8","bg-indigo-100","rounded-lg","flex","items-center","justify-center"],[1,"w-6","h-6","bg-purple-100","rounded","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"w-8","h-8","bg-purple-100","rounded-lg","flex","items-center","justify-center"],["class","text-xs text-gray-400",4,"ngIf"],[1,"text-xs","text-gray-400"],[1,"w-3","h-3","rounded-full"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-200","rounded-lg","shadow-lg"],[1,"mb-3"],[1,"flex","flex-wrap","gap-2"],[3,"class",4,"ngFor","ngForOf"],["type","button",1,"ml-2","inline-flex","items-center","justify-center","w-4","h-4","rounded-full","hover:bg-black","hover:bg-opacity-20","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"px-3","py-2","border-b","border-gray-100"],["type","text","placeholder","Type to create new tag...",1,"w-full","px-3","py-2","text-sm","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","keydown","click","ngModel","ngModelOptions"],[1,"absolute","right-2","top-1/2","transform","-translate-y-1/2","text-xs","text-gray-400"],["class","text-blue-600",4,"ngIf"],[1,"text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"mt-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-sm","font-medium","text-gray-700"],["type","button",1,"text-red-600","hover:text-red-700","text-sm","font-medium","transition-colors",3,"click"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4"],["class","relative group",4,"ngFor","ngForOf"],[1,"mt-4","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-600"],[1,"text-blue-800","text-sm"],[1,"relative","group"],[1,"relative","aspect-square","bg-gray-100","rounded-lg","overflow-hidden","border","border-gray-200","hover:border-blue-300","transition-colors"],["loading","lazy",1,"w-full","h-full","object-cover","bg-white",3,"error","src","alt"],[1,"absolute","inset-0","bg-black","opacity-0","group-hover:opacity-50","transition-all","duration-200","flex","items-center","justify-center"],[1,"opacity-0","group-hover:opacity-100","transition-opacity","duration-200","flex","items-center","space-x-2"],["type","button",1,"w-8","h-8","bg-white","bg-opacity-90","text-gray-700","rounded-full","flex","items-center","justify-center","hover:bg-opacity-100","transition-all","shadow-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["type","button",1,"absolute","top-2","right-2","w-6","h-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","hover:bg-red-600","transition-colors","shadow-sm",3,"click"],[1,"absolute","top-2","left-2","px-2","py-1","bg-green-600","text-white","rounded","text-xs","font-medium"],[1,"mt-2","text-center"],[1,"text-xs","text-gray-600","truncate"],["loading","lazy",1,"w-full","h-full","object-cover","bg-white",3,"error","load","src","alt"],[1,"absolute","inset-0","bg-black","opacity-50","group-hover:bg-opacity-20","transition-all","duration-200","flex","items-center","justify-center"],["type","button","class","w-8 h-8 bg-white bg-opacity-90 text-gray-700 rounded-full flex items-center justify-center hover:bg-opacity-100 transition-all shadow-sm",3,"click",4,"ngIf"],[1,"absolute","top-2","left-2","px-2","py-1","bg-blue-600","text-white","rounded","text-xs","font-medium"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],[1,"mb-6","p-4","bg-red-50","border","border-red-200","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-600"],[1,"text-red-800","font-medium"],[1,"mb-6","p-4","bg-green-50","border","border-green-200","rounded-lg"],[1,"text-green-800","font-medium"],["xmlns","http://www.w3.org/2000/svg","fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5"]],template:function(e,i){e&1&&(d(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"button",6),Y("click",function(){return i.goBack()}),B(),d(5,"svg",7),D(6,"path",8),u(),q(),d(7,"span",9),g(8,"Back to Assets"),u()()(),d(9,"h1",10),g(10,"Edit Asset"),u(),d(11,"p",11),g(12," Update asset information and specifications "),u()(),J(13,py,10,0,"div",12)(14,gy,11,1,"div",12)(15,p4,279,104,"div",13),u()()),e&2&&(x(13),C("ngIf",i.loading),x(),C("ngIf",i.error&&!i.loading),x(),C("ngIf",!i.loading&&!i.error))},dependencies:[ln,Yn,Xt,io,tr,cn,Ks,qs,dn,er,ta,to,eo,Zs,Js,Qs,fn,Pn,Oi],styles:[".asset-edit-page[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:1.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;border:1px solid #e5e7eb;padding:2rem;margin-bottom:1.5rem;transition:all .2s ease-in-out}.section-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.section-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin:0;color:#1f2937}.input[_ngcontent-%COMP%]{width:100%;border-radius:.5rem;border:1px solid #d1d5db;padding:.75rem .875rem;font-size:1rem;background:#fff;transition:all .2s ease-in-out}.input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a;background:#fff}.input.border-red-300[_ngcontent-%COMP%]{border-color:#fca5a5;box-shadow:0 0 0 3px #ef44441a}@media (max-width: 768px){.asset-create-page[_ngcontent-%COMP%]{padding:1rem}.section-card[_ngcontent-%COMP%]{padding:1.5rem;margin-bottom:1rem}.grid-cols-2[_ngcontent-%COMP%], .grid-cols-3[_ngcontent-%COMP%]{grid-template-columns:1fr}}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-button[_ngcontent-%COMP%]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .2s ease-out}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{transition:all .15s ease-in-out}.custom-dropdown[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background-color:#eff6ff}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.rotate-180[_ngcontent-%COMP%]{transform:rotate(180deg)}.transition-transform[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}[_nghost-%COMP%]     .flatpickr-calendar{border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;border:1px solid #e5e7eb;font-family:inherit}[_nghost-%COMP%]     .flatpickr-day{border-radius:.375rem}[_nghost-%COMP%]     .flatpickr-day:hover{background-color:#eff6ff;border-color:#3b82f6}[_nghost-%COMP%]     .flatpickr-day.selected{background-color:#3b82f6;border-color:#3b82f6}[_nghost-%COMP%]     .flatpickr-day.today{border-color:#3b82f6;color:#3b82f6;font-weight:600}[_nghost-%COMP%]     .flatpickr-months{background-color:#f8fafc;border-radius:.5rem .5rem 0 0}[_nghost-%COMP%]     .flatpickr-current-month{color:#1f2937;font-weight:600}[_nghost-%COMP%]     .flatpickr-weekday{color:#6b7280;font-weight:500}[_nghost-%COMP%]     .flatpickr-input{cursor:pointer}[_nghost-%COMP%]     .flatpickr-input:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.slider-input[_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none;background:transparent;outline:none;z-index:20}.slider-input[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:transparent;border:2px solid transparent;cursor:pointer;position:relative;z-index:30}.slider-input[_ngcontent-%COMP%]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:transparent;border:2px solid transparent;cursor:pointer;box-shadow:none}.slider-input[_ngcontent-%COMP%]:focus{outline:none}"]})};var Bh={};Bh.version="0.18.5";var Ai=1200,Aa=1252,g4=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wc={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bc=function(t){g4.indexOf(t)!=-1&&(Aa=wc[0]=t)};function x4(){bc(1252)}var fi=function(t){Ai=t,bc(t)};function Hh(){fi(1200),x4()}function cc(t){for(var n=[],e=0,i=t.length;e<i;++e)n[e]=t.charCodeAt(e);return n}function _4(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return n.join("")}function Uh(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return n.join("")}var us=function(t){var n=t.charCodeAt(0),e=t.charCodeAt(1);return n==255&&e==254?_4(t.slice(2)):n==254&&e==255?Uh(t.slice(2)):n==65279?t.slice(1):t},il=function(n){return String.fromCharCode(n)},Ru=function(n){return String.fromCharCode(n)},ct;var Wt=null,fs=!0,xr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vu(t){for(var n="",e=0,i=0,r=0,a=0,s=0,o=0,l=0,c=0;c<t.length;)e=t.charCodeAt(c++),a=e>>2,i=t.charCodeAt(c++),s=(e&3)<<4|i>>4,r=t.charCodeAt(c++),o=(i&15)<<2|r>>6,l=r&63,isNaN(i)?o=l=64:isNaN(r)&&(l=64),n+=xr.charAt(a)+xr.charAt(s)+xr.charAt(o)+xr.charAt(l);return n}function jn(t){var n="",e=0,i=0,r=0,a=0,s=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=xr.indexOf(t.charAt(c++)),s=xr.indexOf(t.charAt(c++)),e=a<<2|s>>4,n+=String.fromCharCode(e),o=xr.indexOf(t.charAt(c++)),i=(s&15)<<4|o>>2,o!==64&&(n+=String.fromCharCode(i)),l=xr.indexOf(t.charAt(c++)),r=(o&3)<<6|l,l!==64&&(n+=String.fromCharCode(r));return n}var Je=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ur=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(n,e){return e?new Buffer(n,e):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function wr(t){return Je?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Nu(t){return Je?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var di=function(n){return Je?Ur(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)&255})};function zr(t){if(Array.isArray(t))return t.map(function(i){return String.fromCharCode(i)}).join("");for(var n=[],e=0;e<t.length;++e)n[e]=String.fromCharCode(t[e]);return n.join("")}function yc(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return yc(new Uint8Array(t));for(var n=new Array(t.length),e=0;e<t.length;++e)n[e]=t[e];return n}var gr=Je?function(t){return Buffer.concat(t.map(function(n){return Buffer.isBuffer(n)?n:Ur(n)}))}:function(t){if(typeof Uint8Array<"u"){var n=0,e=0;for(n=0;n<t.length;++n)e+=t[n].length;var i=new Uint8Array(e),r=0;for(n=0,e=0;n<t.length;e+=r,++n)if(r=t[n].length,t[n]instanceof Uint8Array)i.set(t[n],e);else{if(typeof t[n]=="string")throw"wtf";i.set(new Uint8Array(t[n]),e)}return i}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function v4(t){for(var n=[],e=0,i=t.length+250,r=wr(t.length+255),a=0;a<t.length;++a){var s=t.charCodeAt(a);if(s<128)r[e++]=s;else if(s<2048)r[e++]=192|s>>6&31,r[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=t.charCodeAt(++a)&1023;r[e++]=240|s>>8&7,r[e++]=128|s>>2&63,r[e++]=128|o>>6&15|(s&3)<<4,r[e++]=128|o&63}else r[e++]=224|s>>12&15,r[e++]=128|s>>6&63,r[e++]=128|s&63;e>i&&(n.push(r.slice(0,e)),e=0,r=wr(65535),i=65530)}return n.push(r.slice(0,e)),gr(n)}var wn=/\u0000/g,hs=/[\u0001-\u0006]/g;function ka(t){for(var n="",e=t.length-1;e>=0;)n+=t.charAt(e--);return n}function ui(t,n){var e=""+t;return e.length>=n?e:At("0",n-e.length)+e}function Sc(t,n){var e=""+t;return e.length>=n?e:At(" ",n-e.length)+e}function ul(t,n){var e=""+t;return e.length>=n?e:e+At(" ",n-e.length)}function w4(t,n){var e=""+Math.round(t);return e.length>=n?e:At("0",n-e.length)+e}function b4(t,n){var e=""+t;return e.length>=n?e:At("0",n-e.length)+e}var Bu=Math.pow(2,32);function Sa(t,n){if(t>Bu||t<-Bu)return w4(t,n);var e=Math.round(t);return b4(e,n)}function hl(t,n){return n=n||0,t.length>=7+n&&(t.charCodeAt(n)|32)===103&&(t.charCodeAt(n+1)|32)===101&&(t.charCodeAt(n+2)|32)===110&&(t.charCodeAt(n+3)|32)===101&&(t.charCodeAt(n+4)|32)===114&&(t.charCodeAt(n+5)|32)===97&&(t.charCodeAt(n+6)|32)===108}var Hu=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Z0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function y4(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Uu={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},S4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ml(t,n,e){for(var i=t<0?-1:1,r=t*i,a=0,s=1,o=0,l=1,c=0,f=0,h=Math.floor(r);c<n&&(h=Math.floor(r),o=h*s+a,f=h*c+l,!(r-h<5e-8));)r=1/(r-h),a=s,s=o,l=c,c=f;if(f>n&&(c>n?(f=l,o=a):(f=c,o=s)),!e)return[0,i*o,f];var m=Math.floor(i*o/f);return[m,i*o-m*f,f]}function Lr(t,n,e){if(t>2958465||t<0)return null;var i=t|0,r=Math.floor(86400*(t-i)),a=0,s=[],o={D:i,T:r,u:86400*(t-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),n&&n.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++r==86400&&(o.T=r=0,++i,++o.D)),i===60)s=e?[1317,10,29]:[1900,2,29],a=3;else if(i===0)s=e?[1317,8,29]:[1900,1,0],a=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),i<60&&(a=(a+6)%7),e&&(a=M4(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=r%60,r=Math.floor(r/60),o.M=r%60,r=Math.floor(r/60),o.H=r,o.q=a,o}var zh=new Date(1899,11,31,0,0,0),C4=zh.getTime(),k4=new Date(1900,2,1,0,0,0);function Wh(t,n){var e=t.getTime();return n?e-=1461*24*60*60*1e3:t>=k4&&(e+=24*60*60*1e3),(e-(C4+(t.getTimezoneOffset()-zh.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cc(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function E4(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function T4(t){var n=t<0?12:11,e=Cc(t.toFixed(12));return e.length<=n||(e=t.toPrecision(10),e.length<=n)?e:t.toExponential(5)}function A4(t){var n=Cc(t.toFixed(11));return n.length>(t<0?12:11)||n==="0"||n==="-0"?t.toPrecision(6):n}function ks(t){var n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return n>=-4&&n<=-1?e=t.toPrecision(10+n):Math.abs(n)<=9?e=T4(t):n===10?e=t.toFixed(10).substr(0,12):e=A4(t),Cc(E4(e.toUpperCase()))}function Nr(t,n){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ks(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ti(14,Wh(t,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+t)}function M4(t,n){n[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function D4(t,n,e,i){var r="",a=0,s=0,o=e.y,l,c=0;switch(t){case 98:o=e.y+543;case 121:switch(n.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(n.length){case 1:case 2:l=e.m,c=n.length;break;case 3:return Z0[e.m-1][1];case 5:return Z0[e.m-1][0];default:return Z0[e.m-1][2]}break;case 100:switch(n.length){case 1:case 2:l=e.d,c=n.length;break;case 3:return Hu[e.q][0];default:return Hu[e.q][1]}break;case 104:switch(n.length){case 1:case 2:l=1+(e.H+11)%12,c=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:l=e.H,c=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:l=e.M,c=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return e.u===0&&(n=="s"||n=="ss")?ui(e.S,n.length):(i>=2?s=i===3?1e3:100:s=i===1?10:1,a=Math.round(s*(e.S+e.u)),a>=60*s&&(a=0),n==="s"?a===0?"0":""+a/s:(r=ui(a,2+i),n==="ss"?r.substr(0,2):"."+r.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+n}c=n.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?ui(l,c):"";return f}function _r(t){var n=3;if(t.length<=n)return t;for(var e=t.length%n,i=t.substr(0,e);e!=t.length;e+=n)i+=(i.length>0?",":"")+t.substr(e,n);return i}var jh=/%/g;function F4(t,n,e){var i=n.replace(jh,""),r=n.length-i.length;return Gi(t,i,e*Math.pow(10,2*r))+At("%",r)}function I4(t,n,e){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return Gi(t,n.substr(0,i),e/Math.pow(10,3*(n.length-i)))}function Gh(t,n){var e,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Gh(t,-n);var r=t.indexOf(".");r===-1&&(r=t.indexOf("E"));var a=Math.floor(Math.log(n)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(n/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),e.indexOf("e")===-1){var s=Math.floor(Math.log(n)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(r+a)%r)+"."+f.substr(a)+"E"})}else e=n.toExponential(i);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var $h=/# (\?+)( ?)\/( ?)(\d+)/;function P4(t,n,e){var i=parseInt(t[4],10),r=Math.round(n*i),a=Math.floor(r/i),s=r-a*i,o=i;return e+(a===0?"":""+a)+" "+(s===0?At(" ",t[1].length+1+t[4].length):Sc(s,t[1].length)+t[2]+"/"+t[3]+ui(o,t[4].length))}function O4(t,n,e){return e+(n===0?"":""+n)+At(" ",t[1].length+2+t[4].length)}var Yh=/^#*0*\.([0#]+)/,Xh=/\).*[0#]/,Kh=/\(###\) ###\\?-####/;function En(t){for(var n="",e,i=0;i!=t.length;++i)switch(e=t.charCodeAt(i)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(e)}return n}function zu(t,n){var e=Math.pow(10,n);return""+Math.round(t*e)/e}function Wu(t,n){var e=t-Math.floor(t),i=Math.pow(10,n);return n<(""+Math.round(e*i)).length?0:Math.round(e*i)}function L4(t,n){return n<(""+Math.round((t-Math.floor(t))*Math.pow(10,n))).length?1:0}function R4(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Zn(t,n,e){if(t.charCodeAt(0)===40&&!n.match(Xh)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Zn("n",i,e):"("+Zn("n",i,-e)+")"}if(n.charCodeAt(n.length-1)===44)return I4(t,n,e);if(n.indexOf("%")!==-1)return F4(t,n,e);if(n.indexOf("E")!==-1)return Gh(n,e);if(n.charCodeAt(0)===36)return"$"+Zn(t,n.substr(n.charAt(1)==" "?2:1),e);var r,a,s,o,l=Math.abs(e),c=e<0?"-":"";if(n.match(/^00+$/))return c+Sa(l,n.length);if(n.match(/^[#?]+$/))return r=Sa(e,0),r==="0"&&(r=""),r.length>n.length?r:En(n.substr(0,n.length-r.length))+r;if(a=n.match($h))return P4(a,l,c);if(n.match(/^#+0+$/))return c+Sa(l,n.length-n.indexOf("0"));if(a=n.match(Yh))return r=zu(e,a[1].length).replace(/^([^\.]+)$/,"$1."+En(a[1])).replace(/\.$/,"."+En(a[1])).replace(/\.(\d*)$/,function(v,_){return"."+_+At("0",En(a[1]).length-_.length)}),n.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),a=n.match(/^(0*)\.(#*)$/))return c+zu(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=n.match(/^#{1,3},##0(\.?)$/))return c+_r(Sa(l,0));if(a=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Zn(t,n,-e):_r(""+(Math.floor(e)+L4(e,a[1].length)))+"."+ui(Wu(e,a[1].length),a[1].length);if(a=n.match(/^#,#*,#0/))return Zn(t,n.replace(/^#,#*,/,""),e);if(a=n.match(/^([0#]+)(\\?-([0#]+))+$/))return r=ka(Zn(t,n.replace(/[\\-]/g,""),e)),s=0,ka(ka(n.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<r.length?r.charAt(s++):v==="0"?"0":""}));if(n.match(Kh))return r=Zn(t,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var f="";if(a=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=ml(l,Math.pow(10,s)-1,!1),r=""+c,f=Gi("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),r+=f+a[2]+"/"+a[3],f=ul(o[2],s),f.length<a[4].length&&(f=En(a[4].substr(a[4].length-f.length))+f),r+=f,r;if(a=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=ml(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Sc(o[1],s)+a[2]+"/"+a[3]+ul(o[2],s):At(" ",2*s+1+a[2].length+a[3].length));if(a=n.match(/^[#0?]+$/))return r=Sa(e,0),n.length<=r.length?r:En(n.substr(0,n.length-r.length))+r;if(a=n.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var h=n.indexOf(".")-s,m=n.length-r.length-h;return En(n.substr(0,h)+r+n.substr(n.length-m))}if(a=n.match(/^00,000\.([#0]*0)$/))return s=Wu(e,a[1].length),e<0?"-"+Zn(t,n,-e):_r(R4(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ui(0,3-v.length):"")+v})+"."+ui(s,a[1].length);switch(n){case"###,##0.00":return Zn(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var p=_r(Sa(l,0));return p!=="0"?c+p:"";case"###,###.00":return Zn(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Zn(t,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+n+"|")}function V4(t,n,e){for(var i=n.length-1;n.charCodeAt(i-1)===44;)--i;return Gi(t,n.substr(0,i),e/Math.pow(10,3*(n.length-i)))}function N4(t,n,e){var i=n.replace(jh,""),r=n.length-i.length;return Gi(t,i,e*Math.pow(10,2*r))+At("%",r)}function qh(t,n){var e,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+qh(t,-n);var r=t.indexOf(".");r===-1&&(r=t.indexOf("E"));var a=Math.floor(Math.log(n)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(n/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),!e.match(/[Ee]/)){var s=Math.floor(Math.log(n)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(r+a)%r)+"."+f.substr(a)+"E"})}else e=n.toExponential(i);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Ti(t,n,e){if(t.charCodeAt(0)===40&&!n.match(Xh)){var i=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ti("n",i,e):"("+Ti("n",i,-e)+")"}if(n.charCodeAt(n.length-1)===44)return V4(t,n,e);if(n.indexOf("%")!==-1)return N4(t,n,e);if(n.indexOf("E")!==-1)return qh(n,e);if(n.charCodeAt(0)===36)return"$"+Ti(t,n.substr(n.charAt(1)==" "?2:1),e);var r,a,s,o,l=Math.abs(e),c=e<0?"-":"";if(n.match(/^00+$/))return c+ui(l,n.length);if(n.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>n.length?r:En(n.substr(0,n.length-r.length))+r;if(a=n.match($h))return O4(a,l,c);if(n.match(/^#+0+$/))return c+ui(l,n.length-n.indexOf("0"));if(a=n.match(Yh))return r=(""+e).replace(/^([^\.]+)$/,"$1."+En(a[1])).replace(/\.$/,"."+En(a[1])),r=r.replace(/\.(\d*)$/,function(v,_){return"."+_+At("0",En(a[1]).length-_.length)}),n.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),a=n.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=n.match(/^#{1,3},##0(\.?)$/))return c+_r(""+l);if(a=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ti(t,n,-e):_r(""+e)+"."+At("0",a[1].length);if(a=n.match(/^#,#*,#0/))return Ti(t,n.replace(/^#,#*,/,""),e);if(a=n.match(/^([0#]+)(\\?-([0#]+))+$/))return r=ka(Ti(t,n.replace(/[\\-]/g,""),e)),s=0,ka(ka(n.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<r.length?r.charAt(s++):v==="0"?"0":""}));if(n.match(Kh))return r=Ti(t,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var f="";if(a=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=ml(l,Math.pow(10,s)-1,!1),r=""+c,f=Gi("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),r+=f+a[2]+"/"+a[3],f=ul(o[2],s),f.length<a[4].length&&(f=En(a[4].substr(a[4].length-f.length))+f),r+=f,r;if(a=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=ml(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Sc(o[1],s)+a[2]+"/"+a[3]+ul(o[2],s):At(" ",2*s+1+a[2].length+a[3].length));if(a=n.match(/^[#0?]+$/))return r=""+e,n.length<=r.length?r:En(n.substr(0,n.length-r.length))+r;if(a=n.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var h=n.indexOf(".")-s,m=n.length-r.length-h;return En(n.substr(0,h)+r+n.substr(n.length-m))}if(a=n.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Ti(t,n,-e):_r(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ui(0,3-v.length):"")+v})+"."+ui(0,a[1].length);switch(n){case"###,###":case"##,###":case"#,###":var p=_r(""+l);return p!=="0"?c+p:"";default:if(n.match(/\.[0#?]*$/))return Ti(t,n.slice(0,n.lastIndexOf(".")),e)+En(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Gi(t,n,e){return(e|0)===e?Ti(t,n,e):Zn(t,n,e)}function B4(t){for(var n=[],e=!1,i=0,r=0;i<t.length;++i)switch(t.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:n[n.length]=t.substr(r,i-r),r=i+1}if(n[n.length]=t.substr(r),e===!0)throw new Error("Format |"+t+"| unterminated string ");return n}var Jh=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fa(t){for(var n=0,e="",i="";n<t.length;)switch(e=t.charAt(n)){case"G":hl(t,n)&&(n+=6),n++;break;case'"':for(;t.charCodeAt(++n)!==34&&n<t.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(t.charAt(n+1)==="1"||t.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(n,3).toUpperCase()==="A/P"||t.substr(n,5).toUpperCase()==="AM/PM"||t.substr(n,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++n;break;case"[":for(i=e;t.charAt(n++)!=="]"&&n<t.length;)i+=t.charAt(n);if(i.match(Jh))return!0;break;case".":case"0":case"#":for(;n<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++n))>-1||e=="\\"&&t.charAt(n+1)=="-"&&"0#".indexOf(t.charAt(n+2))>-1););break;case"?":for(;t.charAt(++n)===e;);break;case"*":++n,(t.charAt(n)==" "||t.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<t.length&&"0123456789".indexOf(t.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function H4(t,n,e,i){for(var r=[],a="",s=0,o="",l="t",c,f,h,m="H";s<t.length;)switch(o=t.charAt(s)){case"G":if(!hl(t,s))throw new Error("unrecognized character "+o+" in "+t);r[r.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(h=t.charCodeAt(++s))!==34&&s<t.length;)a+=String.fromCharCode(h);r[r.length]={t:"t",v:a},++s;break;case"\\":var p=t.charAt(++s),v=p==="("||p===")"?p:"t";r[r.length]={t:v,v:p},++s;break;case"_":r[r.length]={t:"t",v:" "},s+=2;break;case"@":r[r.length]={t:"T",v:n},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(c==null&&(c=Lr(n,e,t.charAt(s+1)==="2"),c==null))return"";r[r.length]={t:"X",v:t.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||c==null&&(c=Lr(n,e),c==null))return"";for(a=o;++s<t.length&&t.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),r[r.length]={t:o,v:a},l=o;break;case"A":case"a":case"\u4E0A":var _={t:o,v:o};if(c==null&&(c=Lr(n,e)),t.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(_.v=c.H>=12?"P":"A"),_.t="T",m="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(_.v=c.H>=12?"PM":"AM"),_.t="T",s+=5,m="h"):t.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(_.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),_.t="T",s+=5,m="h"):(_.t="t",++s),c==null&&_.t==="T")return"";r[r.length]=_,l=o;break;case"[":for(a=o;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Jh)){if(c==null&&(c=Lr(n,e),c==null))return"";r[r.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fa(t)||(r[r.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<t.length&&(o=t.charAt(s))==="0";)a+=o;r[r.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(s))>-1;)a+=o;r[r.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++s)===o;)a+=o;r[r.length]={t:o,v:a},l=o;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":r[r.length]={t:i===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)a+=t.charAt(s);r[r.length]={t:"D",v:a};break;case" ":r[r.length]={t:o,v:o},++s;break;case"$":r[r.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);r[r.length]={t:"t",v:o},++s;break}var w=0,E=0,S;for(s=r.length-1,l="t";s>=0;--s)switch(r[s].t){case"h":case"H":r[s].t=m,l="h",w<1&&(w=1);break;case"s":(S=r[s].v.match(/\.0+$/))&&(E=Math.max(E,S[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=r[s].t;break;case"m":l==="s"&&(r[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&r[s].v.match(/[Hh]/)&&(w=1),w<2&&r[s].v.match(/[Mm]/)&&(w=2),w<3&&r[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",V;for(s=0;s<r.length;++s)switch(r[s].t){case"t":case"T":case" ":case"D":break;case"X":r[s].v="",r[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[s].v=D4(r[s].t.charCodeAt(0),r[s].v,c,E),r[s].t="t";break;case"n":case"?":for(V=s+1;r[V]!=null&&((o=r[V].t)==="?"||o==="D"||(o===" "||o==="t")&&r[V+1]!=null&&(r[V+1].t==="?"||r[V+1].t==="t"&&r[V+1].v==="/")||r[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(r[V].v==="/"||r[V].v===" "&&r[V+1]!=null&&r[V+1].t=="?"));)r[s].v+=r[V].v,r[V]={v:"",t:";"},++V;y+=r[s].v,s=V-1;break;case"G":r[s].t="t",r[s].v=Nr(n,e);break}var H="",I,T;if(y.length>0){y.charCodeAt(0)==40?(I=n<0&&y.charCodeAt(0)===45?-n:n,T=Gi("n",y,I)):(I=n<0&&i>1?-n:n,T=Gi("n",y,I),I<0&&r[0]&&r[0].t=="t"&&(T=T.substr(1),r[0].v="-"+r[0].v)),V=T.length-1;var N=r.length;for(s=0;s<r.length;++s)if(r[s]!=null&&r[s].t!="t"&&r[s].v.indexOf(".")>-1){N=s;break}var W=r.length;if(N===r.length&&T.indexOf("E")===-1){for(s=r.length-1;s>=0;--s)r[s]==null||"n?".indexOf(r[s].t)===-1||(V>=r[s].v.length-1?(V-=r[s].v.length,r[s].v=T.substr(V+1,r[s].v.length)):V<0?r[s].v="":(r[s].v=T.substr(0,V+1),V=-1),r[s].t="t",W=s);V>=0&&W<r.length&&(r[W].v=T.substr(0,V+1)+r[W].v)}else if(N!==r.length&&T.indexOf("E")===-1){for(V=T.indexOf(".")-1,s=N;s>=0;--s)if(!(r[s]==null||"n?".indexOf(r[s].t)===-1)){for(f=r[s].v.indexOf(".")>-1&&s===N?r[s].v.indexOf(".")-1:r[s].v.length-1,H=r[s].v.substr(f+1);f>=0;--f)V>=0&&(r[s].v.charAt(f)==="0"||r[s].v.charAt(f)==="#")&&(H=T.charAt(V--)+H);r[s].v=H,r[s].t="t",W=s}for(V>=0&&W<r.length&&(r[W].v=T.substr(0,V+1)+r[W].v),V=T.indexOf(".")+1,s=N;s<r.length;++s)if(!(r[s]==null||"n?(".indexOf(r[s].t)===-1&&s!==N)){for(f=r[s].v.indexOf(".")>-1&&s===N?r[s].v.indexOf(".")+1:0,H=r[s].v.substr(0,f);f<r[s].v.length;++f)V<T.length&&(H+=T.charAt(V++));r[s].v=H,r[s].t="t",W=s}}}for(s=0;s<r.length;++s)r[s]!=null&&"n?".indexOf(r[s].t)>-1&&(I=i>1&&n<0&&s>0&&r[s-1].v==="-"?-n:n,r[s].v=Gi(r[s].t,r[s].v,I),r[s].t="t");var ee="";for(s=0;s!==r.length;++s)r[s]!=null&&(ee+=r[s].v);return ee}var ju=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gu(t,n){if(n==null)return!1;var e=parseFloat(n[2]);switch(n[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function U4(t,n){var e=B4(t),i=e.length,r=e[i-1].indexOf("@");if(i<4&&r>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof n!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var a=n>0?e[0]:n<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(ju),o=e[1].match(ju);return Gu(n,s)?[i,e[0]]:Gu(n,o)?[i,e[1]]:[i,e[s!=null&&o!=null?2:1]]}return[i,a]}function ti(t,n,e){e==null&&(e={});var i="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?i=e.dateNF:i=t;break;case"number":t==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:je)[t],i==null&&(i=e.table&&e.table[Uu[t]]||je[Uu[t]]),i==null&&(i=S4[t]||"General");break}if(hl(i,0))return Nr(n,e);n instanceof Date&&(n=Wh(n,e.date1904));var r=U4(i,n);if(hl(r[1]))return Nr(n,e);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return H4(r[1],n,e,r[0])}function Rr(t,n){if(typeof n!="number"){n=+n||-1;for(var e=0;e<392;++e){if(je[e]==null){n<0&&(n=e);continue}if(je[e]==t){n=e;break}}n<0&&(n=391)}return je[n]=t,n}function Qh(){je=y4()}var z4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Zh=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function W4(t){var n=typeof t=="number"?je[t]:t;return n=n.replace(Zh,"(\\d+)"),new RegExp("^"+n+"$")}function j4(t,n,e){var i=-1,r=-1,a=-1,s=-1,o=-1,l=-1;(n.match(Zh)||[]).forEach(function(h,m){var p=parseInt(e[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":i=p;break;case"d":a=p;break;case"h":s=p;break;case"s":l=p;break;case"m":s>=0?o=p:r=p;break}}),l>=0&&o==-1&&r>=0&&(o=r,r=-1);var c=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:i==-1&&r==-1&&a==-1?f:c+"T"+f}var G4=function(){var t={};t.version="1.2.0";function n(){for(var T=0,N=new Array(256),W=0;W!=256;++W)T=W,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,N[W]=T;return typeof Int32Array<"u"?new Int32Array(N):N}var e=n();function i(T){var N=0,W=0,ee=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)te[ee]=T[ee];for(ee=0;ee!=256;++ee)for(W=T[ee],N=256+ee;N<4096;N+=256)W=te[N]=W>>>8^T[W&255];var X=[];for(ee=1;ee!=16;++ee)X[ee-1]=typeof Int32Array<"u"?te.subarray(ee*256,ee*256+256):te.slice(ee*256,ee*256+256);return X}var r=i(e),a=r[0],s=r[1],o=r[2],l=r[3],c=r[4],f=r[5],h=r[6],m=r[7],p=r[8],v=r[9],_=r[10],w=r[11],E=r[12],S=r[13],y=r[14];function V(T,N){for(var W=N^-1,ee=0,te=T.length;ee<te;)W=W>>>8^e[(W^T.charCodeAt(ee++))&255];return~W}function H(T,N){for(var W=N^-1,ee=T.length-15,te=0;te<ee;)W=y[T[te++]^W&255]^S[T[te++]^W>>8&255]^E[T[te++]^W>>16&255]^w[T[te++]^W>>>24]^_[T[te++]]^v[T[te++]]^p[T[te++]]^m[T[te++]]^h[T[te++]]^f[T[te++]]^c[T[te++]]^l[T[te++]]^o[T[te++]]^s[T[te++]]^a[T[te++]]^e[T[te++]];for(ee+=15;te<ee;)W=W>>>8^e[(W^T[te++])&255];return~W}function I(T,N){for(var W=N^-1,ee=0,te=T.length,X=0,me=0;ee<te;)X=T.charCodeAt(ee++),X<128?W=W>>>8^e[(W^X)&255]:X<2048?(W=W>>>8^e[(W^(192|X>>6&31))&255],W=W>>>8^e[(W^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,me=T.charCodeAt(ee++)&1023,W=W>>>8^e[(W^(240|X>>8&7))&255],W=W>>>8^e[(W^(128|X>>2&63))&255],W=W>>>8^e[(W^(128|me>>6&15|(X&3)<<4))&255],W=W>>>8^e[(W^(128|me&63))&255]):(W=W>>>8^e[(W^(224|X>>12&15))&255],W=W>>>8^e[(W^(128|X>>6&63))&255],W=W>>>8^e[(W^(128|X&63))&255]);return~W}return t.table=e,t.bstr=V,t.buf=H,t.str=I,t}(),Qe=function(){var n={};n.version="1.2.1";function e(k,P){for(var A=k.split("/"),F=P.split("/"),L=0,R=0,ie=Math.min(A.length,F.length);L<ie;++L){if(R=A[L].length-F[L].length)return R;if(A[L]!=F[L])return A[L]<F[L]?-1:1}return A.length-F.length}function i(k){if(k.charAt(k.length-1)=="/")return k.slice(0,-1).indexOf("/")===-1?k:i(k.slice(0,-1));var P=k.lastIndexOf("/");return P===-1?k:k.slice(0,P+1)}function r(k){if(k.charAt(k.length-1)=="/")return r(k.slice(0,-1));var P=k.lastIndexOf("/");return P===-1?k:k.slice(P+1)}function a(k,P){typeof P=="string"&&(P=new Date(P));var A=P.getHours();A=A<<6|P.getMinutes(),A=A<<5|P.getSeconds()>>>1,k.write_shift(2,A);var F=P.getFullYear()-1980;F=F<<4|P.getMonth()+1,F=F<<5|P.getDate(),k.write_shift(2,F)}function s(k){var P=k.read_shift(2)&65535,A=k.read_shift(2)&65535,F=new Date,L=A&31;A>>>=5;var R=A&15;A>>>=4,F.setMilliseconds(0),F.setFullYear(A+1980),F.setMonth(R-1),F.setDate(L);var ie=P&31;P>>>=5;var ce=P&63;return P>>>=6,F.setHours(P),F.setMinutes(ce),F.setSeconds(ie<<1),F}function o(k){rn(k,0);for(var P={},A=0;k.l<=k.length-4;){var F=k.read_shift(2),L=k.read_shift(2),R=k.l+L,ie={};switch(F){case 21589:A=k.read_shift(1),A&1&&(ie.mtime=k.read_shift(4)),L>5&&(A&2&&(ie.atime=k.read_shift(4)),A&4&&(ie.ctime=k.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}k.l=R,P[F]=ie}return P}var l;function c(){return l||(l={})}function f(k,P){if(k[0]==80&&k[1]==75)return Yr(k,P);if((k[0]|32)==109&&(k[1]|32)==105)return Fe(k,P);if(k.length<512)throw new Error("CFB file size "+k.length+" < 512");var A=3,F=512,L=0,R=0,ie=0,ce=0,ae=0,re=[],se=k.slice(0,512);rn(se,0);var _e=h(se);switch(A=_e[0],A){case 3:F=512;break;case 4:F=4096;break;case 0:if(_e[1]==0)return Yr(k,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}F!==512&&(se=k.slice(0,F),rn(se,28));var Se=k.slice(0,F);m(se,A);var Pe=se.read_shift(4,"i");if(A===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);se.l+=4,ie=se.read_shift(4,"i"),se.l+=4,se.chk("00100000","Mini Stream Cutoff Size: "),ce=se.read_shift(4,"i"),L=se.read_shift(4,"i"),ae=se.read_shift(4,"i"),R=se.read_shift(4,"i");for(var Ce=-1,Ee=0;Ee<109&&(Ce=se.read_shift(4,"i"),!(Ce<0));++Ee)re[Ee]=Ce;var He=p(k,F);w(ae,R,He,F,re);var vt=S(He,ie,re,F);vt[ie].name="!Directory",L>0&&ce!==me&&(vt[ce].name="!MiniFAT"),vt[re[0]].name="!FAT",vt.fat_addrs=re,vt.ssz=F;var Fn={},Pt=[],zn=[],Na=[];y(ie,vt,He,Pt,L,Fn,zn,ce),v(zn,Na,Pt),Pt.shift();var Ba={FileIndex:zn,FullPaths:Na};return P&&P.raw&&(Ba.raw={header:Se,sectors:He}),Ba}function h(k){if(k[k.l]==80&&k[k.l+1]==75)return[0,0];k.chk(Ae,"Header Signature: "),k.l+=16;var P=k.read_shift(2,"u");return[k.read_shift(2,"u"),P]}function m(k,P){var A=9;switch(k.l+=2,A=k.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}k.chk("0600","Mini Sector Shift: "),k.chk("000000000000","Reserved: ")}function p(k,P){for(var A=Math.ceil(k.length/P)-1,F=[],L=1;L<A;++L)F[L-1]=k.slice(L*P,(L+1)*P);return F[A-1]=k.slice(A*P),F}function v(k,P,A){for(var F=0,L=0,R=0,ie=0,ce=0,ae=A.length,re=[],se=[];F<ae;++F)re[F]=se[F]=F,P[F]=A[F];for(;ce<se.length;++ce)F=se[ce],L=k[F].L,R=k[F].R,ie=k[F].C,re[F]===F&&(L!==-1&&re[L]!==L&&(re[F]=re[L]),R!==-1&&re[R]!==R&&(re[F]=re[R])),ie!==-1&&(re[ie]=F),L!==-1&&F!=re[F]&&(re[L]=re[F],se.lastIndexOf(L)<ce&&se.push(L)),R!==-1&&F!=re[F]&&(re[R]=re[F],se.lastIndexOf(R)<ce&&se.push(R));for(F=1;F<ae;++F)re[F]===F&&(R!==-1&&re[R]!==R?re[F]=re[R]:L!==-1&&re[L]!==L&&(re[F]=re[L]));for(F=1;F<ae;++F)if(k[F].type!==0){if(ce=F,ce!=re[ce])do ce=re[ce],P[F]=P[ce]+"/"+P[F];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[F]=-1}for(P[0]+="/",F=1;F<ae;++F)k[F].type!==2&&(P[F]+="/")}function _(k,P,A){for(var F=k.start,L=k.size,R=[],ie=F;A&&L>0&&ie>=0;)R.push(P.slice(ie*X,ie*X+X)),L-=X,ie=Or(A,ie*4);return R.length===0?zt(0):gr(R).slice(0,k.size)}function w(k,P,A,F,L){var R=me;if(k===me){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(k!==-1){var ie=A[k],ce=(F>>>2)-1;if(!ie)return;for(var ae=0;ae<ce&&(R=Or(ie,ae*4))!==me;++ae)L.push(R);w(Or(ie,F-4),P-1,A,F,L)}}function E(k,P,A,F,L){var R=[],ie=[];L||(L=[]);var ce=F-1,ae=0,re=0;for(ae=P;ae>=0;){L[ae]=!0,R[R.length]=ae,ie.push(k[ae]);var se=A[Math.floor(ae*4/F)];if(re=ae*4&ce,F<4+re)throw new Error("FAT boundary crossed: "+ae+" 4 "+F);if(!k[se])break;ae=Or(k[se],re)}return{nodes:R,data:nh([ie])}}function S(k,P,A,F){var L=k.length,R=[],ie=[],ce=[],ae=[],re=F-1,se=0,_e=0,Se=0,Pe=0;for(se=0;se<L;++se)if(ce=[],Se=se+P,Se>=L&&(Se-=L),!ie[Se]){ae=[];var Ce=[];for(_e=Se;_e>=0;){Ce[_e]=!0,ie[_e]=!0,ce[ce.length]=_e,ae.push(k[_e]);var Ee=A[Math.floor(_e*4/F)];if(Pe=_e*4&re,F<4+Pe)throw new Error("FAT boundary crossed: "+_e+" 4 "+F);if(!k[Ee]||(_e=Or(k[Ee],Pe),Ce[_e]))break}R[Se]={nodes:ce,data:nh([ae])}}return R}function y(k,P,A,F,L,R,ie,ce){for(var ae=0,re=F.length?2:0,se=P[k].data,_e=0,Se=0,Pe;_e<se.length;_e+=128){var Ce=se.slice(_e,_e+128);rn(Ce,64),Se=Ce.read_shift(2),Pe=kl(Ce,0,Se-re),F.push(Pe);var Ee={name:Pe,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},He=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);He!==0&&(Ee.ct=V(Ce,Ce.l-8));var vt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);vt!==0&&(Ee.mt=V(Ce,Ce.l-8)),Ee.start=Ce.read_shift(4,"i"),Ee.size=Ce.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=me,Ee.name=""),Ee.type===5?(ae=Ee.start,L>0&&ae!==me&&(P[ae].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",P[Ee.start]===void 0&&(P[Ee.start]=E(A,Ee.start,P.fat_addrs,P.ssz)),P[Ee.start].name=Ee.name,Ee.content=P[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:ae!==me&&Ee.start!==me&&P[ae]&&(Ee.content=_(Ee,P[ae].data,(P[ce]||{}).data))),Ee.content&&rn(Ee.content,0),R[Pe]=Ee,ie.push(Ee)}}function V(k,P){return new Date((qt(k,P+4)/1e7*Math.pow(2,32)+qt(k,P)/1e7-11644473600)*1e3)}function H(k,P){return c(),f(l.readFileSync(k),P)}function I(k,P){var A=P&&P.type;switch(A||Je&&Buffer.isBuffer(k)&&(A="buffer"),A||"base64"){case"file":return H(k,P);case"base64":return f(di(jn(k)),P);case"binary":return f(di(k),P)}return f(k,P)}function T(k,P){var A=P||{},F=A.root||"Root Entry";if(k.FullPaths||(k.FullPaths=[]),k.FileIndex||(k.FileIndex=[]),k.FullPaths.length!==k.FileIndex.length)throw new Error("inconsistent CFB structure");k.FullPaths.length===0&&(k.FullPaths[0]=F+"/",k.FileIndex[0]={name:F,type:5}),A.CLSID&&(k.FileIndex[0].clsid=A.CLSID),N(k)}function N(k){var P="Sh33tJ5";if(!Qe.find(k,"/"+P)){var A=zt(4);A[0]=55,A[1]=A[3]=50,A[2]=54,k.FileIndex.push({name:P,type:2,content:A,size:4,L:69,R:69,C:69}),k.FullPaths.push(k.FullPaths[0]+P),W(k)}}function W(k,P){T(k);for(var A=!1,F=!1,L=k.FullPaths.length-1;L>=0;--L){var R=k.FileIndex[L];switch(R.type){case 0:F?A=!0:(k.FileIndex.pop(),k.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(R.R*R.L*R.C)&&(A=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!P)){var ie=new Date(1987,1,19),ce=0,ae=Object.create?Object.create(null):{},re=[];for(L=0;L<k.FullPaths.length;++L)ae[k.FullPaths[L]]=!0,k.FileIndex[L].type!==0&&re.push([k.FullPaths[L],k.FileIndex[L]]);for(L=0;L<re.length;++L){var se=i(re[L][0]);F=ae[se],F||(re.push([se,{name:r(se).replace("/",""),type:1,clsid:ke,ct:ie,mt:ie,content:null}]),ae[se]=!0)}for(re.sort(function(Pe,Ce){return e(Pe[0],Ce[0])}),k.FullPaths=[],k.FileIndex=[],L=0;L<re.length;++L)k.FullPaths[L]=re[L][0],k.FileIndex[L]=re[L][1];for(L=0;L<re.length;++L){var _e=k.FileIndex[L],Se=k.FullPaths[L];if(_e.name=r(Se).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||ke,L===0)_e.C=re.length>1?1:-1,_e.size=0,_e.type=5;else if(Se.slice(-1)=="/"){for(ce=L+1;ce<re.length&&i(k.FullPaths[ce])!=Se;++ce);for(_e.C=ce>=re.length?-1:ce,ce=L+1;ce<re.length&&i(k.FullPaths[ce])!=i(Se);++ce);_e.R=ce>=re.length?-1:ce,_e.type=1}else i(k.FullPaths[L+1]||"")==i(Se)&&(_e.R=L+1),_e.type=2}}}function ee(k,P){var A=P||{};if(A.fileType=="mad")return ze(k,A);switch(W(k),A.fileType){case"zip":return Dl(k,A)}var F=function(Pe){for(var Ce=0,Ee=0,He=0;He<Pe.FileIndex.length;++He){var vt=Pe.FileIndex[He];if(vt.content){var Fn=vt.content.length;Fn>0&&(Fn<4096?Ce+=Fn+63>>6:Ee+=Fn+511>>9)}}for(var Pt=Pe.FullPaths.length+3>>2,zn=Ce+7>>3,Na=Ce+127>>7,Ba=zn+Ee+Pt+Na,Cr=Ba+127>>7,Fl=Cr<=109?0:Math.ceil((Cr-109)/127);Ba+Cr+Fl+127>>7>Cr;)Fl=++Cr<=109?0:Math.ceil((Cr-109)/127);var Pi=[1,Fl,Cr,Na,Pt,Ee,Ce,0];return Pe.FileIndex[0].size=Ce<<6,Pi[7]=(Pe.FileIndex[0].start=Pi[0]+Pi[1]+Pi[2]+Pi[3]+Pi[4]+Pi[5])+(Pi[6]+7>>3),Pi}(k),L=zt(F[7]<<9),R=0,ie=0;{for(R=0;R<8;++R)L.write_shift(1,he[R]);for(R=0;R<8;++R)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),R=0;R<3;++R)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:me),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:me),L.write_shift(4,F[1]),R=0;R<109;++R)L.write_shift(-4,R<F[2]?F[1]+R:-1)}if(F[1])for(ie=0;ie<F[1];++ie){for(;R<236+ie*127;++R)L.write_shift(-4,R<F[2]?F[1]+R:-1);L.write_shift(-4,ie===F[1]-1?me:ie+1)}var ce=function(Pe){for(ie+=Pe;R<ie-1;++R)L.write_shift(-4,R+1);Pe&&(++R,L.write_shift(-4,me))};for(ie=R=0,ie+=F[1];R<ie;++R)L.write_shift(-4,we.DIFSECT);for(ie+=F[2];R<ie;++R)L.write_shift(-4,we.FATSECT);ce(F[3]),ce(F[4]);for(var ae=0,re=0,se=k.FileIndex[0];ae<k.FileIndex.length;++ae)se=k.FileIndex[ae],se.content&&(re=se.content.length,!(re<4096)&&(se.start=ie,ce(re+511>>9)));for(ce(F[6]+7>>3);L.l&511;)L.write_shift(-4,we.ENDOFCHAIN);for(ie=R=0,ae=0;ae<k.FileIndex.length;++ae)se=k.FileIndex[ae],se.content&&(re=se.content.length,!(!re||re>=4096)&&(se.start=ie,ce(re+63>>6)));for(;L.l&511;)L.write_shift(-4,we.ENDOFCHAIN);for(R=0;R<F[4]<<2;++R){var _e=k.FullPaths[R];if(!_e||_e.length===0){for(ae=0;ae<17;++ae)L.write_shift(4,0);for(ae=0;ae<3;++ae)L.write_shift(4,-1);for(ae=0;ae<12;++ae)L.write_shift(4,0);continue}se=k.FileIndex[R],R===0&&(se.start=se.size?se.start-1:me);var Se=R===0&&A.root||se.name;if(re=2*(Se.length+1),L.write_shift(64,Se,"utf16le"),L.write_shift(2,re),L.write_shift(1,se.type),L.write_shift(1,se.color),L.write_shift(-4,se.L),L.write_shift(-4,se.R),L.write_shift(-4,se.C),se.clsid)L.write_shift(16,se.clsid,"hex");else for(ae=0;ae<4;++ae)L.write_shift(4,0);L.write_shift(4,se.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,se.start),L.write_shift(4,se.size),L.write_shift(4,0)}for(R=1;R<k.FileIndex.length;++R)if(se=k.FileIndex[R],se.size>=4096)if(L.l=se.start+1<<9,Je&&Buffer.isBuffer(se.content))se.content.copy(L,L.l,0,se.size),L.l+=se.size+511&-512;else{for(ae=0;ae<se.size;++ae)L.write_shift(1,se.content[ae]);for(;ae&511;++ae)L.write_shift(1,0)}for(R=1;R<k.FileIndex.length;++R)if(se=k.FileIndex[R],se.size>0&&se.size<4096)if(Je&&Buffer.isBuffer(se.content))se.content.copy(L,L.l,0,se.size),L.l+=se.size+63&-64;else{for(ae=0;ae<se.size;++ae)L.write_shift(1,se.content[ae]);for(;ae&63;++ae)L.write_shift(1,0)}if(Je)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function te(k,P){var A=k.FullPaths.map(function(ae){return ae.toUpperCase()}),F=A.map(function(ae){var re=ae.split("/");return re[re.length-(ae.slice(-1)=="/"?2:1)]}),L=!1;P.charCodeAt(0)===47?(L=!0,P=A[0].slice(0,-1)+P):L=P.indexOf("/")!==-1;var R=P.toUpperCase(),ie=L===!0?A.indexOf(R):F.indexOf(R);if(ie!==-1)return k.FileIndex[ie];var ce=!R.match(hs);for(R=R.replace(wn,""),ce&&(R=R.replace(hs,"!")),ie=0;ie<A.length;++ie)if((ce?A[ie].replace(hs,"!"):A[ie]).replace(wn,"")==R||(ce?F[ie].replace(hs,"!"):F[ie]).replace(wn,"")==R)return k.FileIndex[ie];return null}var X=64,me=-2,Ae="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],ke="00000000000000000000000000000000",we={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:Ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ke,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ve(k,P,A){c();var F=ee(k,A);l.writeFileSync(P,F)}function ve(k){for(var P=new Array(k.length),A=0;A<k.length;++A)P[A]=String.fromCharCode(k[A]);return P.join("")}function Ie(k,P){var A=ee(k,P);switch(P&&P.type||"buffer"){case"file":return c(),l.writeFileSync(P.filename,A),A;case"binary":return typeof A=="string"?A:ve(A);case"base64":return Vu(typeof A=="string"?A:ve(A));case"buffer":if(Je)return Buffer.isBuffer(A)?A:Ur(A);case"array":return typeof A=="string"?di(A):A}return A}var fe;function j(k){try{var P=k.InflateRaw,A=new P;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)fe=k;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function ne(k,P){if(!fe)return Ns(k,P);var A=fe.InflateRaw,F=new A,L=F._processChunk(k.slice(k.l),F._finishFlushFlag);return k.l+=F.bytesRead,L}function Q(k){return fe?fe.deflateRawSync(k):Ge(k)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],De=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(k){var P=(k<<1|k<<11)&139536|(k<<5|k<<15)&558144;return(P>>16|P>>8|P)&255}for(var Me=typeof Uint8Array<"u",pe=Me?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)pe[Xe]=be(Xe);function G(k,P){var A=pe[k&255];return P<=8?A>>>8-P:(A=A<<8|pe[k>>8&255],P<=16?A>>>16-P:(A=A<<8|pe[k>>16&255],A>>>24-P))}function _t(k,P){var A=P&7,F=P>>>3;return(k[F]|(A<=6?0:k[F+1]<<8))>>>A&3}function qe(k,P){var A=P&7,F=P>>>3;return(k[F]|(A<=5?0:k[F+1]<<8))>>>A&7}function it(k,P){var A=P&7,F=P>>>3;return(k[F]|(A<=4?0:k[F+1]<<8))>>>A&15}function $e(k,P){var A=P&7,F=P>>>3;return(k[F]|(A<=3?0:k[F+1]<<8))>>>A&31}function Te(k,P){var A=P&7,F=P>>>3;return(k[F]|(A<=1?0:k[F+1]<<8))>>>A&127}function bt(k,P,A){var F=P&7,L=P>>>3,R=(1<<A)-1,ie=k[L]>>>F;return A<8-F||(ie|=k[L+1]<<8-F,A<16-F)||(ie|=k[L+2]<<16-F,A<24-F)||(ie|=k[L+3]<<24-F),ie&R}function Qt(k,P,A){var F=P&7,L=P>>>3;return F<=5?k[L]|=(A&7)<<F:(k[L]|=A<<F&255,k[L+1]=(A&7)>>8-F),P+3}function Gn(k,P,A){var F=P&7,L=P>>>3;return A=(A&1)<<F,k[L]|=A,P+1}function ii(k,P,A){var F=P&7,L=P>>>3;return A<<=F,k[L]|=A&255,A>>>=8,k[L+1]=A,P+8}function Ki(k,P,A){var F=P&7,L=P>>>3;return A<<=F,k[L]|=A&255,A>>>=8,k[L+1]=A&255,k[L+2]=A>>>8,P+16}function $n(k,P){var A=k.length,F=2*A>P?2*A:P+5,L=0;if(A>=P)return k;if(Je){var R=Nu(F);if(k.copy)k.copy(R);else for(;L<k.length;++L)R[L]=k[L];return R}else if(Me){var ie=new Uint8Array(F);if(ie.set)ie.set(k);else for(;L<A;++L)ie[L]=k[L];return ie}return k.length=F,k}function on(k){for(var P=new Array(k),A=0;A<k;++A)P[A]=0;return P}function Dn(k,P,A){var F=1,L=0,R=0,ie=0,ce=0,ae=k.length,re=Me?new Uint16Array(32):on(32);for(R=0;R<32;++R)re[R]=0;for(R=ae;R<A;++R)k[R]=0;ae=k.length;var se=Me?new Uint16Array(ae):on(ae);for(R=0;R<ae;++R)re[L=k[R]]++,F<L&&(F=L),se[R]=0;for(re[0]=0,R=1;R<=F;++R)re[R+16]=ce=ce+re[R-1]<<1;for(R=0;R<ae;++R)ce=k[R],ce!=0&&(se[R]=re[ce+16]++);var _e=0;for(R=0;R<ae;++R)if(_e=k[R],_e!=0)for(ce=G(se[R],F)>>F-_e,ie=(1<<F+4-_e)-1;ie>=0;--ie)P[ce|ie<<_e]=_e&15|R<<4;return F}var mi=Me?new Uint16Array(512):on(512),qi=Me?new Uint16Array(32):on(32);if(!Me){for(var Zt=0;Zt<512;++Zt)mi[Zt]=0;for(Zt=0;Zt<32;++Zt)qi[Zt]=0}(function(){for(var k=[],P=0;P<32;P++)k.push(5);Dn(k,qi,32);var A=[];for(P=0;P<=143;P++)A.push(8);for(;P<=255;P++)A.push(9);for(;P<=279;P++)A.push(7);for(;P<=287;P++)A.push(8);Dn(A,mi,288)})();var Un=function(){for(var P=Me?new Uint8Array(32768):[],A=0,F=0;A<De.length-1;++A)for(;F<De[A+1];++F)P[F]=A;for(;F<32768;++F)P[F]=29;var L=Me?new Uint8Array(259):[];for(A=0,F=0;A<de.length-1;++A)for(;F<de[A+1];++F)L[F]=A;function R(ce,ae){for(var re=0;re<ce.length;){var se=Math.min(65535,ce.length-re),_e=re+se==ce.length;for(ae.write_shift(1,+_e),ae.write_shift(2,se),ae.write_shift(2,~se&65535);se-- >0;)ae[ae.l++]=ce[re++]}return ae.l}function ie(ce,ae){for(var re=0,se=0,_e=Me?new Uint16Array(32768):[];se<ce.length;){var Se=Math.min(65535,ce.length-se);if(Se<10){for(re=Qt(ae,re,+(se+Se==ce.length)),re&7&&(re+=8-(re&7)),ae.l=re/8|0,ae.write_shift(2,Se),ae.write_shift(2,~Se&65535);Se-- >0;)ae[ae.l++]=ce[se++];re=ae.l*8;continue}re=Qt(ae,re,+(se+Se==ce.length)+2);for(var Pe=0;Se-- >0;){var Ce=ce[se];Pe=(Pe<<5^Ce)&32767;var Ee=-1,He=0;if((Ee=_e[Pe])&&(Ee|=se&-32768,Ee>se&&(Ee-=32768),Ee<se))for(;ce[Ee+He]==ce[se+He]&&He<250;)++He;if(He>2){Ce=L[He],Ce<=22?re=ii(ae,re,pe[Ce+1]>>1)-1:(ii(ae,re,3),re+=5,ii(ae,re,pe[Ce-23]>>5),re+=3);var vt=Ce<8?0:Ce-4>>2;vt>0&&(Ki(ae,re,He-de[Ce]),re+=vt),Ce=P[se-Ee],re=ii(ae,re,pe[Ce]>>3),re-=3;var Fn=Ce<4?0:Ce-2>>1;Fn>0&&(Ki(ae,re,se-Ee-De[Ce]),re+=Fn);for(var Pt=0;Pt<He;++Pt)_e[Pe]=se&32767,Pe=(Pe<<5^ce[se])&32767,++se;Se-=He-1}else Ce<=143?Ce=Ce+48:re=Gn(ae,re,1),re=ii(ae,re,pe[Ce]),_e[Pe]=se&32767,++se}re=ii(ae,re,0)-1}return ae.l=(re+7)/8|0,ae.l}return function(ae,re){return ae.length<8?R(ae,re):ie(ae,re)}}();function Ge(k){var P=zt(50+Math.floor(k.length*1.1)),A=Un(k,P);return P.slice(0,A)}var Ct=Me?new Uint16Array(32768):on(32768),Cn=Me?new Uint16Array(32768):on(32768),Dt=Me?new Uint16Array(128):on(128),Ii=1,mt=1;function Ra(k,P){var A=$e(k,P)+257;P+=5;var F=$e(k,P)+1;P+=5;var L=it(k,P)+4;P+=4;for(var R=0,ie=Me?new Uint8Array(19):on(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,re=Me?new Uint8Array(8):on(8),se=Me?new Uint8Array(8):on(8),_e=ie.length,Se=0;Se<L;++Se)ie[K[Se]]=R=qe(k,P),ae<R&&(ae=R),re[R]++,P+=3;var Pe=0;for(re[0]=0,Se=1;Se<=ae;++Se)se[Se]=Pe=Pe+re[Se-1]<<1;for(Se=0;Se<_e;++Se)(Pe=ie[Se])!=0&&(ce[Se]=se[Pe]++);var Ce=0;for(Se=0;Se<_e;++Se)if(Ce=ie[Se],Ce!=0){Pe=pe[ce[Se]]>>8-Ce;for(var Ee=(1<<7-Ce)-1;Ee>=0;--Ee)Dt[Pe|Ee<<Ce]=Ce&7|Se<<3}var He=[];for(ae=1;He.length<A+F;)switch(Pe=Dt[Te(k,P)],P+=Pe&7,Pe>>>=3){case 16:for(R=3+_t(k,P),P+=2,Pe=He[He.length-1];R-- >0;)He.push(Pe);break;case 17:for(R=3+qe(k,P),P+=3;R-- >0;)He.push(0);break;case 18:for(R=11+Te(k,P),P+=7;R-- >0;)He.push(0);break;default:He.push(Pe),ae<Pe&&(ae=Pe);break}var vt=He.slice(0,A),Fn=He.slice(A);for(Se=A;Se<286;++Se)vt[Se]=0;for(Se=F;Se<30;++Se)Fn[Se]=0;return Ii=Dn(vt,Ct,286),mt=Dn(Fn,Cn,30),P}function Va(k,P){if(k[0]==3&&!(k[1]&3))return[wr(P),2];for(var A=0,F=0,L=Nu(P||1<<18),R=0,ie=L.length>>>0,ce=0,ae=0;(F&1)==0;){if(F=qe(k,A),A+=3,F>>>1)F>>1==1?(ce=9,ae=5):(A=Ra(k,A),ce=Ii,ae=mt);else{A&7&&(A+=8-(A&7));var re=k[A>>>3]|k[(A>>>3)+1]<<8;if(A+=32,re>0)for(!P&&ie<R+re&&(L=$n(L,R+re),ie=L.length);re-- >0;)L[R++]=k[A>>>3],A+=8;continue}for(;;){!P&&ie<R+32767&&(L=$n(L,R+32767),ie=L.length);var se=bt(k,A,ce),_e=F>>>1==1?mi[se]:Ct[se];if(A+=_e&15,_e>>>=4,(_e>>>8&255)===0)L[R++]=_e;else{if(_e==256)break;_e-=257;var Se=_e<8?0:_e-4>>2;Se>5&&(Se=0);var Pe=R+de[_e];Se>0&&(Pe+=bt(k,A,Se),A+=Se),se=bt(k,A,ae),_e=F>>>1==1?qi[se]:Cn[se],A+=_e&15,_e>>>=4;var Ce=_e<4?0:_e-2>>1,Ee=De[_e];for(Ce>0&&(Ee+=bt(k,A,Ce),A+=Ce),!P&&ie<Pe&&(L=$n(L,Pe+100),ie=L.length);R<Pe;)L[R]=L[R-Ee],++R}}}return P?[L,A+7>>>3]:[L.slice(0,R),A+7>>>3]}function Ns(k,P){var A=k.slice(k.l||0),F=Va(A,P);return k.l+=F[1],F[0]}function Sr(k,P){if(k)typeof console<"u"&&console.error(P);else throw new Error(P)}function Yr(k,P){var A=k;rn(A,0);var F=[],L=[],R={FileIndex:F,FullPaths:L};T(R,{root:P.root});for(var ie=A.length-4;(A[ie]!=80||A[ie+1]!=75||A[ie+2]!=5||A[ie+3]!=6)&&ie>=0;)--ie;A.l=ie+4,A.l+=4;var ce=A.read_shift(2);A.l+=6;var ae=A.read_shift(4);for(A.l=ae,ie=0;ie<ce;++ie){A.l+=20;var re=A.read_shift(4),se=A.read_shift(4),_e=A.read_shift(2),Se=A.read_shift(2),Pe=A.read_shift(2);A.l+=8;var Ce=A.read_shift(4),Ee=o(A.slice(A.l+_e,A.l+_e+Se));A.l+=_e+Se+Pe;var He=A.l;A.l=Ce+4,ri(A,re,se,R,Ee),A.l=He}return R}function ri(k,P,A,F,L){k.l+=2;var R=k.read_shift(2),ie=k.read_shift(2),ce=s(k);if(R&8257)throw new Error("Unsupported ZIP encryption");for(var ae=k.read_shift(4),re=k.read_shift(4),se=k.read_shift(4),_e=k.read_shift(2),Se=k.read_shift(2),Pe="",Ce=0;Ce<_e;++Ce)Pe+=String.fromCharCode(k[k.l++]);if(Se){var Ee=o(k.slice(k.l,k.l+Se));(Ee[21589]||{}).mt&&(ce=Ee[21589].mt),((L||{})[21589]||{}).mt&&(ce=L[21589].mt)}k.l+=Se;var He=k.slice(k.l,k.l+re);switch(ie){case 8:He=ne(k,se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var vt=!1;R&8&&(ae=k.read_shift(4),ae==134695760&&(ae=k.read_shift(4),vt=!0),re=k.read_shift(4),se=k.read_shift(4)),re!=P&&Sr(vt,"Bad compressed size: "+P+" != "+re),se!=A&&Sr(vt,"Bad uncompressed size: "+A+" != "+se),We(F,Pe,He,{unsafe:!0,mt:ce})}function Dl(k,P){var A=P||{},F=[],L=[],R=zt(1),ie=A.compression?8:0,ce=0,ae=!1;ae&&(ce|=8);var re=0,se=0,_e=0,Se=0,Pe=k.FullPaths[0],Ce=Pe,Ee=k.FileIndex[0],He=[],vt=0;for(re=1;re<k.FullPaths.length;++re)if(Ce=k.FullPaths[re].slice(Pe.length),Ee=k.FileIndex[re],!(!Ee.size||!Ee.content||Ce=="Sh33tJ5")){var Fn=_e,Pt=zt(Ce.length);for(se=0;se<Ce.length;++se)Pt.write_shift(1,Ce.charCodeAt(se)&127);Pt=Pt.slice(0,Pt.l),He[Se]=G4.buf(Ee.content,0);var zn=Ee.content;ie==8&&(zn=Q(zn)),R=zt(30),R.write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,ce),R.write_shift(2,ie),Ee.mt?a(R,Ee.mt):R.write_shift(4,0),R.write_shift(-4,ce&8?0:He[Se]),R.write_shift(4,ce&8?0:zn.length),R.write_shift(4,ce&8?0:Ee.content.length),R.write_shift(2,Pt.length),R.write_shift(2,0),_e+=R.length,F.push(R),_e+=Pt.length,F.push(Pt),_e+=zn.length,F.push(zn),ce&8&&(R=zt(12),R.write_shift(-4,He[Se]),R.write_shift(4,zn.length),R.write_shift(4,Ee.content.length),_e+=R.l,F.push(R)),R=zt(46),R.write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,ce),R.write_shift(2,ie),R.write_shift(4,0),R.write_shift(-4,He[Se]),R.write_shift(4,zn.length),R.write_shift(4,Ee.content.length),R.write_shift(2,Pt.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,Fn),vt+=R.l,L.push(R),vt+=Pt.length,L.push(Pt),++Se}return R=zt(22),R.write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,Se),R.write_shift(2,Se),R.write_shift(4,vt),R.write_shift(4,_e),R.write_shift(2,0),gr([gr(F),gr(L),R])}var Xr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function M(k,P){if(k.ctype)return k.ctype;var A=k.name||"",F=A.match(/\.([^\.]+)$/);return F&&Xr[F[1]]||P&&(F=(A=P).match(/[\.\\]([^\.\\])+$/),F&&Xr[F[1]])?Xr[F[1]]:"application/octet-stream"}function O(k){for(var P=Vu(k),A=[],F=0;F<P.length;F+=76)A.push(P.slice(F,F+76));return A.join(`\r
`)+`\r
`}function Z(k){var P=k.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var se=re.charCodeAt(0).toString(16).toUpperCase();return"="+(se.length==1?"0"+se:se)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],F=P.split(`\r
`),L=0;L<F.length;++L){var R=F[L];if(R.length==0){A.push("");continue}for(var ie=0;ie<R.length;){var ce=76,ae=R.slice(ie,ie+ce);ae.charAt(ce-1)=="="?ce--:ae.charAt(ce-2)=="="?ce-=2:ae.charAt(ce-3)=="="&&(ce-=3),ae=R.slice(ie,ie+ce),ie+=ce,ie<R.length&&(ae+="="),A.push(ae)}}return A.join(`\r
`)}function le(k){for(var P=[],A=0;A<k.length;++A){for(var F=k[A];A<=k.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+k[++A];P.push(F)}for(var L=0;L<P.length;++L)P[L]=P[L].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return di(P.join(`\r
`))}function ye(k,P,A){for(var F="",L="",R="",ie,ce=0;ce<10;++ce){var ae=P[ce];if(!ae||ae.match(/^\s*$/))break;var re=ae.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":F=re[2].trim();break;case"content-type":R=re[2].trim();break;case"content-transfer-encoding":L=re[2].trim();break}}switch(++ce,L.toLowerCase()){case"base64":ie=di(jn(P.slice(ce).join("")));break;case"quoted-printable":ie=le(P.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var se=We(k,F.slice(A.length),ie,{unsafe:!0});R&&(se.ctype=R)}function Fe(k,P){if(ve(k.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=P&&P.root||"",F=(Je&&Buffer.isBuffer(k)?k.toString("binary"):ve(k)).split(`\r
`),L=0,R="";for(L=0;L<F.length;++L)if(R=F[L],!!/^Content-Location:/i.test(R)&&(R=R.slice(R.indexOf("file")),A||(A=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),R.slice(0,A.length)!=A););var ie=(F[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var ce="--"+(ie[1]||""),ae=[],re=[],se={FileIndex:ae,FullPaths:re};T(se);var _e,Se=0;for(L=0;L<F.length;++L){var Pe=F[L];Pe!==ce&&Pe!==ce+"--"||(Se++&&ye(se,F.slice(_e,L),A),_e=L)}return se}function ze(k,P){var A=P||{},F=A.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],R=k.FullPaths[0],ie=R,ce=k.FileIndex[0],ae=1;ae<k.FullPaths.length;++ae)if(ie=k.FullPaths[ae].slice(R.length),ce=k.FileIndex[ae],!(!ce.size||!ce.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,se=Je&&Buffer.isBuffer(re)?re.toString("binary"):ve(re),_e=0,Se=Math.min(1024,se.length),Pe=0,Ce=0;Ce<=Se;++Ce)(Pe=se.charCodeAt(Ce))>=32&&Pe<128&&++_e;var Ee=_e>=Se*4/5;L.push(F),L.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+ie),L.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),L.push("Content-Type: "+M(ce,ie)),L.push(""),L.push(Ee?Z(se):O(se))}return L.push(F+`--\r
`),L.join(`\r
`)}function Le(k){var P={};return T(P,k),P}function We(k,P,A,F){var L=F&&F.unsafe;L||T(k);var R=!L&&Qe.find(k,P);if(!R){var ie=k.FullPaths[0];P.slice(0,ie.length)==ie?ie=P:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+P).replace("//","/")),R={name:r(P),type:2},k.FileIndex.push(R),k.FullPaths.push(ie),L||Qe.utils.cfb_gc(k)}return R.content=A,R.size=A?A.length:0,F&&(F.CLSID&&(R.clsid=F.CLSID),F.mt&&(R.mt=F.mt),F.ct&&(R.ct=F.ct)),R}function Oe(k,P){T(k);var A=Qe.find(k,P);if(A){for(var F=0;F<k.FileIndex.length;++F)if(k.FileIndex[F]==A)return k.FileIndex.splice(F,1),k.FullPaths.splice(F,1),!0}return!1}function Re(k,P,A){T(k);var F=Qe.find(k,P);if(F){for(var L=0;L<k.FileIndex.length;++L)if(k.FileIndex[L]==F)return k.FileIndex[L].name=r(A),k.FullPaths[L]=A,!0}return!1}function dt(k){W(k,!0)}return n.find=te,n.read=I,n.parse=f,n.write=Ie,n.writeFile=Ve,n.utils={cfb_new:Le,cfb_add:We,cfb_del:Oe,cfb_mov:Re,cfb_gc:dt,ReadShift:gs,CheckField:xm,prep_blob:rn,bconcat:gr,use_zlib:j,_deflateRaw:Ge,_inflateRaw:Ns,consts:we},n}(),$u;function $4(t){if(typeof $u<"u")return $u.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(t);n.open("r"),n.encoding="binary";var e=n.read();return n.close(),e}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+t)}function Mi(t){for(var n=Object.keys(t),e=[],i=0;i<n.length;++i)Object.prototype.hasOwnProperty.call(t,n[i])&&e.push(n[i]);return e}function kc(t){for(var n=[],e=Mi(t),i=0;i!==e.length;++i)n[t[e[i]]]=e[i];return n}var pl=new Date(1899,11,30,0,0,0);function Mn(t,n){var e=t.getTime();n&&(e-=1462*24*60*60*1e3);var i=pl.getTime()+(t.getTimezoneOffset()-pl.getTimezoneOffset())*6e4;return(e-i)/(24*60*60*1e3)}var em=new Date,Y4=pl.getTime()+(em.getTimezoneOffset()-pl.getTimezoneOffset())*6e4,Yu=em.getTimezoneOffset();function Cl(t){var n=new Date;return n.setTime(t*24*60*60*1e3+Y4),n.getTimezoneOffset()!==Yu&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Yu)*6e4),n}function X4(t){var n=0,e=0,i=!1,r=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=r.length;++a)if(r[a]){switch(e=1,a>3&&(i=!0),r[a].slice(r[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[a].slice(r[a].length-1));case"D":e*=24;case"H":e*=60;case"M":if(i)e*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}n+=e*parseInt(r[a],10)}return n}var Xu=new Date("2017-02-19T19:06:09.000Z"),tm=isNaN(Xu.getFullYear())?new Date("2/19/17"):Xu,K4=tm.getFullYear()==2017;function Jt(t,n){var e=new Date(t);if(K4)return n>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):n<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(tm.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return t.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var r=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Br(t,n){if(Je&&Buffer.isBuffer(t)){if(n){if(t[0]==255&&t[1]==254)return ps(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ps(Uh(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(t[0]==255&&t[1]==254)return ps(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ps(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return e[a]||a})}catch{}for(var i=[],r=0;r!=t.length;++r)i.push(String.fromCharCode(t[r]));return i.join("")}function an(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=an(t[e]));return n}function At(t,n){for(var e="";e.length<n;)e+=t;return e}function hi(t){var n=Number(t);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(t))return n;var e=1,i=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(n=Number(i))||(i=i.replace(/[(](.*)[)]/,function(r,a){return e=-e,a}),!isNaN(n=Number(i)))?n/e:n}var q4=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ma(t){var n=new Date(t),e=new Date(NaN),i=n.getYear(),r=n.getMonth(),a=n.getDate();if(isNaN(a))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&q4.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return i<0||i>8099?e:(r>0||a>1)&&i!=101?n:t.match(/[^-0-9:,\/\\]/)?e:n}var J4=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,i,r){if(t||typeof i=="string")return e.split(i);for(var a=e.split(i),s=[a[0]],o=1;o<a.length;++o)s.push(r),s.push(a[o]);return s}}();function nm(t){return t?t.content&&t.type?Br(t.content,!0):t.data?us(t.data):t.asNodeBuffer&&Je?us(t.asNodeBuffer().toString("binary")):t.asBinary?us(t.asBinary()):t._data&&t._data.getContent?us(Br(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function im(t){if(!t)return null;if(t.data)return cc(t.data);if(t.asNodeBuffer&&Je)return t.asNodeBuffer();if(t._data&&t._data.getContent){var n=t._data.getContent();return typeof n=="string"?cc(n):Array.prototype.slice.call(n)}return t.content&&t.type?t.content:null}function Q4(t){return t&&t.name.slice(-4)===".bin"?im(t):nm(t)}function ei(t,n){for(var e=t.FullPaths||Mi(t.files),i=n.toLowerCase().replace(/[\/]/g,"\\"),r=i.replace(/\\/g,"/"),a=0;a<e.length;++a){var s=e[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==s||r==s)return t.files?t.files[e[a]]:t.FileIndex[a]}return null}function Ec(t,n){var e=ei(t,n);if(e==null)throw new Error("Cannot find file "+n+" in zip");return e}function Ht(t,n,e){if(!e)return Q4(Ec(t,n));if(!n)return null;try{return Ht(t,n)}catch{return null}}function Wn(t,n,e){if(!e)return nm(Ec(t,n));if(!n)return null;try{return Wn(t,n)}catch{return null}}function rm(t,n,e){if(!e)return im(Ec(t,n));if(!n)return null;try{return rm(t,n)}catch{return null}}function Ku(t){for(var n=t.FullPaths||Mi(t.files),e=[],i=0;i<n.length;++i)n[i].slice(-1)!="/"&&e.push(n[i].replace(/^Root Entry[\/]/,""));return e.sort()}function Z4(t,n,e){if(t.FullPaths){if(typeof e=="string"){var i;return Je?i=Ur(e):i=v4(e),Qe.utils.cfb_add(t,n,i)}Qe.utils.cfb_add(t,n,e)}else t.file(n,e)}function am(t,n){switch(n.type){case"base64":return Qe.read(t,{type:"base64"});case"binary":return Qe.read(t,{type:"binary"});case"buffer":case"array":return Qe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ms(t,n){if(t.charAt(0)=="/")return t.slice(1);var e=n.split("/");n.slice(-1)!="/"&&e.pop();for(var i=t.split("/");i.length!==0;){var r=i.shift();r===".."?e.pop():r!=="."&&e.push(r)}return e.join("/")}var sm=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,e3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qu=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,t3=/<[^>]*>/g,Sn=sm.match(qu)?qu:t3,n3=/<\w*:/,i3=/<(\/?)\w+:/;function Ne(t,n,e){for(var i={},r=0,a=0;r!==t.length&&!((a=t.charCodeAt(r))===32||a===10||a===13);++r);if(n||(i[0]=t.slice(0,r)),r===t.length)return i;var s=t.match(e3),o=0,l="",c=0,f="",h="",m=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(f=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(m=(r=h.charCodeAt(a+1))==34||r==39?1:0,l=h.slice(a+1+m,h.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),i[f]=l,e||(i[f.toLowerCase()]=l);else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(i[p]&&f.slice(o-3,o)=="ext")continue;i[p]=l,e||(i[p.toLowerCase()]=l)}}return i}function Di(t){return t.replace(i3,"<$1")}var om={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},r3=kc(om),tt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function e(i){var r=i+"",a=r.indexOf("<![CDATA[");if(a==-1)return r.replace(t,function(o,l){return om[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(n,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=r.indexOf("]]>");return e(r.slice(0,a))+r.slice(a+9,s)+e(r.slice(s+3))}}(),a3=/[&<>'"]/g;var s3=/[\u0000-\u001f]/g;function Tc(t){var n=t+"";return n.replace(a3,function(e){return r3[e]}).replace(/\n/g,"<br/>").replace(s3,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ju=function(){var t=/&#(\d+);/g;function n(e,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(t,n)}}();function St(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ec(t){for(var n="",e=0,i=0,r=0,a=0,s=0,o=0;e<t.length;){if(i=t.charCodeAt(e++),i<128){n+=String.fromCharCode(i);continue}if(r=t.charCodeAt(e++),i>191&&i<224){s=(i&31)<<6,s|=r&63,n+=String.fromCharCode(s);continue}if(a=t.charCodeAt(e++),i<240){n+=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63);continue}s=t.charCodeAt(e++),o=((i&7)<<18|(r&63)<<12|(a&63)<<6|s&63)-65536,n+=String.fromCharCode(55296+(o>>>10&1023)),n+=String.fromCharCode(56320+(o&1023))}return n}function Qu(t){var n=wr(2*t.length),e,i,r=1,a=0,s=0,o;for(i=0;i<t.length;i+=r)r=1,(o=t.charCodeAt(i))<128?e=o:o<224?(e=(o&31)*64+(t.charCodeAt(i+1)&63),r=2):o<240?(e=(o&15)*4096+(t.charCodeAt(i+1)&63)*64+(t.charCodeAt(i+2)&63),r=3):(r=4,e=(o&7)*262144+(t.charCodeAt(i+1)&63)*4096+(t.charCodeAt(i+2)&63)*64+(t.charCodeAt(i+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(n[a++]=s&255,n[a++]=s>>>8,s=0),n[a++]=e%256,n[a++]=e>>>8;return n.slice(0,a).toString("ucs2")}function Zu(t){return Ur(t,"binary").toString("utf8")}var rl="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",xt=Je&&(Zu(rl)==ec(rl)&&Zu||Qu(rl)==ec(rl)&&Qu)||ec,ps=Je?function(t){return Ur(t,"utf8").toString("binary")}:function(t){for(var n=[],e=0,i=0,r=0;e<t.length;)switch(i=t.charCodeAt(e++),!0){case i<128:n.push(String.fromCharCode(i));break;case i<2048:n.push(String.fromCharCode(192+(i>>6))),n.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=t.charCodeAt(e++)-56320+(i<<10),n.push(String.fromCharCode(240+(r>>18&7))),n.push(String.fromCharCode(144+(r>>12&63))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)));break;default:n.push(String.fromCharCode(224+(i>>12))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)))}return n.join("")},Es=function(){var t={};return function(e,i){var r=e+"|"+(i||"");return t[r]?t[r]:t[r]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",i||"")}}(),lm=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<t.length;++r)i=i.replace(t[r][0],t[r][1]);return i}}(),o3=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),l3=/<\/?(?:vt:)?variant>/g,c3=/<(?:vt:)([^>]*)>([\s\S]*)</;function eh(t,n){var e=Ne(t),i=t.match(o3(e.baseType))||[],r=[];if(i.length!=e.size){if(n.WTF)throw new Error("unexpected vector length "+i.length+" != "+e.size);return r}return i.forEach(function(a){var s=a.replace(l3,"").match(c3);s&&r.push({v:xt(s[2]),t:s[1]})}),r}var d3=/(^\s|\s$|\n)/;function f3(t){return Mi(t).map(function(n){return" "+n+'="'+t[n]+'"'}).join("")}function u3(t,n,e){return"<"+t+(e!=null?f3(e):"")+(n!=null?(n.match(d3)?' xml:space="preserve"':"")+">"+n+"</"+t:"/")+">"}function Ac(t){if(Je&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return xt(zr(yc(t)));throw new Error("Bad input format: expected Buffer or string")}var Ts=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,h3={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},m3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function p3(t,n){for(var e=1-2*(t[n+7]>>>7),i=((t[n+7]&127)<<4)+(t[n+6]>>>4&15),r=t[n+6]&15,a=5;a>=0;--a)r=r*256+t[n+a];return i==2047?r==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),e*Math.pow(2,i-52)*r)}function g3(t,n,e){var i=(n<0||1/n==-1/0?1:0)<<7,r=0,a=0,s=i?-n:n;isFinite(s)?s==0?r=a=0:(r=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(n)?26985:0);for(var o=0;o<=5;++o,a/=256)t[e+o]=a&255;t[e+6]=(r&15)<<4|a&15,t[e+7]=r>>4|i}var th=function(t){for(var n=[],e=10240,i=0;i<t[0].length;++i)if(t[0][i])for(var r=0,a=t[0][i].length;r<a;r+=e)n.push.apply(n,t[0][i].slice(r,r+e));return n},nh=Je?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(n){return Buffer.isBuffer(n)?n:Ur(n)})):th(t)}:th,ih=function(t,n,e){for(var i=[],r=n;r<e;r+=2)i.push(String.fromCharCode(ji(t,r)));return i.join("").replace(wn,"")},kl=Je?function(t,n,e){return Buffer.isBuffer(t)?t.toString("utf16le",n,e).replace(wn,""):ih(t,n,e)}:ih,rh=function(t,n,e){for(var i=[],r=n;r<n+e;++r)i.push(("0"+t[r].toString(16)).slice(-2));return i.join("")},cm=Je?function(t,n,e){return Buffer.isBuffer(t)?t.toString("hex",n,n+e):rh(t,n,e)}:rh,ah=function(t,n,e){for(var i=[],r=n;r<e;r++)i.push(String.fromCharCode(Ca(t,r)));return i.join("")},Ia=Je?function(n,e,i){return Buffer.isBuffer(n)?n.toString("utf8",e,i):ah(n,e,i)}:ah,dm=function(t,n){var e=qt(t,n);return e>0?Ia(t,n+4,n+4+e-1):""},Mc=dm,fm=function(t,n){var e=qt(t,n);return e>0?Ia(t,n+4,n+4+e-1):""},Dc=fm,um=function(t,n){var e=2*qt(t,n);return e>0?Ia(t,n+4,n+4+e-1):""},Fc=um,hm=function(n,e){var i=qt(n,e);return i>0?kl(n,e+4,e+4+i):""},Ic=hm,mm=function(t,n){var e=qt(t,n);return e>0?Ia(t,n+4,n+4+e):""},Pc=mm,pm=function(t,n){return p3(t,n)},gl=pm,gm=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Je&&(Mc=function(n,e){if(!Buffer.isBuffer(n))return dm(n,e);var i=n.readUInt32LE(e);return i>0?n.toString("utf8",e+4,e+4+i-1):""},Dc=function(n,e){if(!Buffer.isBuffer(n))return fm(n,e);var i=n.readUInt32LE(e);return i>0?n.toString("utf8",e+4,e+4+i-1):""},Fc=function(n,e){if(!Buffer.isBuffer(n))return um(n,e);var i=2*n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+i-1)},Ic=function(n,e){if(!Buffer.isBuffer(n))return hm(n,e);var i=n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+i)},Pc=function(n,e){if(!Buffer.isBuffer(n))return mm(n,e);var i=n.readUInt32LE(e);return n.toString("utf8",e+4,e+4+i)},gl=function(n,e){return Buffer.isBuffer(n)?n.readDoubleLE(e):pm(n,e)},gm=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function x3(){kl=function(t,n,e){return ct.utils.decode(1200,t.slice(n,e)).replace(wn,"")},Ia=function(t,n,e){return ct.utils.decode(65001,t.slice(n,e))},Mc=function(t,n){var e=qt(t,n);return e>0?ct.utils.decode(Aa,t.slice(n+4,n+4+e-1)):""},Dc=function(t,n){var e=qt(t,n);return e>0?ct.utils.decode(Ai,t.slice(n+4,n+4+e-1)):""},Fc=function(t,n){var e=2*qt(t,n);return e>0?ct.utils.decode(1200,t.slice(n+4,n+4+e-1)):""},Ic=function(t,n){var e=qt(t,n);return e>0?ct.utils.decode(1200,t.slice(n+4,n+4+e)):""},Pc=function(t,n){var e=qt(t,n);return e>0?ct.utils.decode(65001,t.slice(n+4,n+4+e)):""}}typeof ct<"u"&&x3();var Ca=function(t,n){return t[n]},ji=function(t,n){return t[n+1]*256+t[n]},_3=function(t,n){var e=t[n+1]*256+t[n];return e<32768?e:(65535-e+1)*-1},qt=function(t,n){return t[n+3]*(1<<24)+(t[n+2]<<16)+(t[n+1]<<8)+t[n]},Or=function(t,n){return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]},v3=function(t,n){return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]};function gs(t,n){var e="",i,r,a=[],s,o,l,c;switch(n){case"dbcs":if(c=this.l,Je&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)e+=String.fromCharCode(ji(this,c)),c+=2;t*=2;break;case"utf8":e=Ia(this,this.l,this.l+t);break;case"utf16le":t*=2,e=kl(this,this.l,this.l+t);break;case"wstr":if(typeof ct<"u")e=ct.utils.decode(Ai,this.slice(this.l,this.l+2*t));else return gs.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":e=Mc(this,this.l),t=4+qt(this,this.l);break;case"lpstr-cp":e=Dc(this,this.l),t=4+qt(this,this.l);break;case"lpwstr":e=Fc(this,this.l),t=4+2*qt(this,this.l);break;case"lpp4":t=4+qt(this,this.l),e=Ic(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+qt(this,this.l),e=Pc(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(s=Ca(this,this.l+t++))!==0;)a.push(il(s));e=a.join("");break;case"_wstr":for(t=0,e="";(s=ji(this,this.l+t))!==0;)a.push(il(s)),t+=2;t+=2,e=a.join("");break;case"dbcs-cont":for(e="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Ca(this,c),this.l=c+1,o=gs.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(il(ji(this,c))),c+=2}e=a.join(""),t*=2;break;case"cpstr":if(typeof ct<"u"){e=ct.utils.decode(Ai,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(e="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Ca(this,c),this.l=c+1,o=gs.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(il(Ca(this,c))),c+=1}e=a.join("");break;default:switch(t){case 1:return i=Ca(this,this.l),this.l++,i;case 2:return i=(n==="i"?_3:ji)(this,this.l),this.l+=2,i;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(i=(t>0?Or:v3)(this,this.l),this.l+=4,i):(r=qt(this,this.l),this.l+=4,r);case 8:case-8:if(n==="f")return t==8?r=gl(this,this.l):r=gl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;t=8;case 16:e=cm(this,this.l,t);break}}return this.l+=t,e}var w3=function(t,n,e){t[e]=n&255,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24&255},b3=function(t,n,e){t[e]=n&255,t[e+1]=n>>8&255,t[e+2]=n>>16&255,t[e+3]=n>>24&255},y3=function(t,n,e){t[e]=n&255,t[e+1]=n>>>8&255};function S3(t,n,e){var i=0,r=0;if(e==="dbcs"){for(r=0;r!=n.length;++r)y3(this,n.charCodeAt(r),this.l+2*r);i=2*n.length}else if(e==="sbcs"){if(typeof ct<"u"&&Aa==874)for(r=0;r!=n.length;++r){var a=ct.utils.encode(Aa,n.charAt(r));this[this.l+r]=a[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=n.length;++r)this[this.l+r]=n.charCodeAt(r)&255;i=n.length}else if(e==="hex"){for(;r<t;++r)this[this.l++]=parseInt(n.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+t,this.length);for(r=0;r<Math.min(n.length,t);++r){var o=n.charCodeAt(r);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:i=1,this[this.l]=n&255;break;case 2:i=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:i=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:i=4,w3(this,n,this.l);break;case 8:if(i=8,e==="f"){g3(this,n,this.l);break}case 16:break;case-4:i=4,b3(this,n,this.l);break}return this.l+=i,this}function xm(t,n){var e=cm(this,this.l,t.length>>1);if(e!==t)throw new Error(n+"Expected "+t+" saw "+e);this.l+=t.length>>1}function rn(t,n){t.l=n,t.read_shift=gs,t.chk=xm,t.write_shift=S3}function yn(t,n){t.l+=n}function zt(t){var n=wr(t);return rn(n,0),n}function Xi(t,n,e){if(t){var i,r,a;rn(t,t.l||0);for(var s=t.length,o=0,l=0;t.l<s;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=yl[o]||yl[65535];for(i=t.read_shift(1),a=i&127,r=1;r<4&&i&128;++r)a+=((i=t.read_shift(1))&127)<<7*r;l=t.l+a;var f=c.f&&c.f(t,a,e);if(t.l=l,n(f,c,o))return}}}function dc(){var t=[],n=Je?256:2048,e=function(c){var f=zt(c);return rn(f,0),f},i=e(n),r=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&t.push(i),i=null)},a=function(c){return i&&c<i.length-i.l?i:(r(),i=e(Math.max(c+1,n)))},s=function(){return r(),gr(t)},o=function(c){r(),i=c,i.l==null&&(i.l=i.length),a(n)};return{next:a,push:o,end:s,_bufs:t}}function xs(t,n,e){var i=an(t);if(n.s?(i.cRel&&(i.c+=n.s.c),i.rRel&&(i.r+=n.s.r)):(i.cRel&&(i.c+=n.c),i.rRel&&(i.r+=n.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function sh(t,n,e){var i=an(t);return i.s=xs(i.s,n.s,e),i.e=xs(i.e,n.s,e),i}function _s(t,n){if(t.cRel&&t.c<0)for(t=an(t);t.c<0;)t.c+=n>8?16384:256;if(t.rRel&&t.r<0)for(t=an(t);t.r<0;)t.r+=n>8?1048576:n>5?65536:16384;var e=Ue(t);return!t.cRel&&t.cRel!=null&&(e=E3(e)),!t.rRel&&t.rRel!=null&&(e=C3(e)),e}function tc(t,n){return t.s.r==0&&!t.s.rRel&&t.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Gt(t.s.c)+":"+(t.e.cRel?"":"$")+Gt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(n.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+sn(t.s.r)+":"+(t.e.rRel?"":"$")+sn(t.e.r):_s(t.s,n.biff)+":"+_s(t.e,n.biff)}function Oc(t){return parseInt(k3(t),10)-1}function sn(t){return""+(t+1)}function C3(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function k3(t){return t.replace(/\$(\d+)$/,"$1")}function Lc(t){for(var n=T3(t),e=0,i=0;i!==n.length;++i)e=26*e+n.charCodeAt(i)-64;return e-1}function Gt(t){if(t<0)throw new Error("invalid column "+t);var n="";for(++t;t;t=Math.floor((t-1)/26))n=String.fromCharCode((t-1)%26+65)+n;return n}function E3(t){return t.replace(/^([A-Z])/,"$$$1")}function T3(t){return t.replace(/^\$([A-Z])/,"$1")}function A3(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function An(t){for(var n=0,e=0,i=0;i<t.length;++i){var r=t.charCodeAt(i);r>=48&&r<=57?n=10*n+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:n-1}}function Ue(t){for(var n=t.c+1,e="";n;n=(n-1)/26|0)e=String.fromCharCode((n-1)%26+65)+e;return e+(t.r+1)}function Pa(t){var n=t.indexOf(":");return n==-1?{s:An(t),e:An(t)}:{s:An(t.slice(0,n)),e:An(t.slice(n+1))}}function Ze(t,n){return typeof n>"u"||typeof n=="number"?Ze(t.s,t.e):(typeof t!="string"&&(t=Ue(t)),typeof n!="string"&&(n=Ue(n)),t==n?t:t+":"+n)}function Mt(t){var n={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,r=0,a=t.length;for(e=0;i<a&&!((r=t.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(n.s.c=--e,e=0;i<a&&!((r=t.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;if(n.s.r=--e,i===a||r!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++i,e=0;i!=a&&!((r=t.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(n.e.c=--e,e=0;i!=a&&!((r=t.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;return n.e.r=--e,n}function oh(t,n){var e=t.t=="d"&&n instanceof Date;if(t.z!=null)try{return t.w=ti(t.z,e?Mn(n):n)}catch{}try{return t.w=ti((t.XF||{}).numFmtId||(e?14:0),e?Mn(n):n)}catch{return""+n}}function Yi(t,n,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Gr[t.v]||t.v:n==null?oh(t,t.v):oh(t,n))}function yr(t,n){var e=n&&n.sheet?n.sheet:"Sheet1",i={};return i[e]=t,{SheetNames:[e],Sheets:i}}function _m(t,n,e){var i=e||{},r=t?Array.isArray(t):i.dense;Wt!=null&&r==null&&(r=Wt);var a=t||(r?[]:{}),s=0,o=0;if(a&&i.origin!=null){if(typeof i.origin=="number")s=i.origin;else{var l=typeof i.origin=="string"?An(i.origin):i.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Mt(a["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),s==-1&&(c.e.r=s=f.e.r+1)}for(var h=0;h!=n.length;++h)if(n[h]){if(!Array.isArray(n[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=n[h].length;++m)if(!(typeof n[h][m]>"u")){var p={v:n[h][m]},v=s+h,_=o+m;if(c.s.r>v&&(c.s.r=v),c.s.c>_&&(c.s.c=_),c.e.r<v&&(c.e.r=v),c.e.c<_&&(c.e.c=_),n[h][m]&&typeof n[h][m]=="object"&&!Array.isArray(n[h][m])&&!(n[h][m]instanceof Date))p=n[h][m];else if(Array.isArray(p.v)&&(p.f=n[h][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(i.nullError)p.t="e",p.v=0;else if(i.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=i.dateNF||je[14],i.cellDates?(p.t="d",p.w=ti(p.z,Mn(p.v))):(p.t="n",p.v=Mn(p.v),p.w=ti(p.z,p.v))):p.t="s";if(r)a[v]||(a[v]=[]),a[v][_]&&a[v][_].z&&(p.z=a[v][_].z),a[v][_]=p;else{var w=Ue({c:_,r:v});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return c.s.c<1e7&&(a["!ref"]=Ze(c)),a}function Oa(t,n){return _m(null,t,n)}function M3(t){return t.read_shift(4,"i")}function bn(t){var n=t.read_shift(4);return n===0?"":t.read_shift(n,"dbcs")}function D3(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Rc(t,n){var e=t.l,i=t.read_shift(1),r=bn(t),a=[],s={t:r,h:r};if((i&1)!==0){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(D3(t));s.r=a}else s.r=[{ich:0,ifnt:0}];return t.l=e+n,s}var F3=Rc;function ni(t){var n=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:n,iStyleRef:e}}function Wr(t){var n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:n}}var I3=bn;function Vc(t){var n=t.read_shift(4);return n===0||n===4294967295?"":t.read_shift(n,"dbcs")}var P3=bn,fc=Vc;function Nc(t){var n=t.slice(t.l,t.l+4),e=n[0]&1,i=n[0]&2;t.l+=4;var r=i===0?gl([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Or(n,0)>>2;return e?r/100:r}function vm(t){var n={s:{},e:{}};return n.s.r=t.read_shift(4),n.e.r=t.read_shift(4),n.s.c=t.read_shift(4),n.e.c=t.read_shift(4),n}var jr=vm;function _n(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function O3(t){var n={},e=t.read_shift(1),i=e>>>1,r=t.read_shift(1),a=t.read_shift(2,"i"),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,i){case 0:n.auto=1;break;case 1:n.index=r;var c=Vr[r];c&&(n.rgb=Ms(c));break;case 2:n.rgb=Ms([s,o,l]);break;case 3:n.theme=r;break}return a!=0&&(n.tint=a>0?a/32767:a/32768),n}function L3(t){var n=t.read_shift(1);t.l++;var e={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return e}function wm(t,n){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=t.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return t.l-=4,t.read_shift(0,n==1?"lpstr":"lpwstr")}function R3(t){return wm(t,1)}function V3(t){return wm(t,2)}var Bc=2,Hn=3,al=11,lh=12,xl=19;var sl=64,N3=65,B3=71;var H3=4108,U3=4126,Kt=80,bm=81,z3=[Kt,bm],W3={1:{n:"CodePage",t:Bc},2:{n:"Category",t:Kt},3:{n:"PresentationFormat",t:Kt},4:{n:"ByteCount",t:Hn},5:{n:"LineCount",t:Hn},6:{n:"ParagraphCount",t:Hn},7:{n:"SlideCount",t:Hn},8:{n:"NoteCount",t:Hn},9:{n:"HiddenCount",t:Hn},10:{n:"MultimediaClipCount",t:Hn},11:{n:"ScaleCrop",t:al},12:{n:"HeadingPairs",t:H3},13:{n:"TitlesOfParts",t:U3},14:{n:"Manager",t:Kt},15:{n:"Company",t:Kt},16:{n:"LinksUpToDate",t:al},17:{n:"CharacterCount",t:Hn},19:{n:"SharedDoc",t:al},22:{n:"HyperlinksChanged",t:al},23:{n:"AppVersion",t:Hn,p:"version"},24:{n:"DigSig",t:N3},26:{n:"ContentType",t:Kt},27:{n:"ContentStatus",t:Kt},28:{n:"Language",t:Kt},29:{n:"Version",t:Kt},255:{},2147483648:{n:"Locale",t:xl},2147483651:{n:"Behavior",t:xl},1919054434:{}},j3={1:{n:"CodePage",t:Bc},2:{n:"Title",t:Kt},3:{n:"Subject",t:Kt},4:{n:"Author",t:Kt},5:{n:"Keywords",t:Kt},6:{n:"Comments",t:Kt},7:{n:"Template",t:Kt},8:{n:"LastAuthor",t:Kt},9:{n:"RevNumber",t:Kt},10:{n:"EditTime",t:sl},11:{n:"LastPrinted",t:sl},12:{n:"CreatedDate",t:sl},13:{n:"ModifiedDate",t:sl},14:{n:"PageCount",t:Hn},15:{n:"WordCount",t:Hn},16:{n:"CharCount",t:Hn},17:{n:"Thumbnail",t:B3},18:{n:"Application",t:Kt},19:{n:"DocSecurity",t:Hn},255:{},2147483648:{n:"Locale",t:xl},2147483651:{n:"Behavior",t:xl},1919054434:{}},ch={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},G3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $3(t){return t.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var Y3=$3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vr=an(Y3),Gr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ym={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},dh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function X3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function K3(t){var n=X3();if(!t||!t.match)return n;var e={};if((t.match(Sn)||[]).forEach(function(i){var r=Ne(i);switch(r[0].replace(n3,"<")){case"<?xml":break;case"<Types":n.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[r.Extension]=r.ContentType;break;case"<Override":n[dh[r.ContentType]]!==void 0&&n[dh[r.ContentType]].push(r.PartName);break}}),n.xmlns!==h3.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=e,delete n.calcchains,n}var Wi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function uc(t){var n=t.lastIndexOf("/");return t.slice(0,n+1)+"_rels/"+t.slice(n+1)+".rels"}function vs(t,n){var e={"!id":{}};if(!t)return e;n.charAt(0)!=="/"&&(n="/"+n);var i={};return(t.match(Sn)||[]).forEach(function(r){var a=Ne(r);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:ms(a.Target,n);e[o]=s,i[a.Id]=s}}),e["!id"]=i,e}var q3="application/vnd.oasis.opendocument.spreadsheet";function J3(t,n){for(var e=Ac(t),i,r;i=Ts.exec(e);)switch(i[3]){case"manifest":break;case"file-entry":if(r=Ne(i[0],!1),r.path=="/"&&r.type!==q3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw i}}var ws=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Q3=function(){for(var t=new Array(ws.length),n=0;n<ws.length;++n){var e=ws[n],i="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[n]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return t}();function Sm(t){var n={};t=xt(t);for(var e=0;e<ws.length;++e){var i=ws[e],r=t.match(Q3[e]);r!=null&&r.length>0&&(n[i[1]]=tt(r[1])),i[2]==="date"&&n[i[1]]&&(n[i[1]]=Jt(n[i[1]]))}return n}var Z3=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Cm(t,n,e,i){var r=[];if(typeof t=="string")r=eh(t,i);else for(var a=0;a<t.length;++a)r=r.concat(t[a].map(function(f){return{v:f}}));var s=typeof n=="string"?eh(n,i).map(function(f){return f.v}):n,o=0,l=0;if(s.length>0)for(var c=0;c!==r.length;c+=2){switch(l=+r[c+1].v,r[c].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":e.Worksheets=l,e.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":e.NamedRanges=l,e.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":e.Chartsheets=l,e.ChartNames=s.slice(o,o+l);break}o+=l}}function eS(t,n,e){var i={};return n||(n={}),t=xt(t),Z3.forEach(function(r){var a=(t.match(Es(r[0]))||[])[1];switch(r[2]){case"string":a&&(n[r[1]]=tt(a));break;case"bool":n[r[1]]=a==="true";break;case"raw":var s=t.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(i[r[1]]=s[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&Cm(i.HeadingPairs,i.TitlesOfParts,n,e),n}var tS=/<[^>]+>[^<]*/g;function nS(t,n){var e={},i="",r=t.match(tS);if(r)for(var a=0;a!=r.length;++a){var s=r[a],o=Ne(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":i=tt(o.name);break;case"</property>":i=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":e[i]=tt(f);break;case"bool":e[i]=St(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[i]=parseInt(f,10);break;case"r4":case"r8":case"decimal":e[i]=parseFloat(f);break;case"filetime":case"date":e[i]=Jt(f);break;case"cy":case"error":e[i]=tt(f);break;default:if(c.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(n.WTF)throw new Error(s)}}}return e}var iS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},nc;function rS(t,n,e){nc||(nc=kc(iS)),n=nc[n]||n,t[n]=e}function Hc(t){var n=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function km(t,n,e){var i=t.l,r=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-i&3;)++t.l;return r}function Em(t,n,e){var i=t.read_shift(0,"lpwstr");return e&&(t.l+=4-(i.length+1&3)&3),i}function Tm(t,n,e){return n===31?Em(t):km(t,n,e)}function hc(t,n,e){return Tm(t,n,e===!1?0:4)}function aS(t,n){if(!n)throw new Error("VtUnalignedString must have positive length");return Tm(t,n,0)}function sS(t){for(var n=t.read_shift(4),e=[],i=0;i!=n;++i){var r=t.l;e[i]=t.read_shift(0,"lpwstr").replace(wn,""),t.l-r&2&&(t.l+=2)}return e}function oS(t){for(var n=t.read_shift(4),e=[],i=0;i!=n;++i)e[i]=t.read_shift(0,"lpstr-cp").replace(wn,"");return e}function lS(t){var n=t.l,e=_l(t,bm);t[t.l]==0&&t[t.l+1]==0&&t.l-n&2&&(t.l+=2);var i=_l(t,Hn);return[e,i]}function cS(t){for(var n=t.read_shift(4),e=[],i=0;i<n/2;++i)e.push(lS(t));return e}function fh(t,n){for(var e=t.read_shift(4),i={},r=0;r!=e;++r){var a=t.read_shift(4),s=t.read_shift(4);i[a]=t.read_shift(s,n===1200?"utf16le":"utf8").replace(wn,"").replace(hs,"!"),n===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),i}function Am(t){var n=t.read_shift(4),e=t.slice(t.l,t.l+n);return t.l+=n,(n&3)>0&&(t.l+=4-(n&3)&3),e}function dS(t){var n={};return n.Size=t.read_shift(4),t.l+=n.Size+3-(n.Size-1)%4,n}function _l(t,n,e){var i=t.read_shift(2),r,a=e||{};if(t.l+=2,n!==lh&&i!==n&&z3.indexOf(n)===-1&&!((n&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+n+" saw "+i);switch(n===lh?i:n){case 2:return r=t.read_shift(2,"i"),a.raw||(t.l+=2),r;case 3:return r=t.read_shift(4,"i"),r;case 11:return t.read_shift(4)!==0;case 19:return r=t.read_shift(4),r;case 30:return km(t,i,4).replace(wn,"");case 31:return Em(t);case 64:return Hc(t);case 65:return Am(t);case 71:return dS(t);case 80:return hc(t,i,!a.raw).replace(wn,"");case 81:return aS(t,i).replace(wn,"");case 4108:return cS(t);case 4126:case 4127:return i==4127?sS(t):oS(t);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+i)}}function uh(t,n){var e=t.l,i=t.read_shift(4),r=t.read_shift(4),a=[],s=0,o=0,l=-1,c={};for(s=0;s!=r;++s){var f=t.read_shift(4),h=t.read_shift(4);a[s]=[f,h+e]}a.sort(function(S,y){return S[1]-y[1]});var m={};for(s=0;s!=r;++s){if(t.l!==a[s][1]){var p=!0;if(s>0&&n)switch(n[a[s-1][0]].t){case 2:t.l+2===a[s][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[s][1]&&(t.l=a[s][1],p=!1);break;case 4108:t.l<=a[s][1]&&(t.l=a[s][1],p=!1);break}if((!n||s==0)&&t.l<=a[s][1]&&(p=!1,t.l=a[s][1]),p)throw new Error("Read Error: Expected address "+a[s][1]+" at "+t.l+" :"+s)}if(n){var v=n[a[s][0]];if(m[v.n]=_l(t,v.t,{raw:!0}),v.p==="version"&&(m[v.n]=String(m[v.n]>>16)+"."+("0000"+String(m[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(m[v.n]){case 0:m[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fi(o=m[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[v.n])}}else if(a[s][0]===1){if(o=m.CodePage=_l(t,Bc),fi(o),l!==-1){var _=t.l;t.l=a[l][1],c=fh(t,o),t.l=_}}else if(a[s][0]===0){if(o===0){l=s,t.l=a[s+1][1];continue}c=fh(t,o)}else{var w=c[a[s][0]],E;switch(t[t.l]){case 65:t.l+=4,E=Am(t);break;case 30:t.l+=4,E=hc(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,E=hc(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,E=t.read_shift(4,"i");break;case 19:t.l+=4,E=t.read_shift(4);break;case 5:t.l+=4,E=t.read_shift(8,"f");break;case 11:t.l+=4,E=It(t,4);break;case 64:t.l+=4,E=Jt(Hc(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[w]=E}}return t.l=e+i,m}function hh(t,n,e){var i=t.content;if(!i)return{};rn(i,0);var r,a,s,o,l=0;i.chk("feff","Byte Order: "),i.read_shift(2);var c=i.read_shift(4),f=i.read_shift(16);if(f!==Qe.utils.consts.HEADER_CLSID&&f!==e)throw new Error("Bad PropertySet CLSID "+f);if(r=i.read_shift(4),r!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(a=i.read_shift(16),o=i.read_shift(4),r===1&&o!==i.l)throw new Error("Length mismatch: "+o+" !== "+i.l);r===2&&(s=i.read_shift(16),l=i.read_shift(4));var h=uh(i,n),m={SystemIdentifier:c};for(var p in h)m[p]=h[p];if(m.FMTID=a,r===1)return m;if(l-i.l==2&&(i.l+=2),i.l!==l)throw new Error("Length mismatch 2: "+i.l+" !== "+l);var v;try{v=uh(i,null)}catch{}for(p in v)m[p]=v[p];return m.FMTID=[a,s],m}function pr(t,n){return t.read_shift(n),null}function fS(t,n,e){for(var i=[],r=t.l+n;t.l<r;)i.push(e(t,r-t.l));if(r!==t.l)throw new Error("Slurp error");return i}function It(t,n){return t.read_shift(n)===1}function Ut(t){return t.read_shift(2,"u")}function Mm(t,n){return fS(t,n,Ut)}function uS(t){var n=t.read_shift(1),e=t.read_shift(1);return e===1?n:n===1}function Ps(t,n,e){var i=t.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont",a=Ai;if(e&&e.biff>=8&&(Ai=1200),!e||e.biff==8){var s=t.read_shift(1);s&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var o=i?t.read_shift(i,r):"";return Ai=a,o}function hS(t){var n=Ai;Ai=1200;var e=t.read_shift(2),i=t.read_shift(1),r=i&4,a=i&8,s=1+(i&1),o=0,l,c={};a&&(o=t.read_shift(2)),r&&(l=t.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",h=e===0?"":t.read_shift(e,f);return a&&(t.l+=4*o),r&&(t.l+=l),c.t=h,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Ai=n,c}function Hr(t,n,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(n,"cpstr");if(e.biff>=12)return t.read_shift(n,"dbcs-cont")}var r=t.read_shift(1);return r===0?i=t.read_shift(n,"sbcs-cont"):i=t.read_shift(n,"dbcs-cont"),i}function Os(t,n,e){var i=t.read_shift(e&&e.biff==2?1:2);return i===0?(t.l++,""):Hr(t,i,e)}function $r(t,n,e){if(e.biff>5)return Os(t,n,e);var i=t.read_shift(1);return i===0?(t.l++,""):t.read_shift(i,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function mS(t){var n=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[n,e]}function pS(t){var n=t.read_shift(4),e=t.l,i=!1;n>24&&(t.l+=n-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),t.l=e);var r=t.read_shift((i?n-24:n)>>1,"utf16le").replace(wn,"");return i&&(t.l+=24),r}function gS(t){for(var n=t.read_shift(2),e="";n-- >0;)e+="../";var i=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var r=t.read_shift(4);if(r===0)return e+i.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(a>>1,"utf16le").replace(wn,"");return e+s}function xS(t,n){var e=t.read_shift(16);switch(n-=16,e){case"e0c9ea79f9bace118c8200aa004ba90b":return pS(t,n);case"0303000000000000c000000000000046":return gS(t,n);default:throw new Error("Unsupported Moniker "+e)}}function ol(t){var n=t.read_shift(4),e=n>0?t.read_shift(n,"utf16le").replace(wn,""):"";return e}function _S(t,n){var e=t.l+n,i=t.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var r=t.read_shift(2);t.l+=2;var a,s,o,l,c="",f,h;r&16&&(a=ol(t,e-t.l)),r&128&&(s=ol(t,e-t.l)),(r&257)===257&&(o=ol(t,e-t.l)),(r&257)===1&&(l=xS(t,e-t.l)),r&8&&(c=ol(t,e-t.l)),r&32&&(f=t.read_shift(16)),r&64&&(h=Hc(t)),t.l=e;var m=s||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),r&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return f&&(p.guid=f),h&&(p.time=h),a&&(p.Tooltip=a),p}function Dm(t){var n=t.read_shift(1),e=t.read_shift(1),i=t.read_shift(1),r=t.read_shift(1);return[n,e,i,r]}function Fm(t,n){var e=Dm(t,n);return e[3]=0,e}function Fi(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2);return{r:n,c:e,ixfe:i}}function vS(t){var n=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:n,flags:e}}function wS(t,n,e){return n===0?"":$r(t,n,e)}function bS(t,n,e){var i=e.biff>8?4:2,r=t.read_shift(i),a=t.read_shift(i,"i"),s=t.read_shift(i,"i");return[r,a,s]}function Im(t){var n=t.read_shift(2),e=Nc(t);return[n,e]}function yS(t,n,e){t.l+=4,n-=4;var i=t.l+n,r=Ps(t,n,e),a=t.read_shift(2);if(i-=t.l,a!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+a);return t.l+=a,r}function El(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2),r=t.read_shift(2);return{s:{c:i,r:n},e:{c:r,r:e}}}function Pm(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(1),r=t.read_shift(1);return{s:{c:i,r:n},e:{c:r,r:e}}}var SS=Pm;function Om(t){t.l+=4;var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2);return t.l+=12,[e,n,i]}function CS(t){var n={};return t.l+=4,t.l+=16,n.fSharedNote=t.read_shift(2),t.l+=4,n}function kS(t){var n={};return t.l+=4,t.cf=t.read_shift(2),n}function gn(t){t.l+=2,t.l+=t.read_shift(2)}var ES={0:gn,4:gn,5:gn,6:gn,7:kS,8:gn,9:gn,10:gn,11:gn,12:gn,13:CS,14:gn,15:gn,16:gn,17:gn,18:gn,19:gn,20:gn,21:Om};function TS(t,n){for(var e=t.l+n,i=[];t.l<e;){var r=t.read_shift(2);t.l-=2;try{i.push(ES[r](t,e-t.l))}catch{return t.l=e,i}}return t.l!=e&&(t.l=e),i}function ll(t,n){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),n-=2,n>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(n),e}function AS(t,n){return n===0||t.read_shift(2),1200}function MS(t,n,e){if(e.enc)return t.l+=n,"";var i=t.l,r=$r(t,0,e);return t.read_shift(n+i-t.l),r}function DS(t,n,e){var i=e&&e.biff==8||n==2?t.read_shift(2):(t.l+=n,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function FS(t,n,e){var i=t.read_shift(4),r=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=Ps(t,0,e);return s.length===0&&(s="Sheet1"),{pos:i,hs:r,dt:a,name:s}}function IS(t,n){for(var e=t.l+n,i=t.read_shift(4),r=t.read_shift(4),a=[],s=0;s!=r&&t.l<e;++s)a.push(hS(t));return a.Count=i,a.Unique=r,a}function PS(t,n){var e={};return e.dsst=t.read_shift(2),t.l+=n-2,e}function OS(t){var n={};n.r=t.read_shift(2),n.c=t.read_shift(2),n.cnt=t.read_shift(2)-n.c;var e=t.read_shift(2);t.l+=4;var i=t.read_shift(1);return t.l+=3,i&7&&(n.level=i&7),i&32&&(n.hidden=!0),i&64&&(n.hpt=e/20),n}function LS(t){var n=vS(t);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var e=t.read_shift(4);return e!==0}function RS(t){return t.read_shift(2),t.read_shift(4)}function mh(t,n,e){var i=0;e&&e.biff==2||(i=t.read_shift(2));var r=t.read_shift(2);e&&e.biff==2&&(i=1-(r>>15),r&=32767);var a={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[a,r]}function VS(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[n,e],Dim:[i,r],Flags:a,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function NS(t,n,e){if(e&&e.biff>=2&&e.biff<5)return{};var i=t.read_shift(2);return{RTL:i&64}}function BS(){}function HS(t,n,e){var i={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return i.name=Ps(t,0,e),i}function US(t){var n=Fi(t);return n.isst=t.read_shift(4),n}function zS(t,n,e){e.biffguess&&e.biff==2&&(e.biff=5);var i=t.l+n,r=Fi(t,6);e.biff==2&&t.l++;var a=Os(t,i-t.l,e);return r.val=a,r}function WS(t,n,e){var i=t.read_shift(2),r=$r(t,0,e);return[i,r]}var jS=$r;function ph(t,n,e){var i=t.l+n,r=e.biff==8||!e.biff?4:2,a=t.read_shift(r),s=t.read_shift(r),o=t.read_shift(2),l=t.read_shift(2);return t.l=i,{s:{r:a,c:o},e:{r:s,c:l}}}function GS(t){var n=t.read_shift(2),e=t.read_shift(2),i=Im(t);return{r:n,c:e,ixfe:i[0],rknum:i[1]}}function $S(t,n){for(var e=t.l+n-2,i=t.read_shift(2),r=t.read_shift(2),a=[];t.l<e;)a.push(Im(t));if(t.l!==e)throw new Error("MulRK read error");var s=t.read_shift(2);if(a.length!=s-r+1)throw new Error("MulRK length mismatch");return{r:i,c:r,C:s,rkrec:a}}function YS(t,n){for(var e=t.l+n-2,i=t.read_shift(2),r=t.read_shift(2),a=[];t.l<e;)a.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var s=t.read_shift(2);if(a.length!=s-r+1)throw new Error("MulBlank length mismatch");return{r:i,c:r,C:s,ixfe:a}}function XS(t,n,e,i){var r={},a=t.read_shift(4),s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return r.patternType=G3[o>>26],i.cellStyles&&(r.alc=a&7,r.fWrap=a>>3&1,r.alcV=a>>4&7,r.fJustLast=a>>7&1,r.trot=a>>8&255,r.cIndent=a>>16&15,r.fShrinkToFit=a>>20&1,r.iReadOrder=a>>22&2,r.fAtrNum=a>>26&1,r.fAtrFnt=a>>27&1,r.fAtrAlc=a>>28&1,r.fAtrBdr=a>>29&1,r.fAtrPat=a>>30&1,r.fAtrProt=a>>31&1,r.dgLeft=s&15,r.dgRight=s>>4&15,r.dgTop=s>>8&15,r.dgBottom=s>>12&15,r.icvLeft=s>>16&127,r.icvRight=s>>23&127,r.grbitDiag=s>>30&3,r.icvTop=o&127,r.icvBottom=o>>7&127,r.icvDiag=o>>14&127,r.dgDiag=o>>21&15,r.icvFore=l&127,r.icvBack=l>>7&127,r.fsxButton=l>>14&1),r}function KS(t,n,e){var i={};return i.ifnt=t.read_shift(2),i.numFmtId=t.read_shift(2),i.flags=t.read_shift(2),i.fStyle=i.flags>>2&1,n-=6,i.data=XS(t,n,i.fStyle,e),i}function qS(t){t.l+=4;var n=[t.read_shift(2),t.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function gh(t,n,e){var i=Fi(t,6);(e.biff==2||n==9)&&++t.l;var r=uS(t,2);return i.val=r,i.t=r===!0||r===!1?"b":"e",i}function JS(t,n,e){e.biffguess&&e.biff==2&&(e.biff=5);var i=Fi(t,6),r=_n(t,8);return i.val=r,i}var xh=wS;function QS(t,n,e){var i=t.l+n,r=t.read_shift(2),a=t.read_shift(2);if(e.sbcch=a,a==1025||a==14849)return[a,r];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Hr(t,a),o=[];i>t.l;)o.push(Os(t));return[a,r,s,o]}function _h(t,n,e){var i=t.read_shift(2),r,a={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return e.sbcch===14849&&(r=yS(t,n-2,e)),a.body=r||t.read_shift(n-2),typeof r=="string"&&(a.Name=r),a}var ZS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vh(t,n,e){var i=t.l+n,r=t.read_shift(2),a=t.read_shift(1),s=t.read_shift(1),o=t.read_shift(e&&e.biff==2?1:2),l=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),l=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var c=Hr(t,s,e);r&32&&(c=ZS[c.charCodeAt(0)]);var f=i-t.l;e&&e.biff==2&&--f;var h=i==t.l||o===0||!(f>0)?[]:O5(t,f,e,o);return{chKey:a,Name:c,itab:l,rgce:h}}function Lm(t,n,e){if(e.biff<8)return eC(t,n,e);for(var i=[],r=t.l+n,a=t.read_shift(e.biff>8?4:2);a--!==0;)i.push(bS(t,e.biff>8?12:6,e));if(t.l!=r)throw new Error("Bad ExternSheet: "+t.l+" != "+r);return i}function eC(t,n,e){t[t.l+1]==3&&t[t.l]++;var i=Ps(t,n,e);return i.charCodeAt(0)==3?i.slice(1):i}function tC(t,n,e){if(e.biff<8){t.l+=n;return}var i=t.read_shift(2),r=t.read_shift(2),a=Hr(t,i,e),s=Hr(t,r,e);return[a,s]}function nC(t,n,e){var i=Pm(t,6);t.l++;var r=t.read_shift(1);return n-=8,[L5(t,n,e),r,i]}function wh(t,n,e){var i=SS(t,6);switch(e.biff){case 2:t.l++,n-=7;break;case 3:case 4:t.l+=2,n-=8;break;default:t.l+=6,n-=12}return[i,I5(t,n,e,i)]}function iC(t){var n=t.read_shift(4)!==0,e=t.read_shift(4)!==0,i=t.read_shift(4);return[n,e,i]}function rC(t,n,e){if(!(e.biff<8)){var i=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=$r(t,0,e);return e.biff<8&&t.read_shift(1),[{r:i,c:r},o,s,a]}}function aC(t,n,e){return rC(t,n,e)}function sC(t,n){for(var e=[],i=t.read_shift(2);i--;)e.push(El(t,n));return e}function oC(t,n,e){if(e&&e.biff<8)return cC(t,n,e);var i=Om(t,22),r=TS(t,n-22,i[1]);return{cmo:i,ft:r}}var lC={8:function(t,n){var e=t.l+n;t.l+=10;var i=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var r=t.read_shift(1);return t.l+=r,t.l=e,{fmt:i}}};function cC(t,n,e){t.l+=4;var i=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,n-=36;var s=[];return s.push((lC[i]||yn)(t,n,e)),{cmo:[r,i,a],ft:s}}function dC(t,n,e){var i=t.l,r="";try{t.l+=4;var a=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:s=mS(t,6,e);var o=t.read_shift(2);t.read_shift(2),Ut(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-i!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],h=Hr(t,t.lens[c+1]-t.lens[c]-1);if(r+=h,r.length>=(f?o:2*o))break}if(r.length!==o&&r.length!==o*2)throw new Error("cchText: "+o+" != "+r.length);return t.l=i+n,{t:r}}catch{return t.l=i+n,{t:r}}}function fC(t,n){var e=El(t,8);t.l+=16;var i=_S(t,n-24);return[e,i]}function uC(t,n){t.read_shift(2);var e=El(t,8),i=t.read_shift((n-10)/2,"dbcs-cont");return i=i.replace(wn,""),[e,i]}function hC(t){var n=[0,0],e;return e=t.read_shift(2),n[0]=ch[e]||e,e=t.read_shift(2),n[1]=ch[e]||e,n}function mC(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(Fm(t,8));return e}function pC(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(Fm(t,8));return e}function gC(t){t.l+=2;var n={cxfs:0,crc:0};return n.cxfs=t.read_shift(2),n.crc=t.read_shift(4),n}function Rm(t,n,e){if(!e.cellStyles)return yn(t,n);var i=e&&e.biff>=12?4:2,r=t.read_shift(i),a=t.read_shift(i),s=t.read_shift(i),o=t.read_shift(i),l=t.read_shift(2);i==2&&(t.l+=2);var c={s:r,e:a,w:s,ixfe:o,flags:l};return(e.biff>=5||!e.biff)&&(c.level=l>>8&7),c}function xC(t,n){var e={};return n<32||(t.l+=16,e.header=_n(t,8),e.footer=_n(t,8),t.l+=2),e}function _C(t,n,e){var i={area:!1};if(e.biff!=5)return t.l+=n,i;var r=t.read_shift(1);return t.l+=3,r&16&&(i.area=!0),i}var vC=Fi,wC=Mm,bC=Os;function yC(t){var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(4),r={fmt:n,env:e,len:i,data:t.slice(t.l,t.l+i)};return t.l+=i,r}function SC(t,n,e){e.biffguess&&e.biff==5&&(e.biff=2);var i=Fi(t,6);++t.l;var r=$r(t,n-7,e);return i.t="str",i.val=r,i}function CC(t){var n=Fi(t,6);++t.l;var e=_n(t,8);return n.t="n",n.val=e,n}function kC(t){var n=Fi(t,6);++t.l;var e=t.read_shift(2);return n.t="n",n.val=e,n}function EC(t){var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,"sbcs-cont")}function TC(t,n){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=n-13}function AC(t,n,e){var i=t.l+n,r=Fi(t,6),a=t.read_shift(2),s=Hr(t,a,e);return t.l=i,r.t="str",r.val=s,r}var MC=[2,3,48,49,131,139,140,245],bh=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=kc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,l){var c=[],f=wr(1);switch(l.type){case"base64":f=di(jn(o));break;case"binary":f=di(o);break;case"buffer":case"array":f=o;break}rn(f,0);var h=f.read_shift(1),m=!!(h&136),p=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var _=0,w=521;h==2&&(_=f.read_shift(2)),f.l+=3,h!=2&&(_=f.read_shift(4)),_>1048576&&(_=1e6),h!=2&&(w=f.read_shift(2));var E=f.read_shift(2),S=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(S=t[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var y=[],V={},H=Math.min(f.length,h==2?521:w-10-(p?264:0)),I=v?32:11;f.l<H&&f[f.l]!=13;)switch(V={},V.name=ct.utils.decode(S,f.slice(f.l,f.l+I)).replace(/[\u0000\r\n].*$/g,""),f.l+=I,V.type=String.fromCharCode(f.read_shift(1)),h!=2&&!v&&(V.offset=f.read_shift(4)),V.len=f.read_shift(1),h==2&&(V.offset=f.read_shift(2)),V.dec=f.read_shift(1),V.name.length&&y.push(V),h!=2&&(f.l+=v?13:14),V.type){case"B":(!p||V.len!=8)&&l.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+V.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var T=0,N=0;for(c[0]=[],N=0;N!=y.length;++N)c[0][N]=y[N].name;for(;_-- >0;){if(f[f.l]===42){f.l+=E;continue}for(++f.l,c[++T]=[],N=0,N=0;N!=y.length;++N){var W=f.slice(f.l,f.l+y[N].len);f.l+=y[N].len,rn(W,0);var ee=ct.utils.decode(S,W);switch(y[N].type){case"C":ee.trim().length&&(c[T][N]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?c[T][N]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):c[T][N]=ee;break;case"F":c[T][N]=parseFloat(ee.trim());break;case"+":case"I":c[T][N]=v?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":c[T][N]=!0;break;case"N":case"F":c[T][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[T][N]="##MEMO##"+(v?parseInt(ee.trim(),10):W.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(c[T][N]=+ee||0);break;case"@":c[T][N]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":c[T][N]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":c[T][N]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][N]=-W.read_shift(-8,"f");break;case"B":if(p&&y[N].len==8){c[T][N]=W.read_shift(8,"f");break}case"G":case"P":W.l+=y[N].len;break;case"0":if(y[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[N].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function i(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=Oa(e(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function r(o,l){try{return yr(i(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&fi(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=dc(),h=vc(o,{header:1,raw:!0,cellDates:!0}),m=h[0],p=h.slice(1),v=o["!cols"]||[],_=0,w=0,E=0,S=1;for(_=0;_<m.length;++_){if(((v[_]||{}).DBF||{}).name){m[_]=v[_].DBF.name,++E;continue}if(m[_]!=null){if(++E,typeof m[_]=="number"&&(m[_]=m[_].toString(10)),typeof m[_]!="string")throw new Error("DBF Invalid column name "+m[_]+" |"+typeof m[_]+"|");if(m.indexOf(m[_])!==_){for(w=0;w<1024;++w)if(m.indexOf(m[_]+"_"+w)==-1){m[_]+="_"+w;break}}}}var y=Mt(o["!ref"]),V=[],H=[],I=[];for(_=0;_<=y.e.c-y.s.c;++_){var T="",N="",W=0,ee=[];for(w=0;w<p.length;++w)p[w][_]!=null&&ee.push(p[w][_]);if(ee.length==0||m[_]==null){V[_]="?";continue}for(w=0;w<ee.length;++w){switch(typeof ee[w]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=ee[w]instanceof Date?"D":"C";break;default:N="C"}W=Math.max(W,String(ee[w]).length),T=T&&T!=N?"C":N}W>250&&(W=250),N=((v[_]||{}).DBF||{}).type,N=="C"&&v[_].DBF.len>W&&(W=v[_].DBF.len),T=="B"&&N=="N"&&(T="N",I[_]=v[_].DBF.dec,W=v[_].DBF.len),H[_]=T=="C"||N=="N"?W:a[T]||0,S+=H[_],V[_]=T}var te=f.next(32);for(te.write_shift(4,318902576),te.write_shift(4,p.length),te.write_shift(2,296+32*E),te.write_shift(2,S),_=0;_<4;++_)te.write_shift(4,0);for(te.write_shift(4,0|(+n[Aa]||3)<<8),_=0,w=0;_<m.length;++_)if(m[_]!=null){var X=f.next(32),me=(m[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,me,"sbcs"),X.write_shift(1,V[_]=="?"?"C":V[_],"sbcs"),X.write_shift(4,w),X.write_shift(1,H[_]||a[V[_]]||0),X.write_shift(1,I[_]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),w+=H[_]||a[V[_]]||0}var Ae=f.next(264);for(Ae.write_shift(4,13),_=0;_<65;++_)Ae.write_shift(4,0);for(_=0;_<p.length;++_){var he=f.next(S);for(he.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(V[w]){case"L":he.write_shift(1,p[_][w]==null?63:p[_][w]?84:70);break;case"B":he.write_shift(8,p[_][w]||0,"f");break;case"N":var ke="0";for(typeof p[_][w]=="number"&&(ke=p[_][w].toFixed(I[w]||0)),E=0;E<H[w]-ke.length;++E)he.write_shift(1,32);he.write_shift(1,ke,"sbcs");break;case"D":p[_][w]?(he.write_shift(4,("0000"+p[_][w].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(p[_][w].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+p[_][w].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var we=String(p[_][w]!=null?p[_][w]:"").slice(0,H[w]);for(he.write_shift(1,we,"sbcs"),E=0;E<H[w]-we.length;++E)he.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:r,to_sheet:i,from_sheet:s}}(),DC=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Mi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(m,p){var v=t[p];return typeof v=="number"?Ru(v):v},i=function(m,p,v){var _=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return _==59?m:Ru(_)};t["|"]=254;function r(m,p){switch(p.type){case"base64":return a(jn(m),p);case"binary":return a(m,p);case"buffer":return a(Je&&Buffer.isBuffer(m)?m.toString("binary"):zr(m),p);case"array":return a(Br(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var v=m.split(/[\n\r]+/),_=-1,w=-1,E=0,S=0,y=[],V=[],H=null,I={},T=[],N=[],W=[],ee=0,te;for(+p.codepage>=0&&fi(+p.codepage);E!==v.length;++E){ee=0;var X=v[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(n,e),me=X.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),Ae=me[0],he;if(X.length>0)switch(Ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&V.push(X.slice(3).replace(/;;/g,";"));break;case"C":var ke=!1,we=!1,Ve=!1,ve=!1,Ie=-1,fe=-1;for(S=1;S<me.length;++S)switch(me[S].charAt(0)){case"A":break;case"X":w=parseInt(me[S].slice(1))-1,we=!0;break;case"Y":for(_=parseInt(me[S].slice(1))-1,we||(w=0),te=y.length;te<=_;++te)y[te]=[];break;case"K":he=me[S].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(hi(he))?isNaN(Ma(he).getDate())||(he=Jt(he)):(he=hi(he),H!==null&&Fa(H)&&(he=Cl(he))),typeof ct<"u"&&typeof he=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(he=ct.utils.decode(p.codepage,he)),ke=!0;break;case"E":ve=!0;var j=Ea(me[S].slice(1),{r:_,c:w});y[_][w]=[y[_][w],j];break;case"S":Ve=!0,y[_][w]=[y[_][w],"S5S"];break;case"G":break;case"R":Ie=parseInt(me[S].slice(1))-1;break;case"C":fe=parseInt(me[S].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+X)}if(ke&&(y[_][w]&&y[_][w].length==2?y[_][w][0]=he:y[_][w]=he,H=null),Ve){if(ve)throw new Error("SYLK shared formula cannot have own formula");var ne=Ie>-1&&y[Ie][fe];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");y[_][w][1]=$m(ne[1],{r:_-Ie,c:w-fe})}break;case"F":var Q=0;for(S=1;S<me.length;++S)switch(me[S].charAt(0)){case"X":w=parseInt(me[S].slice(1))-1,++Q;break;case"Y":for(_=parseInt(me[S].slice(1))-1,te=y.length;te<=_;++te)y[te]=[];break;case"M":ee=parseInt(me[S].slice(1))/20;break;case"F":break;case"G":break;case"P":H=V[parseInt(me[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=me[S].slice(1).split(" "),te=parseInt(W[0],10);te<=parseInt(W[1],10);++te)ee=parseInt(W[2],10),N[te-1]=ee===0?{hidden:!0}:{wch:ee},Da(N[te-1]);break;case"C":w=parseInt(me[S].slice(1))-1,N[w]||(N[w]={});break;case"R":_=parseInt(me[S].slice(1))-1,T[_]||(T[_]={}),ee>0?(T[_].hpt=ee,T[_].hpx=Ds(ee)):ee===0&&(T[_].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+X)}Q<1&&(H=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+X)}}return T.length>0&&(I["!rows"]=T),N.length>0&&(I["!cols"]=N),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,I]}function s(m,p){var v=r(m,p),_=v[0],w=v[1],E=Oa(_,p);return Mi(w).forEach(function(S){E[S]=w[S]}),E}function o(m,p){return yr(s(m,p),p)}function l(m,p,v,_){var w="C;Y"+(v+1)+";X"+(_+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+gE(m.f,{r:v,c:_}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,p){p.forEach(function(v,_){var w="F;W"+(_+1)+" "+(_+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=wl(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=bl(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function f(m,p){p.forEach(function(v,_){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*Wm(v.hpx)+";"),w.length>2&&m.push(w+"R"+(_+1))})}function h(m,p){var v=["ID;PWXL;N;E"],_=[],w=Mt(m["!ref"]),E,S=Array.isArray(m),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&c(v,m["!cols"]),m["!rows"]&&f(v,m["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var V=w.s.r;V<=w.e.r;++V)for(var H=w.s.c;H<=w.e.c;++H){var I=Ue({r:V,c:H});E=S?(m[V]||[])[H]:m[I],!(!E||E.v==null&&(!E.f||E.F))&&_.push(l(E,m,V,H,p))}return v.join(y)+y+_.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),FC=function(){function t(a,s){switch(s.type){case"base64":return n(jn(a),s);case"binary":return n(a,s);case"buffer":return n(Je&&Buffer.isBuffer(a)?a.toString("binary"):zr(a),s);case"array":return n(Br(a),s)}throw new Error("Unrecognized type "+s.type)}function n(a,s){for(var o=a.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var m=o[f].trim().split(","),p=m[0],v=m[1];++f;for(var _=o[f]||"";(_.match(/["]/g)||[]).length&1&&f<o.length-1;)_+=`
`+o[++f];switch(_=_.trim(),+p){case-1:if(_==="BOT"){h[++l]=[],c=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?h[l][c]=!0:_==="FALSE"?h[l][c]=!1:isNaN(hi(v))?isNaN(Ma(v).getDate())?h[l][c]=v:h[l][c]=Jt(v):h[l][c]=hi(v),++c;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),fs&&_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),h[l][c++]=_!==""?_:null;break}if(_==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function e(a,s){return Oa(t(a,s),s)}function i(a,s){return yr(e(a,s),s)}var r=function(){var a=function(l,c,f,h,m){l.push(c),l.push(f+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},s=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=Mt(l["!ref"]),h,m=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,f.e.r-f.s.r+1,""),a(c,"TUPLES",0,f.e.c-f.s.c+1,""),a(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){s(c,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var _=Ue({r:p,c:v});if(h=m?(l[p]||[])[v]:l[_],!h){s(c,1,0,"");continue}switch(h.t){case"n":var w=fs?h.w:h.v;!w&&h.v!=null&&(w=h.v),w==null?fs&&h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,w,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,!fs||isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ti(h.z||je[14],Mn(Jt(h.v)))),fs?s(c,0,h.w,"V"):s(c,1,0,h.w);break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var E=`\r
`,S=c.join(E);return S}}();return{to_workbook:i,to_sheet:e,from_sheet:r}}(),IC=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(h,m){for(var p=h.split(`
`),v=-1,_=-1,w=0,E=[];w!==p.length;++w){var S=p[w].trim().split(":");if(S[0]==="cell"){var y=An(S[1]);if(E.length<=y.r)for(v=E.length;v<=y.r;++v)E[v]||(E[v]=[]);switch(v=y.r,_=y.c,S[2]){case"t":E[v][_]=t(S[3]);break;case"v":E[v][_]=+S[3];break;case"vtf":var V=S[S.length-1];case"vtc":switch(S[3]){case"nl":E[v][_]=!!+S[4];break;default:E[v][_]=+S[4];break}S[2]=="vtf"&&(E[v][_]=[E[v][_],V])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function i(h,m){return Oa(e(h,m),m)}function r(h,m){return yr(i(h,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var m=[],p=[],v,_="",w=Pa(h["!ref"]),E=Array.isArray(h),S=w.s.r;S<=w.e.r;++S)for(var y=w.s.c;y<=w.e.c;++y)if(_=Ue({r:S,c:y}),v=E?(h[S]||[])[y]:h[_],!(!v||v.v==null||v.t==="z")){switch(p=["cell",_,"t"],v.t){case"s":case"str":p.push(n(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=n(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=n(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var V=Mn(Jt(v.v));p[2]="vtc",p[3]="nd",p[4]=""+V,p[5]=v.w||ti(v.z||je[14],V);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(h){return[a,s,o,s,c(h),l].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:f}}(),As=function(){function t(f,h,m,p,v){v.raw?h[m][p]=f:f===""||(f==="TRUE"?h[m][p]=!0:f==="FALSE"?h[m][p]=!1:isNaN(hi(f))?isNaN(Ma(f).getDate())?h[m][p]=f:h[m][p]=Jt(f):h[m][p]=hi(f))}function n(f,h){var m=h||{},p=[];if(!f||f.length===0)return p;for(var v=f.split(/[\r\n]/),_=v.length-1;_>=0&&v[_].length===0;)--_;for(var w=10,E=0,S=0;S<=_;++S)E=v[S].indexOf(" "),E==-1?E=v[S].length:E++,w=Math.max(w,E);for(S=0;S<=_;++S){p[S]=[];var y=0;for(t(v[S].slice(0,w).trim(),p,S,y,m),y=1;y<=(v[S].length-w)/10+1;++y)t(v[S].slice(w+(y-1)*10,w+y*10).trim(),p,S,y,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(f){for(var h={},m=!1,p=0,v=0;p<f.length;++p)(v=f.charCodeAt(p))==34?m=!m:!m&&v in e&&(h[v]=(h[v]||0)+1);v=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p]);if(!v.length){h=i;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&v.push([h[p],p])}return v.sort(function(_,w){return _[0]-w[0]||i[_[1]]-i[w[1]]}),e[v.pop()[1]]||44}function a(f,h){var m=h||{},p="";Wt!=null&&m.dense==null&&(m.dense=Wt);var v=m.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=r(f.slice(0,1024)):m&&m.FS?p=m.FS:p=r(f.slice(0,1024));var w=0,E=0,S=0,y=0,V=0,H=p.charCodeAt(0),I=!1,T=0,N=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var W=m.dateNF!=null?W4(m.dateNF):null;function ee(){var te=f.slice(y,V),X={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)X.t="z";else if(m.raw)X.t="s",X.v=te;else if(te.trim().length===0)X.t="s",X.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(X.t="s",X.v=te.slice(2,-1).replace(/""/g,'"')):_E(te)?(X.t="n",X.f=te.slice(1)):(X.t="s",X.v=te);else if(te=="TRUE")X.t="b",X.v=!0;else if(te=="FALSE")X.t="b",X.v=!1;else if(!isNaN(S=hi(te)))X.t="n",m.cellText!==!1&&(X.w=te),X.v=S;else if(!isNaN(Ma(te).getDate())||W&&te.match(W)){X.z=m.dateNF||je[14];var me=0;W&&te.match(W)&&(te=j4(te,m.dateNF,te.match(W)||[]),me=1),m.cellDates?(X.t="d",X.v=Jt(te,me)):(X.t="n",X.v=Mn(Jt(te,me))),m.cellText!==!1&&(X.w=ti(X.z,X.v instanceof Date?Mn(X.v):X.v)),m.cellNF||delete X.z}else X.t="s",X.v=te;if(X.t=="z"||(m.dense?(v[w]||(v[w]=[]),v[w][E]=X):v[Ue({c:E,r:w})]=X),y=V+1,N=f.charCodeAt(y),_.e.c<E&&(_.e.c=E),_.e.r<w&&(_.e.r=w),T==H)++E;else if(E=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;V<f.length;++V)switch(T=f.charCodeAt(V)){case 34:N===34&&(I=!I);break;case H:case 10:case 13:if(!I&&ee())break e;break;default:break}return V-y>0&&ee(),v["!ref"]=Ze(_),v}function s(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,h):Oa(n(f,h),h)}function o(f,h){var m="",p=h.type=="string"?[0,0,0,0]:Xc(f,h);switch(h.type){case"base64":m=jn(f);break;case"binary":m=f;break;case"buffer":h.codepage==65001?m=f.toString("utf8"):h.codepage&&typeof ct<"u"?m=ct.utils.decode(h.codepage,f):m=Je&&Buffer.isBuffer(f)?f.toString("binary"):zr(f);break;case"array":m=Br(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=xt(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=xt(m):h.type=="binary"&&typeof ct<"u"&&h.codepage&&(m=ct.utils.decode(h.codepage,ct.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?IC.to_sheet(h.type=="string"?m:xt(m),h):s(m,h)}function l(f,h){return yr(o(f,h),h)}function c(f){for(var h=[],m=Mt(f["!ref"]),p,v=Array.isArray(f),_=m.s.r;_<=m.e.r;++_){for(var w=[],E=m.s.c;E<=m.e.c;++E){var S=Ue({r:_,c:E});if(p=v?(f[_]||[])[E]:f[S],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(Yi(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(E===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function PC(t,n){var e=n||{},i=!!e.WTF;e.WTF=!0;try{var r=DC.to_workbook(t,e);return e.WTF=i,r}catch(a){if(e.WTF=i,!a.message.match(/SYLK bad record ID/)&&i)throw a;return As.to_workbook(t,n)}}var bs=function(){function t(j,ne,Q){if(j){rn(j,j.l||0);for(var K=Q.Enum||Ie;j.l<j.length;){var de=j.read_shift(2),De=K[de]||K[65535],be=j.read_shift(2),Me=j.l+be,pe=De.f&&De.f(j,be,Q);if(j.l=Me,ne(pe,De,de))return}}}function n(j,ne){switch(ne.type){case"base64":return e(di(jn(j)),ne);case"binary":return e(di(j),ne);case"buffer":case"array":return e(j,ne)}throw"Unsupported type "+ne.type}function e(j,ne){if(!j)return j;var Q=ne||{};Wt!=null&&Q.dense==null&&(Q.dense=Wt);var K=Q.dense?[]:{},de="Sheet1",De="",be=0,Me={},pe=[],Xe=[],G={s:{r:0,c:0},e:{r:0,c:0}},_t=Q.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)Q.Enum=Ie,t(j,function(Te,bt,Qt){switch(Qt){case 0:Q.vers=Te,Te>=4096&&(Q.qpro=!0);break;case 6:G=Te;break;case 204:Te&&(De=Te);break;case 222:De=Te;break;case 15:case 51:Q.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:Qt==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=Q.dateNF||je[14],Q.cellDates&&(Te[1].t="d",Te[1].v=Cl(Te[1].v))),Q.qpro&&Te[3]>be&&(K["!ref"]=Ze(G),Me[de]=K,pe.push(de),K=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},be=Te[3],de=De||"Sheet"+(be+1),De="");var Gn=Q.dense?(K[Te[0].r]||[])[Te[0].c]:K[Ue(Te[0])];if(Gn){Gn.t=Te[1].t,Gn.v=Te[1].v,Te[1].z!=null&&(Gn.z=Te[1].z),Te[1].f!=null&&(Gn.f=Te[1].f);break}Q.dense?(K[Te[0].r]||(K[Te[0].r]=[]),K[Te[0].r][Te[0].c]=Te[1]):K[Ue(Te[0])]=Te[1];break;default:}},Q);else if(j[2]==26||j[2]==14)Q.Enum=fe,j[2]==14&&(Q.qpro=!0,j.l=0),t(j,function(Te,bt,Qt){switch(Qt){case 204:de=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>be&&(K["!ref"]=Ze(G),Me[de]=K,pe.push(de),K=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},be=Te[3],de="Sheet"+(be+1)),_t>0&&Te[0].r>=_t)break;Q.dense?(K[Te[0].r]||(K[Te[0].r]=[]),K[Te[0].r][Te[0].c]=Te[1]):K[Ue(Te[0])]=Te[1],G.e.c<Te[0].c&&(G.e.c=Te[0].c),G.e.r<Te[0].r&&(G.e.r=Te[0].r);break;case 27:Te[14e3]&&(Xe[Te[14e3][0]]=Te[14e3][1]);break;case 1537:Xe[Te[0]]=Te[1],Te[0]==be&&(de=Te[1]);break;default:break}},Q);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(K["!ref"]=Ze(G),Me[De||de]=K,pe.push(De||de),!Xe.length)return{SheetNames:pe,Sheets:Me};for(var qe={},it=[],$e=0;$e<Xe.length;++$e)Me[pe[$e]]?(it.push(Xe[$e]||pe[$e]),qe[Xe[$e]]=Me[Xe[$e]]||Me[pe[$e]]):(it.push(Xe[$e]),qe[Xe[$e]]={"!ref":"A1"});return{SheetNames:it,Sheets:qe}}function i(j,ne){var Q=ne||{};if(+Q.codepage>=0&&fi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var K=dc(),de=Mt(j["!ref"]),De=Array.isArray(j),be=[];ci(K,0,a(1030)),ci(K,6,l(de));for(var Me=Math.min(de.e.r,8191),pe=de.s.r;pe<=Me;++pe)for(var Xe=sn(pe),G=de.s.c;G<=de.e.c;++G){pe===de.s.r&&(be[G]=Gt(G));var _t=be[G]+Xe,qe=De?(j[pe]||[])[G]:j[_t];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?ci(K,13,p(pe,G,qe.v)):ci(K,14,_(pe,G,qe.v));else{var it=Yi(qe);ci(K,15,h(pe,G,it.slice(0,239)))}}return ci(K,1),K.end()}function r(j,ne){var Q=ne||{};if(+Q.codepage>=0&&fi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var K=dc();ci(K,0,s(j));for(var de=0,De=0;de<j.SheetNames.length;++de)(j.Sheets[j.SheetNames[de]]||{})["!ref"]&&ci(K,27,ve(j.SheetNames[de],De++));var be=0;for(de=0;de<j.SheetNames.length;++de){var Me=j.Sheets[j.SheetNames[de]];if(!(!Me||!Me["!ref"])){for(var pe=Mt(Me["!ref"]),Xe=Array.isArray(Me),G=[],_t=Math.min(pe.e.r,8191),qe=pe.s.r;qe<=_t;++qe)for(var it=sn(qe),$e=pe.s.c;$e<=pe.e.c;++$e){qe===pe.s.r&&(G[$e]=Gt($e));var Te=G[$e]+it,bt=Xe?(Me[qe]||[])[$e]:Me[Te];if(!(!bt||bt.t=="z"))if(bt.t=="n")ci(K,23,ee(qe,$e,be,bt.v));else{var Qt=Yi(bt);ci(K,22,T(qe,$e,be,Qt.slice(0,239)))}}++be}}return ci(K,1),K.end()}function a(j){var ne=zt(2);return ne.write_shift(2,j),ne}function s(j){var ne=zt(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var Q=0,K=0,de=0,De=0;De<j.SheetNames.length;++De){var be=j.SheetNames[De],Me=j.Sheets[be];if(!(!Me||!Me["!ref"])){++de;var pe=Pa(Me["!ref"]);Q<pe.e.r&&(Q=pe.e.r),K<pe.e.c&&(K=pe.e.c)}}return Q>8191&&(Q=8191),ne.write_shift(2,Q),ne.write_shift(1,de),ne.write_shift(1,K),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function o(j,ne,Q){var K={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&Q.qpro?(K.s.c=j.read_shift(1),j.l++,K.s.r=j.read_shift(2),K.e.c=j.read_shift(1),j.l++,K.e.r=j.read_shift(2),K):(K.s.c=j.read_shift(2),K.s.r=j.read_shift(2),ne==12&&Q.qpro&&(j.l+=2),K.e.c=j.read_shift(2),K.e.r=j.read_shift(2),ne==12&&Q.qpro&&(j.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function l(j){var ne=zt(8);return ne.write_shift(2,j.s.c),ne.write_shift(2,j.s.r),ne.write_shift(2,j.e.c),ne.write_shift(2,j.e.r),ne}function c(j,ne,Q){var K=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(K[0].c=j.read_shift(1),K[3]=j.read_shift(1),K[0].r=j.read_shift(2),j.l+=2):(K[2]=j.read_shift(1),K[0].c=j.read_shift(2),K[0].r=j.read_shift(2)),K}function f(j,ne,Q){var K=j.l+ne,de=c(j,ne,Q);if(de[1].t="s",Q.vers==20768){j.l++;var De=j.read_shift(1);return de[1].v=j.read_shift(De,"utf8"),de}return Q.qpro&&j.l++,de[1].v=j.read_shift(K-j.l,"cstr"),de}function h(j,ne,Q){var K=zt(7+Q.length);K.write_shift(1,255),K.write_shift(2,ne),K.write_shift(2,j),K.write_shift(1,39);for(var de=0;de<K.length;++de){var De=Q.charCodeAt(de);K.write_shift(1,De>=128?95:De)}return K.write_shift(1,0),K}function m(j,ne,Q){var K=c(j,ne,Q);return K[1].v=j.read_shift(2,"i"),K}function p(j,ne,Q){var K=zt(7);return K.write_shift(1,255),K.write_shift(2,ne),K.write_shift(2,j),K.write_shift(2,Q,"i"),K}function v(j,ne,Q){var K=c(j,ne,Q);return K[1].v=j.read_shift(8,"f"),K}function _(j,ne,Q){var K=zt(13);return K.write_shift(1,255),K.write_shift(2,ne),K.write_shift(2,j),K.write_shift(8,Q,"f"),K}function w(j,ne,Q){var K=j.l+ne,de=c(j,ne,Q);if(de[1].v=j.read_shift(8,"f"),Q.qpro)j.l=K;else{var De=j.read_shift(2);V(j.slice(j.l,j.l+De),de),j.l+=De}return de}function E(j,ne,Q){var K=ne&32768;return ne&=-32769,ne=(K?j:0)+(ne>=8192?ne-16384:ne),(K?"":"$")+(Q?Gt(ne):sn(ne))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(j,ne){rn(j,0);for(var Q=[],K=0,de="",De="",be="",Me="";j.l<j.length;){var pe=j[j.l++];switch(pe){case 0:Q.push(j.read_shift(8,"f"));break;case 1:De=E(ne[0].c,j.read_shift(2),!0),de=E(ne[0].r,j.read_shift(2),!1),Q.push(De+de);break;case 2:{var Xe=E(ne[0].c,j.read_shift(2),!0),G=E(ne[0].r,j.read_shift(2),!1);De=E(ne[0].c,j.read_shift(2),!0),de=E(ne[0].r,j.read_shift(2),!1),Q.push(Xe+G+":"+De+de)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(j.read_shift(2));break;case 6:{for(var _t="";pe=j[j.l++];)_t+=String.fromCharCode(pe);Q.push('"'+_t.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:Me=Q.pop(),be=Q.pop(),Q.push(["AND","OR"][pe-20]+"("+be+","+Me+")");break;default:if(pe<32&&y[pe])Me=Q.pop(),be=Q.pop(),Q.push(be+y[pe]+Me);else if(S[pe]){if(K=S[pe][1],K==69&&(K=j[j.l++]),K>Q.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+Q.join("|")+"|");return}var qe=Q.slice(-K);Q.length-=K,Q.push(S[pe][0]+"("+qe.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}Q.length==1?ne[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function H(j){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=j.read_shift(2),ne[3]=j[j.l++],ne[0].c=j[j.l++],ne}function I(j,ne){var Q=H(j,ne);return Q[1].t="s",Q[1].v=j.read_shift(ne-4,"cstr"),Q}function T(j,ne,Q,K){var de=zt(6+K.length);de.write_shift(2,j),de.write_shift(1,Q),de.write_shift(1,ne),de.write_shift(1,39);for(var De=0;De<K.length;++De){var be=K.charCodeAt(De);de.write_shift(1,be>=128?95:be)}return de.write_shift(1,0),de}function N(j,ne){var Q=H(j,ne);Q[1].v=j.read_shift(2);var K=Q[1].v>>1;if(Q[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return Q[1].v=K,Q}function W(j,ne){var Q=H(j,ne),K=j.read_shift(4),de=j.read_shift(4),De=j.read_shift(2);if(De==65535)return K===0&&de===3221225472?(Q[1].t="e",Q[1].v=15):K===0&&de===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var be=De&32768;return De=(De&32767)-16446,Q[1].v=(1-be*2)*(de*Math.pow(2,De+32)+K*Math.pow(2,De)),Q}function ee(j,ne,Q,K){var de=zt(14);if(de.write_shift(2,j),de.write_shift(1,Q),de.write_shift(1,ne),K==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var De=0,be=0,Me=0,pe=0;return K<0&&(De=1,K=-K),be=Math.log2(K)|0,K/=Math.pow(2,be-31),pe=K>>>0,(pe&2147483648)==0&&(K/=2,++be,pe=K>>>0),K-=pe,pe|=2147483648,pe>>>=0,K*=Math.pow(2,32),Me=K>>>0,de.write_shift(4,Me),de.write_shift(4,pe),be+=16383+(De?32768:0),de.write_shift(2,be),de}function te(j,ne){var Q=W(j,14);return j.l+=ne-14,Q}function X(j,ne){var Q=H(j,ne),K=j.read_shift(4);return Q[1].v=K>>6,Q}function me(j,ne){var Q=H(j,ne),K=j.read_shift(8,"f");return Q[1].v=K,Q}function Ae(j,ne){var Q=me(j,14);return j.l+=ne-10,Q}function he(j,ne){return j[j.l+ne-1]==0?j.read_shift(ne,"cstr"):""}function ke(j,ne){var Q=j[j.l++];Q>ne-1&&(Q=ne-1);for(var K="";K.length<Q;)K+=String.fromCharCode(j[j.l++]);return K}function we(j,ne,Q){if(!(!Q.qpro||ne<21)){var K=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var de=j.read_shift(ne-21,"cstr");return[K,de]}}function Ve(j,ne){for(var Q={},K=j.l+ne;j.l<K;){var de=j.read_shift(2);if(de==14e3){for(Q[de]=[0,""],Q[de][0]=j.read_shift(2);j[j.l];)Q[de][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return Q}function ve(j,ne){var Q=zt(5+j.length);Q.write_shift(2,14e3),Q.write_shift(2,ne);for(var K=0;K<j.length;++K){var de=j.charCodeAt(K);Q[Q.l++]=de>127?95:de}return Q[Q.l++]=0,Q}var Ie={0:{n:"BOF",f:Ut},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:ke},65535:{n:""}},fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:Ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:we},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:r,to_workbook:n}}();function OC(t){var n={},e=t.match(Sn),i=0,r=!1;if(e)for(;i!=e.length;++i){var a=Ne(e[i]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;n.cp=wc[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=a.val;break;case"<sz":n.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":a.rgb&&(n.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(a[0].charCodeAt(1)!==47&&!r)throw new Error("Unrecognized rich format "+a[0])}}return n}var LC=function(){var t=Es("t"),n=Es("rPr");function e(a){var s=a.match(t);if(!s)return{t:"s",v:""};var o={t:"s",v:tt(s[1])},l=a.match(n);return l&&(o.s=OC(l[1])),o}var i=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(s){return s.replace(i,"").split(r).map(e).filter(function(o){return o.v})}}(),RC=function(){var n=/(\r\n|\n)/g;function e(r,a,s){var o=[];r.u&&o.push("text-decoration: underline;"),r.uval&&o.push("text-underline-style:"+r.uval+";"),r.sz&&o.push("font-size:"+r.sz+"pt;"),r.outline&&o.push("text-effect: outline;"),r.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),r.b&&(a.push("<b>"),s.push("</b>")),r.i&&(a.push("<i>"),s.push("</i>")),r.strike&&(a.push("<s>"),s.push("</s>"));var l=r.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),r}function i(r){var a=[[],r.v,[]];return r.v?(r.s&&e(r.s,a[0],a[2]),a[0].join("")+a[1].replace(n,"<br/>")+a[2].join("")):""}return function(a){return a.map(i).join("")}}(),VC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,NC=/<(?:\w+:)?r>/,BC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Uc(t,n){var e=n?n.cellHTML:!0,i={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=tt(xt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=xt(t),e&&(i.h=Tc(i.t))):t.match(NC)&&(i.r=xt(t),i.t=tt(xt((t.replace(BC,"").match(VC)||[]).join("").replace(Sn,""))),e&&(i.h=RC(LC(i.r)))),i):{t:""}}var HC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,UC=/<(?:\w+:)?(?:si|sstItem)>/g,zC=/<\/(?:\w+:)?(?:si|sstItem)>/;function WC(t,n){var e=[],i="";if(!t)return e;var r=t.match(HC);if(r){i=r[2].replace(UC,"").split(zC);for(var a=0;a!=i.length;++a){var s=Uc(i[a].trim(),n);s!=null&&(e[e.length]=s)}r=Ne(r[1]),e.Count=r.count,e.Unique=r.uniqueCount}return e}function jC(t){return[t.read_shift(4),t.read_shift(4)]}function GC(t,n){var e=[],i=!1;return Xi(t,function(a,s,o){switch(o){case 159:e.Count=a[0],e.Unique=a[1];break;case 19:e.push(a);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(s.T,!i||n.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),e}function Vm(t){if(typeof ct<"u")return ct.utils.encode(Aa,t);for(var n=[],e=t.split(""),i=0;i<e.length;++i)n[i]=e[i].charCodeAt(0);return n}function $i(t,n){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),n>=4&&(t.l+=n-4),e}function $C(t){var n={};return n.id=t.read_shift(0,"lpp4"),n.R=$i(t,4),n.U=$i(t,4),n.W=$i(t,4),n}function YC(t){for(var n=t.read_shift(4),e=t.l+n-4,i={},r=t.read_shift(4),a=[];r-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(i.name=t.read_shift(0,"lpp4"),i.comps=a,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return i}function XC(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(YC(t));return n}function KC(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(t.read_shift(0,"lpp4"));return n}function qC(t){var n={};return t.read_shift(4),t.l+=4,n.id=t.read_shift(0,"lpp4"),n.name=t.read_shift(0,"lpp4"),n.R=$i(t,4),n.U=$i(t,4),n.W=$i(t,4),n}function JC(t){var n=qC(t);if(n.ename=t.read_shift(0,"8lpp4"),n.blksz=t.read_shift(4),n.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Nm(t,n){var e=t.l+n,i={};i.Flags=t.read_shift(4)&63,t.l+=4,i.AlgID=t.read_shift(4);var r=!1;switch(i.AlgID){case 26126:case 26127:case 26128:r=i.Flags==36;break;case 26625:r=i.Flags==4;break;case 0:r=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=t.read_shift(4),i.KeySize=t.read_shift(4),i.ProviderType=t.read_shift(4),t.l+=8,i.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,i}function Bm(t,n){var e={},i=t.l+n;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,i),t.l=i,e}function QC(t){var n=$i(t);switch(n.Minor){case 2:return[n.Minor,ZC(t,n)];case 3:return[n.Minor,ek(t,n)];case 4:return[n.Minor,tk(t,n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function ZC(t){var n=t.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),i=Nm(t,e),r=Bm(t,t.length-t.l);return{t:"Std",h:i,v:r}}function ek(){throw new Error("File is password-protected: ECMA-376 Extensible")}function tk(t){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),i={};return e.replace(Sn,function(a){var s=Ne(a);switch(Di(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(o){i[o]=s[o]});break;case"<dataIntegrity":i.encryptedHmacKey=s.encryptedHmacKey,i.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(s);break;default:throw s[0]}}),i}function nk(t,n){var e={},i=e.EncryptionVersionInfo=$i(t,4);if(n-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);e.Flags=t.read_shift(4),n-=4;var r=t.read_shift(4);return n-=4,e.EncryptionHeader=Nm(t,r),n-=r,e.EncryptionVerifier=Bm(t,n),e}function ik(t){var n={},e=n.EncryptionVersionInfo=$i(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return n.Salt=t.read_shift(16),n.EncryptedVerifier=t.read_shift(16),n.EncryptedVerifierHash=t.read_shift(16),n}function rk(t){var n=0,e,i=Vm(t),r=i.length+1,a,s,o,l,c;for(e=wr(r),e[0]=i.length,a=1;a!=r;++a)e[a]=i[a-1];for(a=r-1;a>=0;--a)s=e[a],o=(n&16384)===0?0:1,l=n<<1&32767,c=o|l,n=c^s;return n^52811}var Hm=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(s){return(s/2|s*128)&255},r=function(s,o){return i(s^o)},a=function(s){for(var o=n[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var f=s[c],h=0;h!=7;++h)f&64&&(o^=e[l]),f*=2,--l;return o};return function(s){for(var o=Vm(s),l=a(o),c=o.length,f=wr(16),h=0;h!=16;++h)f[h]=0;var m,p,v;for((c&1)===1&&(m=l>>8,f[c]=r(t[0],m),--c,m=l&255,p=o[o.length-1],f[c]=r(p,m));c>0;)--c,m=l>>8,f[c]=r(o[c],m),--c,m=l&255,f[c]=r(o[c],m);for(c=15,v=15-o.length;v>0;)m=l>>8,f[c]=r(t[v],m),--c,--v,m=l&255,f[c]=r(o[c],m),--c,--v;return f}}(),ak=function(t,n,e,i,r){r||(r=n),i||(i=Hm(t));var a,s;for(a=0;a!=n.length;++a)s=n[a],s^=i[e],s=(s>>5|s<<3)&255,r[a]=s,++e;return[r,e,i]},sk=function(t){var n=0,e=Hm(t);return function(i){var r=ak("",i,n,e);return n=r[1],r[0]}};function ok(t,n,e,i){var r={key:Ut(t),verificationBytes:Ut(t)};return e.password&&(r.verifier=rk(e.password)),i.valid=r.verificationBytes===r.verifier,i.valid&&(i.insitu=sk(e.password)),r}function lk(t,n,e){var i=e||{};return i.Info=t.read_shift(2),t.l-=2,i.Info===1?i.Data=ik(t,n):i.Data=nk(t,n),i}function ck(t,n,e){var i={Type:e.biff>=8?t.read_shift(2):0};return i.Type?lk(t,n-2,i):ok(t,e.biff>=8?n:n-2,e,i),i}var dk=function(){function t(r,a){switch(a.type){case"base64":return n(jn(r),a);case"binary":return n(r,a);case"buffer":return n(Je&&Buffer.isBuffer(r)?r.toString("binary"):zr(r),a);case"array":return n(Br(r),a)}throw new Error("Unrecognized type "+a.type)}function n(r,a){var s=a||{},o=s.dense?[]:{},l=r.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,p=0,v,_=-1;v=m.exec(f);){switch(v[0]){case"\\cell":var w=f.slice(p,m.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var E={v:w,t:"s"};Array.isArray(o)?o[h][_]=E:o[Ue({r:h,c:_})]=E}break}p=m.lastIndex}_>c.e.c&&(c.e.c=_)}),o["!ref"]=Ze(c),o}function e(r,a){return yr(t(r,a),a)}function i(r){for(var a=["{\\rtf1\\ansi"],s=Mt(r["!ref"]),o,l=Array.isArray(r),c=s.s.r;c<=s.e.r;++c){a.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var h=Ue({r:c,c:f});o=l?(r[c]||[])[f]:r[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Yi(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:i}}();function fk(t){var n=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function Ms(t){for(var n=0,e=1;n!=3;++n)e=e*256+(t[n]>255?255:t[n]<0?0:t[n]);return e.toString(16).toUpperCase().slice(1)}function uk(t){var n=t[0]/255,e=t[1]/255,i=t[2]/255,r=Math.max(n,e,i),a=Math.min(n,e,i),s=r-a;if(s===0)return[0,0,n];var o=0,l=0,c=r+a;switch(l=s/(c>1?2-c:c),r){case n:o=((e-i)/s+6)%6;break;case e:o=(i-n)/s+2;break;case i:o=(n-e)/s+4;break}return[o/6,l,c/2]}function hk(t){var n=t[0],e=t[1],i=t[2],r=e*2*(i<.5?i:1-i),a=i-r/2,s=[a,a,a],o=6*n,l;if(e!==0)switch(o|0){case 0:case 6:l=r*o,s[0]+=r,s[1]+=l;break;case 1:l=r*(2-o),s[0]+=l,s[1]+=r;break;case 2:l=r*(o-2),s[1]+=r,s[2]+=l;break;case 3:l=r*(4-o),s[1]+=l,s[2]+=r;break;case 4:l=r*(o-4),s[2]+=r,s[0]+=l;break;case 5:l=r*(6-o),s[2]+=l,s[0]+=r;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function vl(t,n){if(n===0)return t;var e=uk(fk(t));return n<0?e[2]=e[2]*(1+n):e[2]=1-(1-e[2])*(1-n),Ms(hk(e))}var Um=6,mk=15,pk=1,Tn=Um;function wl(t){return Math.floor((t+Math.round(128/Tn)/256)*Tn)}function bl(t){return Math.floor((t-5)/Tn*100+.5)/100}function mc(t){return Math.round((t*Tn+5)/Tn*256)/256}function ic(t){return mc(bl(wl(t)))}function zc(t){var n=Math.abs(t-ic(t)),e=Tn;if(n>.005)for(Tn=pk;Tn<mk;++Tn)Math.abs(t-ic(t))<=n&&(n=Math.abs(t-ic(t)),e=Tn);Tn=e}function Da(t){t.width?(t.wpx=wl(t.width),t.wch=bl(t.wpx),t.MDW=Tn):t.wpx?(t.wch=bl(t.wpx),t.width=mc(t.wch),t.MDW=Tn):typeof t.wch=="number"&&(t.width=mc(t.wch),t.wpx=wl(t.width),t.MDW=Tn),t.customWidth&&delete t.customWidth}var gk=96,zm=gk;function Wm(t){return t*96/zm}function Ds(t){return t*zm/96}var xk={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _k(t,n,e,i){n.Borders=[];var r={},a=!1;(t[0].match(Sn)||[]).forEach(function(s){var o=Ne(s);switch(Di(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":r={},o.diagonalUp&&(r.diagonalUp=St(o.diagonalUp)),o.diagonalDown&&(r.diagonalDown=St(o.diagonalDown)),n.Borders.push(r);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function vk(t,n,e,i){n.Fills=[];var r={},a=!1;(t[0].match(Sn)||[]).forEach(function(s){var o=Ne(s);switch(Di(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":r={},n.Fills.push(r);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":o.patternType&&(r.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":r.bgColor||(r.bgColor={}),o.indexed&&(r.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(r.bgColor.theme=parseInt(o.theme,10)),o.tint&&(r.bgColor.tint=parseFloat(o.tint)),o.rgb&&(r.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":r.fgColor||(r.fgColor={}),o.theme&&(r.fgColor.theme=parseInt(o.theme,10)),o.tint&&(r.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(r.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function wk(t,n,e,i){n.Fonts=[];var r={},a=!1;(t[0].match(Sn)||[]).forEach(function(s){var o=Ne(s);switch(Di(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(r),r={};break;case"<name":o.val&&(r.name=xt(o.val));break;case"<name/>":case"</name>":break;case"<b":r.bold=o.val?St(o.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=o.val?St(o.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(o.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34;break}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=o.val?St(o.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=o.val?St(o.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=o.val?St(o.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=o.val?St(o.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=o.val?St(o.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":o.val&&(r.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(r.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(r.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(r.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=wc[parseInt(o.val,10)];break;case"<color":if(r.color||(r.color={}),o.auto&&(r.color.auto=St(o.auto)),o.rgb)r.color.rgb=o.rgb.slice(-6);else if(o.indexed){r.color.index=parseInt(o.indexed,10);var l=Vr[r.color.index];r.color.index==81&&(l=Vr[1]),l||(l=Vr[1]),r.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(r.color.theme=parseInt(o.theme,10),o.tint&&(r.color.tint=parseFloat(o.tint)),o.theme&&e.themeElements&&e.themeElements.clrScheme&&(r.color.rgb=vl(e.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function bk(t,n,e){n.NumberFmt=[];for(var i=Mi(je),r=0;r<i.length;++r)n.NumberFmt[i[r]]=je[i[r]];var a=t[0].match(Sn);if(a)for(r=0;r<a.length;++r){var s=Ne(a[r]);switch(Di(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=tt(xt(s.formatCode)),l=parseInt(s.numFmtId,10);if(n.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&n.NumberFmt[l]!=null;--l);n.NumberFmt[l]=o}Rr(o,l)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var cl=["numFmtId","fillId","fontId","borderId","xfId"],dl=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function yk(t,n,e){n.CellXf=[];var i,r=!1;(t[0].match(Sn)||[]).forEach(function(a){var s=Ne(a),o=0;switch(Di(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=s,delete i[0],o=0;o<cl.length;++o)i[cl[o]]&&(i[cl[o]]=parseInt(i[cl[o]],10));for(o=0;o<dl.length;++o)i[dl[o]]&&(i[dl[o]]=St(i[dl[o]]));if(n.NumberFmt&&i.numFmtId>392){for(o=392;o>60;--o)if(n.NumberFmt[i.numFmtId]==n.NumberFmt[o]){i.numFmtId=o;break}}n.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=St(s.wrapText)),i.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":r=!0;break;case"</AlternateContent>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(e&&e.WTF&&!r)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var Sk=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(n))&&bk(h,f,c),(h=o.match(r))&&wk(h,f,l,c),(h=o.match(i))&&vk(h,f,l,c),(h=o.match(a))&&_k(h,f,l,c),(h=o.match(e))&&yk(h,f,c),f}}();function Ck(t,n){var e=t.read_shift(2),i=bn(t,n-2);return[e,i]}function kk(t,n,e){var i={};i.sz=t.read_shift(2)/20;var r=L3(t,2,e);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var a=t.read_shift(2);switch(a===700&&(i.bold=1),t.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(i.underline=s);var o=t.read_shift(1);o>0&&(i.family=o);var l=t.read_shift(1);switch(l>0&&(i.charset=l),t.l++,i.color=O3(t,8),t.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=bn(t,n-21),i}var Ek=yn;function Tk(t,n){var e=t.l+n,i=t.read_shift(2),r=t.read_shift(2);return t.l=e,{ixfe:i,numFmtId:r}}var Ak=yn;function Mk(t,n,e){var i={};i.NumberFmt=[];for(var r in je)i.NumberFmt[r]=je[r];i.CellXf=[],i.Fonts=[];var a=[],s=!1;return Xi(t,function(l,c,f){switch(f){case 44:i.NumberFmt[l[0]]=l[1],Rr(l[1],l[0]);break;case 43:i.Fonts.push(l),l.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(l.color.rgb=vl(n.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&i.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(f),s=!0;break;case 38:a.pop(),s=!1;break;default:if(c.T>0)a.push(f);else if(c.T<0)a.pop();else if(!s||e.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),i}var Dk=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Fk(t,n,e){n.themeElements.clrScheme=[];var i={};(t[0].match(Sn)||[]).forEach(function(r){var a=Ne(r);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=a.val;break;case"<a:sysClr":i.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(n.themeElements.clrScheme[Dk.indexOf(a[0])]=i,i={}):i.name=a[0].slice(3,a[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Ik(){}function Pk(){}var Ok=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Lk=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Rk=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Vk(t,n,e){n.themeElements={};var i;[["clrScheme",Ok,Fk],["fontScheme",Lk,Ik],["fmtScheme",Rk,Pk]].forEach(function(r){if(!(i=t.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](i,n,e)})}var Nk=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function jm(t,n){(!t||t.length===0)&&(t=Bk());var e,i={};if(!(e=t.match(Nk)))throw new Error("themeElements not found in theme");return Vk(e[0],i,n),i.raw=t,i}function Bk(t,n){if(n&&n.themeXLSX)return n.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[sm];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Hk(t,n,e){var i=t.l+n,r=t.read_shift(4);if(r!==124226){if(!e.cellStyles){t.l=i;return}var a=t.slice(t.l);t.l=i;var s;try{s=am(a,{type:"array"})}catch{return}var o=Wn(s,"theme/theme/theme1.xml",!0);if(o)return jm(o,e)}}function Uk(t){return t.read_shift(4)}function zk(t){var n={};switch(n.xclrType=t.read_shift(2),n.nTintShade=t.read_shift(2),n.xclrType){case 0:t.l+=4;break;case 1:n.xclrValue=Wk(t,4);break;case 2:n.xclrValue=Dm(t,4);break;case 3:n.xclrValue=Uk(t,4);break;case 4:t.l+=4;break}return t.l+=8,n}function Wk(t,n){return yn(t,n)}function jk(t,n){return yn(t,n)}function Gk(t){var n=t.read_shift(2),e=t.read_shift(2)-4,i=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=zk(t,e);break;case 6:i[1]=jk(t,e);break;case 14:case 15:i[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+e)}return i}function $k(t,n){var e=t.l+n;t.l+=2;var i=t.read_shift(2);t.l+=2;for(var r=t.read_shift(2),a=[];r-- >0;)a.push(Gk(t,e-t.l));return{ixfe:i,ext:a}}function Yk(t,n){n.forEach(function(e){switch(e[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function Xk(t,n){return{flags:t.read_shift(4),version:t.read_shift(4),name:bn(t,n-8)}}function Kk(t){for(var n=[],e=t.read_shift(4);e-- >0;)n.push([t.read_shift(4),t.read_shift(4)]);return n}function qk(t){return t.l+=4,t.read_shift(4)!=0}function Jk(t,n,e){var i={Types:[],Cell:[],Value:[]},r=e||{},a=[],s=!1,o=2;return Xi(t,function(l,c,f){switch(f){case 335:i.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?i.Cell.push({type:i.Types[h[0]-1].name,index:h[1]}):o==0&&i.Value.push({type:i.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(f),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!c.T){if(!s||r.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),i}function Qk(t,n,e){var i={Types:[],Cell:[],Value:[]};if(!t)return i;var r=!1,a=2,s;return t.replace(Sn,function(o){var l=Ne(o);switch(Di(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<i.Types.length;++c)i.Types[c].name==l.name&&(s=i.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?i.Cell.push({type:i.Types[l.t-1].name,index:+l.v}):a==0&&i.Value.push({type:i.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),i}function Zk(t){var n=[];if(!t)return n;var e=1;return(t.match(Sn)||[]).forEach(function(i){var r=Ne(i);switch(r[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?e=r.i:r.i=e,n.push(r);break}}),n}function eE(t){var n={};n.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),n.r=Ue(e);var i=t.read_shift(1);return i&2&&(n.l="1"),i&8&&(n.a="1"),n}function tE(t,n,e){var i=[],r=!1;return Xi(t,function(s,o,l){switch(l){case 63:i.push(s);break;default:if(!o.T){if(!r||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),i}function nE(t,n,e,i){if(!t)return t;var r=i||{},a=!1,s=!1;Xi(t,function(l,c,f){if(!s)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},r)}function iE(t,n){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][e].Target}function yh(t,n,e,i){var r=Array.isArray(t),a;n.forEach(function(s){var o=An(s.ref);if(r?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[s.ref],!a){a={t:"z"},r?t[o.r][o.c]=a:t[s.ref]=a;var l=Mt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ze(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var f={a:s.author,t:s.t,r:s.r,T:e};s.h&&(f.h=s.h);for(var h=a.c.length-1;h>=0;--h){if(!e&&a.c[h].T)return;e&&!a.c[h].T&&a.c.splice(h,1)}if(e&&i){for(h=0;h<i.length;++h)if(f.a==i[h].id){f.a=i[h].name||f.a;break}}a.c.push(f)})}function rE(t,n){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],i=[],r=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&e.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ne(o[0]),c={author:l.authorId&&e[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=An(l.ref);if(!(n.sheetRows&&n.sheetRows<=f.r)){var h=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&Uc(h[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(c.h=m.h),i.push(c)}}}}),i}function aE(t,n){var e=[],i=!1,r={},a=0;return t.replace(Sn,function(o,l){var c=Ne(o);switch(Di(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":r={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":r.t!=null&&e.push(r);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":r.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&n.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),e}function sE(t,n){var e=[],i=!1;return t.replace(Sn,function(a){var s=Ne(a);switch(Di(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&n.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),e}function oE(t){var n={};n.iauthor=t.read_shift(4);var e=jr(t,16);return n.rfx=e.s,n.ref=Ue(e.s),t.l+=16,n}var lE=bn;function cE(t,n){var e=[],i=[],r={},a=!1;return Xi(t,function(o,l,c){switch(c){case 632:i.push(o);break;case 635:r=o;break;case 637:r.t=o.t,r.h=o.h,r.r=o.r;break;case 636:if(r.author=i[r.iauthor],delete r.iauthor,n.sheetRows&&r.rfx&&n.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,e.push(r);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),e}var dE="application/vnd.ms-office.vbaProject";function fE(t){var n=Qe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,i){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var r=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qe.utils.cfb_add(n,r,t.FileIndex[i].content)}}),Qe.write(n)}function uE(){return{"!type":"dialog"}}function hE(){return{"!type":"dialog"}}function mE(){return{"!type":"macro"}}function pE(){return{"!type":"macro"}}var Ea=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function e(i,r,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=n.c:--f,l?c+=n.r:--c,r+(o?"":"$")+Gt(f)+(l?"":"$")+sn(c)}return function(r,a){return n=a,r.replace(t,e)}}(),Gm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gE=function(){return function(n,e){return n.replace(Gm,function(i,r,a,s,o,l){var c=Lc(s)-(a?0:e.c),f=Oc(l)-(o?0:e.r),h=f==0?"":o?f+1:"["+f+"]",m=c==0?"":a?c+1:"["+c+"]";return r+"R"+h+"C"+m})}}();function $m(t,n){return t.replace(Gm,function(e,i,r,a,s,o){return i+(r=="$"?r+a:Gt(Lc(a)+n.c))+(s=="$"?s+o:sn(Oc(o)+n.r))})}function xE(t,n,e){var i=Pa(n),r=i.s,a=An(e),s={r:a.r-r.r,c:a.c-r.c};return $m(t,s)}function _E(t){return t.length!=1}function Sh(t){return t.replace(/_xlfn\./g,"")}function Bt(t){t.l+=1}function br(t,n){var e=t.read_shift(n==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function Ym(t,n,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return Xm(t,n,e);e.biff==12&&(i=4)}var r=t.read_shift(i),a=t.read_shift(i),s=br(t,2),o=br(t,2);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Xm(t){var n=br(t,2),e=br(t,2),i=t.read_shift(1),r=t.read_shift(1);return{s:{r:n[0],c:i,cRel:n[1],rRel:n[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function vE(t,n,e){if(e.biff<8)return Xm(t,n,e);var i=t.read_shift(e.biff==12?4:2),r=t.read_shift(e.biff==12?4:2),a=br(t,2),s=br(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r,c:s[0],cRel:s[1],rRel:s[2]}}}function Km(t,n,e){if(e&&e.biff>=2&&e.biff<=5)return wE(t,n,e);var i=t.read_shift(e&&e.biff==12?4:2),r=br(t,2);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function wE(t){var n=br(t,2),e=t.read_shift(1);return{r:n[0],c:e,cRel:n[1],rRel:n[2]}}function bE(t){var n=t.read_shift(2),e=t.read_shift(2);return{r:n,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function yE(t,n,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return SE(t,n,e);var r=t.read_shift(i>=12?4:2),a=t.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;r>524287;)r-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r,c:a,cRel:s,rRel:o}}function SE(t){var n=t.read_shift(2),e=t.read_shift(1),i=(n&32768)>>15,r=(n&16384)>>14;return n&=16383,i==1&&n>=8192&&(n=n-16384),r==1&&e>=128&&(e=e-256),{r:n,c:e,cRel:r,rRel:i}}function CE(t,n,e){var i=(t[t.l++]&96)>>5,r=Ym(t,e.biff>=2&&e.biff<=5?6:8,e);return[i,r]}function kE(t,n,e){var i=(t[t.l++]&96)>>5,r=t.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var s=Ym(t,a,e);return[i,r,s]}function EE(t,n,e){var i=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function TE(t,n,e){var i=(t[t.l++]&96)>>5,r=t.read_shift(2),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[i,r]}function AE(t,n,e){var i=(t[t.l++]&96)>>5,r=vE(t,n-1,e);return[i,r]}function ME(t,n,e){var i=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[i]}function Ch(t){var n=t[t.l+1]&1,e=1;return t.l+=4,[n,e]}function DE(t,n,e){t.l+=2;for(var i=t.read_shift(e&&e.biff==2?1:2),r=[],a=0;a<=i;++a)r.push(t.read_shift(e&&e.biff==2?1:2));return r}function FE(t,n,e){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(e&&e.biff==2?1:2)]}function IE(t,n,e){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(e&&e.biff==2?1:2)]}function PE(t){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(2)]}function OE(t,n,e){var i=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[i]}function qm(t){var n=t.read_shift(1),e=t.read_shift(1);return[n,e]}function LE(t){return t.read_shift(2),qm(t,2)}function RE(t){return t.read_shift(2),qm(t,2)}function VE(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=Km(t,0,e);return[i,r]}function NE(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=yE(t,0,e);return[i,r]}function BE(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var a=Km(t,0,e);return[i,r,a]}function HE(t,n,e){var i=(t[t.l]&96)>>5;t.l+=1;var r=t.read_shift(e&&e.biff<=3?1:2);return[U5[r],Zm[r],i]}function UE(t,n,e){var i=t[t.l++],r=t.read_shift(1),a=e&&e.biff<=3?[i==88?-1:0,t.read_shift(1)]:zE(t);return[r,(a[0]===0?Zm:H5)[a[1]]]}function zE(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function WE(t,n,e){t.l+=e&&e.biff==2?3:4}function jE(t,n,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var i=t.read_shift(2),r=t.read_shift(e&&e.biff==2?1:2);return[i,r]}function GE(t){return t.l++,Gr[t.read_shift(1)]}function $E(t){return t.l++,t.read_shift(2)}function YE(t){return t.l++,t.read_shift(1)!==0}function XE(t){return t.l++,_n(t,8)}function KE(t,n,e){return t.l++,Ps(t,n-1,e)}function qE(t,n){var e=[t.read_shift(1)];if(n==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=It(t,1)?"TRUE":"FALSE",n!=12&&(t.l+=7);break;case 37:case 16:e[1]=Gr[t[t.l]],t.l+=n==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=_n(t,8);break;case 2:e[1]=$r(t,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function JE(t,n,e){for(var i=t.read_shift(e.biff==12?4:2),r=[],a=0;a!=i;++a)r.push((e.biff==12?jr:El)(t,8));return r}function QE(t,n,e){var i=0,r=0;e.biff==12?(i=t.read_shift(4),r=t.read_shift(4)):(r=1+t.read_shift(1),i=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--r==0&&(r=256));for(var a=0,s=[];a!=i&&(s[a]=[]);++a)for(var o=0;o!=r;++o)s[a][o]=qE(t,e.biff);return s}function ZE(t,n,e){var i=t.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,a=t.read_shift(r);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[i,0,a]}function e5(t,n,e){if(e.biff==5)return t5(t,n,e);var i=t.read_shift(1)>>>5&3,r=t.read_shift(2),a=t.read_shift(4);return[i,r,a]}function t5(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var i=t.read_shift(2);return t.l+=12,[n,e,i]}function n5(t,n,e){var i=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var r=t.read_shift(e&&e.biff==2?1:2);return[i,r]}function i5(t,n,e){var i=t.read_shift(1)>>>5&3,r=t.read_shift(e&&e.biff==2?1:2);return[i,r]}function r5(t,n,e){var i=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[i]}function a5(t,n,e){var i=(t[t.l++]&96)>>5,r=t.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[i,r]}var s5=yn,o5=yn,l5=yn;function Ls(t,n,e){return t.l+=2,[bE(t,4,e)]}function Wc(t){return t.l+=6,[]}var c5=Ls,d5=Wc,f5=Wc,u5=Ls;function Jm(t){return t.l+=2,[Ut(t),t.read_shift(2)&1]}var h5=Ls,m5=Jm,p5=Wc,g5=Ls,x5=Ls,_5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function v5(t){t.l+=2;var n=t.read_shift(2),e=t.read_shift(2),i=t.read_shift(4),r=t.read_shift(2),a=t.read_shift(2),s=_5[e>>2&31];return{ixti:n,coltype:e&3,rt:s,idx:i,c:r,C:a}}function w5(t){return t.l+=2,[t.read_shift(4)]}function b5(t,n,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function y5(t,n,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function S5(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[n,e]}function C5(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[n,e]}function k5(t){return t.l+=4,[0,0]}var kh={1:{n:"PtgExp",f:jE},2:{n:"PtgTbl",f:l5},3:{n:"PtgAdd",f:Bt},4:{n:"PtgSub",f:Bt},5:{n:"PtgMul",f:Bt},6:{n:"PtgDiv",f:Bt},7:{n:"PtgPower",f:Bt},8:{n:"PtgConcat",f:Bt},9:{n:"PtgLt",f:Bt},10:{n:"PtgLe",f:Bt},11:{n:"PtgEq",f:Bt},12:{n:"PtgGe",f:Bt},13:{n:"PtgGt",f:Bt},14:{n:"PtgNe",f:Bt},15:{n:"PtgIsect",f:Bt},16:{n:"PtgUnion",f:Bt},17:{n:"PtgRange",f:Bt},18:{n:"PtgUplus",f:Bt},19:{n:"PtgUminus",f:Bt},20:{n:"PtgPercent",f:Bt},21:{n:"PtgParen",f:Bt},22:{n:"PtgMissArg",f:Bt},23:{n:"PtgStr",f:KE},26:{n:"PtgSheet",f:b5},27:{n:"PtgEndSheet",f:y5},28:{n:"PtgErr",f:GE},29:{n:"PtgBool",f:YE},30:{n:"PtgInt",f:$E},31:{n:"PtgNum",f:XE},32:{n:"PtgArray",f:ME},33:{n:"PtgFunc",f:HE},34:{n:"PtgFuncVar",f:UE},35:{n:"PtgName",f:ZE},36:{n:"PtgRef",f:VE},37:{n:"PtgArea",f:CE},38:{n:"PtgMemArea",f:n5},39:{n:"PtgMemErr",f:s5},40:{n:"PtgMemNoMem",f:o5},41:{n:"PtgMemFunc",f:i5},42:{n:"PtgRefErr",f:r5},43:{n:"PtgAreaErr",f:EE},44:{n:"PtgRefN",f:NE},45:{n:"PtgAreaN",f:AE},46:{n:"PtgMemAreaN",f:S5},47:{n:"PtgMemNoMemN",f:C5},57:{n:"PtgNameX",f:e5},58:{n:"PtgRef3d",f:BE},59:{n:"PtgArea3d",f:kE},60:{n:"PtgRefErr3d",f:a5},61:{n:"PtgAreaErr3d",f:TE},255:{}},E5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},T5={1:{n:"PtgElfLel",f:Jm},2:{n:"PtgElfRw",f:g5},3:{n:"PtgElfCol",f:c5},6:{n:"PtgElfRwV",f:x5},7:{n:"PtgElfColV",f:u5},10:{n:"PtgElfRadical",f:h5},11:{n:"PtgElfRadicalS",f:p5},13:{n:"PtgElfColS",f:d5},15:{n:"PtgElfColSV",f:f5},16:{n:"PtgElfRadicalLel",f:m5},25:{n:"PtgList",f:v5},29:{n:"PtgSxName",f:w5},255:{}},A5={0:{n:"PtgAttrNoop",f:k5},1:{n:"PtgAttrSemi",f:OE},2:{n:"PtgAttrIf",f:IE},4:{n:"PtgAttrChoose",f:DE},8:{n:"PtgAttrGoto",f:FE},16:{n:"PtgAttrSum",f:WE},32:{n:"PtgAttrBaxcel",f:Ch},33:{n:"PtgAttrBaxcel",f:Ch},64:{n:"PtgAttrSpace",f:LE},65:{n:"PtgAttrSpaceSemi",f:RE},128:{n:"PtgAttrIfError",f:PE},255:{}};function Rs(t,n,e,i){if(i.biff<8)return yn(t,n);for(var r=t.l+n,a=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=QE(t,0,i),a.push(e[s][1]);break;case"PtgMemArea":e[s][2]=JE(t,e[s][1],i),a.push(e[s][2]);break;case"PtgExp":i&&i.biff==12&&(e[s][1][1]=t.read_shift(4),a.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0];default:break}return n=r-t.l,n!==0&&a.push(yn(t,n)),a}function Vs(t,n,e){for(var i=t.l+n,r,a,s=[];i!=t.l;)n=i-t.l,a=t[t.l],r=kh[a]||kh[E5[a]],(a===24||a===25)&&(r=(a===24?T5:A5)[t[t.l+1]]),!r||!r.f?yn(t,n):s.push([r.n,r.f(t,n,e)]);return s}function M5(t){for(var n=[],e=0;e<t.length;++e){for(var i=t[e],r=[],a=0;a<i.length;++a){var s=i[a];if(s)switch(s[0]){case 2:r.push('"'+s[1].replace(/"/g,'""')+'"');break;default:r.push(s[1])}else r.push("")}n.push(r.join(","))}return n.join(";")}var D5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function F5(t,n){if(!t&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Qm(t,n,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[n]))return t.SheetNames[n];if(!t.XTI)return"SH33TJSERR6";var i=t.XTI[n];if(e.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":t.XTI[n-1];if(!i)return"SH33TJSERR1";var r="";if(e.biff>8)switch(t[i[0]][0]){case 357:return r=i[1]==-1?"#REF":t.SheetNames[i[1]],i[1]==i[2]?r:r+":"+t.SheetNames[i[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[i[0]][0];case 355:default:return"SH33TJSSRC"+t[i[0]][0]}switch(t[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":t.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+t.SheetNames[i[2]];case 14849:return t[i[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[i[0]][0][3]?(r=i[1]==-1?"#REF":t[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+t[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Eh(t,n,e){var i=Qm(t,n,e);return i=="#REF"?i:F5(i,e)}function xn(t,n,e,i,r){var a=r&&r.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,f,h=0,m=0,p,v="";if(!t[0]||!t[0][0])return"";for(var _=-1,w="",E=0,S=t[0].length;E<S;++E){var y=t[0][E];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),_>=0){switch(t[0][_][1][0]){case 0:w=At(" ",t[0][_][1][1]);break;case 1:w=At("\r",t[0][_][1][1]);break;default:if(w="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}c=c+w,_=-1}o.push(c+D5[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=xs(y[1][1],s,r),o.push(_s(f,a));break;case"PtgRefN":f=e?xs(y[1][1],e,r):y[1][1],o.push(_s(f,a));break;case"PtgRef3d":h=y[1][1],f=xs(y[1][2],s,r),v=Eh(i,h,r);var V=v;o.push(v+"!"+_s(f,a));break;case"PtgFunc":case"PtgFuncVar":var H=y[1][0],I=y[1][1];H||(H=0),H&=127;var T=H==0?[]:o.slice(-H);o.length-=H,I==="User"&&(I=T.shift()),o.push(I+"("+T.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=sh(y[1][1],e?{s:e}:s,r),o.push(tc(p,r));break;case"PtgArea":p=sh(y[1][1],s,r),o.push(tc(p,r));break;case"PtgArea3d":h=y[1][1],p=y[1][2],v=Eh(i,h,r),o.push(v+"!"+tc(p,r));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var N=(i.names||[])[m-1]||(i[0]||[])[m],W=N?N.Name:"SH33TJSNAME"+String(m);W&&W.slice(0,6)=="_xlfn."&&!r.xlfn&&(W=W.slice(6)),o.push(W);break;case"PtgNameX":var ee=y[1][1];m=y[1][2];var te;if(r.biff<=5)ee<0&&(ee=-ee),i[ee]&&(te=i[ee][m]);else{var X="";if(((i[ee]||[])[0]||[])[0]==14849||(((i[ee]||[])[0]||[])[0]==1025?i[ee][m]&&i[ee][m].itab>0&&(X=i.SheetNames[i[ee][m].itab-1]+"!"):X=i.SheetNames[m-1]+"!"),i[ee]&&i[ee][m])X+=i[ee][m].Name;else if(i[0]&&i[0][m])X+=i[0][m].Name;else{var me=(Qm(i,ee,r)||"").split(";;");me[m-1]?X=me[m-1]:X+="SH33TJSERRX"}o.push(X);break}te||(te={Name:"SH33TJSERRY"}),o.push(te.Name);break;case"PtgParen":var Ae="(",he=")";if(_>=0){switch(w="",t[0][_][1][0]){case 2:Ae=At(" ",t[0][_][1][1])+Ae;break;case 3:Ae=At("\r",t[0][_][1][1])+Ae;break;case 4:he=At(" ",t[0][_][1][1])+he;break;case 5:he=At("\r",t[0][_][1][1])+he;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}o.push(Ae+o.pop()+he);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:y[1][1],r:y[1][0]};var ke={c:e.c,r:e.r};if(i.sharedf[Ue(f)]){var we=i.sharedf[Ue(f)];o.push(xn(we,s,ke,i,r))}else{var Ve=!1;for(l=0;l!=i.arrayf.length;++l)if(c=i.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(xn(c[1],s,ke,i,r)),Ve=!0;break}Ve||o.push(y[1])}break;case"PtgArray":o.push("{"+M5(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&_>=0&&ve.indexOf(t[0][E][0])==-1){y=t[0][_];var Ie=!0;switch(y[1][0]){case 4:Ie=!1;case 0:w=At(" ",y[1][1]);break;case 5:Ie=!1;case 1:w=At("\r",y[1][1]);break;default:if(w="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((Ie?w:"")+o.pop()+(Ie?"":w)),_=-1}}if(o.length>1&&r.WTF)throw new Error("bad formula stack");return o[0]}function I5(t,n,e){var i=t.l+n,r=e.biff==2?1:2,a,s=t.read_shift(r);if(s==65535)return[[],yn(t,n-2)];var o=Vs(t,s,e);return n!==s+r&&(a=Rs(t,n-s-r,o,e)),t.l=i,[o,a]}function P5(t,n,e){var i=t.l+n,r=e.biff==2?1:2,a,s=t.read_shift(r);if(s==65535)return[[],yn(t,n-2)];var o=Vs(t,s,e);return n!==s+r&&(a=Rs(t,n-s-r,o,e)),t.l=i,[o,a]}function O5(t,n,e,i){var r=t.l+n,a=Vs(t,i,e),s;return r!==t.l&&(s=Rs(t,r-t.l,a,e)),[a,s]}function L5(t,n,e){var i=t.l+n,r,a=t.read_shift(2),s=Vs(t,a,e);return a==65535?[[],yn(t,n-2)]:(n!==a+2&&(r=Rs(t,i-a-2,s,e)),[s,r])}function R5(t){var n;if(ji(t,t.l+6)!==65535)return[_n(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return n=t[t.l+2]===1,t.l+=8,[n,"b"];case 2:return n=t[t.l+2],t.l+=8,[n,"e"];case 3:return t.l+=8,["","s"]}return[]}function rc(t,n,e){var i=t.l+n,r=Fi(t,6);e.biff==2&&++t.l;var a=R5(t,8),s=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var o=P5(t,i-t.l,e);return{cell:r,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function Tl(t,n,e){var i=t.read_shift(4),r=Vs(t,i,e),a=t.read_shift(4),s=a>0?Rs(t,a,r,e):null;return[r,s]}var V5=Tl,Al=Tl,N5=Tl,B5=Tl,H5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Zm={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},U5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Th(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function ac(t){var n=t.split(":"),e=n[0].split(".")[0];return[e,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var ys={},Ta={};function Ss(t,n){if(t){var e=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function ep(t,n,e,i,r,a){try{i.cellNF&&(t.z=je[n])}catch(o){if(i.WTF)throw o}if(!(t.t==="z"&&!i.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Jt(t.v)),(!i||i.cellText!==!1)&&t.t!=="z")try{if(je[n]==null&&Rr(z4[n]||"General",n),t.t==="e")t.w=t.w||Gr[t.v];else if(n===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ks(t.v);else if(t.t==="d"){var s=Mn(t.v);(s|0)===s?t.w=s.toString(10):t.w=ks(s)}else{if(t.v===void 0)return"";t.w=Nr(t.v,Ta)}else t.t==="d"?t.w=ti(n,Mn(t.v),Ta):t.w=ti(n,t.v,Ta)}catch(o){if(i.WTF)throw o}if(i.cellStyles&&e!=null)try{t.s=a.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=vl(r.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),i.WTF&&(t.s.fgColor.raw_rgb=r.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=vl(r.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),i.WTF&&(t.s.bgColor.raw_rgb=r.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(i.WTF&&a.Fills)throw o}}}function z5(t,n){var e=Mt(n);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=Ze(e))}var W5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,j5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,G5=/<(?:\w:)?hyperlink [^>]*>/mg,$5=/"(\w*:\w*)"/,Y5=/<(?:\w:)?col\b[^>]*[\/]?>/g,X5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,K5=/<(?:\w:)?pageMargins[^>]*\/>/g,tp=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,q5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,J5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Q5(t,n,e,i,r,a,s){if(!t)return t;i||(i={"!id":{}}),Wt!=null&&n.dense==null&&(n.dense=Wt);var o=n.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",h=t.match(j5);h?(c=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):c=f=t;var m=c.match(tp);m?jc(m[0],o,r,e):(m=c.match(q5))&&Z5(m[0],m[1]||"",o,r,e,s,a);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=c.slice(p,p+50).match($5);v&&z5(o,v[1])}var _=c.match(J5);_&&_[1]&&aT(_[1],r);var w=[];if(n.cellStyles){var E=c.match(Y5);E&&nT(w,E)}h&&sT(h[1],o,n,l,a,s);var S=f.match(X5);S&&(o["!autofilter"]=iT(S[0]));var y=[],V=f.match(W5);if(V)for(p=0;p!=V.length;++p)y[p]=Mt(V[p].slice(V[p].indexOf('"')+1));var H=f.match(G5);H&&eT(o,H,i);var I=f.match(K5);if(I&&(o["!margins"]=tT(Ne(I[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ze(l)),n.sheetRows>0&&o["!ref"]){var T=Mt(o["!ref"]);n.sheetRows<=+T.e.r&&(T.e.r=n.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ze(T))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function jc(t,n,e,i){var r=Ne(t);e.Sheets[i]||(e.Sheets[i]={}),r.codeName&&(e.Sheets[i].CodeName=tt(xt(r.codeName)))}function Z5(t,n,e,i,r){jc(t.slice(0,t.indexOf(">")),e,i,r)}function eT(t,n,e){for(var i=Array.isArray(t),r=0;r!=n.length;++r){var a=Ne(xt(n[r]),!0);if(!a.ref)return;var s=((e||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+tt(a.location))):(a.Target="#"+tt(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Mt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Ue({c,r:l});i?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=a)}}}function tT(t){var n={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(n[e]=parseFloat(t[e]))}),n}function nT(t,n){for(var e=!1,i=0;i!=n.length;++i){var r=Ne(n[i],!0);r.hidden&&(r.hidden=St(r.hidden));var a=parseInt(r.min,10)-1,s=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!e&&r.width&&(e=!0,zc(r.width)),Da(r);a<=s;)t[a++]=an(r)}}function iT(t){var n={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return n}var rT=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function aT(t,n){n.Views||(n.Views=[{}]),(t.match(rT)||[]).forEach(function(e,i){var r=Ne(e);n.Views[i]||(n.Views[i]={}),+r.zoomScale&&(n.Views[i].zoom=+r.zoomScale),St(r.rightToLeft)&&(n.Views[i].RTL=!0)})}var sT=function(){var t=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,a=Es("v"),s=Es("f");return function(l,c,f,h,m,p){for(var v=0,_="",w=[],E=[],S=0,y=0,V=0,H="",I,T,N=0,W=0,ee,te,X=0,me=0,Ae=Array.isArray(p.CellXf),he,ke=[],we=[],Ve=Array.isArray(c),ve=[],Ie={},fe=!1,j=!!f.sheetStubs,ne=l.split(n),Q=0,K=ne.length;Q!=K;++Q){_=ne[Q].trim();var de=_.length;if(de!==0){var De=0;e:for(v=0;v<de;++v)switch(_[v]){case">":if(_[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(T=Ne(_.slice(De,v),!0),N=T.r!=null?parseInt(T.r,10):N+1,W=-1,f.sheetRows&&f.sheetRows<N)continue;Ie={},fe=!1,T.ht&&(fe=!0,Ie.hpt=parseFloat(T.ht),Ie.hpx=Ds(Ie.hpt)),T.hidden=="1"&&(fe=!0,Ie.hidden=!0),T.outlineLevel!=null&&(fe=!0,Ie.level=+T.outlineLevel),fe&&(ve[N-1]=Ie)}break;case"<":De=v;break}if(De>=v)break;if(T=Ne(_.slice(De,v),!0),N=T.r!=null?parseInt(T.r,10):N+1,W=-1,!(f.sheetRows&&f.sheetRows<N)){h.s.r>N-1&&(h.s.r=N-1),h.e.r<N-1&&(h.e.r=N-1),f&&f.cellStyles&&(Ie={},fe=!1,T.ht&&(fe=!0,Ie.hpt=parseFloat(T.ht),Ie.hpx=Ds(Ie.hpt)),T.hidden=="1"&&(fe=!0,Ie.hidden=!0),T.outlineLevel!=null&&(fe=!0,Ie.level=+T.outlineLevel),fe&&(ve[N-1]=Ie)),w=_.slice(v).split(t);for(var be=0;be!=w.length&&w[be].trim().charAt(0)=="<";++be);for(w=w.slice(be),v=0;v!=w.length;++v)if(_=w[v].trim(),_.length!==0){if(E=_.match(e),S=v,y=0,V=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,E!=null&&E.length===2){for(S=0,H=E[1],y=0;y!=H.length&&!((V=H.charCodeAt(y)-64)<1||V>26);++y)S=26*S+V;--S,W=S}else++W;for(y=0;y!=_.length&&_.charCodeAt(y)!==62;++y);if(++y,T=Ne(_.slice(0,y),!0),T.r||(T.r=Ue({r:N-1,c:W})),H=_.slice(y),I={t:""},(E=H.match(a))!=null&&E[1]!==""&&(I.v=tt(E[1])),f.cellFormula){if((E=H.match(s))!=null&&E[1]!==""){if(I.f=tt(xt(E[1])).replace(/\r\n/g,`
`),f.xlfn||(I.f=Sh(I.f)),E[0].indexOf('t="array"')>-1)I.F=(H.match(r)||[])[1],I.F.indexOf(":")>-1&&ke.push([Mt(I.F),I.F]);else if(E[0].indexOf('t="shared"')>-1){te=Ne(E[0]);var Me=tt(xt(E[1]));f.xlfn||(Me=Sh(Me)),we[parseInt(te.si,10)]=[te,Me,T.r]}}else(E=H.match(/<f[^>]*\/>/))&&(te=Ne(E[0]),we[te.si]&&(I.f=xE(we[te.si][1],we[te.si][2],T.r)));var pe=An(T.r);for(y=0;y<ke.length;++y)pe.r>=ke[y][0].s.r&&pe.r<=ke[y][0].e.r&&pe.c>=ke[y][0].s.c&&pe.c<=ke[y][0].e.c&&(I.F=ke[y][1])}if(T.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(j)I.t="z";else continue;else I.t=T.t||"n";switch(h.s.c>W&&(h.s.c=W),h.e.c<W&&(h.e.c=W),I.t){case"n":if(I.v==""||I.v==null){if(!j)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!j)continue;I.t="z"}else ee=ys[parseInt(I.v,10)],I.v=ee.t,I.r=ee.r,f.cellHTML&&(I.h=ee.h);break;case"str":I.t="s",I.v=I.v!=null?xt(I.v):"",f.cellHTML&&(I.h=Tc(I.v));break;case"inlineStr":E=H.match(i),I.t="s",E!=null&&(ee=Uc(E[1]))?(I.v=ee.t,f.cellHTML&&(I.h=ee.h)):I.v="";break;case"b":I.v=St(I.v);break;case"d":f.cellDates?I.v=Jt(I.v,1):(I.v=Mn(Jt(I.v,1)),I.t="n");break;case"e":(!f||f.cellText!==!1)&&(I.w=I.v),I.v=ym[I.v];break}if(X=me=0,he=null,Ae&&T.s!==void 0&&(he=p.CellXf[T.s],he!=null&&(he.numFmtId!=null&&(X=he.numFmtId),f.cellStyles&&he.fillId!=null&&(me=he.fillId))),ep(I,X,me,f,m,p),f.cellDates&&Ae&&I.t=="n"&&Fa(je[X])&&(I.t="d",I.v=Cl(I.v)),T.cm&&f.xlmeta){var Xe=(f.xlmeta.Cell||[])[+T.cm-1];Xe&&Xe.type=="XLDAPR"&&(I.D=!0)}if(Ve){var G=An(T.r);c[G.r]||(c[G.r]=[]),c[G.r][G.c]=I}else c[T.r]=I}}}}ve.length>0&&(c["!rows"]=ve)}}();function oT(t,n){var e={},i=t.l+n;e.r=t.read_shift(4),t.l+=4;var r=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=i,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=r/20),e}var lT=jr;function cT(){}function dT(t,n){var e={},i=t[t.l];return++t.l,e.above=!(i&64),e.left=!(i&128),t.l+=18,e.name=I3(t,n-19),e}function fT(t){var n=ni(t);return[n]}function uT(t){var n=Wr(t);return[n]}function hT(t){var n=ni(t),e=t.read_shift(1);return[n,e,"b"]}function mT(t){var n=Wr(t),e=t.read_shift(1);return[n,e,"b"]}function pT(t){var n=ni(t),e=t.read_shift(1);return[n,e,"e"]}function gT(t){var n=Wr(t),e=t.read_shift(1);return[n,e,"e"]}function xT(t){var n=ni(t),e=t.read_shift(4);return[n,e,"s"]}function _T(t){var n=Wr(t),e=t.read_shift(4);return[n,e,"s"]}function vT(t){var n=ni(t),e=_n(t);return[n,e,"n"]}function np(t){var n=Wr(t),e=_n(t);return[n,e,"n"]}function wT(t){var n=ni(t),e=Nc(t);return[n,e,"n"]}function bT(t){var n=Wr(t),e=Nc(t);return[n,e,"n"]}function yT(t){var n=ni(t),e=Rc(t);return[n,e,"is"]}function ST(t){var n=ni(t),e=bn(t);return[n,e,"str"]}function CT(t){var n=Wr(t),e=bn(t);return[n,e,"str"]}function kT(t,n,e){var i=t.l+n,r=ni(t);r.r=e["!row"];var a=t.read_shift(1),s=[r,a,"b"];if(e.cellFormula){t.l+=2;var o=Al(t,i-t.l,e);s[3]=xn(o,null,r,e.supbooks,e)}else t.l=i;return s}function ET(t,n,e){var i=t.l+n,r=ni(t);r.r=e["!row"];var a=t.read_shift(1),s=[r,a,"e"];if(e.cellFormula){t.l+=2;var o=Al(t,i-t.l,e);s[3]=xn(o,null,r,e.supbooks,e)}else t.l=i;return s}function TT(t,n,e){var i=t.l+n,r=ni(t);r.r=e["!row"];var a=_n(t),s=[r,a,"n"];if(e.cellFormula){t.l+=2;var o=Al(t,i-t.l,e);s[3]=xn(o,null,r,e.supbooks,e)}else t.l=i;return s}function AT(t,n,e){var i=t.l+n,r=ni(t);r.r=e["!row"];var a=bn(t),s=[r,a,"str"];if(e.cellFormula){t.l+=2;var o=Al(t,i-t.l,e);s[3]=xn(o,null,r,e.supbooks,e)}else t.l=i;return s}var MT=jr;function DT(t,n){var e=t.l+n,i=jr(t,16),r=Vc(t),a=bn(t),s=bn(t),o=bn(t);t.l=e;var l={rfx:i,relId:r,loc:a,display:o};return s&&(l.Tooltip=s),l}function FT(){}function IT(t,n,e){var i=t.l+n,r=vm(t,16),a=t.read_shift(1),s=[r];if(s[2]=a,e.cellFormula){var o=V5(t,i-t.l,e);s[1]=o}else t.l=i;return s}function PT(t,n,e){var i=t.l+n,r=jr(t,16),a=[r];if(e.cellFormula){var s=B5(t,i-t.l,e);a[1]=s,t.l=i}else t.l=i;return a}var OT=["left","right","top","bottom","header","footer"];function LT(t){var n={};return OT.forEach(function(e){n[e]=_n(t,8)}),n}function RT(t){var n=t.read_shift(2);return t.l+=28,{RTL:n&32}}function VT(){}function NT(){}function BT(t,n,e,i,r,a,s){if(!t)return t;var o=n||{};i||(i={"!id":{}}),Wt!=null&&o.dense==null&&(o.dense=Wt);var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=[],m=!1,p=!1,v,_,w,E,S,y,V,H,I,T=[];o.biff=12,o["!row"]=0;var N=0,W=!1,ee=[],te={},X=o.supbooks||r.supbooks||[[]];if(X.sharedf=te,X.arrayf=ee,X.SheetNames=r.SheetNames||r.Sheets.map(function(Ie){return Ie.name}),!o.supbooks&&(o.supbooks=X,r.Names))for(var me=0;me<r.Names.length;++me)X[0][me+1]=r.Names[me];var Ae=[],he=[],ke=!1;yl[16]={n:"BrtShortReal",f:np};var we,Ve;if(Xi(t,function(fe,j,ne){if(!p)switch(ne){case 148:c=fe;break;case 0:v=fe,o.sheetRows&&o.sheetRows<=v.r&&(p=!0),H=sn(E=v.r),o["!row"]=v.r,(fe.hidden||fe.hpt||fe.level!=null)&&(fe.hpt&&(fe.hpx=Ds(fe.hpt)),he[fe.r]=fe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:fe[2]},fe[2]){case"n":_.v=fe[1];break;case"s":V=ys[fe[1]],_.v=V.t,_.r=V.r;break;case"b":_.v=!!fe[1];break;case"e":_.v=fe[1],o.cellText!==!1&&(_.w=Gr[_.v]);break;case"str":_.t="s",_.v=fe[1];break;case"is":_.t="s",_.v=fe[1].t;break}if((w=s.CellXf[fe[0].iStyleRef])&&ep(_,w.numFmtId,null,o,a,s),S=fe[0].c==-1?S+1:fe[0].c,o.dense?(l[E]||(l[E]=[]),l[E][S]=_):l[Gt(S)+H]=_,o.cellFormula){for(W=!1,N=0;N<ee.length;++N){var Q=ee[N];v.r>=Q[0].s.r&&v.r<=Q[0].e.r&&S>=Q[0].s.c&&S<=Q[0].e.c&&(_.F=Ze(Q[0]),W=!0)}!W&&fe.length>3&&(_.f=fe[3])}if(f.s.r>v.r&&(f.s.r=v.r),f.s.c>S&&(f.s.c=S),f.e.r<v.r&&(f.e.r=v.r),f.e.c<S&&(f.e.c=S),o.cellDates&&w&&_.t=="n"&&Fa(je[w.numFmtId])){var K=Lr(_.v);K&&(_.t="d",_.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}we&&(we.type=="XLDAPR"&&(_.D=!0),we=void 0),Ve&&(Ve=void 0);break;case 1:case 12:if(!o.sheetStubs||m)break;_={t:"z",v:void 0},S=fe[0].c==-1?S+1:fe[0].c,o.dense?(l[E]||(l[E]=[]),l[E][S]=_):l[Gt(S)+H]=_,f.s.r>v.r&&(f.s.r=v.r),f.s.c>S&&(f.s.c=S),f.e.r<v.r&&(f.e.r=v.r),f.e.c<S&&(f.e.c=S),we&&(we.type=="XLDAPR"&&(_.D=!0),we=void 0),Ve&&(Ve=void 0);break;case 176:T.push(fe);break;case 49:we=((o.xlmeta||{}).Cell||[])[fe-1];break;case 494:var de=i["!id"][fe.relId];for(de?(fe.Target=de.Target,fe.loc&&(fe.Target+="#"+fe.loc),fe.Rel=de):fe.relId==""&&(fe.Target="#"+fe.loc),E=fe.rfx.s.r;E<=fe.rfx.e.r;++E)for(S=fe.rfx.s.c;S<=fe.rfx.e.c;++S)o.dense?(l[E]||(l[E]=[]),l[E][S]||(l[E][S]={t:"z",v:void 0}),l[E][S].l=fe):(y=Ue({c:S,r:E}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=fe);break;case 426:if(!o.cellFormula)break;ee.push(fe),I=o.dense?l[E][S]:l[Gt(S)+H],I.f=xn(fe[1],f,{r:v.r,c:S},X,o),I.F=Ze(fe[0]);break;case 427:if(!o.cellFormula)break;te[Ue(fe[0].s)]=fe[1],I=o.dense?l[E][S]:l[Gt(S)+H],I.f=xn(fe[1],f,{r:v.r,c:S},X,o);break;case 60:if(!o.cellStyles)break;for(;fe.e>=fe.s;)Ae[fe.e--]={width:fe.w/256,hidden:!!(fe.flags&1),level:fe.level},ke||(ke=!0,zc(fe.w/256)),Da(Ae[fe.e+1]);break;case 161:l["!autofilter"]={ref:Ze(fe)};break;case 476:l["!margins"]=fe;break;case 147:r.Sheets[e]||(r.Sheets[e]={}),fe.name&&(r.Sheets[e].CodeName=fe.name),(fe.above||fe.left)&&(l["!outline"]={above:fe.above,left:fe.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),fe.RTL&&(r.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:h.push(ne),m=!0;break;case 38:h.pop(),m=!1;break;default:if(!j.T){if(!m||o.WTF)throw new Error("Unexpected record 0x"+ne.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ze(c||f)),o.sheetRows&&l["!ref"]){var ve=Mt(l["!ref"]);o.sheetRows<=+ve.e.r&&(ve.e.r=o.sheetRows-1,ve.e.r>f.e.r&&(ve.e.r=f.e.r),ve.e.r<ve.s.r&&(ve.s.r=ve.e.r),ve.e.c>f.e.c&&(ve.e.c=f.e.c),ve.e.c<ve.s.c&&(ve.s.c=ve.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ze(ve))}return T.length>0&&(l["!merges"]=T),Ae.length>0&&(l["!cols"]=Ae),he.length>0&&(l["!rows"]=he),l}function HT(t){var n=[],e=t.match(/^<c:numCache>/),i;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(n[+s[1]]=e?+s[2]:s[2])});var r=tt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){i=a.replace(/<.*?>/g,"")}),[n,r,i]}function UT(t,n,e,i,r,a){var s=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=HT(h);f.s.r=f.s.c=0,f.e.c=o,c=Gt(o),m[0].forEach(function(p,v){s[c+sn(v)]={t:"n",v:p,z:m[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(s["!ref"]=Ze(f)),s}function zT(t,n,e,i,r){if(!t)return t;i||(i={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=t.match(tp);return o&&jc(o[0],a,r,e),(s=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),i["!id"][a["!rel"]]&&(a["!drawel"]=i["!id"][a["!rel"]]),a}function WT(t,n){t.l+=10;var e=bn(t,n-10);return{name:e}}function jT(t,n,e,i,r){if(!t)return t;i||(i={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return Xi(t,function(c,f,h){switch(h){case 550:a["!rel"]=c;break;case 651:r.Sheets[e]||(r.Sheets[e]={}),c.name&&(r.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h);break;case 38:s.pop();break;default:if(f.T>0)s.push(h);else if(f.T<0)s.pop();else if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}},n),i["!id"][a["!rel"]]&&(a["!drawel"]=i["!id"][a["!rel"]]),a}var ip=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],GT=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$T=[],YT=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ah(t,n){for(var e=0;e!=t.length;++e)for(var i=t[e],r=0;r!=n.length;++r){var a=n[r];if(i[a[0]]==null)i[a[0]]=a[1];else switch(a[2]){case"bool":typeof i[a[0]]=="string"&&(i[a[0]]=St(i[a[0]]));break;case"int":typeof i[a[0]]=="string"&&(i[a[0]]=parseInt(i[a[0]],10));break}}}function Mh(t,n){for(var e=0;e!=n.length;++e){var i=n[e];if(t[i[0]]==null)t[i[0]]=i[1];else switch(i[2]){case"bool":typeof t[i[0]]=="string"&&(t[i[0]]=St(t[i[0]]));break;case"int":typeof t[i[0]]=="string"&&(t[i[0]]=parseInt(t[i[0]],10));break}}}function rp(t){Mh(t.WBProps,ip),Mh(t.CalcPr,YT),Ah(t.WBView,GT),Ah(t.Sheets,$T),Ta.date1904=St(t.WBProps.date1904)}var XT="][*?/\\".split("");function KT(t,n){if(t.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return XT.forEach(function(i){if(t.indexOf(i)!=-1){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}var qT=/<\w+:workbook/;function JT(t,n){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,r="xmlns",a={},s=0;if(t.replace(Sn,function(l,c){var f=Ne(l);switch(Di(f[0])){case"<?xml":break;case"<workbook":l.match(qT)&&(r="xmlns"+l.match(/<(\w+):/)[1]),e.xmlns=f[r];break;case"</workbook>":break;case"<fileVersion":delete f[0],e.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ip.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":e.WBProps[h[0]]=St(f[h[0]]);break;case"int":e.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:e.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(e.WBProps.CodeName=xt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],e.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=tt(xt(f.name)),delete f[0],e.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":a={},a.Name=xt(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),St(f.hidden||"0")&&(a.Hidden=!0),s=c+l.length;break;case"</definedName>":a.Ref=tt(xt(t.slice(s,c))),e.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],e.CalcPr=f;break;case"<calcPr/>":delete f[0],e.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&n.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),m3.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return rp(e),e}function QT(t,n){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=fc(t,n-8),e.name=bn(t),e}function ZT(t,n){var e={},i=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var r=n>8?bn(t):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function e6(t,n){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=n-8,e}function t6(t,n,e){var i=t.l+n;t.l+=4,t.l+=1;var r=t.read_shift(4),a=P3(t),s=N5(t,0,e),o=Vc(t);t.l=i;var l={Name:a,Ptg:s};return r<268435455&&(l.Sheet=r),o&&(l.Comment=o),l}function n6(t,n){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],r=!1;n||(n={}),n.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],yl[16]={n:"BrtFRTArchID$",f:e6},Xi(t,function(l,c,f){switch(f){case 156:s.SheetNames.push(l.name),e.Sheets.push(l);break;case 153:e.WBProps=l;break;case 39:l.Sheet!=null&&(n.SID=l.Sheet),l.Ref=xn(l.Ptg,null,null,s,n),delete n.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,l]):s[0]=[f,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(f),r=!0;break;case 36:i.pop(),r=!1;break;case 37:i.push(f),r=!0;break;case 38:i.pop(),r=!1;break;case 16:break;default:if(!c.T){if(!r||n.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},n),rp(e),e.Names=a,e.supbooks=s,e}function i6(t,n,e){return n.slice(-4)===".bin"?n6(t,e):JT(t,e)}function r6(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?BT(t,i,e,r,a,s,o):Q5(t,i,e,r,a,s,o)}function a6(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?jT(t,i,e,r,a,s,o):zT(t,i,e,r,a,s,o)}function s6(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?mE(t,i,e,r,a,s,o):pE(t,i,e,r,a,s,o)}function o6(t,n,e,i,r,a,s,o){return n.slice(-4)===".bin"?uE(t,i,e,r,a,s,o):hE(t,i,e,r,a,s,o)}function l6(t,n,e,i){return n.slice(-4)===".bin"?Mk(t,e,i):Sk(t,e,i)}function c6(t,n,e){return jm(t,e)}function d6(t,n,e){return n.slice(-4)===".bin"?GC(t,e):WC(t,e)}function f6(t,n,e){return n.slice(-4)===".bin"?cE(t,e):rE(t,e)}function u6(t,n,e){return n.slice(-4)===".bin"?tE(t,n,e):Zk(t,n,e)}function h6(t,n,e,i){return e.slice(-4)===".bin"?nE(t,n,e,i):void 0}function m6(t,n,e){return n.slice(-4)===".bin"?Jk(t,n,e):Qk(t,n,e)}var ap=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sp=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function li(t,n){var e=t.split(/\s+/),i=[];if(n||(i[0]=e[0]),e.length===1)return i;var r=t.match(ap),a,s,o,l;if(r)for(l=0;l!=r.length;++l)a=r[l].match(sp),(s=a[1].indexOf(":"))===-1?i[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),i[o]=a[2].slice(1,a[2].length-1));return i}function p6(t){var n=t.split(/\s+/),e={};if(n.length===1)return e;var i=t.match(ap),r,a,s,o;if(i)for(o=0;o!=i.length;++o)r=i[o].match(sp),(a=r[1].indexOf(":"))===-1?e[r[1]]=r[2].slice(1,r[2].length-1):(r[1].slice(0,6)==="xmlns:"?s="xmlns"+r[1].slice(6):s=r[1].slice(a+1),e[s]=r[2].slice(1,r[2].length-1));return e}var Cs;function g6(t,n){var e=Cs[t]||tt(t);return e==="General"?Nr(n):ti(e,n)}function x6(t,n,e,i){var r=i;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=St(i);break;case"i2":case"int":r=parseInt(i,10);break;case"r4":case"float":r=parseFloat(i);break;case"date":case"dateTime.tz":r=Jt(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[tt(n)]=r}function _6(t,n,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Gr[t.v]:n==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ks(t.v):t.w=Nr(t.v):t.w=g6(n||"General",t.v)}catch(a){if(e.WTF)throw a}try{var i=Cs[n]||n||"General";if(e.cellNF&&(t.z=i),e.cellDates&&t.t=="n"&&Fa(i)){var r=Lr(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(a){if(e.WTF)throw a}}}function v6(t,n,e){if(e.cellStyles&&n.Interior){var i=n.Interior;i.Pattern&&(i.patternType=xk[i.Pattern]||i.Pattern)}t[n.ID]=n}function w6(t,n,e,i,r,a,s,o,l,c){var f="General",h=i.StyleID,m={};c=c||{};var p=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);a[h]!==void 0&&(a[h].nf&&(f=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(e.Type){case"Boolean":i.t="b",i.v=St(t);break;case"String":i.t="s",i.r=Ju(tt(t)),i.v=t.indexOf("<")>-1?tt(n||t).replace(/<.*?>/g,""):i.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),i.v=(Jt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),i.v!==i.v?i.v=tt(t):i.v<60&&(i.v=i.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+t),i.t||(i.t="n");break;case"Error":i.t="e",i.v=ym[t],c.cellText!==!1&&(i.w=t);break;default:t==""&&n==""?i.t="z":(i.t="s",i.v=Ju(n||t));break}if(_6(i,f,c),c.cellFormula!==!1)if(i.Formula){var _=tt(i.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),i.f=Ea(_,r),delete i.Formula,i.ArrayRange=="RC"?i.F=Ea("RC:RC",r):i.ArrayRange&&(i.F=Ea(i.ArrayRange,r),l.push([Mt(i.F),i.F]))}else for(v=0;v<l.length;++v)r.r>=l[v][0].s.r&&r.r<=l[v][0].e.r&&r.c>=l[v][0].s.c&&r.c<=l[v][0].e.c&&(i.F=l[v][1]);c.cellStyles&&(p.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),i.s=m),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function b6(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function sc(t,n){var e=n||{};Qh();var i=us(Ac(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(typeof ct<"u"?i=ct.utils.decode(65001,cc(i)):i=xt(i));var r=i.slice(0,1024).toLowerCase(),a=!1;if(r=r.replace(/".*?"/g,""),(r.indexOf(">")&1023)>Math.min(r.indexOf(",")&1023,r.indexOf(";")&1023)){var s=an(e);return s.type="string",As.to_workbook(i,s)}if(r.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(bt){r.indexOf("<"+bt)>=0&&(a=!0)}),a)return D6(i,e);Cs={"General Number":"General","General Date":je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":je[15],"Short Date":je[14],"Long Time":je[19],"Medium Time":je[18],"Short Time":je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:je[2],Standard:je[4],Percent:je[10],Scientific:je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c;Wt!=null&&e.dense==null&&(e.dense=Wt);var f={},h=[],m=e.dense?[]:{},p="",v={},_={},w=li('<Data ss:Type="String">'),E=0,S=0,y=0,V={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},I={},T="",N=0,W=[],ee={},te={},X=0,me=[],Ae=[],he={},ke=[],we,Ve=!1,ve=[],Ie=[],fe={},j=0,ne=0,Q={Sheets:[],WBProps:{date1904:!1}},K={};Ts.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=Ts.exec(i);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?w6(i.slice(E,o.index),T,w,l[l.length-1][0]=="comment"?he:v,{c:S,r:y},H,ke[S],_,ve,e):(T="",w=li(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ae.length>0&&(v.c=Ae),(!e.sheetRows||e.sheetRows>y)&&v.v!==void 0&&(e.dense?(m[y]||(m[y]=[]),m[y][S]=v):m[Gt(S)+sn(y)]=v),v.HRef&&(v.l={Target:tt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(j=S+(parseInt(v.MergeAcross,10)|0),ne=y+(parseInt(v.MergeDown,10)|0),W.push({s:{c:S,r:y},e:{c:j,r:ne}})),!e.sheetStubs)v.MergeAcross?S=j+1:++S;else if(v.MergeAcross||v.MergeDown){for(var De=S;De<=j;++De)for(var be=y;be<=ne;++be)(De>S||be>y)&&(e.dense?(m[be]||(m[be]=[]),m[be][De]={t:"z"}):m[Gt(De)+sn(be)]={t:"z"});S=j+1}else++S;else v=p6(o[0]),v.Index&&(S=+v.Index-1),S<V.s.c&&(V.s.c=S),S>V.e.c&&(V.e.c=S),o[0].slice(-2)==="/>"&&++S,Ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<V.s.r&&(V.s.r=y),y>V.e.r&&(V.e.r=y),o[0].slice(-2)==="/>"&&(_=li(o[0]),_.Index&&(y=+_.Index-1)),S=0,++y):(_=li(o[0]),_.Index&&(y=+_.Index-1),fe={},(_.AutoFitHeight=="0"||_.Height)&&(fe.hpx=parseInt(_.Height,10),fe.hpt=Wm(fe.hpx),Ie[y]=fe),_.Hidden=="1"&&(fe.hidden=!0,Ie[y]=fe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),V.s.r<=V.e.r&&V.s.c<=V.e.c&&(m["!ref"]=Ze(V),e.sheetRows&&e.sheetRows<=V.e.r&&(m["!fullref"]=m["!ref"],V.e.r=e.sheetRows-1,m["!ref"]=Ze(V))),W.length&&(m["!merges"]=W),ke.length>0&&(m["!cols"]=ke),Ie.length>0&&(m["!rows"]=Ie),f[p]=m}else V={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=S=0,l.push([o[3],!1]),c=li(o[0]),p=tt(c.Name),m=e.dense?[]:{},W=[],ve=[],Ie=[],K={name:p,Hidden:0},Q.Sheets.push(K);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ke=[],Ve=!1}break;case"style":o[1]==="/"?v6(H,I,e):I=li(o[0]);break;case"numberformat":I.nf=tt(li(o[0]).Format||"General"),Cs[I.nf]&&(I.nf=Cs[I.nf]);for(var Me=0;Me!=392&&je[Me]!=I.nf;++Me);if(Me==392){for(Me=57;Me!=392;++Me)if(je[Me]==null){Rr(I.nf,Me);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(we=li(o[0]),we.Hidden&&(we.hidden=!0,delete we.Hidden),we.Width&&(we.wpx=parseInt(we.Width,10)),!Ve&&we.wpx>10){Ve=!0,Tn=Um;for(var pe=0;pe<ke.length;++pe)ke[pe]&&Da(ke[pe])}Ve&&Da(we),ke[we.Index-1||ke.length]=we;for(var Xe=0;Xe<+we.Span;++Xe)ke[ke.length]=an(we);break;case"namedrange":if(o[1]==="/")break;Q.Names||(Q.Names=[]);var G=Ne(o[0]),_t={Name:G.Name,Ref:Ea(G.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(_t.Sheet=Q.Sheets.length-1),Q.Names.push(_t);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=i.slice(N,o.index):N=o.index+o[0].length;break;case"interior":if(!e.cellStyles)break;I.Interior=li(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?rS(ee,de,i.slice(X,o.index)):X=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));b6(he),Ae.push(he)}else l.push([o[3],!1]),c=li(o[0]),he={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var qe=li(o[0]);m["!autofilter"]={ref:Ea(qe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Lh(i,e);var it=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:it=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:it=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:it=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:it=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(i.slice(X,o.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else X=o.index+o[0].length;break;case"header":m["!margins"]||Ss(m["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(m["!margins"].header=+Ne(o[0]).Margin);break;case"footer":m["!margins"]||Ss(m["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(m["!margins"].footer=+Ne(o[0]).Margin);break;case"pagemargins":var $e=Ne(o[0]);m["!margins"]||Ss(m["!margins"]={},"xlml"),isNaN(+$e.Top)||(m["!margins"].top=+$e.Top),isNaN(+$e.Left)||(m["!margins"].left=+$e.Left),isNaN(+$e.Right)||(m["!margins"].right=+$e.Right),isNaN(+$e.Bottom)||(m["!margins"].bottom=+$e.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:it=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:it=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:it=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:it=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:it=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:it=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:it=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:it=!1}break;case"smarttags":break;default:it=!1;break}if(it||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?x6(te,de,me,i.slice(X,o.index)):(me=o,X=o.index+o[0].length);break}if(e.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Te={};return!e.bookSheets&&!e.bookProps&&(Te.Sheets=f),Te.SheetNames=h,Te.Workbook=Q,Te.SSF=an(je),Te.Props=ee,Te.Custprops=te,Te}function pc(t,n){switch(Yc(n=n||{}),n.type||"base64"){case"base64":return sc(jn(t),n);case"binary":case"buffer":case"file":return sc(t,n);case"array":return sc(zr(t),n)}}function y6(t){var n={},e=t.content;if(e.l=28,n.AnsiUserType=e.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=R3(e),e.length-e.l<=4)return n;var i=e.read_shift(4);if(i==0||i>40||(e.l-=4,n.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(i=e.read_shift(4),i!==1907505652)||(n.UnicodeClipboardFormat=V3(e),i=e.read_shift(4),i==0||i>40))return n;e.l-=4,n.Reserved2=e.read_shift(0,"lpwstr")}var S6=[60,1084,2066,2165,2175];function C6(t,n,e,i,r){var a=i,s=[],o=e.slice(e.l,e.l+a);if(r&&r.enc&&r.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:r.enc.insitu(o)}s.push(o),e.l+=a;for(var l=ji(e,e.l),c=gc[l],f=0;c!=null&&S6.indexOf(l)>-1;)a=ji(e,e.l+2),f=e.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=e.slice(f,e.l+4+a),s.push(o),e.l+=4+a,c=gc[l=ji(e,e.l)];var h=gr(s);rn(h,0);var m=0;h.lens=[];for(var p=0;p<s.length;++p)h.lens.push(m),m+=s[p].length;if(h.length<i)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+i;return n.f(h,h.length,r)}function Ei(t,n,e){if(t.t!=="z"&&t.XF){var i=0;try{i=t.z||t.XF.numFmtId||0,n.cellNF&&(t.z=je[i])}catch(a){if(n.WTF)throw a}if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||Gr[t.v]:i===0||i=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ks(t.v):t.w=Nr(t.v):t.w=ti(i,t.v,{date1904:!!e,dateNF:n&&n.dateNF})}catch(a){if(n.WTF)throw a}if(n.cellDates&&i&&t.t=="n"&&Fa(je[i]||String(i))){var r=Lr(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function fl(t,n,e){return{v:t,ixfe:n,t:e}}function k6(t,n){var e={opts:{}},i={};Wt!=null&&n.dense==null&&(n.dense=Wt);var r=n.dense?[]:{},a={},s={},o=null,l=[],c="",f={},h,m="",p,v,_,w,E={},S=[],y,V,H=[],I=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},W=function(Ge){return Ge<8?Vr[Ge]:Ge<64&&I[Ge-8]||Vr[Ge]},ee=function(Ge,Ct,Cn){var Dt=Ct.XF.data;if(!(!Dt||!Dt.patternType||!Cn||!Cn.cellStyles)){Ct.s={},Ct.s.patternType=Dt.patternType;var Ii;(Ii=Ms(W(Dt.icvFore)))&&(Ct.s.fgColor={rgb:Ii}),(Ii=Ms(W(Dt.icvBack)))&&(Ct.s.bgColor={rgb:Ii})}},te=function(Ge,Ct,Cn){if(!(fe>1)&&!(Cn.sheetRows&&Ge.r>=Cn.sheetRows)){if(Cn.cellStyles&&Ct.XF&&Ct.XF.data&&ee(Ge,Ct,Cn),delete Ct.ixfe,delete Ct.XF,h=Ge,m=Ue(Ge),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<s.s.r&&(s.s.r=Ge.r),Ge.c<s.s.c&&(s.s.c=Ge.c),Ge.r+1>s.e.r&&(s.e.r=Ge.r+1),Ge.c+1>s.e.c&&(s.e.c=Ge.c+1),Cn.cellFormula&&Ct.f){for(var Dt=0;Dt<S.length;++Dt)if(!(S[Dt][0].s.c>Ge.c||S[Dt][0].s.r>Ge.r)&&!(S[Dt][0].e.c<Ge.c||S[Dt][0].e.r<Ge.r)){Ct.F=Ze(S[Dt][0]),(S[Dt][0].s.c!=Ge.c||S[Dt][0].s.r!=Ge.r)&&delete Ct.f,Ct.f&&(Ct.f=""+xn(S[Dt][1],s,Ge,ve,X));break}}Cn.dense?(r[Ge.r]||(r[Ge.r]=[]),r[Ge.r][Ge.c]=Ct):r[m]=Ct}},X={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(X.password=n.password);var me,Ae=[],he=[],ke=[],we=[],Ve=!1,ve=[];ve.SheetNames=X.snames,ve.sharedf=X.sharedf,ve.arrayf=X.arrayf,ve.names=[],ve.XTI=[];var Ie=0,fe=0,j=0,ne=[],Q=[],K;X.codepage=1200,fi(1200);for(var de=!1;t.l<t.length-1;){var De=t.l,be=t.read_shift(2);if(be===0&&Ie===10)break;var Me=t.l===t.length?0:t.read_shift(2),pe=gc[be];if(pe&&pe.f){if(n.bookSheets&&Ie===133&&be!==133)break;if(Ie=be,pe.r===2||pe.r==12){var Xe=t.read_shift(2);if(Me-=2,!X.enc&&Xe!==be&&((Xe&255)<<8|Xe>>8)!==be)throw new Error("rt mismatch: "+Xe+"!="+be);pe.r==12&&(t.l+=10,Me-=10)}var G={};if(be===10?G=pe.f(t,Me,X):G=C6(be,pe,t,Me,X),fe==0&&[9,521,1033,2057].indexOf(Ie)===-1)continue;switch(be){case 34:e.opts.Date1904=T.WBProps.date1904=G;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(X.enc||(t.l=0),X.enc=G,!n.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=G;break;case 66:var _t=Number(G);switch(_t){case 21010:_t=1200;break;case 32768:_t=1e4;break;case 32769:_t=1252;break}fi(X.codepage=_t),de=!0;break;case 317:X.rrtabid=G;break;case 25:X.winlocked=G;break;case 439:e.opts.RefreshAll=G;break;case 12:e.opts.CalcCount=G;break;case 16:e.opts.CalcDelta=G;break;case 17:e.opts.CalcIter=G;break;case 13:e.opts.CalcMode=G;break;case 14:e.opts.CalcPrecision=G;break;case 95:e.opts.CalcSaveRecalc=G;break;case 15:X.CalcRefMode=G;break;case 2211:e.opts.FullCalc=G;break;case 129:G.fDialog&&(r["!type"]="dialog"),G.fBelow||((r["!outline"]||(r["!outline"]={})).above=!0),G.fRight||((r["!outline"]||(r["!outline"]={})).left=!0);break;case 224:H.push(G);break;case 430:ve.push([G]),ve[ve.length-1].XTI=[];break;case 35:case 547:ve[ve.length-1].push(G);break;case 24:case 536:K={Name:G.Name,Ref:xn(G.rgce,s,null,ve,X)},G.itab>0&&(K.Sheet=G.itab-1),ve.names.push(K),ve[0]||(ve[0]=[],ve[0].XTI=[]),ve[ve.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(Q[G.itab-1]={ref:Ze(G.rgce[0][0][1][2])});break;case 22:X.ExternCount=G;break;case 23:ve.length==0&&(ve[0]=[],ve[0].XTI=[]),ve[ve.length-1].XTI=ve[ve.length-1].XTI.concat(G),ve.XTI=ve.XTI.concat(G);break;case 2196:if(X.biff<8)break;K!=null&&(K.Comment=G[1]);break;case 18:r["!protect"]=G;break;case 19:G!==0&&X.WTF&&console.error("Password verifier: "+G);break;case 133:a[G.pos]=G,X.snames.push(G.name);break;case 10:{if(--fe)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,r["!ref"]=Ze(s),n.sheetRows&&n.sheetRows<=s.e.r){var qe=s.e.r;s.e.r=n.sheetRows-1,r["!fullref"]=r["!ref"],r["!ref"]=Ze(s),s.e.r=qe}s.e.r++,s.e.c++}Ae.length>0&&(r["!merges"]=Ae),he.length>0&&(r["!objects"]=he),ke.length>0&&(r["!cols"]=ke),we.length>0&&(r["!rows"]=we),T.Sheets.push(N)}c===""?f=r:i[c]=r,r=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[be]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),X.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(X.biff=5,de=!0,fi(X.codepage=28591)),X.biff==8&&G.BIFFVer==0&&G.dt==16&&(X.biff=2),fe++)break;if(r=n.dense?[]:{},X.biff<8&&!de&&(de=!0,fi(X.codepage=n.codepage||1252)),X.biff<5||G.BIFFVer==0&&G.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var it={pos:t.l-Me,name:c};a[it.pos]=it,X.snames.push(c)}else c=(a[De]||{name:""}).name;G.dt==32&&(r["!type"]="chart"),G.dt==64&&(r["!type"]="macro"),Ae=[],he=[],X.arrayf=S=[],ke=[],we=[],Ve=!1,N={Hidden:(a[De]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:r["!type"]=="chart"&&(n.dense?(r[G.r]||[])[G.c]:r[Ue({c:G.c,r:G.r})])&&++G.c,y={ixfe:G.ixfe,XF:H[G.ixfe]||{},v:G.val,t:"n"},j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:G.c,r:G.r},y,n);break;case 5:case 517:y={ixfe:G.ixfe,XF:H[G.ixfe],v:G.val,t:G.t},j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:G.c,r:G.r},y,n);break;case 638:y={ixfe:G.ixfe,XF:H[G.ixfe],v:G.rknum,t:"n"},j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:G.c,r:G.r},y,n);break;case 189:for(var $e=G.c;$e<=G.C;++$e){var Te=G.rkrec[$e-G.c][0];y={ixfe:Te,XF:H[Te],v:G.rkrec[$e-G.c][1],t:"n"},j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:$e,r:G.r},y,n)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(y=fl(G.val,G.cell.ixfe,G.tt),y.XF=H[y.ixfe],n.cellFormula){var bt=G.formula;if(bt&&bt[0]&&bt[0][0]&&bt[0][0][0]=="PtgExp"){var Qt=bt[0][0][1][0],Gn=bt[0][0][1][1],ii=Ue({r:Qt,c:Gn});E[ii]?y.f=""+xn(G.formula,s,G.cell,ve,X):y.F=((n.dense?(r[Qt]||[])[Gn]:r[ii])||{}).F}else y.f=""+xn(G.formula,s,G.cell,ve,X)}j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te(G.cell,y,n),o=G}break;case 7:case 519:if(o)o.val=G,y=fl(G,o.cell.ixfe,"s"),y.XF=H[y.ixfe],n.cellFormula&&(y.f=""+xn(o.formula,s,o.cell,ve,X)),j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te(o.cell,y,n),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(G);var Ki=Ue(G[0].s);if(p=n.dense?(r[G[0].s.r]||[])[G[0].s.c]:r[Ki],n.cellFormula&&p){if(!o||!Ki||!p)break;p.f=""+xn(G[1],s,G[0],ve,X),p.F=Ze(G[0])}}break;case 1212:{if(!n.cellFormula)break;if(m){if(!o)break;E[Ue(o.cell)]=G[0],p=n.dense?(r[o.cell.r]||[])[o.cell.c]:r[Ue(o.cell)],(p||{}).f=""+xn(G[0],s,h,ve,X)}}break;case 253:y=fl(l[G.isst].t,G.ixfe,"s"),l[G.isst].h&&(y.h=l[G.isst].h),y.XF=H[y.ixfe],j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:G.c,r:G.r},y,n);break;case 513:n.sheetStubs&&(y={ixfe:G.ixfe,XF:H[G.ixfe],t:"z"},j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:G.c,r:G.r},y,n));break;case 190:if(n.sheetStubs)for(var $n=G.c;$n<=G.C;++$n){var on=G.ixfe[$n-G.c];y={ixfe:on,XF:H[on],t:"z"},j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:$n,r:G.r},y,n)}break;case 214:case 516:case 4:y=fl(G.val,G.ixfe,"s"),y.XF=H[y.ixfe],j>0&&(y.z=ne[y.ixfe>>8&63]),Ei(y,n,e.opts.Date1904),te({c:G.c,r:G.r},y,n);break;case 0:case 512:fe===1&&(s=G);break;case 252:l=G;break;case 1054:if(X.biff==4){ne[j++]=G[1];for(var Dn=0;Dn<j+163&&je[Dn]!=G[1];++Dn);Dn>=163&&Rr(G[1],j+163)}else Rr(G[1],G[0]);break;case 30:{ne[j++]=G;for(var mi=0;mi<j+163&&je[mi]!=G;++mi);mi>=163&&Rr(G,j+163)}break;case 229:Ae=Ae.concat(G);break;case 93:he[G.cmo[0]]=X.lastobj=G;break;case 438:X.lastobj.TxO=G;break;case 127:X.lastobj.ImData=G;break;case 440:for(w=G[0].s.r;w<=G[0].e.r;++w)for(_=G[0].s.c;_<=G[0].e.c;++_)p=n.dense?(r[w]||[])[_]:r[Ue({c:_,r:w})],p&&(p.l=G[1]);break;case 2048:for(w=G[0].s.r;w<=G[0].e.r;++w)for(_=G[0].s.c;_<=G[0].e.c;++_)p=n.dense?(r[w]||[])[_]:r[Ue({c:_,r:w})],p&&p.l&&(p.l.Tooltip=G[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;p=n.dense?(r[G[0].r]||[])[G[0].c]:r[Ue(G[0])];var qi=he[G[2]];p||(n.dense?(r[G[0].r]||(r[G[0].r]=[]),p=r[G[0].r][G[0].c]={t:"z"}):p=r[Ue(G[0])]={t:"z"},s.e.r=Math.max(s.e.r,G[0].r),s.s.r=Math.min(s.s.r,G[0].r),s.e.c=Math.max(s.e.c,G[0].c),s.s.c=Math.min(s.s.c,G[0].c)),p.c||(p.c=[]),v={a:G[1],t:qi.TxO.t},p.c.push(v)}break;case 2173:Yk(H[G.ixfe],G.ext);break;case 125:{if(!X.cellStyles)break;for(;G.e>=G.s;)ke[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},Ve||(Ve=!0,zc(G.w/256)),Da(ke[G.e+1])}break;case 520:{var Zt={};G.level!=null&&(we[G.r]=Zt,Zt.level=G.level),G.hidden&&(we[G.r]=Zt,Zt.hidden=!0),G.hpt&&(we[G.r]=Zt,Zt.hpt=G.hpt,Zt.hpx=Ds(G.hpt))}break;case 38:case 39:case 40:case 41:r["!margins"]||Ss(r["!margins"]={}),r["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[be]]=G;break;case 161:r["!margins"]||Ss(r["!margins"]={}),r["!margins"].header=G.header,r["!margins"].footer=G.footer;break;case 574:G.RTL&&(T.Views[0].RTL=!0);break;case 146:I=G;break;case 2198:me=G;break;case 140:V=G;break;case 442:c?N.CodeName=G||N.name:T.WBProps.CodeName=G||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+be.toString(16)),t.l+=Me}return e.SheetNames=Mi(a).sort(function(Un,Ge){return Number(Un)-Number(Ge)}).map(function(Un){return a[Un].name}),n.bookSheets||(e.Sheets=i),!e.SheetNames.length&&f["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=f)):e.Preamble=f,e.Sheets&&Q.forEach(function(Un,Ge){e.Sheets[e.SheetNames[Ge]]["!autofilter"]=Un}),e.Strings=l,e.SSF=an(je),X.enc&&(e.Encryption=X.enc),me&&(e.Themes=me),e.Metadata={},V!==void 0&&(e.Metadata.Country=V),ve.names.length>0&&(T.Names=ve.names),e.Workbook=T,e}var Dh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function E6(t,n,e){var i=Qe.find(t,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var r=hh(i,W3,Dh.DSI);for(var a in r)n[a]=r[a]}catch(c){if(e.WTF)throw c}var s=Qe.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var o=hh(s,j3,Dh.SI);for(var l in o)n[l]==null&&(n[l]=o[l])}catch(c){if(e.WTF)throw c}n.HeadingPairs&&n.TitlesOfParts&&(Cm(n.HeadingPairs,n.TitlesOfParts,n,e),delete n.HeadingPairs,delete n.TitlesOfParts)}function op(t,n){n||(n={}),Yc(n),Hh(),n.codepage&&bc(n.codepage);var e,i;if(t.FullPaths){if(Qe.find(t,"/encryption"))throw new Error("File is password-protected");e=Qe.find(t,"!CompObj"),i=Qe.find(t,"/Workbook")||Qe.find(t,"/Book")}else{switch(n.type){case"base64":t=di(jn(t));break;case"binary":t=di(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}rn(t,0),i={content:t}}var r,a;if(e&&y6(e),n.bookProps&&!n.bookSheets)r={};else{var s=Je?"buffer":"array";if(i&&i.content)r=k6(i.content,n);else if((a=Qe.find(t,"PerfectOffice_MAIN"))&&a.content)r=bs.to_workbook(a.content,(n.type=s,n));else if((a=Qe.find(t,"NativeContent_MAIN"))&&a.content)r=bs.to_workbook(a.content,(n.type=s,n));else throw(a=Qe.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&t.FullPaths&&Qe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=fE(t))}var o={};return t.FullPaths&&E6(t,o,n),r.Props=r.Custprops=o,n.bookFiles&&(r.cfb=t),r}var yl={0:{f:oT},1:{f:fT},2:{f:wT},3:{f:pT},4:{f:hT},5:{f:vT},6:{f:ST},7:{f:xT},8:{f:AT},9:{f:TT},10:{f:kT},11:{f:ET},12:{f:uT},13:{f:bT},14:{f:gT},15:{f:mT},16:{f:np},17:{f:CT},18:{f:_T},19:{f:Rc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:t6},40:{},42:{},43:{f:kk},44:{f:Ck},45:{f:Ek},46:{f:Ak},47:{f:Tk},48:{},49:{f:M3},50:{},51:{f:Kk},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Rm},62:{f:yT},63:{f:eE},64:{f:VT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:yn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dT},148:{f:lT,p:16},151:{f:FT},152:{},153:{f:ZT},154:{},155:{},156:{f:QT},157:{},158:{},159:{T:1,f:jC},160:{T:-1},161:{T:1,f:jr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:MT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Xk},336:{T:-1},337:{f:qk,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Lm},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:IT},427:{f:PT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:LT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cT},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:DT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lE},633:{T:1},634:{T:-1},635:{T:1,f:oE},636:{T:-1},637:{f:F3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:WT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:NT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},gc={6:{f:rc},10:{f:pr},12:{f:Ut},13:{f:Ut},14:{f:It},15:{f:It},16:{f:_n},17:{f:It},18:{f:It},19:{f:Ut},20:{f:xh},21:{f:xh},23:{f:Lm},24:{f:vh},25:{f:It},26:{},27:{},28:{f:aC},29:{},34:{f:It},35:{f:_h},38:{f:_n},39:{f:_n},40:{f:_n},41:{f:_n},42:{f:It},43:{f:It},47:{f:ck},49:{f:HS},51:{f:Ut},60:{},61:{f:VS},64:{f:It},65:{f:BS},66:{f:Ut},77:{},80:{},81:{},82:{},85:{f:Ut},89:{},90:{},91:{},92:{f:MS},93:{f:oC},94:{},95:{f:It},96:{},97:{},99:{f:It},125:{f:Rm},128:{f:qS},129:{f:DS},130:{f:Ut},131:{f:It},132:{f:It},133:{f:FS},134:{},140:{f:hC},141:{f:Ut},144:{},146:{f:pC},151:{},152:{},153:{},154:{},155:{},156:{f:Ut},157:{},158:{},160:{f:wC},161:{f:xC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$S},190:{f:YS},193:{f:pr},197:{},198:{},199:{},200:{},201:{},202:{f:It},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ut},220:{},221:{f:It},222:{},224:{f:KS},225:{f:AS},226:{f:pr},227:{},229:{f:sC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:IS},253:{f:US},255:{f:PS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Mm},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:It},353:{f:pr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:QS},431:{f:It},432:{},433:{},434:{},437:{},438:{f:dC},439:{f:It},440:{f:fC},441:{},442:{f:Os},443:{},444:{f:Ut},445:{},446:{},448:{f:pr},449:{f:RS,r:2},450:{f:pr},512:{f:ph},513:{f:vC},515:{f:JS},516:{f:zS},517:{f:gh},519:{f:bC},520:{f:OS},523:{},545:{f:wh},549:{f:mh},566:{},574:{f:NS},638:{f:GS},659:{},1048:{},1054:{f:WS},1084:{},1212:{f:nC},2048:{f:uC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ll},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:pr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:gC,r:12},2173:{f:$k,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:It,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:tC,r:12},2197:{},2198:{f:Hk,r:12},2199:{},2200:{},2201:{},2202:{f:iC,r:12},2203:{f:pr},2204:{},2205:{},2206:{},2207:{},2211:{f:LS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ut},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_C},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ph},1:{},2:{f:kC},3:{f:CC},4:{f:SC},5:{f:gh},7:{f:EC},8:{},9:{f:ll},11:{},22:{f:Ut},30:{f:jS},31:{},32:{},33:{f:wh},36:{},37:{f:mh},50:{f:TC},62:{},52:{},67:{},68:{f:Ut},69:{},86:{},126:{},127:{f:yC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:AC},223:{},234:{},354:{},421:{},518:{f:rc},521:{f:ll},536:{f:vh},547:{f:_h},561:{},579:{},1030:{f:rc},1033:{f:ll},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ci(t,n,e,i){var r=n;if(!isNaN(r)){var a=i||(e||[]).length||0,s=t.next(4);s.write_shift(2,r),s.write_shift(2,a),a>0&&gm(e)&&t.push(e)}}function Fh(t,n){var e=n||{};Wt!=null&&e.dense==null&&(e.dense=Wt);var i=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var r=t.match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),s=r.index,o=a&&a.index||t.length,l=J4(t.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,h=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<l.length;++s){var _=l[s].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,e.sheetRows&&e.sheetRows<=c){--c;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var E=_.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var S=E[o].trim();if(S.match(/<t[dh]/i)){for(var y=S,V=0;y.charAt(0)=="<"&&(V=y.indexOf(">"))>-1;)y=y.slice(V+1);for(var H=0;H<v.length;++H){var I=v[H];I.s.c==f&&I.s.r<c&&c<=I.e.r&&(f=I.e.c+1,H=-1)}var T=Ne(S.slice(0,S.indexOf(">")));m=T.colspan?+T.colspan:1,((h=+T.rowspan)>1||m>1)&&v.push({s:{r:c,c:f},e:{r:c+(h||1)-1,c:f+m-1}});var N=T.t||T["data-t"]||"";if(!y.length){f+=m;continue}if(y=lm(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!y.length){f+=m;continue}var W={t:"s",v:y};e.raw||!y.trim().length||N=="s"||(y==="TRUE"?W={t:"b",v:!0}:y==="FALSE"?W={t:"b",v:!1}:isNaN(hi(y))?isNaN(Ma(y).getDate())||(W={t:"d",v:Jt(y)},e.cellDates||(W={t:"n",v:Mn(W.v)}),W.z=e.dateNF||je[14]):W={t:"n",v:hi(y)}),e.dense?(i[c]||(i[c]=[]),i[c][f]=W):i[Ue({r:c,c:f})]=W,f+=m}}}}return i["!ref"]=Ze(p),v.length&&(i["!merges"]=v),i}function T6(t,n,e,i){for(var r=t["!merges"]||[],a=[],s=n.s.c;s<=n.e.c;++s){for(var o=0,l=0,c=0;c<r.length;++c)if(!(r[c].s.r>e||r[c].s.c>s)&&!(r[c].e.r<e||r[c].e.c<s)){if(r[c].s.r<e||r[c].s.c<s){o=-1;break}o=r[c].e.r-r[c].s.r+1,l=r[c].e.c-r[c].s.c+1;break}if(!(o<0)){var f=Ue({r:e,c:s}),h=i.dense?(t[e]||[])[s]:t[f],m=h&&h.v!=null&&(h.h||Tc(h.w||(Yi(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),i.editable?m='<span contenteditable="true">'+m+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),p.id=(i.id||"sjs")+"-"+f,a.push(u3("td",m,p))}}var v="<tr>";return v+a.join("")+"</tr>"}var A6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',M6="</body></html>";function D6(t,n){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return yr(Fh(e[0],n),n);var i=Kc();return e.forEach(function(r,a){qc(i,Fh(r,n),"Sheet"+(a+1))}),i}function F6(t,n,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function I6(t,n){var e=n||{},i=e.header!=null?e.header:A6,r=e.footer!=null?e.footer:M6,a=[i],s=Pa(t["!ref"]);e.dense=Array.isArray(t),a.push(F6(t,s,e));for(var o=s.s.r;o<=s.e.r;++o)a.push(T6(t,s,o,e));return a.push("</table>"+r),a.join("")}function lp(t,n,e){var i=e||{};Wt!=null&&(i.dense=Wt);var r=0,a=0;if(i.origin!=null)if(typeof i.origin=="number")r=i.origin;else{var s=typeof i.origin=="string"?An(i.origin):i.origin;r=s.r,a=s.c}var o=n.getElementsByTagName("tr"),l=Math.min(i.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r,c:a}};if(t["!ref"]){var f=Pa(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),r==-1&&(c.e.r=r=f.e.r+1)}var h=[],m=0,p=t["!rows"]||(t["!rows"]=[]),v=0,_=0,w=0,E=0,S=0,y=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&_<l;++v){var V=o[v];if(Ih(V)){if(i.display)continue;p[_]={hidden:!0}}var H=V.children;for(w=E=0;w<H.length;++w){var I=H[w];if(!(i.display&&Ih(I))){var T=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):lm(I.innerHTML),N=I.getAttribute("data-z")||I.getAttribute("z");for(m=0;m<h.length;++m){var W=h[m];W.s.c==E+a&&W.s.r<_+r&&_+r<=W.e.r&&(E=W.e.c+1-a,m=-1)}y=+I.getAttribute("colspan")||1,((S=+I.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:_+r,c:E+a},e:{r:_+r+(S||1)-1,c:E+a+(y||1)-1}});var ee={t:"s",v:T},te=I.getAttribute("data-t")||I.getAttribute("t")||"";T!=null&&(T.length==0?ee.t=te||"z":i.raw||T.trim().length==0||te=="s"||(T==="TRUE"?ee={t:"b",v:!0}:T==="FALSE"?ee={t:"b",v:!1}:isNaN(hi(T))?isNaN(Ma(T).getDate())||(ee={t:"d",v:Jt(T)},i.cellDates||(ee={t:"n",v:Mn(ee.v)}),ee.z=i.dateNF||je[14]):ee={t:"n",v:hi(T)})),ee.z===void 0&&N!=null&&(ee.z=N);var X="",me=I.getElementsByTagName("A");if(me&&me.length)for(var Ae=0;Ae<me.length&&!(me[Ae].hasAttribute("href")&&(X=me[Ae].getAttribute("href"),X.charAt(0)!="#"));++Ae);X&&X.charAt(0)!="#"&&(ee.l={Target:X}),i.dense?(t[_+r]||(t[_+r]=[]),t[_+r][E+a]=ee):t[Ue({c:E+a,r:_+r})]=ee,c.e.c<E+a&&(c.e.c=E+a),E+=y}}++_}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,_-1+r),t["!ref"]=Ze(c),_>=l&&(t["!fullref"]=Ze((c.e.r=o.length-v+_-1+r,c))),t}function cp(t,n){var e=n||{},i=e.dense?[]:{};return lp(i,t,n)}function P6(t,n){return yr(cp(t,n),n)}function Ih(t){var n="",e=O6(t);return e&&(n=e(t).getPropertyValue("display")),n||(n=t.style&&t.style.display),n==="none"}function O6(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function L6(t){var n=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,r){return Array(parseInt(r,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=tt(n.replace(/<[^>]*>/g,""));return[e]}var Ph={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dp(t,n){var e=n||{};Wt!=null&&e.dense==null&&(e.dense=Wt);var i=Ac(t),r=[],a,s,o={name:""},l="",c=0,f,h,m={},p=[],v=e.dense?[]:{},_,w,E={value:""},S="",y=0,V,H=[],I=-1,T=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,ee={},te=[],X={},me=0,Ae=0,he=[],ke=1,we=1,Ve=[],ve={Names:[]},Ie={},fe=["",""],j=[],ne={},Q="",K=0,de=!1,De=!1,be=0;for(Ts.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=Ts.exec(i);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":_[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?v["!ref"]=Ze(N):v["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=N.e.r&&(v["!fullref"]=v["!ref"],N.e.r=e.sheetRows-1,v["!ref"]=Ze(N)),te.length&&(v["!merges"]=te),he.length&&(v["!rows"]=he),f.name=f.\u540D\u79F0||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),m[f.name]=v,De=!1):_[0].charAt(_[0].length-2)!=="/"&&(f=Ne(_[0],!1),I=T=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,v=e.dense?[]:{},te=[],he=[],De=!0);break;case"table-row-group":_[1]==="/"?--W:++W;break;case"table-row":case"\u884C":if(_[1]==="/"){I+=ke,ke=1;break}if(h=Ne(_[0],!1),h.\u884C\u53F7?I=h.\u884C\u53F7-1:I==-1&&(I=0),ke=+h["number-rows-repeated"]||1,ke<10)for(be=0;be<ke;++be)W>0&&(he[I+be]={level:W});T=-1;break;case"covered-table-cell":_[1]!=="/"&&++T,e.sheetStubs&&(e.dense?(v[I]||(v[I]=[]),v[I][T]={t:"z"}):v[Ue({r:I,c:T})]={t:"z"}),S="",H=[];break;case"table-cell":case"\u6570\u636E":if(_[0].charAt(_[0].length-2)==="/")++T,E=Ne(_[0],!1),we=parseInt(E["number-columns-repeated"]||"1",10),w={t:"z",v:null},E.formula&&e.cellFormula!=!1&&(w.f=Th(tt(E.formula))),(E.\u6570\u636E\u7C7B\u578B||E["value-type"])=="string"&&(w.t="s",w.v=tt(E["string-value"]||""),e.dense?(v[I]||(v[I]=[]),v[I][T]=w):v[Ue({r:I,c:T})]=w),T+=we-1;else if(_[1]!=="/"){++T,S="",y=0,H=[],we=1;var Me=ke?I+ke-1:I;if(T>N.e.c&&(N.e.c=T),T<N.s.c&&(N.s.c=T),I<N.s.r&&(N.s.r=I),Me>N.e.r&&(N.e.r=Me),E=Ne(_[0],!1),j=[],ne={},w={t:E.\u6570\u636E\u7C7B\u578B||E["value-type"],v:null},e.cellFormula)if(E.formula&&(E.formula=tt(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(me=parseInt(E["number-matrix-rows-spanned"],10)||0,Ae=parseInt(E["number-matrix-columns-spanned"],10)||0,X={s:{r:I,c:T},e:{r:I+me-1,c:T+Ae-1}},w.F=Ze(X),Ve.push([X,w.F])),E.formula)w.f=Th(E.formula);else for(be=0;be<Ve.length;++be)I>=Ve[be][0].s.r&&I<=Ve[be][0].e.r&&T>=Ve[be][0].s.c&&T<=Ve[be][0].e.c&&(w.F=Ve[be][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(me=parseInt(E["number-rows-spanned"],10)||0,Ae=parseInt(E["number-columns-spanned"],10)||0,X={s:{r:I,c:T},e:{r:I+me-1,c:T+Ae-1}},te.push(X)),E["number-columns-repeated"]&&(we=parseInt(E["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=St(E["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(E.value);break;case"percentage":w.t="n",w.v=parseFloat(E.value);break;case"currency":w.t="n",w.v=parseFloat(E.value);break;case"date":w.t="d",w.v=Jt(E["date-value"]),e.cellDates||(w.t="n",w.v=Mn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=X4(E["time-value"])/86400,e.cellDates&&(w.t="d",w.v=Cl(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(E.\u6570\u636E\u6570\u503C);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",E["string-value"]!=null&&(S=tt(E["string-value"]),H=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(de=!1,w.t==="s"&&(w.v=S||"",H.length&&(w.R=H),de=y==0),Ie.Target&&(w.l=Ie),j.length>0&&(w.c=j,j=[]),S&&e.cellText!==!1&&(w.w=S),de&&(w.t="z",delete w.v),(!de||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=I))for(var pe=0;pe<ke;++pe){if(we=parseInt(E["number-columns-repeated"]||"1",10),e.dense)for(v[I+pe]||(v[I+pe]=[]),v[I+pe][T]=pe==0?w:an(w);--we>0;)v[I+pe][T+we]=an(w);else for(v[Ue({r:I+pe,c:T})]=w;--we>0;)v[Ue({r:I+pe,c:T+we})]=an(w);N.e.c<=T&&(N.e.c=T)}we=parseInt(E["number-columns-repeated"]||"1",10),T+=we-1,we=0,w={},S="",H=[]}Ie={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=r.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&r.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=r.pop())[0]!==_[3])throw"Bad state: "+a;ne.t=S,H.length&&(ne.R=H),ne.a=Q,j.push(ne)}else _[0].charAt(_[0].length-2)!=="/"&&r.push([_[3],!1]);Q="",K=0,S="",y=0,H=[];break;case"creator":_[1]==="/"?Q=i.slice(K,_.index):K=_.index+_[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=r.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&r.push([_[3],!1]);S="",y=0,H=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(ee[o.name]=l,(a=r.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&(l="",o=Ne(_[0],!1),r.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(r[r.length-1][0]){case"time-style":case"date-style":s=Ne(_[0],!1),l+=Ph[_[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(r[r.length-1][0]){case"time-style":case"date-style":s=Ne(_[0],!1),l+=Ph[_[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(r[r.length-1][0]){case"number-style":case"date-style":case"time-style":l+=i.slice(c,_.index);break}else c=_.index+_[0].length;break;case"named-range":s=Ne(_[0],!1),fe=ac(s["cell-range-address"]);var Xe={Name:s.name,Ref:fe[0]+"!"+fe[1]};De&&(Xe.Sheet=p.length),ve.Names.push(Xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(r[r.length-1][0])>-1)break;if(_[1]==="/"&&(!E||!E["string-value"])){var G=L6(i.slice(y,_.index),V);S=(S.length>0?S+`
`:"")+G[0]}else V=Ne(_[0],!1),y=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{fe=ac(Ne(_[0])["target-range-address"]),m[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(Ie=Ne(_[0],!1),!Ie.href)break;Ie.Target=tt(Ie.href),delete Ie.href,Ie.Target.charAt(0)=="#"&&Ie.Target.indexOf(".")>-1?(fe=ac(Ie.Target.slice(1)),Ie.Target="#"+fe[0]+"!"+fe[1]):Ie.Target.match(/^\.\.[\\\/]/)&&(Ie.Target=Ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(e.WTF)throw new Error(_)}}var _t={Sheets:m,SheetNames:p,Workbook:ve};return e.bookSheets&&delete _t.Sheets,_t}function Oh(t,n){n=n||{},ei(t,"META-INF/manifest.xml")&&J3(Ht(t,"META-INF/manifest.xml"),n);var e=Wn(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var i=dp(xt(e),n);return ei(t,"meta.xml")&&(i.Props=Sm(Ht(t,"meta.xml"))),i}function Lh(t,n){return dp(t,n)}function Gc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function xc(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):xt(zr(t))}function _c(t){var n=t.reduce(function(r,a){return r+a.length},0),e=new Uint8Array(n),i=0;return t.forEach(function(r){e.set(r,i),i+=r.length}),e}function Rh(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function R6(t,n){for(var e=(t[n+15]&127)<<7|t[n+14]>>1,i=t[n+14]&1,r=n+13;r>=n;--r)i=i*256+t[r];return(t[n+15]&128?-i:i)*Math.pow(10,e-6176)}function Fs(t,n){var e=n?n[0]:0,i=t[e]&127;e:if(t[e++]>=128&&(i|=(t[e]&127)<<7,t[e++]<128||(i|=(t[e]&127)<<14,t[e++]<128)||(i|=(t[e]&127)<<21,t[e++]<128)||(i+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(i+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(i+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return n&&(n[0]=e),i}function $t(t){var n=0,e=t[n]&127;e:if(t[n++]>=128){if(e|=(t[n]&127)<<7,t[n++]<128||(e|=(t[n]&127)<<14,t[n++]<128)||(e|=(t[n]&127)<<21,t[n++]<128))break e;e|=(t[n]&127)<<28}return e}function vn(t){for(var n=[],e=[0];e[0]<t.length;){var i=e[0],r=Fs(t,e),a=r&7;r=Math.floor(r/8);var s=0,o;if(r==0)break;switch(a){case 0:{for(var l=e[0];t[e[0]++]>=128;);o=t.slice(l,e[0])}break;case 5:s=4,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Fs(t,e),o=t.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(r," at offset ").concat(i))}var c={data:o,type:a};n[r]==null?n[r]=[c]:n[r].push(c)}return n}function $c(t,n){return t?.map(function(e){return n(e.data)})||[]}function V6(t){for(var n,e=[],i=[0];i[0]<t.length;){var r=Fs(t,i),a=vn(t.slice(i[0],i[0]+r));i[0]+=r;var s={id:$t(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=vn(o.data),c=$t(l[3][0].data);s.messages.push({meta:l,data:t.slice(i[0],i[0]+c)}),i[0]+=c}),(n=a[3])!=null&&n[0]&&(s.merge=$t(a[3][0].data)>>>0>0),e.push(s)}return e}function N6(t,n){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],i=Fs(n,e),r=[];e[0]<n.length;){var a=n[e[0]]&3;if(a==0){var s=n[e[0]++]>>2;if(s<60)++s;else{var o=s-59;s=n[e[0]],o>1&&(s|=n[e[0]+1]<<8),o>2&&(s|=n[e[0]+2]<<16),o>3&&(s|=n[e[0]+3]<<24),s>>>=0,s++,e[0]+=o}r.push(n.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var l=0,c=0;if(a==1?(c=(n[e[0]]>>2&7)+4,l=(n[e[0]++]&224)<<3,l|=n[e[0]++]):(c=(n[e[0]++]>>2)+1,a==2?(l=n[e[0]]|n[e[0]+1]<<8,e[0]+=2):(l=(n[e[0]]|n[e[0]+1]<<8|n[e[0]+2]<<16|n[e[0]+3]<<24)>>>0,e[0]+=4)),r=[_c(r)],l==0)throw new Error("Invalid offset 0");if(l>r[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(r.push(r[0].slice(-l)),c-=l;c>=r[r.length-1].length;)r.push(r[r.length-1]),c-=r[r.length-1].length;r.push(r[0].slice(-l,-l+c))}}var f=_c(r);if(f.length!=i)throw new Error("Unexpected length: ".concat(f.length," != ").concat(i));return f}function B6(t){for(var n=[],e=0;e<t.length;){var i=t[e++],r=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,n.push(N6(i,t.slice(e,e+r))),e+=r}if(e!==t.length)throw new Error("data is not a valid framed stream!");return _c(n)}function H6(t,n,e,i){var r=Gc(t),a=r.getUint32(4,!0),s=(i>1?12:8)+Rh(a&(i>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);a&512&&(o=r.getUint32(s,!0),s+=4),s+=Rh(a&(i>1?12288:4096))*4,a&16&&(l=r.getUint32(s,!0),s+=4),a&32&&(c=r.getFloat64(s,!0),s+=8),a&64&&(f.setTime(f.getTime()+r.getFloat64(s,!0)*1e3),s+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:n[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:e[o]};else if(l>-1)h={t:"s",v:n[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function U6(t,n,e){var i=Gc(t),r=i.getUint32(8,!0),a=12,s=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);r&1&&(l=R6(t,a),a+=16),r&2&&(c=i.getFloat64(a,!0),a+=8),r&4&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8),r&8&&(o=i.getUint32(a,!0),a+=4),r&16&&(s=i.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:n[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(s>-1)h={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(r&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(r&31," : ").concat(t.slice(0,4)))}return h}function z6(t,n,e){switch(t[0]){case 0:case 1:case 2:case 3:return H6(t,n,e,t[0]);case 5:return U6(t,n,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function vr(t){var n=vn(t);return Fs(n[1][0].data)}function Vh(t,n){var e=vn(n.data),i=$t(e[1][0].data),r=e[3],a=[];return(r||[]).forEach(function(s){var o=vn(s.data),l=$t(o[1][0].data)>>>0;switch(i){case 1:a[l]=xc(o[3][0].data);break;case 8:{var c=t[vr(o[9][0].data)][0],f=vn(c.data),h=t[vr(f[1][0].data)][0],m=$t(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=vn(h.data);a[l]=p[3].map(function(v){return xc(v.data)}).join("")}break}}),a}function W6(t,n){var e,i,r,a,s,o,l,c,f,h,m,p,v,_,w=vn(t),E=$t(w[1][0].data)>>>0,S=$t(w[2][0].data)>>>0,y=((i=(e=w[8])==null?void 0:e[0])==null?void 0:i.data)&&$t(w[8][0].data)>0||!1,V,H;if((a=(r=w[7])==null?void 0:r[0])!=null&&a.data&&n!=0)V=(o=(s=w[7])==null?void 0:s[0])==null?void 0:o.data,H=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(f=w[4])==null?void 0:f[0])!=null&&h.data&&n!=1)V=(p=(m=w[4])==null?void 0:m[0])==null?void 0:p.data,H=(_=(v=w[3])==null?void 0:v[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var I=y?4:1,T=Gc(V),N=[],W=0;W<V.length/2;++W){var ee=T.getUint16(W*2,!0);ee<65535&&N.push([W,ee])}if(N.length!=S)throw"Expected ".concat(S," cells, found ").concat(N.length);var te=[];for(W=0;W<N.length-1;++W)te[N[W][0]]=H.subarray(N[W][1]*I,N[W+1][1]*I);return N.length>=1&&(te[N[N.length-1][0]]=H.subarray(N[N.length-1][1]*I)),{R:E,cells:te}}function j6(t,n){var e,i=vn(n.data),r=(e=i?.[7])!=null&&e[0]?$t(i[7][0].data)>>>0>0?1:0:-1,a=$c(i[5],function(s){return W6(s,r)});return{nrows:$t(i[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function G6(t,n,e){var i,r=vn(n.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=($t(r[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(a.e.c=($t(r[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));e["!ref"]=Ze(a);var s=vn(r[4][0].data),o=Vh(t,t[vr(s[4][0].data)][0]),l=(i=s[17])!=null&&i[0]?Vh(t,t[vr(s[17][0].data)][0]):[],c=vn(s[3][0].data),f=0;c[1].forEach(function(h){var m=vn(h.data),p=t[vr(m[2][0].data)][0],v=$t(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var _=j6(t,p);_.data.forEach(function(w,E){w.forEach(function(S,y){var V=Ue({r:f+E,c:y}),H=z6(S,o,l);H&&(e[V]=H)})}),f+=_.nrows})}function $6(t,n){var e=vn(n.data),i={"!ref":"A1"},r=t[vr(e[2][0].data)],a=$t(r[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return G6(t,r[0],i),i}function Y6(t,n){var e,i=vn(n.data),r={name:(e=i[1])!=null&&e[0]?xc(i[1][0].data):"",sheets:[]},a=$c(i[2],vr);return a.forEach(function(s){t[s].forEach(function(o){var l=$t(o.meta[1][0].data);l==6e3&&r.sheets.push($6(t,o))})}),r}function X6(t,n){var e=Kc(),i=vn(n.data),r=$c(i[1],vr);if(r.forEach(function(a){t[a].forEach(function(s){var o=$t(s.meta[1][0].data);if(o==2){var l=Y6(t,s);l.sheets.forEach(function(c,f){qc(e,c,f==0?l.name:l.name+"_"+f,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function oc(t){var n,e,i,r,a={},s=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=B6(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=V6(c)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){a[h.id]=h.messages,s.push(h.id)})}}),!s.length)throw new Error("File has no messages");var o=((r=(i=(e=(n=a?.[1])==null?void 0:n[0])==null?void 0:e.meta)==null?void 0:i[1])==null?void 0:r[0].data)&&$t(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(l){a[l].forEach(function(c){var f=$t(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return X6(a,o)}function K6(t){return function(e){for(var i=0;i!=t.length;++i){var r=t[i];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function Yc(t){K6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function q6(t){return Wi.WS.indexOf(t)>-1?"sheet":Wi.CS&&t==Wi.CS?"chart":Wi.DS&&t==Wi.DS?"dialog":Wi.MS&&t==Wi.MS?"macro":t&&t.length?t:"sheet"}function J6(t,n){if(!t)return 0;try{t=n.map(function(i){return i.id||(i.id=i.strRelID),[i.name,t["!id"][i.id].Target,q6(t["!id"][i.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Q6(t,n,e,i,r,a,s,o,l,c,f,h){try{a[i]=vs(Wn(t,e,!0),n);var m=Ht(t,n),p;switch(o){case"sheet":p=r6(m,n,r,l,a[i],c,f,h);break;case"chart":if(p=a6(m,n,r,l,a[i],c,f,h),!p||!p["!drawel"])break;var v=ms(p["!drawel"].Target,n),_=uc(v),w=iE(Wn(t,v,!0),vs(Wn(t,_,!0),v)),E=ms(w,v),S=uc(E);p=UT(Wn(t,E,!0),E,l,vs(Wn(t,S,!0),E),c,p);break;case"macro":p=s6(m,n,r,l,a[i],c,f,h);break;case"dialog":p=o6(m,n,r,l,a[i],c,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}s[i]=p;var y=[];a&&a[i]&&Mi(a[i]).forEach(function(V){var H="";if(a[i][V].Type==Wi.CMNT){H=ms(a[i][V].Target,n);var I=f6(Ht(t,H,!0),H,l);if(!I||!I.length)return;yh(p,I,!1)}a[i][V].Type==Wi.TCMNT&&(H=ms(a[i][V].Target,n),y=y.concat(aE(Ht(t,H,!0),l)))}),y&&y.length&&yh(p,y,!0,l.people||[])}catch(V){if(l.WTF)throw V}}function Qn(t){return t.charAt(0)=="/"?t.slice(1):t}function Z6(t,n){if(Qh(),n=n||{},Yc(n),ei(t,"META-INF/manifest.xml")||ei(t,"objectdata.xml"))return Oh(t,n);if(ei(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof oc<"u"){if(t.FileIndex)return oc(t);var e=Qe.utils.cfb_new();return Ku(t).forEach(function(Ae){Z4(e,Ae,rm(t,Ae))}),oc(e)}throw new Error("Unsupported NUMBERS file")}if(!ei(t,"[Content_Types].xml"))throw ei(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ei(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=Ku(t),r=K3(Wn(t,"[Content_Types].xml")),a=!1,s,o;if(r.workbooks.length===0&&(o="xl/workbook.xml",Ht(t,o,!0)&&r.workbooks.push(o)),r.workbooks.length===0){if(o="xl/workbook.bin",!Ht(t,o,!0))throw new Error("Could not find workbook");r.workbooks.push(o),a=!0}r.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!n.bookSheets&&!n.bookProps){if(ys=[],r.sst)try{ys=d6(Ht(t,Qn(r.sst)),r.sst,n)}catch(Ae){if(n.WTF)throw Ae}n.cellStyles&&r.themes.length&&(l=c6(Wn(t,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],n)),r.style&&(c=l6(Ht(t,Qn(r.style)),r.style,l,n))}r.links.map(function(Ae){try{var he=vs(Wn(t,uc(Qn(Ae))),Ae);return h6(Ht(t,Qn(Ae)),he,Ae,n)}catch{}});var f=i6(Ht(t,Qn(r.workbooks[0])),r.workbooks[0],n),h={},m="";r.coreprops.length&&(m=Ht(t,Qn(r.coreprops[0]),!0),m&&(h=Sm(m)),r.extprops.length!==0&&(m=Ht(t,Qn(r.extprops[0]),!0),m&&eS(m,h,n)));var p={};(!n.bookSheets||n.bookProps)&&r.custprops.length!==0&&(m=Wn(t,Qn(r.custprops[0]),!0),m&&(p=nS(m,n)));var v={};if((n.bookSheets||n.bookProps)&&(f.Sheets?s=f.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(s=h.SheetNames),n.bookProps&&(v.Props=h,v.Custprops=p),n.bookSheets&&typeof s<"u"&&(v.SheetNames=s),n.bookSheets?v.SheetNames:n.bookProps))return v;s={};var _={};n.bookDeps&&r.calcchain&&(_=u6(Ht(t,Qn(r.calcchain)),r.calcchain,n));var w=0,E={},S,y;{var V=f.Sheets;h.Worksheets=V.length,h.SheetNames=[];for(var H=0;H!=V.length;++H)h.SheetNames[H]=V[H].name}var I=a?"bin":"xml",T=r.workbooks[0].lastIndexOf("/"),N=(r.workbooks[0].slice(0,T+1)+"_rels/"+r.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");ei(t,N)||(N="xl/_rels/workbook."+I+".rels");var W=vs(Wn(t,N,!0),N.replace(/_rels.*/,"s5s"));(r.metadata||[]).length>=1&&(n.xlmeta=m6(Ht(t,Qn(r.metadata[0])),r.metadata[0],n)),(r.people||[]).length>=1&&(n.people=sE(Ht(t,Qn(r.people[0])),n)),W&&(W=J6(W,f.Sheets));var ee=Ht(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var te="sheet";if(W&&W[w]?(S="xl/"+W[w][1].replace(/[\/]?xl\//,""),ei(t,S)||(S=W[w][1]),ei(t,S)||(S=N.replace(/_rels\/.*$/,"")+W[w][1]),te=W[w][2]):(S="xl/worksheets/sheet"+(w+1-ee)+"."+I,S=S.replace(/sheet0\./,"sheet.")),y=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(w!=n.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var X=!1,me=0;me!=n.sheets.length;++me)typeof n.sheets[me]=="number"&&n.sheets[me]==w&&(X=1),typeof n.sheets[me]=="string"&&n.sheets[me].toLowerCase()==h.SheetNames[w].toLowerCase()&&(X=1);if(!X)continue e}}Q6(t,S,y,h.SheetNames[w],w,E,s,te,n,f,l,c)}return v={Directory:r,Workbook:f,Props:h,Custprops:p,Deps:_,Sheets:s,SheetNames:h.SheetNames,Strings:ys,Styles:c,Themes:l,SSF:an(je)},n&&n.bookFiles&&(t.files?(v.keys=i,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(Ae,he){Ae=Ae.replace(/^Root Entry[\/]/,""),v.keys.push(Ae),v.files[Ae]=t.FileIndex[he]}))),n&&n.bookVBA&&(r.vba.length>0?v.vbaraw=Ht(t,Qn(r.vba[0]),!0):r.defaults&&r.defaults.bin===dE&&(v.vbaraw=Ht(t,"xl/vbaProject.bin",!0))),v}function eA(t,n){var e=n||{},i="Workbook",r=Qe.find(t,i);try{if(i="/!DataSpaces/Version",r=Qe.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);if($C(r.content),i="/!DataSpaces/DataSpaceMap",r=Qe.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var a=XC(r.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",r=Qe.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var s=KC(r.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",r=Qe.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);JC(r.content)}catch{}if(i="/EncryptionInfo",r=Qe.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=QC(r.content);if(i="/EncryptedPackage",r=Qe.find(t,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],r.content,e.password||"",e);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],r.content,e.password||"",e);throw new Error("File is password-protected")}function Xc(t,n){var e="";switch((n||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=jn(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function tA(t,n){return Qe.find(t,"EncryptedPackage")?eA(t,n):op(t,n)}function nA(t,n){var e,i=t,r=n||{};return r.type||(r.type=Je&&Buffer.isBuffer(t)?"buffer":"base64"),e=am(i,r),Z6(e,r)}function fp(t,n){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return pc(t.slice(e),n);default:break e}return As.to_workbook(t,n)}function iA(t,n){var e="",i=Xc(t,n);switch(n.type){case"base64":e=jn(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Br(t);break;default:throw new Error("Unrecognized type "+n.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(e=xt(e)),n.type="binary",fp(e,n)}function rA(t,n){var e=t;return n.type=="base64"&&(e=jn(e)),e=ct.utils.decode(1200,e.slice(2),"str"),n.type="binary",fp(e,n)}function aA(t){return t.match(/[^\x00-\x7F]/)?ps(t):t}function lc(t,n,e,i){return i?(e.type="string",As.to_workbook(t,e)):As.to_workbook(n,e)}function Sl(t,n){Hh();var e=n||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Sl(new Uint8Array(t),(e=an(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var i=t,r=[0,0,0,0],a=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Ta={},e.dateNF&&(Ta.dateNF=e.dateNF),e.type||(e.type=Je&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=Je?"buffer":"binary",i=$4(t),typeof Uint8Array<"u"&&!Je&&(e.type="array")),e.type=="string"&&(a=!0,e.type="binary",e.codepage=65001,i=aA(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return e=an(e),e.type="array",Sl(yc(i),e)}switch((r=Xc(i,e))[0]){case 208:if(r[1]===207&&r[2]===17&&r[3]===224&&r[4]===161&&r[5]===177&&r[6]===26&&r[7]===225)return tA(Qe.read(i,e),e);break;case 9:if(r[1]<=8)return op(i,e);break;case 60:return pc(i,e);case 73:if(r[1]===73&&r[2]===42&&r[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(r[1]===68)return PC(i,e);break;case 84:if(r[1]===65&&r[2]===66&&r[3]===76)return FC.to_workbook(i,e);break;case 80:return r[1]===75&&r[2]<9&&r[3]<9?nA(i,e):lc(t,i,e,a);case 239:return r[3]===60?pc(i,e):lc(t,i,e,a);case 255:if(r[1]===254)return rA(i,e);if(r[1]===0&&r[2]===2&&r[3]===0)return bs.to_workbook(i,e);break;case 0:if(r[1]===0&&(r[2]>=2&&r[3]===0||r[2]===0&&(r[3]===8||r[3]===9)))return bs.to_workbook(i,e);break;case 3:case 131:case 139:case 140:return bh.to_workbook(i,e);case 123:if(r[1]===92&&r[2]===114&&r[3]===116)return dk.to_workbook(i,e);break;case 10:case 13:case 32:return iA(i,e);case 137:if(r[1]===80&&r[2]===78&&r[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return MC.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?bh.to_workbook(i,e):lc(t,i,e,a)}function sA(t,n,e,i,r,a,s,o){var l=sn(e),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:e,enumerable:!1})}catch{m.__rowNum__=e}else m.__rowNum__=e;if(!s||t[e])for(var p=n.s.c;p<=n.e.c;++p){var v=s?t[e][p]:t[i[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;a[p]!=null&&(m[a[p]]=c);continue}var _=v.v;switch(v.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[p]!=null){if(_==null)if(v.t=="e"&&_===null)m[a[p]]=null;else if(c!==void 0)m[a[p]]=c;else if(f&&_===null)m[a[p]]=null;else continue;else m[a[p]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?_:Yi(v,_,o);_!=null&&(h=!1)}}return{row:m,isempty:h}}function vc(t,n){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},i=0,r=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=n||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)?i=3:c.header==null&&(i=0),typeof f){case"string":l=Mt(f);break;case"number":l=Mt(t["!ref"]),l.s.r=f;break;default:l=f}i>0&&(r=0);var h=sn(l.s.r),m=[],p=[],v=0,_=0,w=Array.isArray(t),E=l.s.r,S=0,y={};w&&!t[E]&&(t[E]=[]);var V=c.skipHidden&&t["!cols"]||[],H=c.skipHidden&&t["!rows"]||[];for(S=l.s.c;S<=l.e.c;++S)if(!(V[S]||{}).hidden)switch(m[S]=Gt(S),e=w?t[E][S]:t[m[S]+h],i){case 1:a[S]=S-l.s.c;break;case 2:a[S]=m[S];break;case 3:a[S]=c.header[S-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=s=Yi(e,null,c),_=y[s]||0,!_)y[s]=1;else{do o=s+"_"+_++;while(y[o]);y[s]=_,y[o]=1}a[S]=o}for(E=l.s.r+r;E<=l.e.r;++E)if(!(H[E]||{}).hidden){var I=sA(t,l,E,m,i,a,w,c);(I.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=I.row)}return p.length=v,p}var Nh=/"/g;function oA(t,n,e,i,r,a,s,o){for(var l=!0,c=[],f="",h=sn(e),m=n.s.c;m<=n.e.c;++m)if(i[m]){var p=o.dense?(t[e]||[])[m]:t[i[m]+h];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:Yi(p,null,o));for(var v=0,_=0;v!==f.length;++v)if((_=f.charCodeAt(v))===r||_===a||_===34||o.forceQuotes){f='"'+f.replace(Nh,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Nh,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(s)}function up(t,n){var e=[],i=n??{};if(t==null||t["!ref"]==null)return"";var r=Mt(t["!ref"]),a=i.FS!==void 0?i.FS:",",s=a.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),f="",h=[];i.dense=Array.isArray(t);for(var m=i.skipHidden&&t["!cols"]||[],p=i.skipHidden&&t["!rows"]||[],v=r.s.c;v<=r.e.c;++v)(m[v]||{}).hidden||(h[v]=Gt(v));for(var _=0,w=r.s.r;w<=r.e.r;++w)(p[w]||{}).hidden||(f=oA(t,r,w,h,s,l,a,i),f!=null&&(i.strip&&(f=f.replace(c,"")),(f||i.blankrows!==!1)&&e.push((_++?o:"")+f)));return delete i.dense,e.join("")}function lA(t,n){n||(n={}),n.FS="	",n.RS=`
`;var e=up(t,n);if(typeof ct>"u"||n.type=="string")return e;var i=ct.utils.encode(1200,e,"str");return"\xFF\xFE"+i}function cA(t){var n="",e,i="";if(t==null||t["!ref"]==null)return[];var r=Mt(t["!ref"]),a="",s=[],o,l=[],c=Array.isArray(t);for(o=r.s.c;o<=r.e.c;++o)s[o]=Gt(o);for(var f=r.s.r;f<=r.e.r;++f)for(a=sn(f),o=r.s.c;o<=r.e.c;++o)if(n=s[o]+a,e=c?(t[f]||[])[o]:t[n],i="",e!==void 0){if(e.F!=null){if(n=e.F,!e.f)continue;i=e.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}l[l.length]=n+"="+i}return l}function hp(t,n,e){var i=e||{},r=+!i.skipHeader,a=t||{},s=0,o=0;if(a&&i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var l=typeof i.origin=="string"?An(i.origin):i.origin;s=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:s+n.length-1+r}};if(a["!ref"]){var h=Mt(a["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),s==-1&&(s=h.e.r+1,f.e.r=s+n.length-1+r)}else s==-1&&(s=0,f.e.r=n.length-1+r);var m=i.header||[],p=0;n.forEach(function(_,w){Mi(_).forEach(function(E){(p=m.indexOf(E))==-1&&(m[p=m.length]=E);var S=_[E],y="z",V="",H=Ue({c:o+p,r:s+w+r});c=Is(a,H),S&&typeof S=="object"&&!(S instanceof Date)?a[H]=S:(typeof S=="number"?y="n":typeof S=="boolean"?y="b":typeof S=="string"?y="s":S instanceof Date?(y="d",i.cellDates||(y="n",S=Mn(S)),V=i.dateNF||je[14]):S===null&&i.nullError&&(y="e",S=0),c?(c.t=y,c.v=S,delete c.w,delete c.R,V&&(c.z=V)):a[H]=c={t:y,v:S},V&&(c.z=V))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var v=sn(s);if(r)for(p=0;p<m.length;++p)a[Gt(p+o)+v]={t:"s",v:m[p]};return a["!ref"]=Ze(f),a}function dA(t,n){return hp(null,t,n)}function Is(t,n,e){if(typeof n=="string"){if(Array.isArray(t)){var i=An(n);return t[i.r]||(t[i.r]=[]),t[i.r][i.c]||(t[i.r][i.c]={t:"z"})}return t[n]||(t[n]={t:"z"})}return typeof n!="number"?Is(t,Ue(n)):Is(t,Ue({r:n,c:e||0}))}function fA(t,n){if(typeof n=="number"){if(n>=0&&t.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var e=t.SheetNames.indexOf(n);if(e>-1)return e;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Kc(){return{SheetNames:[],Sheets:{}}}function qc(t,n,e,i){var r=1;if(!e)for(;r<=65535&&t.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&t.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var s=a&&a[1]||e;for(++r;r<=65535&&t.SheetNames.indexOf(e=s+r)!=-1;++r);}if(KT(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=n,e}function uA(t,n,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var i=fA(t,n);switch(t.Workbook.Sheets[i]||(t.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[i].Hidden=e}function hA(t,n){return t.z=n,t}function mp(t,n,e){return n?(t.l={Target:n},e&&(t.l.Tooltip=e)):delete t.l,t}function mA(t,n,e){return mp(t,"#"+n,e)}function pA(t,n,e){t.c||(t.c=[]),t.c.push({t:n,a:e||"SheetJS"})}function gA(t,n,e,i){for(var r=typeof n!="string"?n:Mt(n),a=typeof n=="string"?n:Ze(n),s=r.s.r;s<=r.e.r;++s)for(var o=r.s.c;o<=r.e.c;++o){var l=Is(t,s,o);l.t="n",l.F=a,delete l.v,s==r.s.r&&o==r.s.c&&(l.f=e,i&&(l.D=!0))}return t}var pp={encode_col:Gt,encode_row:sn,encode_cell:Ue,encode_range:Ze,decode_col:Lc,decode_row:Oc,split_cell:A3,decode_cell:An,decode_range:Pa,format_cell:Yi,sheet_add_aoa:_m,sheet_add_json:hp,sheet_add_dom:lp,aoa_to_sheet:Oa,json_to_sheet:dA,table_to_sheet:cp,table_to_book:P6,sheet_to_csv:up,sheet_to_txt:lA,sheet_to_json:vc,sheet_to_html:I6,sheet_to_formulae:cA,sheet_to_row_object_array:vc,sheet_get_cell:Is,book_new:Kc,book_append_sheet:qc,book_set_sheet_visibility:uA,cell_set_number_format:hA,cell_set_hyperlink:mp,cell_set_internal_link:mA,cell_add_comment:pA,sheet_set_array_formula:gA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var HM=Bh.version;var _A=()=>[1,2,3,4];function vA(t,n){if(t&1){let e=ue();d(0,"div",16)(1,"div",3)(2,"div",17),B(),d(3,"svg",18),D(4,"path",19),u(),q(),d(5,"span",20),g(6),u()(),d(7,"button",21),Y("click",function(){U(e);let r=b();return z(r.clearError())}),B(),d(8,"svg",22),D(9,"path",23),u()()()()}if(t&2){let e=b();x(6),oe(e.errorMessage)}}function wA(t,n){t&1&&(d(0,"span"),B(),d(1,"svg",22),D(2,"path",28),u()())}function bA(t,n){if(t&1&&(d(0,"span"),g(1),u()),t&2){let e=b().$implicit;x(),oe(e)}}function yA(t,n){if(t&1&&D(0,"div",29),t&2){let e=b().$implicit,i=b();Ot(i.currentStep>e?"bg-green-500":"bg-gray-200")}}function SA(t,n){if(t&1&&(d(0,"div",17)(1,"div",24)(2,"div",25),J(3,wA,3,0,"span",15)(4,bA,2,1,"span",15),u(),d(5,"span",26),g(6),u()(),J(7,yA,1,2,"div",27),u()),t&2){let e=n.$implicit,i=n.index,r=b();x(2),Ot(r.currentStep>e?"bg-green-500 text-white":r.currentStep===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"),x(),C("ngIf",r.currentStep>e),x(),C("ngIf",r.currentStep<=e),x(),Ot(r.currentStep>=e?"text-blue-600":"text-gray-500"),x(),xe(" ",e===1?"Upload":e===2?"Preview":e===3?"Map Fields":"Import"," "),x(),C("ngIf",i<3)}}function CA(t,n){if(t&1){let e=ue();d(0,"div",30)(1,"div",2)(2,"div",31),B(),d(3,"svg",32),D(4,"path",33),u()(),q(),d(5,"h2",34),g(6,"Upload Asset File"),u(),d(7,"p",35),g(8,"Upload a spreadsheet file (CSV, Excel, etc.) with your asset data to get started."),u()(),d(9,"div",36)(10,"div",30),B(),d(11,"svg",37),D(12,"path",33),u(),q(),d(13,"p",38),g(14,"Choose Spreadsheet File"),u(),d(15,"p",39),g(16,"or drag and drop your file here"),u(),d(17,"button",40),Y("click",function(){U(e);let r=zs(20);return z(r.click())}),g(18," Browse Files "),u(),d(19,"input",41,0),Y("change",function(r){U(e);let a=b();return z(a.parseFile(r))}),u()()(),d(21,"div",42)(22,"h3",43),B(),d(23,"svg",44),D(24,"path",45),u(),g(25," Supported Formats "),u(),q(),d(26,"div",46)(27,"div")(28,"h4",47),g(29,"Standard Asset List"),u(),d(30,"p",48),g(31,"Includes: Asset Name, Description, Category, Type, Serial Number, Model, Manufacturer, Purchase Date, Purchase Price, Depreciation, Location, Department, Warranty, Insurance, Health Score, Status"),u(),d(32,"ul",49)(33,"li",17),B(),d(34,"svg",50),D(35,"path",28),u(),g(36," Spreadsheet formats (.csv, .xlsx, .xls, .ods) "),u(),q(),d(37,"li",17),B(),d(38,"svg",50),D(39,"path",28),u(),g(40," Asset Name is required "),u()()()()(),q(),d(41,"div",51)(42,"a",52),B(),d(43,"svg",7),D(44,"path",53),u(),g(45," Download Standard Template "),u(),q(),d(46,"a",54),B(),d(47,"svg",7),D(48,"path",53),u(),g(49," Download EY Master Template "),u()()()}}function kA(t,n){if(t&1&&(d(0,"div",69)(1,"div",70),B(),d(2,"svg",71),D(3,"path",57),u(),q(),d(4,"h3",72),g(5,"Format Detected"),u()(),d(6,"p",73),g(7),u(),d(8,"p",74),g(9),u()()),t&2){let e=b(2);x(7),oe(e.formatName),x(2),xe(" ",e.detectedFormat==="STANDARD"?"Standard asset list format with comprehensive fields including financial and operational data.":e.detectedFormat==="EY_MASTER"?"EY Master asset list format with location hierarchy and technical specifications. Data will be imported starting from row 2 (skipping the header row).":"Unknown format - manual field mapping may be required."," ")}}function EA(t,n){if(t&1){let e=ue();d(0,"div",30)(1,"div",2)(2,"div",55),B(),d(3,"svg",56),D(4,"path",57),u()(),q(),d(5,"h2",34),g(6,"File Uploaded Successfully"),u(),d(7,"p",35),g(8,"Detected format: "),d(9,"span",58),g(10),u()()(),J(11,kA,10,2,"div",59),d(12,"div",60)(13,"div",61)(14,"div",30)(15,"div",62),g(16),u(),d(17,"div",63),g(18,"File Name"),u()(),d(19,"div",30)(20,"div",62),g(21),u(),d(22,"div",63),g(23,"File Size"),u()(),d(24,"div",30)(25,"div",62),g(26),u(),d(27,"div",63),g(28,"Data Rows"),u()(),d(29,"div",30)(30,"div",62),g(31),u(),d(32,"div",63),g(33,"Columns"),u()()()(),d(34,"div",64)(35,"button",65),Y("click",function(){U(e);let r=b();return z(r.back())}),g(36," Back "),u(),d(37,"button",66),Y("click",function(){U(e);let r=b();return z(r.makeMapped())}),g(38," Continue to Mapping "),B(),d(39,"svg",67),D(40,"path",68),u()()()()}if(t&2){let e=b();x(10),oe(e.formatName),x(),C("ngIf",e.detectedFormat!=="UNKNOWN"),x(5),oe((e.uploadedData==null?null:e.uploadedData.name)||"N/A"),x(5),xe("",e.getFileSizeInKB(e.uploadedData==null?null:e.uploadedData.size)," KB"),x(5),oe((e.parsedData==null||e.parsedData.rows==null?null:e.parsedData.rows.length)||0),x(5),oe((e.parsedData==null||e.parsedData.headers==null?null:e.parsedData.headers.length)||0)}}function TA(t,n){if(t&1&&(d(0,"div",86)(1,"div",3)(2,"span",87),g(3),u(),d(4,"span",88),g(5),u()()()),t&2){let e=b(2);x(3),xe("Detected ",e.parsedData.headers.length," columns in your file"),x(2),xe("",e.importFields.length," available for mapping")}}function AA(t,n){t&1&&(d(0,"span",103),g(1,"*"),u())}function MA(t,n){t&1&&(d(0,"span",104),g(1,"(Required)"),u())}function DA(t,n){t&1&&(d(0,"span",105),g(1,"Not Mapped"),u())}function FA(t,n){if(t&1&&(d(0,"span",106),g(1),u()),t&2){let e=b().$implicit,i=b(2);x(),xe(" ",i.getSelectedFieldName(e)," ")}}function IA(t,n){if(t&1){let e=ue();d(0,"button",110),Y("click",function(){let r=U(e).$implicit,a=b(2).$implicit;return a.map=r.map,z(a.showDropdown=!1)}),d(1,"div",93)(2,"div",112),B(),d(3,"svg",113),D(4,"path",114),u()(),q(),d(5,"div")(6,"div",90),g(7),u(),d(8,"div",63),g(9),u()()()()}if(t&2){let e=n.$implicit,i=b(2).$implicit;ge("bg-blue-50",i.map===e.map)("text-blue-700",i.map===e.map),x(7),oe(e.field),x(2),xe("Column ",e.map,"")}}function PA(t,n){if(t&1){let e=ue();d(0,"div",107)(1,"div",108)(2,"div",109),g(3,"Select field to map"),u(),d(4,"button",110),Y("click",function(){U(e);let r=b().$implicit;return r.map="-1",z(r.showDropdown=!1)}),g(5," -- Not Mapped -- "),u(),J(6,IA,10,6,"button",111),u()()}if(t&2){let e=b().$implicit,i=b(2);x(4),ge("bg-blue-50",e.map==="-1"),x(2),C("ngForOf",i.importFields)("ngForTrackBy",i.trackByImportField)}}function OA(t,n){t&1&&(d(0,"div",115),B(),d(1,"svg",116),D(2,"path",28),u()())}function LA(t,n){t&1&&(d(0,"div",117),B(),d(1,"svg",118),D(2,"path",23),u()())}function RA(t,n){if(t&1){let e=ue();d(0,"div",89)(1,"div",3)(2,"div",17)(3,"span",90),g(4),u(),J(5,AA,2,0,"span",91)(6,MA,2,0,"span",92),u(),d(7,"div",93)(8,"div",94),Y("click",function(r){return U(e),z(r.stopPropagation())}),d(9,"button",95),Y("click",function(){let r=U(e).$implicit,a=b(2);return z(a.toggleFieldDropdown(r))}),d(10,"div",3),J(11,DA,2,0,"span",96)(12,FA,2,1,"span",97),B(),d(13,"svg",98),D(14,"path",99),u()()(),J(15,PA,7,4,"div",100),u(),J(16,OA,3,0,"div",101)(17,LA,3,0,"div",102),u()()()}if(t&2){let e=n.$implicit,i=b(2);yt("display",i.detectedFormat==="EY_MASTER"&&(e.name==="type"||e.name==="sm_type")?"none":"block"),x(4),oe(e.title),x(),C("ngIf",e.required),x(),C("ngIf",e.required),x(3),ge("border-blue-500",e.showDropdown),x(2),C("ngIf",e.map==="-1"),x(),C("ngIf",e.map!=="-1"),x(),ge("rotate-180",e.showDropdown),x(2),C("ngIf",e.showDropdown),x(),C("ngIf",e.map!=="-1"),x(),C("ngIf",e.map==="-1")}}function VA(t,n){t&1&&(B(),d(0,"svg",119),D(1,"circle",120)(2,"path",121),u())}function NA(t,n){if(t&1){let e=ue();d(0,"div")(1,"div",75)(2,"div",31),B(),d(3,"svg",32),D(4,"path",76),u()(),q(),d(5,"h2",34),g(6,"Map Your Fields"),u(),d(7,"p",35),g(8,"Match your CSV columns to the system fields"),u()(),J(9,TA,6,2,"div",77),d(10,"div",78)(11,"div",79)(12,"h3",80),g(13,"Field Mapping"),u(),d(14,"p",81),g(15,"Select which column from your file maps to each system field"),u()(),d(16,"div",82),J(17,RA,18,14,"div",83),u()(),d(18,"div",64)(19,"button",65),Y("click",function(){U(e);let r=b();return z(r.previousStep())}),g(20," Back "),u(),d(21,"button",84),Y("click",function(){U(e);let r=b();return z(r.import())}),J(22,VA,3,0,"svg",85),g(23),u()()()}if(t&2){let e=b();x(9),C("ngIf",(e.parsedData==null||e.parsedData.headers==null?null:e.parsedData.headers.length)>0),x(8),C("ngForOf",e.assetFields)("ngForTrackBy",e.trackByField),x(4),C("disabled",e.importLoading),x(),C("ngIf",e.importLoading),x(),xe(" ",e.importLoading?"Importing...":"Import Assets"," ")}}function BA(t,n){if(t&1&&(d(0,"div",138)(1,"div",139),g(2),u(),d(3,"div",128),g(4),u()()),t&2){let e=n.$implicit;x(2),oe(e.name),x(2),xe("ID: ",e.asset_id,"")}}function HA(t,n){if(t&1&&(d(0,"div",133)(1,"div",134)(2,"h3",135),B(),d(3,"svg",44),D(4,"path",28),u(),g(5),u(),q(),d(6,"div",136),J(7,BA,5,2,"div",137),u()()()),t&2){let e=b(3);x(5),xe(" Successfully Imported (",e.importResults.imported.length,") "),x(2),C("ngForOf",e.importResults.imported)}}function UA(t,n){if(t&1&&(d(0,"div",144)(1,"div",145)(2,"div",146),g(3),u(),d(4,"span",147),g(5),u()(),d(6,"div",148),g(7),u()()),t&2){let e=n.$implicit;x(3),oe(e.name),x(2),xe("Row ",e.index,""),x(2),xe(" ",e.error," ")}}function zA(t,n){if(t&1&&(d(0,"div",133)(1,"div",140)(2,"h3",141),B(),d(3,"svg",44),D(4,"path",19),u(),g(5),u(),q(),d(6,"div",142),J(7,UA,8,3,"div",143),u()()()),t&2){let e=b(3);x(5),xe(" Failed Imports (",e.importResults.failed.length,") "),x(2),C("ngForOf",e.importResults.failed)}}function WA(t,n){if(t&1&&(d(0,"div",2)(1,"div",124)(2,"div",125)(3,"div",62),g(4),u(),d(5,"div",63),g(6,"Total Processed"),u()(),d(7,"div",126)(8,"div",127),g(9),u(),d(10,"div",128),g(11,"Successfully Imported"),u()(),d(12,"div",129)(13,"div",130),g(14),u(),d(15,"div",131),g(16,"Failed"),u()()(),J(17,HA,8,2,"div",132)(18,zA,8,2,"div",132),u()),t&2){let e=b(2);x(4),oe(e.importResults.total_processed),x(5),oe(e.importResults.imported_count),x(5),oe(e.importResults.failed_count),x(3),C("ngIf",e.importResults.imported&&e.importResults.imported.length>0),x(),C("ngIf",e.importResults.failed&&e.importResults.failed.length>0)}}function jA(t,n){if(t&1){let e=ue();d(0,"div",30)(1,"div",2)(2,"div",55),B(),d(3,"svg",56),D(4,"path",57),u()(),q(),d(5,"h2",34),g(6,"Import Results"),u(),d(7,"p",35),g(8,"Import process completed. Review the results below."),u()(),J(9,WA,19,5,"div",122),d(10,"div",64)(11,"button",65),Y("click",function(){U(e);let r=b();return z(r.reset())}),g(12," Import More Assets "),u(),d(13,"button",123),Y("click",function(){U(e);let r=b();return z(r.closeModal())}),g(14," View Assets "),u()()()}if(t&2){let e=b();x(9),C("ngIf",e.importResults)}}var La=class t{constructor(n,e){this.assetService=n;this.router=e}importComplete=new In;currentStep=1;totalSteps=4;uploadedData=null;parsedData=null;uploaded=!1;importFields=[];initMapFields=!1;importLoading=!1;isImportComplete=!1;importedCount=0;importResults=null;showResults=!1;errorMessage="";showError=!1;detectedFormat="UNKNOWN";formatName="";assetFields=[{name:"name",title:"Asset Name",map:"-1",required:!0,showDropdown:!1},{name:"asset_id",title:"Asset ID",map:"-1",required:!1,showDropdown:!1},{name:"description",title:"Description",map:"-1",required:!1,showDropdown:!1},{name:"category",title:"Category",map:"-1",required:!1,showDropdown:!1},{name:"type",title:"Asset Type",map:"-1",required:!1,showDropdown:!1},{name:"serial_number",title:"Serial Number",map:"-1",required:!1,showDropdown:!1},{name:"model",title:"Model",map:"-1",required:!1,showDropdown:!1},{name:"manufacturer",title:"Manufacturer",map:"-1",required:!1,showDropdown:!1},{name:"purchase_date",title:"Purchase Date",map:"-1",required:!1,showDropdown:!1},{name:"purchase_price",title:"Purchase Price",map:"-1",required:!1,showDropdown:!1},{name:"depreciation",title:"Depreciation",map:"-1",required:!1,showDropdown:!1},{name:"location",title:"Location",map:"-1",required:!1,showDropdown:!1},{name:"department",title:"Department",map:"-1",required:!1,showDropdown:!1},{name:"warranty",title:"Warranty",map:"-1",required:!1,showDropdown:!1},{name:"insurance",title:"Insurance",map:"-1",required:!1,showDropdown:!1},{name:"health_score",title:"Health Score",map:"-1",required:!1,showDropdown:!1},{name:"status",title:"Status",map:"-1",required:!1,showDropdown:!1},{name:"sm_type",title:"S/M Type",map:"-1",required:!1,showDropdown:!1},{name:"building",title:"Building",map:"-1",required:!1,showDropdown:!1},{name:"floor",title:"Floor",map:"-1",required:!1,showDropdown:!1},{name:"brand",title:"Brand/Make",map:"-1",required:!1,showDropdown:!1},{name:"capacity",title:"Capacity/Rating",map:"-1",required:!1,showDropdown:!1},{name:"depreciation_life",title:"Depreciation Life (Years)",map:"-1",required:!1,showDropdown:!1}];formatPatterns={STANDARD:["Asset Name","Description","Category","Type","Serial Number","Model","Manufacturer","Purchase Date","Purchase Price","Depreciation","Location","Department","Warranty","Insurance","Health Score","Status"],EY_MASTER:["Asset ID Number","S/M Type","Building","Location","Floor","Asset Description","Brand/Make","Model No","Capacity/Rating"]};detectFormat(n){let e=this.formatPatterns.STANDARD.filter(r=>n.some(a=>this.normalize(a)===this.normalize(r))).length,i=this.formatPatterns.EY_MASTER.filter(r=>n.some(a=>this.normalize(a)===this.normalize(r))).length;return e>=10?(this.formatName="Standard Asset List","STANDARD"):i>=7?(this.formatName="EY Master Asset List (Starting from Row 2)","EY_MASTER"):(this.formatName="Unknown Format","UNKNOWN")}autoMapFields(n){this.assetFields.forEach(e=>{let i=-1;if(this.detectedFormat==="EY_MASTER")switch(e.name){case"asset_id":i=n.findIndex(r=>this.normalize(r).includes("assetidnumber")||this.normalize(r).includes("assetid")||this.normalize(r).includes("idnumber"));break;case"name":i=n.findIndex(r=>this.normalize(r).includes("assetname")||this.normalize(r).includes("name")),i===-1&&(i=n.findIndex(r=>this.normalize(r).includes("assetidnumber")||this.normalize(r).includes("assetid")||this.normalize(r).includes("idnumber")));break;case"description":i=n.findIndex(r=>this.normalize(r).includes("assetdescription")||this.normalize(r).includes("description"));break;case"manufacturer":i=n.findIndex(r=>this.normalize(r).includes("brandmake")||this.normalize(r).includes("brand")||this.normalize(r).includes("make"));break;case"model":i=n.findIndex(r=>this.normalize(r).includes("modelno")||this.normalize(r).includes("model"));break;case"capacity":i=n.findIndex(r=>this.normalize(r).includes("capacityrating")||this.normalize(r).includes("capacity")||this.normalize(r).includes("rating"));break;case"sm_type":i=n.findIndex(r=>this.normalize(r).includes("smtype")||this.normalize(r).includes("type"));break;case"category":i=n.findIndex(r=>this.normalize(r).includes("smtype")||this.normalize(r).includes("type"));break;case"building":i=n.findIndex(r=>this.normalize(r).includes("building"));break;case"floor":i=n.findIndex(r=>this.normalize(r).includes("floor"));break;case"location":i=n.findIndex(r=>this.normalize(r).includes("location"));break;default:i=n.findIndex(r=>this.normalize(r)===this.normalize(e.title))}else i=n.findIndex(r=>this.normalize(r)===this.normalize(e.title));e.map=i>=0?i.toString():"-1"})}parseFile(n){let e=n.target.files[0];if(this.uploadedData=e,this.clearError(),!e){this.errorMessage="No file selected",this.showError=!0;return}let i=e.name.split(".").pop()?.toLowerCase();if(!i||!["csv","xlsx","xls","ods"].includes(i)){this.errorMessage="Please upload a valid spreadsheet file (.csv, .xlsx, .xls, .ods).",this.showError=!0;return}i==="csv"?this.parseCSVFile(e):this.parseExcelFile(e)}parseCSVFile(n){let e=new FileReader;e.readAsText(n),e.onload=()=>{try{let i=e.result;if(i.length>1e3&&i.includes("\0")){this.errorMessage="Invalid file format. Please ensure you are uploading a valid CSV file.",this.showError=!0;return}let r=i.split(/\r?\n/).filter(a=>a.trim()!=="");if(r.length<2){this.errorMessage="File must contain at least a header row and one data row.",this.showError=!0;return}this.processParsedData(r)}catch(i){this.errorMessage="Error parsing CSV file: "+i.message,this.showError=!0}},e.onerror=()=>{this.errorMessage="Error reading CSV file.",this.showError=!0}}parseExcelFile(n){let e=new FileReader;e.readAsArrayBuffer(n),e.onload=()=>{try{let i=new Uint8Array(e.result),r=Sl(i,{type:"array"}),a=r.SheetNames[0],s=r.Sheets[a],o=pp.sheet_to_json(s,{header:1});if(o.length<2){this.errorMessage="File must contain at least a header row and one data row.",this.showError=!0;return}let l=o.map(c=>Array.isArray(c)?c.map(f=>f||"").join(","):"").filter(c=>c.trim()!=="");this.processParsedData(l)}catch(i){this.errorMessage="Error parsing Excel file: "+i.message,this.showError=!0}},e.onerror=()=>{this.errorMessage="Error reading Excel file.",this.showError=!0}}processParsedData(n){let e,i,r;if(n.length>=2){let c=this.parseCSVLine(n[0]).join(" ").toLowerCase();c.includes("ey_master")||c.includes("asset list")?(e=n[1],i=this.parseCSVLine(e),r=2,this.detectedFormat="EY_MASTER"):(e=n[0],i=this.parseCSVLine(e),r=1,this.detectedFormat=this.detectFormat(i))}else e=n[0],i=this.parseCSVLine(e),r=1,this.detectedFormat=this.detectFormat(i);if(i.length===0){this.errorMessage="No valid headers found in the file.",this.showError=!0;return}this.autoMapFields(i);let a=this.detectedFormat==="EY_MASTER"?3:2;if(n.length<a){this.errorMessage=this.detectedFormat==="EY_MASTER"?"EY Master format requires at least a title row, header row, and one data row.":"File must contain at least a header row and one data row.",this.showError=!0;return}let o=n.slice(r).map(l=>this.parseCSVLine(l)).filter(l=>l.length>0&&l.some(c=>c.trim()!==""));this.parsedData={headers:i,rows:o},this.uploaded=!0,this.nextStep()}parseCSVLine(n){let e=[],i="",r=!1;for(let a=0;a<n.length;a++){let s=n[a];s==='"'?r&&n[a+1]==='"'?(i+='"',a++):r=!r:s===","&&!r?(e.push(i.trim()),i=""):i+=s}return e.push(i.trim()),e}normalize(n){return n.toLowerCase().replace(/[^a-z0-9]/gi,"").trim()}getFileSizeInKB(n=0){return Math.round(n/1024)}nextStep(){this.currentStep<this.totalSteps&&(this.clearError(),this.currentStep++)}previousStep(){this.currentStep>1&&(this.clearError(),this.currentStep--)}back(){this.clearError(),this.uploaded=!1,this.parsedData=null,this.uploadedData=null,this.currentStep=1}makeMapped(){this.clearError(),this.importFields=[];let n=this.parsedData.headers;if(this.initMapFields=!0,this.assetFields.forEach(e=>{e.map="-1",e.showDropdown=!1}),this.assetFields.forEach((e,i)=>{let r=-1;if(this.detectedFormat==="EY_MASTER")switch(e.name){case"asset_id":r=n.findIndex(a=>this.normalize(a).includes("assetidnumber")||this.normalize(a).includes("assetid")||this.normalize(a).includes("idnumber"));break;case"name":r=n.findIndex(a=>this.normalize(a).includes("assetname")||this.normalize(a).includes("name")),r===-1&&(r=n.findIndex(a=>this.normalize(a).includes("assetidnumber")||this.normalize(a).includes("assetid")||this.normalize(a).includes("idnumber")));break;case"description":r=n.findIndex(a=>this.normalize(a).includes("assetdescription")||this.normalize(a).includes("description"));break;case"manufacturer":r=n.findIndex(a=>this.normalize(a).includes("brandmake")||this.normalize(a).includes("brand")||this.normalize(a).includes("make"));break;case"model":r=n.findIndex(a=>this.normalize(a).includes("modelno")||this.normalize(a).includes("model"));break;case"capacity":r=n.findIndex(a=>this.normalize(a).includes("capacityrating")||this.normalize(a).includes("capacity")||this.normalize(a).includes("rating"));break;case"sm_type":r=n.findIndex(a=>this.normalize(a).includes("smtype")||this.normalize(a).includes("type"));break;case"category":r=n.findIndex(a=>this.normalize(a).includes("smtype")||this.normalize(a).includes("type"));break;case"building":r=n.findIndex(a=>this.normalize(a).includes("building"));break;case"floor":r=n.findIndex(a=>this.normalize(a).includes("floor"));break;case"location":r=n.findIndex(a=>this.normalize(a).includes("location"));break;default:r=n.findIndex(a=>this.normalize(e.title)===this.normalize(a))}else r=n.findIndex(a=>this.normalize(e.title)===this.normalize(a));r>=0&&(this.assetFields[i].map=r.toString())}),n.forEach((e,i)=>{let r=e.trim();r&&r.length>0&&this.importFields.push({field:r,map:i.toString()})}),this.importFields.length===0){this.errorMessage="No valid fields found in the uploaded file. Please check your CSV format.",this.showError=!0;return}this.nextStep()}formatErrorMessage(n){if(n.error&&n.error.data&&n.error.data.errors){let e=n.error.data.errors;return`Validation errors:
${Object.keys(e).map(r=>`${r}: ${e[r].join(", ")}`).join(`
`)}`}else return n.error&&n.error.message?n.error.message:n.error&&n.error.error?n.error.error:n.message?n.message:"Import failed. Please check your data and try again."}import(){this.clearError(),this.importLoading=!0;let n=[],i=this.assetFields.filter(a=>a.required).filter(a=>a.map==="-1");if(i.length>0){this.importLoading=!1,this.errorMessage=`Please map the following required fields: ${i.map(a=>a.title).join(", ")}`,this.showError=!0;return}let r=["Active","Inactive","Maintenance","Retired","active","inactive","maintenance","retired"];if(this.parsedData.rows.forEach((a,s)=>{if(!a||a.length===0||a.every(f=>!f||f.trim()===""))return;let o={},l=!0,c="";if(this.assetFields.forEach(f=>{if(f.map!=="-1"&&a[parseInt(f.map)]!==void 0){let h=a[parseInt(f.map)].trim();if(console.log(`Processing field ${f.name} (${f.title}): "${h}" from column ${f.map}`),f.required&&(!h||h==="")&&(l=!1),f.name==="status"&&h&&(r.includes(h)||(c=`Invalid status value "${h}" in row ${s+1}. Valid values are: ${r.join(", ")}`)),this.detectedFormat==="EY_MASTER")switch(f.name){case"asset_id":o.asset_id=h;break;case"name":o.name=h;break;case"description":o.description=h;break;case"manufacturer":o.manufacturer=h;break;case"model":o.model=h;break;case"capacity":o.capacity=h;break;case"category":o.category=h;break;case"sm_type":o.sm_type=h;break;case"building":case"floor":case"location":o[f.name]=h;break;default:o[f.name]=h}else o[f.name]=h}}),c){this.importLoading=!1,this.errorMessage=c,this.showError=!0;return}l&&o.name&&n.push(o)}),n.length===0){this.importLoading=!1,this.errorMessage="No valid assets found to import. Please check your data and field mappings.",this.showError=!0;return}console.log("Importing assets:",n),console.log("Asset fields mapping:",this.assetFields.map(a=>({name:a.name,title:a.title,map:a.map}))),console.log("Parsed data headers:",this.parsedData.headers),Qc(300).subscribe({complete:()=>{this.assetService.bulkImportAssets({assets:n}).subscribe({next:a=>{console.log("Import response:",a),a.success?(this.importResults=a.data,this.importedCount=a.data.imported_count||0,this.isImportComplete=!0,this.showResults=!0,this.nextStep()):(this.errorMessage=a.message||"Import failed",this.showError=!0),this.importLoading=!1},error:a=>{console.error("Import error:",a),this.errorMessage=this.formatErrorMessage(a),this.showError=!0,this.importLoading=!1}})}})}clearError(){this.errorMessage="",this.showError=!1}reset(){this.currentStep=1,this.uploaded=!1,this.initMapFields=!1,this.importLoading=!1,this.isImportComplete=!1,this.importedCount=0,this.parsedData=null,this.uploadedData=null,this.importFields=[],this.assetFields.forEach(n=>{n.map="-1",n.showDropdown=!1}),this.importResults=null,this.showResults=!1,this.clearError()}closeModal(){this.importComplete.emit(),this.reset(),this.router.navigate(["/assets/list"])}trackByField(n,e){return e.name}trackByImportField(n,e){return e.map}toggleFieldDropdown(n){this.assetFields.forEach(e=>{e!==n&&(e.showDropdown=!1)}),n.showDropdown=!n.showDropdown}getSelectedFieldName(n){if(n.map==="-1")return"Not Mapped";let e=this.importFields.find(i=>i.map===n.map);return e?e.field:"Unknown Field"}closeAllDropdowns(){this.assetFields.forEach(n=>{n.showDropdown=!1})}static \u0275fac=function(e){return new(e||t)(ft(Kn),ft(_i))};static \u0275cmp=Yt({type:t,selectors:[["app-smart-import"]],outputs:{importComplete:"importComplete"},decls:22,vars:7,consts:[["fileInput",""],[1,"min-h-screen","bg-gray-50","p-6",3,"click"],[1,"mb-8"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-gray-900","mb-1"],[1,"text-gray-600","text-base"],["routerLink","/assets/list",1,"bg-gray-100","hover:bg-gray-200","text-gray-700","font-semibold","px-4","py-2","rounded-lg","transition-colors","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],["class","mb-6 bg-red-50 border border-red-200 rounded-xl p-4",4,"ngIf"],[1,"max-w-4xl","mx-auto"],[1,"flex","items-center","justify-center","space-x-4"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-200","p-8"],["class","text-center",4,"ngIf"],[4,"ngIf"],[1,"mb-6","bg-red-50","border","border-red-200","rounded-xl","p-4"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-500","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-700","font-medium"],[1,"text-red-500","hover:text-red-700","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","flex-col","items-center"],[1,"w-12","h-12","rounded-full","flex","items-center","justify-center","text-sm","font-semibold","transition-all","duration-300"],[1,"mt-2","text-xs","font-medium"],["class","w-16 h-0.5 mx-4 transition-all duration-300",3,"class",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"w-16","h-0.5","mx-4","transition-all","duration-300"],[1,"text-center"],[1,"w-20","h-20","bg-blue-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"border-2","border-dashed","border-blue-300","rounded-xl","p-8","mb-6","hover:border-blue-400","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-blue-400","mx-auto","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4"],["type","button",1,"bg-blue-600","hover:bg-blue-700","text-white","font-semibold","px-6","py-3","rounded-lg","transition-colors",3,"click"],["type","file","accept",".csv,.CSV,.xlsx,.xls,.ods",1,"hidden",3,"change"],[1,"bg-blue-50","border","border-blue-200","rounded-xl","p-6","mb-6"],[1,"text-lg","font-semibold","text-blue-900","mb-4","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm"],[1,"font-medium","text-blue-900","mb-2"],[1,"text-blue-800","mb-3"],[1,"space-y-1","text-blue-800"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2","text-blue-600"],[1,"flex","flex-col","sm:flex-row","gap-4","justify-center"],["href","/assets/templates/asset-import-template.csv","download","standard-asset-import-template.csv",1,"inline-flex","items-center","text-blue-600","hover:text-blue-700","font-medium","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["href","/assets/templates/ey-master-asset-template.csv","download","ey-master-asset-template.csv",1,"inline-flex","items-center","text-blue-600","hover:text-blue-700","font-medium","transition-colors"],[1,"w-20","h-20","bg-green-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"font-semibold","text-blue-600"],["class","bg-green-50 border border-green-200 rounded-xl p-6 mb-6",4,"ngIf"],[1,"bg-gray-50","border","border-gray-200","rounded-xl","p-6","mb-8"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"flex","justify-center","space-x-4"],[1,"bg-gray-100","hover:bg-gray-200","text-gray-700","font-semibold","px-6","py-3","rounded-lg","transition-colors",3,"click"],[1,"bg-blue-600","hover:bg-blue-700","text-white","font-semibold","px-6","py-3","rounded-lg","transition-colors","flex","items-center",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","ml-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"bg-green-50","border","border-green-200","rounded-xl","p-6","mb-6"],[1,"flex","items-center","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-600","mr-3"],[1,"text-lg","font-semibold","text-green-900"],[1,"text-green-800"],[1,"text-sm","text-green-700","mt-2"],[1,"mb-8","text-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["class","bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",4,"ngIf"],[1,"bg-white","border","border-gray-200","rounded-xl","overflow-hidden","mb-8"],[1,"bg-gray-50","px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600","mt-1"],[1,"divide-y","divide-gray-200"],["class","px-6 py-4",3,"display",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-blue-600","hover:bg-blue-700","disabled:bg-blue-400","text-white","font-semibold","px-6","py-3","rounded-lg","transition-colors","flex","items-center",3,"click","disabled"],["class","animate-spin -ml-1 mr-3 h-4 w-4 text-white","fill","none","viewBox","0 0 24 24",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-xl","p-4","mb-6"],[1,"text-sm","font-medium","text-blue-900"],[1,"text-xs","text-blue-600","bg-blue-100","px-2","py-1","rounded-full"],[1,"px-6","py-4"],[1,"font-medium","text-gray-900"],["class","ml-2 text-red-500 text-sm font-medium",4,"ngIf"],["class","ml-1 text-xs text-gray-500",4,"ngIf"],[1,"flex","items-center","space-x-3"],[1,"relative","min-w-[200px]",3,"click"],["type","button",1,"w-full","px-4","py-3","text-left","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","bg-white","transition-all",3,"click"],["class","text-gray-400",4,"ngIf"],["class","text-gray-900",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",4,"ngIf"],["class","w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",4,"ngIf"],["class","w-6 h-6 bg-red-100 rounded-full flex items-center justify-center",4,"ngIf"],[1,"ml-2","text-red-500","text-sm","font-medium"],[1,"ml-1","text-xs","text-gray-500"],[1,"text-gray-400"],[1,"text-gray-900"],[1,"absolute","z-50","w-full","mt-1","bg-white","border","border-gray-200","rounded-lg","shadow-lg","max-h-60","overflow-auto"],[1,"py-1"],[1,"px-3","py-2","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","bg-gray-50"],["type","button",1,"w-full","px-3","py-3","text-left","hover:bg-blue-50","focus:bg-blue-50","focus:outline-none","transition-colors",3,"click"],["type","button","class","w-full px-3 py-3 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors",3,"bg-blue-50","text-blue-700","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"w-8","h-8","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"w-6","h-6","bg-green-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-600"],[1,"w-6","h-6","bg-red-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-red-600"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["class","mb-8",4,"ngIf"],[1,"bg-blue-600","hover:bg-blue-700","text-white","font-semibold","px-6","py-3","rounded-lg","transition-colors",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-6"],[1,"bg-gray-50","border","border-gray-200","rounded-xl","p-6","text-center"],[1,"bg-green-50","border","border-green-200","rounded-xl","p-6","text-center"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-sm","text-green-600"],[1,"bg-red-50","border","border-red-200","rounded-xl","p-6","text-center"],[1,"text-2xl","font-bold","text-red-600"],[1,"text-sm","text-red-600"],["class","mb-6",4,"ngIf"],[1,"mb-6"],[1,"bg-green-50","border","border-green-200","rounded-xl","p-6"],[1,"text-lg","font-semibold","text-green-900","mb-4","flex","items-center"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3"],["class","bg-white border border-green-200 rounded-lg p-3",4,"ngFor","ngForOf"],[1,"bg-white","border","border-green-200","rounded-lg","p-3"],[1,"font-medium","text-green-900"],[1,"bg-red-50","border","border-red-200","rounded-xl","p-6"],[1,"text-lg","font-semibold","text-red-900","mb-4","flex","items-center"],[1,"space-y-3"],["class","bg-white border border-red-200 rounded-lg p-4",4,"ngFor","ngForOf"],[1,"bg-white","border","border-red-200","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-medium","text-red-900"],[1,"text-xs","bg-red-100","text-red-600","px-2","py-1","rounded-full"],[1,"text-sm","text-red-700","bg-red-50","border-l-4","border-red-400","pl-3","py-2"]],template:function(e,i){e&1&&(d(0,"div",1),Y("click",function(){return i.closeAllDropdowns()}),d(1,"div",2)(2,"div",3)(3,"div")(4,"h1",4),g(5,"Smart Asset Import"),u(),d(6,"p",5),g(7,"Import multiple assets efficiently with our guided wizard"),u()(),d(8,"button",6),B(),d(9,"svg",7),D(10,"path",8),u(),g(11," Back to Assets "),u()()(),J(12,vA,10,1,"div",9),q(),d(13,"div",10)(14,"div",2)(15,"div",11),J(16,SA,8,8,"div",12),u()(),d(17,"div",13),J(18,CA,50,0,"div",14)(19,EA,41,6,"div",14)(20,NA,24,6,"div",15)(21,jA,15,1,"div",14),u()()()),e&2&&(x(12),C("ngIf",i.showError),x(4),C("ngForOf",Zr(6,_A)),x(2),C("ngIf",i.currentStep===1),x(),C("ngIf",i.currentStep===2),x(),C("ngIf",i.currentStep===3),x(),C("ngIf",i.currentStep===4))},dependencies:[ln,Yn,Xt,fn],encapsulation:2})};var GA=[{path:"list",component:ia},{path:"create",component:xo},{path:"import",component:La},{path:"preview/:id",component:ba},{path:":id/edit",component:ya}],Ml=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=Hs({type:t});static \u0275inj=Bs({imports:[Oi.forChild(GA),Oi]})};var gp=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=Hs({type:t});static \u0275inj=Bs({imports:[ln,Ml,ia,ba,ya,sa,La,ud]})};export{gp as AssetsModule};
