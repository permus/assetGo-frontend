import"./chunk-GGQ7LRWG.js";import{a as Qe}from"./chunk-E2VV4REU.js";import{a as F}from"./chunk-4WAJ5FSM.js";import{c as Ue,d as X,f as R,g as ee}from"./chunk-C5P3YSZX.js";import{A as J,B as Ke,C as Y,c as j,d as _,e as D,f as $,i as qe,j as z,o as q,r as W,s as We,t as Je,u as Ye,x as Ze}from"./chunk-E3TUIQ6F.js";import{a as ce}from"./chunk-47ABMRM7.js";import{a as Ge,b as He,c as M,d as $e,e as ze,g as Q}from"./chunk-6DC6CTDU.js";import"./chunk-GSMNBVZZ.js";import{E as Ie,F as pe,a as Ne,j as Re,k as me,l as I,q as Be,x as S}from"./chunk-SXJTW2OO.js";import{G as Le,Gb as i,Hb as n,Ib as c,J as Fe,Mb as A,Pb as u,Qb as m,S as je,U as ae,Ua as P,Wa as De,X as G,Xa as a,Y as se,aa as N,ab as b,bc as s,cc as f,dc as v,ec as L,f as oe,fc as de,g as Pe,gc as Se,hc as Ee,ia as x,ic as Ae,ja as h,jb as C,ka as y,kb as le,la as E,ob as p,qc as Oe,rc as Ve,sa as H,wb as l,yb as w,zb as U}from"./chunk-XGV57TRJ.js";import{a as we,b as Ce}from"./chunk-EQDQRRRY.js";var O=class o{constructor(t){this.http=t;this.loadAdminFromStorage()}apiUrl=ce.apiUrl;currentAdminSubject=new Pe(null);currentAdmin$=this.currentAdminSubject.asObservable();loadAdminFromStorage(){let t=localStorage.getItem("admin");if(t)try{let e=JSON.parse(t);this.currentAdminSubject.next(e)}catch{localStorage.removeItem("admin"),localStorage.removeItem("admin_token")}}getAuthHeaders(){return{headers:{Authorization:`Bearer ${this.getToken()}`,"Content-Type":"application/json"}}}login(t){return this.http.post(`${this.apiUrl}/admin/login`,t,{headers:{"Content-Type":"application/json"}}).pipe(ae(e=>{e.success&&e.data?.token&&this.setSession(e.data.token,e.data.admin)}))}logout(){return this.http.post(`${this.apiUrl}/admin/logout`,{},this.getAuthHeaders()).pipe(ae(()=>{this.clearSession()}))}getProfile(){return this.http.get(`${this.apiUrl}/admin/profile`,this.getAuthHeaders()).pipe(ae(t=>{t.success&&t.data&&(this.currentAdminSubject.next(t.data),localStorage.setItem("admin",JSON.stringify(t.data)))}))}setSession(t,e){localStorage.setItem("admin_token",t),localStorage.setItem("admin",JSON.stringify(e)),this.currentAdminSubject.next(e)}clearSession(){localStorage.removeItem("admin_token"),localStorage.removeItem("admin"),this.currentAdminSubject.next(null)}getToken(){return localStorage.getItem("admin_token")}isAuthenticated(){return!!this.getToken()}getCurrentAdmin(){return this.currentAdminSubject.value}static \u0275fac=function(e){return new(e||o)(N(pe))};static \u0275prov=G({token:o,factory:o.\u0275fac,providedIn:"root"})};function tt(o,t){if(o&1&&(i(0,"div",23)(1,"p",24),s(2),n()()),o&2){let e=m();a(2),f(e.errorMessage)}}function it(o,t){o&1&&(y(),i(0,"svg",25),c(1,"path",26)(2,"path",27),n())}function nt(o,t){o&1&&(y(),i(0,"svg",25),c(1,"path",28),n())}function rt(o,t){o&1&&(i(0,"span"),s(1,"Sign In"),n())}function ot(o,t){o&1&&(i(0,"span",29),y(),i(1,"svg",30),c(2,"circle",31)(3,"path",32),n(),s(4," Signing In... "),n())}var ue=class o{constructor(t,e,r){this.fb=t;this.router=e;this.adminAuthService=r;this.loginForm=this.fb.group({email:["",[_.required,_.email]],password:["",[_.required,_.minLength(6)]]})}loginForm;isLoading=!1;errorMessage="";showPassword=!1;onSubmit(){this.loginForm.valid&&!this.isLoading&&(this.isLoading=!0,this.errorMessage="",this.adminAuthService.login(this.loginForm.value).subscribe({next:t=>{t.success?this.router.navigate(["/admin/dashboard"]):this.errorMessage=t.message||"Login failed",this.isLoading=!1},error:t=>{let e=t.error;this.errorMessage=e?.message||"An error occurred during login",this.isLoading=!1}}))}togglePasswordVisibility(){this.showPassword=!this.showPassword}ngOnDestroy(){}static \u0275fac=function(e){return new(e||o)(b(J),b(M),b(O))};static \u0275cmp=C({type:o,selectors:[["app-admin-login"]],decls:32,vars:13,consts:[[1,"min-h-screen","bg-gray-50","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"text-center"],[1,"flex","justify-center","mb-6"],[1,"flex","items-center","space-x-3"],["alt","AssetGo Logo",1,"h-20","w-auto",3,"src"],[1,"text-gray-600"],[1,"bg-white","rounded-2xl","shadow-lg","p-8","max-w-md","mx-auto"],[1,"text-center","mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],["class","mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"space-y-6"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","email","type","email","formControlName","email","placeholder","Enter your email","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","placeholder-gray-400"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["id","password","formControlName","password","placeholder","Enter your password","required","",1,"w-full","px-4","py-3","pr-10","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","placeholder-gray-400",3,"type"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","cursor-pointer","text-gray-400","hover:text-gray-600",3,"click"],["class","h-5 w-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["type","submit",1,"w-full","bg-blue-600","text-white","py-3","px-4","rounded-lg","font-medium","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],[4,"ngIf"],["class","flex items-center justify-center",4,"ngIf"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-600","text-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"],[1,"flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,r){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),c(5,"img",5),n()(),i(6,"p",6),s(7,"Admin Panel"),n()(),i(8,"div",7)(9,"div",8)(10,"h2",9),s(11,"Admin Login"),n(),i(12,"p",6),s(13,"Sign in to access the admin panel"),n()(),p(14,tt,3,1,"div",10),i(15,"form",11),u("ngSubmit",function(){return r.onSubmit()}),i(16,"div",12)(17,"div")(18,"label",13),s(19,"Email"),n(),c(20,"input",14),n(),i(21,"div")(22,"label",15),s(23,"Password"),n(),i(24,"div",16),c(25,"input",17),i(26,"button",18),u("click",function(){return r.togglePasswordVisibility()}),p(27,it,3,0,"svg",19)(28,nt,2,0,"svg",19),n()()(),i(29,"button",20),p(30,rt,2,0,"span",21)(31,ot,5,0,"span",22),n()()()()()()),e&2){let d,g;a(5),l("src","images/logo.png",P),a(9),l("ngIf",r.errorMessage),a(),l("formGroup",r.loginForm),a(5),w("border-red-300",((d=r.loginForm.get("email"))==null?null:d.invalid)&&((d=r.loginForm.get("email"))==null?null:d.touched)),a(5),w("border-red-300",((g=r.loginForm.get("password"))==null?null:g.invalid)&&((g=r.loginForm.get("password"))==null?null:g.touched)),l("type",r.showPassword?"text":"password"),a(2),l("ngIf",!r.showPassword),a(),l("ngIf",r.showPassword),a(),l("disabled",r.loginForm.invalid||r.isLoading),a(),l("ngIf",!r.isLoading),a(),l("ngIf",r.isLoading)}},dependencies:[I,Y,z,j,D,$,Ze,q,W],encapsulation:2})};function at(o,t){if(o&1){let e=A();i(0,"div",39)(1,"div",40)(2,"div",41)(3,"div",42)(4,"span"),s(5),n()(),i(6,"div")(7,"div",43),s(8),n(),i(9,"div",44),s(10),n()()()(),i(11,"div",45)(12,"button",46),u("click",function(){x(e);let d=m();return h(d.signOut())}),i(13,"div",47),y(),i(14,"svg",48),c(15,"path",49),n()(),E(),i(16,"div")(17,"div",33),s(18,"Sign Out"),n(),i(19,"div",50),s(20,"Sign out of admin panel"),n()()()()()}if(o&2){let e=m();a(5),f(e.getAdminInitials()),a(3),f(e.currentAdmin==null?null:e.currentAdmin.name),a(2),f(e.currentAdmin==null?null:e.currentAdmin.email)}}var ge=class o{constructor(t,e){this.router=t;this.adminAuthService=e}currentAdmin=null;showUserDropdown=!1;sidebarOpen=!0;destroy$=new oe;ngOnInit(){this.adminAuthService.currentAdmin$.pipe(je(this.destroy$)).subscribe(t=>{this.currentAdmin=t})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getAdminInitials(){return this.currentAdmin?this.currentAdmin.name.charAt(0).toUpperCase():"A"}toggleUserDropdown(){this.showUserDropdown=!this.showUserDropdown}signOut(){this.adminAuthService.logout().subscribe({next:()=>{this.router.navigate(["/admin/login"])},error:()=>{this.router.navigate(["/admin/login"])}})}toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}onDocumentClick(t){t.target.closest(".relative")||(this.showUserDropdown=!1)}isRtl(){return document.documentElement.dir==="rtl"}static \u0275fac=function(e){return new(e||o)(b(M),b(O))};static \u0275cmp=C({type:o,selectors:[["app-admin-layout"]],hostBindings:function(e,r){e&1&&u("click",function(g){return r.onDocumentClick(g)},!1,De)},decls:54,vars:49,consts:[[1,"min-h-screen","bg-gray-50","flex"],[1,"bg-white","border-gray-200","h-screen","fixed","top-0","z-40","transition-all","duration-300","ease-in-out","overflow-y-auto"],[3,"ngClass"],["alt","AssetGo Logo",3,"src"],[1,"text-2xl","text-gray-900",3,"ngClass"],[1,"font-bold"],[1,"p-4"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wider","mb-4",3,"ngClass"],["routerLink","/admin/dashboard","routerLinkActive","bg-blue-50 text-blue-700",1,"flex","items-center","space-x-3","px-3","py-2","rounded-lg","text-gray-700","hover:bg-gray-100","cursor-pointer"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-chart-column","mr-3","h-5","w-5","text-blue-600"],["d","M3 3v16a2 2 0 0 0 2 2h16"],["d","M18 17V9"],["d","M13 17V5"],["d","M8 17v-3"],["routerLink","/admin/users","routerLinkActive","bg-blue-50 text-blue-700",1,"flex","items-center","space-x-3","px-3","py-2","rounded-lg","text-gray-700","hover:bg-gray-100","cursor-pointer"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-users","mr-3","h-5","w-5","text-teal-600"],["d","M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"],["cx","9","cy","7","r","4"],["d","M22 21v-2a4 4 0 0 0-3-3.87"],["d","M16 3.13a4 4 0 0 1 0 7.75"],[1,"flex","flex-col","flex-1","transition-all","duration-300","ease-in-out"],[1,"bg-white","border-b","border-gray-200","sticky","top-0","z-50"],[1,"flex","items-center","justify-between","px-6","py-4"],[1,"flex","items-center","space-x-4"],[1,"p-2","rounded-lg","hover:bg-gray-100","cursor-pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"size-5","text-gray-600"],["width","18","height","18","x","3","y","3","rx","2"],["d","M9 3v18"],[1,"flex","items-center","space-x-4","ml-auto"],[1,"relative"],[1,"flex","items-center","space-x-3","p-2","rounded-lg","hover:bg-gray-100","transition-colors","cursor-pointer",3,"click"],[1,"w-8","h-8","bg-blue-600","rounded-full","flex","items-center","justify-center","text-white","font-medium"],[1,"text-sm"],[1,"font-medium","text-gray-900"],[1,"text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50",4,"ngIf"],[1,"flex-1","overflow-y-auto"],[1,"absolute","right-0","mt-2","w-80","bg-white","rounded-xl","shadow-lg","border","border-gray-200","py-2","z-50"],[1,"px-4","py-3","border-b","border-gray-100"],[1,"flex","items-center","space-x-3"],[1,"w-12","h-12","bg-blue-600","rounded-full","flex","items-center","justify-center","text-white","font-medium","text-lg"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"px-4","py-2","border-t","border-gray-100"],[1,"w-full","flex","items-center","space-x-3","px-3","py-2","rounded-lg","hover:bg-red-50","text-left","transition-colors","cursor-pointer",3,"click"],[1,"w-8","h-8","bg-red-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"],[1,"text-xs","text-gray-500"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"aside",1)(2,"div",2),c(3,"img",3),i(4,"h3",4)(5,"span",5),s(6,"Admin"),n()()(),i(7,"nav",6)(8,"div",7),s(9,"Navigation "),n(),i(10,"ul",2)(11,"li")(12,"a",8),y(),i(13,"svg",9),c(14,"path",10)(15,"path",11)(16,"path",12)(17,"path",13),n(),E(),i(18,"span",2),s(19,"Dashboard"),n()()(),i(20,"li")(21,"a",14),y(),i(22,"svg",15),c(23,"path",16)(24,"circle",17)(25,"path",18)(26,"path",19),n(),E(),i(27,"span",2),s(28,"Users"),n()()()()()(),i(29,"div",20)(30,"header",21)(31,"div",22)(32,"div",23)(33,"button",24),u("click",function(){return r.toggleSidebar()}),y(),i(34,"svg",25),c(35,"rect",26)(36,"path",27),n()()(),E(),i(37,"div",28)(38,"div",29)(39,"button",30),u("click",function(){return r.toggleUserDropdown()}),i(40,"div",31)(41,"span"),s(42),n()(),i(43,"div",32)(44,"div",33),s(45),n(),i(46,"div",34),s(47),n()(),y(),i(48,"svg",35),c(49,"path",36),n()(),p(50,at,21,3,"div",37),n()()()(),E(),i(51,"main",38),c(52,"router-outlet"),n()(),c(53,"app-toast"),n()),e&2&&(a(),w("w-64",r.sidebarOpen)("w-16",!r.sidebarOpen)("left-0",!r.isRtl())("right-0",r.isRtl())("border-r",!r.isRtl())("border-l",r.isRtl()),a(),l("ngClass",r.sidebarOpen?"flex items-center space-x-2 p-6":"px-2 py-6"),a(),w("h-10",r.sidebarOpen)("w-auto",r.sidebarOpen)("size-10",!r.sidebarOpen)("object-contain",!r.sidebarOpen),l("src","images/logo-short.png",P),a(),l("ngClass",r.sidebarOpen?"":"hidden"),a(3),w("p-4",r.sidebarOpen)("p-2",!r.sidebarOpen),a(),l("ngClass",r.sidebarOpen?"":"hidden"),a(2),l("ngClass",r.sidebarOpen?"space-y-3":"space-y-2"),a(2),w("!block",!r.sidebarOpen),a(6),l("ngClass",r.sidebarOpen?"":"hidden"),a(3),w("!block",!r.sidebarOpen),a(6),l("ngClass",r.sidebarOpen?"":"hidden"),a(2),w("ml-64",!r.isRtl()&&r.sidebarOpen)("ml-16",!r.isRtl()&&!r.sidebarOpen)("mr-64",r.isRtl()&&r.sidebarOpen)("mr-16",r.isRtl()&&!r.sidebarOpen),a(13),f(r.getAdminInitials()),a(3),f(r.currentAdmin==null?null:r.currentAdmin.name),a(2),f(r.currentAdmin==null?null:r.currentAdmin.email),a(),w("rotate-180",r.showUserDropdown),a(2),l("ngIf",r.showUserDropdown))},dependencies:[S,Re,I,He,Q,$e,ze,Qe],encapsulation:2})};var fe=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-admin-dashboard"]],decls:3,vars:0,consts:[[1,"p-6","grid","place-items-center","h-[calc(100vh-200px)]"],[1,"text-2xl","font-bold","text-gray-900","mb-6"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"h1",1),s(2,"Admin Dashboard"),n()())},dependencies:[S],encapsulation:2})};function st(o,t){o&1&&(y(),i(0,"svg",21),c(1,"path",22),n())}function lt(o,t){o&1&&(y(),i(0,"svg",23),c(1,"path",24),n())}function dt(o,t){o&1&&(i(0,"span"),s(1," This user will be suspended and will not be able to access the system. You can activate them again later. "),n())}function mt(o,t){o&1&&(i(0,"span"),s(1," This user will be activated and will regain access to the system. "),n())}function pt(o,t){if(o&1&&(i(0,"span"),s(1),Oe(2,"titlecase"),n()),o&2){let e=m(2);a(),f(Ve(2,1,e.actionText))}}function ct(o,t){o&1&&(i(0,"span",25),y(),i(1,"svg",26),c(2,"circle",27)(3,"path",28),n(),E(),i(4,"span"),s(5,"Processing..."),n()())}function ut(o,t){if(o&1){let e=A();i(0,"div",1),u("click",function(){x(e);let d=m();return h(d.onCancel())}),i(1,"div",2),u("click",function(d){return x(e),h(d.stopPropagation())}),i(2,"div",3)(3,"div",4)(4,"div"),p(5,st,2,0,"svg",5)(6,lt,2,0,"svg",6),n(),i(7,"h2",7),s(8),n()(),i(9,"button",8),u("click",function(){x(e);let d=m();return h(d.onCancel())}),y(),i(10,"svg",9),c(11,"path",10),n()()(),E(),i(12,"div",11)(13,"div",12)(14,"h3",13),s(15),i(16,"span",14),s(17),n(),s(18,"? "),n(),i(19,"p",15),p(20,dt,2,0,"span",16)(21,mt,2,0,"span",16),n()(),i(22,"div",17)(23,"button",18),u("click",function(){x(e);let d=m();return h(d.onCancel())}),s(24," Cancel "),n(),i(25,"button",19),u("click",function(){x(e);let d=m();return h(d.onConfirm())}),p(26,pt,3,3,"span",16)(27,ct,6,0,"span",20),n()()()()()}if(o&2){let e=m();l("@backdropAnimation",void 0),a(),l("@modalAnimation",void 0),a(3),U(e.isActive?"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center":"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"),a(),l("ngIf",e.isActive),a(),l("ngIf",!e.isActive),a(2),f(e.actionTitle),a(),l("disabled",e.isLoading),a(6),v(" Are you sure you want to ",e.actionText," "),a(2),f(e.userName),a(3),l("ngIf",e.isActive),a(),l("ngIf",!e.isActive),a(2),l("disabled",e.isLoading),a(2),U(e.isActive?"px-6 py-2 bg-orange-600 text-white font-medium rounded-lg hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed":"px-6 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed"),l("disabled",e.isLoading),a(),l("ngIf",!e.isLoading),a(),l("ngIf",e.isLoading)}}var Z=class o{isOpen=!1;isActive=!0;userName="";isLoading=!1;closeModal=new H;confirmAction=new H;get actionText(){return this.isActive?"suspend":"activate"}get actionTitle(){return this.isActive?"Suspend User":"Activate User"}onConfirm(){this.isLoading||this.confirmAction.emit(!this.isActive)}onCancel(){this.isLoading||this.closeModal.emit()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-suspend-activate-confirmation-modal"]],inputs:{isOpen:"isOpen",isActive:"isActive",userName:"userName",isLoading:"isLoading"},outputs:{closeModal:"closeModal",confirmAction:"confirmAction"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-[#00000085] flex items-center justify-center p-4","style","z-index: 1000;",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-[#00000085]","flex","items-center","justify-center","p-4",2,"z-index","1000",3,"click"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-md","w-full",3,"click"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200"],[1,"flex","items-center","space-x-3"],["class","w-5 h-5 text-orange-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-5 h-5 text-green-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-lg","transition-colors","disabled:opacity-50",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"text-center","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"font-bold"],[1,"text-gray-600"],[4,"ngIf"],[1,"flex","items-center","justify-end","space-x-3"],[1,"px-6","py-2","text-gray-600","hover:text-gray-800","font-medium","transition-colors","disabled:opacity-50",3,"click","disabled"],[3,"click","disabled"],["class","flex items-center space-x-2",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","items-center","space-x-2"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,r){e&1&&p(0,ut,28,18,"div",0),e&2&&l("ngIf",r.isOpen)},dependencies:[S,I,Be],encapsulation:2,data:{animation:[Ue("backdropAnimation",[ee(":enter",[R({opacity:0}),X("150ms ease-out",R({opacity:1}))]),ee(":leave",[X("150ms ease-in",R({opacity:0}))])]),Ue("modalAnimation",[ee(":enter",[R({opacity:0,transform:"scale(0.7) translateY(-50px)"}),X("200ms ease-out",R({opacity:1,transform:"scale(1) translateY(0)"}))]),ee(":leave",[X("150ms ease-in",R({opacity:0,transform:"scale(0.7) translateY(-50px)"}))])])]}})};var T=class o{constructor(t){this.http=t}apiUrl=ce.apiUrl;getAuthHeaders(){let t=localStorage.getItem("admin_token"),e=localStorage.getItem("token");if(!t)throw console.error("AdminUsersService: No admin_token found in localStorage"),console.error("Regular token exists:",!!e),console.error("Please login through /admin/login to get an admin token"),alert("Admin authentication required. Please login through the admin panel at /admin/login"),new Error("Admin token not found. Please login through /admin/login");return console.log("AdminUsersService: Using admin_token (first 20 chars):",t.substring(0,20)+"..."),{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t.trim()}`}}}getAuthHeadersForFileUpload(){let t=localStorage.getItem("admin_token");if(!t)throw new Error("Admin token not found. Please login through /admin/login");return{headers:{Accept:"application/json",Authorization:`Bearer ${t.trim()}`}}}getUsers(t){let e=new Ie;return t&&Object.keys(t).forEach(r=>{t[r]!==void 0&&t[r]!==null&&(e=e.set(r,t[r].toString()))}),this.http.get(`${this.apiUrl}/admin/users`,Ce(we({},this.getAuthHeaders()),{params:e}))}getUser(t){return this.http.get(`${this.apiUrl}/admin/users/${t}`,this.getAuthHeaders())}updateUser(t,e){return this.http.put(`${this.apiUrl}/admin/users/${t}`,e,this.getAuthHeaders())}deleteUser(t){return this.http.delete(`${this.apiUrl}/admin/users/${t}`,this.getAuthHeaders())}getCreatedTeams(t,e){let r=new Ie;return e&&Object.keys(e).forEach(d=>{e[d]!==void 0&&e[d]!==null&&(r=r.set(d,e[d].toString()))}),this.http.get(`${this.apiUrl}/admin/users/${t}/teams`,Ce(we({},this.getAuthHeaders()),{params:r}))}createUser(t){let e=new FormData;return e.append("first_name",t.first_name),e.append("last_name",t.last_name),e.append("email",t.email),e.append("password",t.password),e.append("password_confirmation",t.password_confirmation),e.append("company_name",t.company_name),t.industry&&e.append("industry",t.industry),t.business_type&&e.append("business_type",t.business_type),t.company_email&&e.append("company_email",t.company_email),t.company_phone&&e.append("company_phone",t.company_phone),t.company_address&&e.append("company_address",t.company_address),t.logo&&e.append("logo",t.logo),this.http.post(`${this.apiUrl}/admin/users`,e,this.getAuthHeadersForFileUpload())}changePassword(t,e){return this.http.post(`${this.apiUrl}/admin/users/${t}/change-password`,e,this.getAuthHeaders())}static \u0275fac=function(e){return new(e||o)(N(pe))};static \u0275prov=G({token:o,factory:o.\u0275fac,providedIn:"root"})};function gt(o,t){if(o&1&&(i(0,"p",19),s(1),n()),o&2){let e=m(2);a(),L(" Change password for ",e.user.first_name," ",e.user.last_name," ")}}function ft(o,t){if(o&1&&(i(0,"div",20),s(1),n()),o&2){let e=m(2);a(),v(" ",e.getPasswordError()," ")}}function vt(o,t){if(o&1&&(i(0,"div",20),s(1),n()),o&2){let e=m(2);a(),v(" ",e.getPasswordConfirmationError()," ")}}function _t(o,t){o&1&&(i(0,"span"),s(1,"Change Password"),n())}function xt(o,t){o&1&&(i(0,"span"),s(1,"Changing..."),n())}function ht(o,t){if(o&1){let e=A();i(0,"div",1),u("click",function(){x(e);let d=m();return h(d.onCancel())}),c(1,"div",2),i(2,"div",3)(3,"div",4),u("click",function(d){return x(e),h(d.stopPropagation())}),i(4,"div",5)(5,"h3",6),s(6,"Change Password"),n(),p(7,gt,2,2,"p",7),n(),i(8,"form",8),u("ngSubmit",function(){x(e);let d=m();return h(d.onConfirm())}),i(9,"div")(10,"label",9),s(11," New Password "),i(12,"span",10),s(13,"*"),n()(),c(14,"input",11),p(15,ft,2,1,"div",12),i(16,"div",13),s(17," Must be at least 8 characters with uppercase, lowercase, and a number "),n()(),i(18,"div")(19,"label",9),s(20," Confirm Password "),i(21,"span",10),s(22,"*"),n()(),c(23,"input",14),p(24,vt,2,1,"div",12),n(),i(25,"div",15)(26,"button",16),u("click",function(){x(e);let d=m();return h(d.onCancel())}),s(27," Cancel "),n(),i(28,"button",17),p(29,_t,2,0,"span",18)(30,xt,2,0,"span",18),n()()()()()()}if(o&2){let e,r=m();a(7),l("ngIf",r.user),a(),l("formGroup",r.passwordForm),a(6),w("border-red-300",((e=r.passwordForm.get("password"))==null?null:e.invalid)&&((e=r.passwordForm.get("password"))==null?null:e.touched)),a(),l("ngIf",r.getPasswordError()),a(8),w("border-red-300",r.getPasswordConfirmationError()),a(),l("ngIf",r.getPasswordConfirmationError()),a(2),l("disabled",r.isLoading),a(2),l("disabled",r.isLoading),a(),l("ngIf",!r.isLoading),a(),l("ngIf",r.isLoading)}}var K=class o{constructor(t,e,r){this.fb=t;this.adminUsersService=e;this.toastService=r;this.passwordForm=this.fb.group({password:["",[_.required,_.minLength(8),_.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/)]],password_confirmation:["",[_.required]]},{validators:this.passwordMatchValidator})}isOpen=!1;user=null;isLoading=!1;closeModal=new H;passwordChanged=new H;passwordForm;ngOnInit(){this.isOpen&&this.passwordForm.reset()}passwordMatchValidator(t){let e=t.get("password"),r=t.get("password_confirmation");return!e||!r||e.value===r.value?null:{passwordMismatch:!0}}getPasswordError(){let t=this.passwordForm.get("password");return!t||!t.errors||!t.touched?"":t.errors.required?"Password is required":t.errors.minlength?"Password must be at least 8 characters":t.errors.pattern?"Password must contain at least one uppercase letter, one lowercase letter, and one number":""}getPasswordConfirmationError(){return this.passwordForm.errors&&this.passwordForm.errors.passwordMismatch&&this.passwordForm.get("password_confirmation")?.touched?"Password confirmation does not match":""}onConfirm(){if(this.isLoading||!this.user)return;if(this.passwordForm.invalid){Object.keys(this.passwordForm.controls).forEach(e=>{this.passwordForm.get(e)?.markAsTouched()});return}this.isLoading=!0;let t=this.passwordForm.value;this.adminUsersService.changePassword(this.user.id,{password:t.password,password_confirmation:t.password_confirmation}).subscribe({next:e=>{e.success&&(this.toastService.success("Password changed successfully"),this.passwordForm.reset(),this.passwordChanged.emit(),this.closeModal.emit()),this.isLoading=!1},error:e=>{this.isLoading=!1;let r=e.error?.message||"Failed to change password. Please try again.";this.toastService.error(r)}})}onCancel(){this.isLoading||(this.passwordForm.reset(),this.closeModal.emit())}static \u0275fac=function(e){return new(e||o)(b(J),b(T),b(F))};static \u0275cmp=C({type:o,selectors:[["app-change-password-modal"]],inputs:{isOpen:"isOpen",user:"user",isLoading:"isLoading"},outputs:{closeModal:"closeModal",passwordChanged:"passwordChanged"},decls:1,vars:1,consts:[["class","fixed inset-0 overflow-y-auto","style","z-index: 1000;",3,"click",4,"ngIf"],[1,"fixed","inset-0","overflow-y-auto",2,"z-index","1000",3,"click"],[1,"fixed","inset-0","transition-opacity",2,"background-color","rgba(0, 0, 0, 0.55)"],[1,"flex","min-h-full","items-center","justify-center","p-4"],[1,"relative","bg-white","rounded-lg","shadow-xl","max-w-md","w-full","p-6",3,"click"],[1,"mb-4"],[1,"text-lg","font-semibold","text-gray-900"],["class","text-sm text-gray-600 mt-1",4,"ngIf"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","password","formControlName","password",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["class","text-red-600 text-sm mt-1",4,"ngIf"],[1,"text-xs","text-gray-500","mt-1"],["type","password","formControlName","password_confirmation",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],[1,"flex","justify-end","gap-3","pt-4"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],[4,"ngIf"],[1,"text-sm","text-gray-600","mt-1"],[1,"text-red-600","text-sm","mt-1"]],template:function(e,r){e&1&&p(0,ht,31,12,"div",0),e&2&&l("ngIf",r.isOpen)},dependencies:[S,I,Y,z,j,D,$,q,W],encapsulation:2})};function bt(o,t){o&1&&(y(),i(0,"svg",20),c(1,"path",21),n())}function yt(o,t){o&1&&(y(),i(0,"svg",20),c(1,"path",22),n())}function wt(o,t){if(o&1&&(i(0,"option",23),s(1),n()),o&2){let e=t.$implicit;l("value",e.value),a(),f(e.label)}}function Ct(o,t){o&1&&(i(0,"div",24),s(1," Loading... "),n())}function St(o,t){if(o&1){let e=A();i(0,"tr")(1,"td",33)(2,"div",34),s(3),n()(),i(4,"td",33)(5,"div",35),s(6),n()(),i(7,"td",33)(8,"span",36),s(9),n()(),i(10,"td",33)(11,"div",35),s(12),n()(),i(13,"td",33)(14,"span"),s(15),n()(),i(16,"td",37)(17,"div",38)(18,"button",39),u("click",function(){let d=x(e).$implicit,g=m(3);return h(g.viewUser(d))}),s(19," View "),n(),i(20,"button",40),u("click",function(){let d=x(e).$implicit,g=m(3);return h(g.changePassword(d))}),s(21," Change Password "),n(),i(22,"button",41),u("click",function(){let d=x(e).$implicit,g=m(3);return h(g.toggleUserStatus(d))}),s(23),n()()()()}if(o&2){let e=t.$implicit;a(3),L("",e.first_name," ",e.last_name,""),a(3),f(e.email),a(3),v(" ",e.user_type," "),a(3),f((e.company==null?null:e.company.name)||"N/A"),a(2),U(e.active?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"),a(),v(" ",e.active?"Active":"Inactive"," "),a(7),U(e.active?"px-3 py-1.5 text-xs font-medium text-orange-600 bg-orange-50 hover:bg-orange-100 rounded-md transition-colors cursor-pointer":"px-3 py-1.5 text-xs font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-md transition-colors cursor-pointer"),a(),v(" ",e.active?"Suspend":"Activate"," ")}}function Et(o,t){if(o&1&&(i(0,"table",28)(1,"thead",29)(2,"tr")(3,"th",30),s(4,"Name"),n(),i(5,"th",30),s(6,"Email"),n(),i(7,"th",30),s(8,"Type"),n(),i(9,"th",30),s(10,"Company"),n(),i(11,"th",30),s(12,"Status"),n(),i(13,"th",30),s(14,"Actions"),n()()(),i(15,"tbody",31),p(16,St,24,11,"tr",32),n()()),o&2){let e=m(2);a(16),l("ngForOf",e.users)}}function At(o,t){o&1&&(i(0,"div",42),s(1," No users found. "),n())}function It(o,t){if(o&1&&(i(0,"div")(1,"div",25),p(2,Et,17,1,"table",26)(3,At,2,0,"div",27),n()()),o&2){let e=m();a(2),l("ngIf",e.users.length>0),a(),l("ngIf",e.users.length===0)}}function Ut(o,t){if(o&1){let e=A();i(0,"div",46)(1,"div",47)(2,"div",48)(3,"div",49),s(4),n(),i(5,"div")(6,"h3",50),s(7),n(),i(8,"p",51),s(9),n()()()(),i(10,"div",52)(11,"div",53)(12,"span",51),s(13,"Type:"),n(),i(14,"span",54),s(15),n()(),i(16,"div",53)(17,"span",51),s(18,"Company:"),n(),i(19,"span",55),s(20),n()(),i(21,"div",53)(22,"span",51),s(23,"Status:"),n(),i(24,"span"),s(25),n()()(),i(26,"div",56)(27,"button",57),u("click",function(){let d=x(e).$implicit,g=m(3);return h(g.viewUser(d))}),s(28," View "),n(),i(29,"button",58),u("click",function(){let d=x(e).$implicit,g=m(3);return h(g.changePassword(d))}),s(30," Change Password "),n(),i(31,"button",41),u("click",function(){let d=x(e).$implicit,g=m(3);return h(g.toggleUserStatus(d))}),s(32),n()()()}if(o&2){let e=t.$implicit;a(4),L(" ",e.first_name.charAt(0),"",e.last_name.charAt(0)," "),a(3),L("",e.first_name," ",e.last_name,""),a(2),f(e.email),a(6),v(" ",e.user_type," "),a(5),f((e.company==null?null:e.company.name)||"N/A"),a(4),U(e.active?"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800":"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800"),a(),v(" ",e.active?"Active":"Inactive"," "),a(6),U(e.active?"flex-1 px-3 py-2 text-xs font-medium text-orange-600 bg-orange-50 hover:bg-orange-100 rounded-md transition-colors cursor-pointer":"flex-1 px-3 py-2 text-xs font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-md transition-colors cursor-pointer"),a(),v(" ",e.active?"Suspend":"Activate"," ")}}function Mt(o,t){if(o&1&&(i(0,"div",44),p(1,Ut,33,13,"div",45),n()),o&2){let e=m(2);a(),l("ngForOf",e.users)}}function kt(o,t){o&1&&(i(0,"div",24),s(1," No users found. "),n())}function Tt(o,t){if(o&1&&(i(0,"div"),p(1,Mt,2,1,"div",43)(2,kt,2,0,"div",15),n()),o&2){let e=m();a(),l("ngIf",e.users.length>0),a(),l("ngIf",e.users.length===0)}}function Pt(o,t){if(o&1){let e=A();i(0,"div",59)(1,"div",9),s(2),n(),i(3,"div",60)(4,"button",61),u("click",function(){x(e);let d=m();return h(d.onPageChange(d.currentPage-1))}),s(5," Previous "),n(),i(6,"button",61),u("click",function(){x(e);let d=m();return h(d.onPageChange(d.currentPage+1))}),s(7," Next "),n()()()}if(o&2){let e=m();a(2),de(" Showing ",(e.currentPage-1)*e.perPage+1," to ",e.Math.min(e.currentPage*e.perPage,e.total)," of ",e.total," users "),a(2),l("disabled",e.currentPage===1),a(2),l("disabled",e.currentPage===e.lastPage)}}var _e=class o{constructor(t,e,r){this.adminUsersService=t;this.router=e;this.toastService=r}users=[];loading=!1;searchTerm="";selectedUserType=null;currentPage=1;perPage=15;total=0;lastPage=1;userTypeOptions=[{value:null,label:"All"},{value:"user",label:"User"},{value:"admin",label:"Admin"},{value:"manager",label:"Manager"},{value:"team",label:"Team"},{value:"owner",label:"Owner"}];showConfirmModal=!1;selectedUser=null;confirmModalLoading=!1;showChangePasswordModal=!1;changePasswordLoading=!1;viewMode="list";searchSubject=new oe;ngOnInit(){this.searchSubject.pipe(Le(500),Fe()).subscribe(t=>{this.searchTerm=t,this.currentPage=1,this.loadUsers()}),this.loadUsers()}ngOnDestroy(){this.searchSubject.complete()}loadUsers(){this.loading=!0,this.adminUsersService.getUsers({page:this.currentPage,per_page:this.perPage,search:this.searchTerm||void 0,user_type:this.selectedUserType||void 0,sort_by:"created_at",sort_dir:"desc"}).subscribe({next:t=>{t.success&&(this.users=t.data.users,this.total=t.data.pagination.total,this.lastPage=t.data.pagination.last_page,this.currentPage=t.data.pagination.current_page),this.loading=!1},error:()=>{this.loading=!1}})}onSearch(){this.currentPage=1,this.loadUsers()}onSearchInputChange(){this.searchSubject.next(this.searchTerm)}onUserTypeFilter(){this.currentPage=1,this.loadUsers()}onPageChange(t){this.currentPage=t,this.loadUsers()}toggleUserStatus(t){this.selectedUser=t,this.showConfirmModal=!0}onConfirmStatusChange(t){if(!this.selectedUser)return;this.confirmModalLoading=!0;let e=t?"activate":"suspend";this.adminUsersService.updateUser(this.selectedUser.id,{active:t}).subscribe({next:()=>{this.selectedUser.active=t,this.showConfirmModal=!1,this.selectedUser=null,this.confirmModalLoading=!1,this.toastService.success(`User ${e}d successfully`)},error:r=>{this.confirmModalLoading=!1,this.toastService.error(`Failed to ${e} user`),console.error(r)}})}onCloseConfirmModal(){this.showConfirmModal=!1,this.selectedUser=null}viewUser(t){this.router.navigate(["/admin/users",t.id])}toggleViewMode(){this.viewMode=this.viewMode==="list"?"grid":"list"}createUser(){this.router.navigate(["/admin/users/create"])}changePassword(t){this.selectedUser=t,this.showChangePasswordModal=!0}onPasswordChanged(){this.showChangePasswordModal=!1,this.selectedUser=null}onCloseChangePasswordModal(){this.showChangePasswordModal=!1,this.selectedUser=null}Math=Math;static \u0275fac=function(e){return new(e||o)(b(T),b(M),b(F))};static \u0275cmp=C({type:o,selectors:[["app-admin-users"]],decls:26,vars:17,consts:[[1,"p-6"],[1,"mb-6","flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"flex","gap-3"],[1,"flex","items-center","gap-2","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"flex","items-center","gap-2","px-4","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50","cursor-pointer",3,"click"],["class","w-5 h-5 text-gray-600","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-sm","text-gray-700"],[1,"mb-4"],[1,"flex","gap-4","items-center"],["type","text","placeholder","Search users...",1,"w-64","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","keyup.enter","ngModel"],[1,"px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","bg-white rounded-lg shadow p-6 text-center text-gray-500",4,"ngIf"],[4,"ngIf"],["class","mt-4 flex items-center justify-between",4,"ngIf"],[3,"closeModal","confirmAction","isOpen","isActive","userName","isLoading"],[3,"closeModal","passwordChanged","isOpen","user","isLoading"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],[3,"value"],[1,"bg-white","rounded-lg","shadow","p-6","text-center","text-gray-500"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],["class","min-w-full divide-y divide-gray-200",4,"ngIf"],["class","p-6 text-center text-gray-500",4,"ngIf"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngFor","ngForOf"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full","bg-blue-100","text-blue-800","capitalize"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"flex","items-center","gap-2"],[1,"px-3","py-1.5","text-xs","font-medium","text-blue-600","bg-blue-50","hover:bg-blue-100","rounded-md","transition-colors","cursor-pointer",3,"click"],[1,"px-3","py-1.5","text-xs","font-medium","text-purple-600","bg-purple-50","hover:bg-purple-100","rounded-md","transition-colors","cursor-pointer",3,"click"],[3,"click"],[1,"p-6","text-center","text-gray-500"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-4"],["class","bg-white rounded-lg shadow hover:shadow-md transition-shadow p-6",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow","hover:shadow-md","transition-shadow","p-6"],[1,"flex","items-start","justify-between","mb-4"],[1,"flex","items-center","gap-3"],[1,"w-12","h-12","bg-blue-600","rounded-full","flex","items-center","justify-center","text-white","font-semibold","text-lg"],[1,"text-sm","font-semibold","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"space-y-2","mb-4"],[1,"flex","items-center","justify-between"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full","bg-blue-100","text-blue-800","capitalize"],[1,"text-xs","font-medium","text-gray-900"],[1,"flex","gap-2","pt-4","border-t","border-gray-200"],[1,"flex-1","px-3","py-2","text-xs","font-medium","text-blue-600","bg-blue-50","hover:bg-blue-100","rounded-md","transition-colors","cursor-pointer",3,"click"],[1,"flex-1","px-3","py-2","text-xs","font-medium","text-purple-600","bg-purple-50","hover:bg-purple-100","rounded-md","transition-colors","cursor-pointer",3,"click"],[1,"mt-4","flex","items-center","justify-between"],[1,"flex","gap-2"],[1,"px-4","py-2","border","border-gray-300","rounded-lg","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50","cursor-pointer",3,"click","disabled"]],template:function(e,r){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"Users"),n(),i(4,"div",3)(5,"button",4),u("click",function(){return r.createUser()}),y(),i(6,"svg",5),c(7,"path",6),n(),E(),i(8,"span"),s(9,"Add User"),n()(),i(10,"button",7),u("click",function(){return r.toggleViewMode()}),p(11,bt,2,0,"svg",8)(12,yt,2,0,"svg",8),i(13,"span",9),s(14),n()()()(),i(15,"div",10)(16,"div",11)(17,"input",12),Ae("ngModelChange",function(g){return Ee(r.searchTerm,g)||(r.searchTerm=g),g}),u("ngModelChange",function(){return r.onSearchInputChange()})("keyup.enter",function(){return r.onSearch()}),n(),i(18,"select",13),Ae("ngModelChange",function(g){return Ee(r.selectedUserType,g)||(r.selectedUserType=g),g}),u("change",function(){return r.onUserTypeFilter()}),p(19,wt,2,2,"option",14),n()()(),p(20,Ct,2,0,"div",15)(21,It,4,2,"div",16)(22,Tt,3,2,"div",16)(23,Pt,8,5,"div",17),i(24,"app-suspend-activate-confirmation-modal",18),u("closeModal",function(){return r.onCloseConfirmModal()})("confirmAction",function(g){return r.onConfirmStatusChange(g)}),n(),i(25,"app-change-password-modal",19),u("closeModal",function(){return r.onCloseChangePasswordModal()})("passwordChanged",function(){return r.onPasswordChanged()}),n()()),e&2){let d;a(11),l("ngIf",r.viewMode==="list"),a(),l("ngIf",r.viewMode==="grid"),a(2),f(r.viewMode==="list"?"Grid View":"List View"),a(3),Se("ngModel",r.searchTerm),a(),Se("ngModel",r.selectedUserType),a(),l("ngForOf",r.userTypeOptions),a(),l("ngIf",r.loading),a(),l("ngIf",!r.loading&&r.viewMode==="list"),a(),l("ngIf",!r.loading&&r.viewMode==="grid"),a(),l("ngIf",!r.loading&&r.total>0),a(),l("isOpen",r.showConfirmModal)("isActive",(d=r.selectedUser==null?null:r.selectedUser.active)!==null&&d!==void 0?d:!0)("userName",r.selectedUser?r.selectedUser.first_name+" "+r.selectedUser.last_name:"")("isLoading",r.confirmModalLoading),a(),l("isOpen",r.showChangePasswordModal)("user",r.selectedUser)("isLoading",r.changePasswordLoading)}},dependencies:[S,me,I,Ke,Je,Ye,j,We,D,qe,Z,K],encapsulation:2})};function Lt(o,t){if(o&1){let e=A();i(0,"div",12)(1,"button",13),u("click",function(){x(e);let d=m();return h(d.changePassword())}),s(2," Change Password "),n(),i(3,"button",14),u("click",function(){x(e);let d=m();return h(d.toggleUserStatus())}),s(4),n()()}if(o&2){let e=m();a(3),U(e.user.active?"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 cursor-pointer":"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer"),a(),v(" ",e.user.active?"Suspend User":"Activate User"," ")}}function Ft(o,t){o&1&&(i(0,"div",15),s(1," Loading user details... "),n())}function jt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Avatar"),n(),c(3,"img",30),n()),o&2){let e=m(2);a(3),l("src",e.user.avatar,P)}}function Dt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Hourly Rate"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(2);a(4),v("$",e.user.hourly_rate,"")}}function Ot(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Created By"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(2);a(4),f(e.user.created_by_name||"Administrator")}}function Vt(o,t){if(o&1&&(i(0,"div",32)(1,"label",33),s(2,"Company Logo"),n(),i(3,"div",34),c(4,"img",35),n()()),o&2){let e=m(3);a(4),l("src",e.user.company.logo_url||e.user.company.logo,P)}}function Nt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Phone"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(3);a(4),f(e.user.company.phone)}}function Rt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Email"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(3);a(4),f(e.user.company.email)}}function Bt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Address"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(3);a(4),f(e.user.company.address)}}function Gt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Business Type"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(3);a(4),f(e.user.company.business_type)}}function Ht(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Industry"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(3);a(4),f(e.user.company.industry)}}function $t(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Currency"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(3);a(4),f(e.user.company.currency)}}function zt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Subscription Status"),n(),i(3,"p",23)(4,"span",36),s(5),n()()()),o&2){let e=m(3);a(5),v(" ",e.user.company.subscription_status," ")}}function qt(o,t){if(o&1&&(i(0,"div")(1,"label",21),s(2,"Slug"),n(),i(3,"p",23),s(4),n()()),o&2){let e=m(3);a(4),f(e.user.company.slug)}}function Wt(o,t){if(o&1&&(i(0,"div",17)(1,"div",18)(2,"h2",19),s(3,"Company Information"),n()(),i(4,"div",0)(5,"div",20),p(6,Vt,5,1,"div",31),i(7,"div")(8,"label",21),s(9,"Company Name"),n(),i(10,"p",23),s(11),n()(),p(12,Nt,5,1,"div",25)(13,Rt,5,1,"div",25)(14,Bt,5,1,"div",25)(15,Gt,5,1,"div",25)(16,Ht,5,1,"div",25)(17,$t,5,1,"div",25)(18,zt,6,1,"div",25)(19,qt,5,1,"div",25),n()()()),o&2){let e=m(2);a(6),l("ngIf",e.user.company.logo||e.user.company.logo_url),a(5),f(e.user.company.name),a(),l("ngIf",e.user.company.phone),a(),l("ngIf",e.user.company.email),a(),l("ngIf",e.user.company.address),a(),l("ngIf",e.user.company.business_type),a(),l("ngIf",e.user.company.industry),a(),l("ngIf",e.user.company.currency),a(),l("ngIf",e.user.company.subscription_status),a(),l("ngIf",e.user.company.slug)}}function Jt(o,t){if(o&1&&(i(0,"span",39),s(1),n()),o&2){let e=t.$implicit;a(),v(" ",e.name," ")}}function Yt(o,t){if(o&1&&(i(0,"div",17)(1,"div",18)(2,"h2",19),s(3,"Roles"),n()(),i(4,"div",0)(5,"div",37),p(6,Jt,2,1,"span",38),n()()()),o&2){let e=m(2);a(6),l("ngForOf",e.user.roles)}}function Zt(o,t){o&1&&(i(0,"div",40),s(1," Loading teams... "),n())}function Kt(o,t){if(o&1&&(i(0,"tr")(1,"td",47)(2,"div",48),s(3),n()(),i(4,"td",47)(5,"div",49),s(6),n()(),i(7,"td",47)(8,"div",50),s(9),n()(),i(10,"td",47)(11,"span"),s(12),n()(),i(13,"td",47)(14,"div",49),s(15),n()()()),o&2){let e=t.$implicit,r=m(3);a(3),L("",e.first_name," ",e.last_name,""),a(3),f(e.email),a(3),f(r.getRoleName(e)),a(2),U(e.active?"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800":"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800"),a(),v(" ",e.active?"Active":"Inactive"," "),a(3),f(r.formatDate(e.created_at))}}function Qt(o,t){if(o&1&&(i(0,"div",41)(1,"table",42)(2,"thead",43)(3,"tr")(4,"th",44),s(5,"Name"),n(),i(6,"th",44),s(7,"Email"),n(),i(8,"th",44),s(9,"Role"),n(),i(10,"th",44),s(11,"Status"),n(),i(12,"th",44),s(13,"Created"),n()()(),i(14,"tbody",45),p(15,Kt,16,8,"tr",46),n()()()),o&2){let e=m(2);a(15),l("ngForOf",e.teams)}}function Xt(o,t){o&1&&(i(0,"div",40),s(1," No teams created by this user. "),n())}function ei(o,t){if(o&1){let e=A();i(0,"div",51)(1,"div",52),s(2),n(),i(3,"div",53)(4,"button",54),u("click",function(){x(e);let d=m(2);return h(d.onTeamsPageChange(d.teamsCurrentPage-1))}),s(5," Previous "),n(),i(6,"button",54),u("click",function(){x(e);let d=m(2);return h(d.onTeamsPageChange(d.teamsCurrentPage+1))}),s(7," Next "),n()()()}if(o&2){let e=m(2);a(2),de(" Showing ",(e.teamsCurrentPage-1)*e.teamsPerPage+1," to ",e.Math.min(e.teamsCurrentPage*e.teamsPerPage,e.teamsTotal)," of ",e.teamsTotal," teams "),a(2),l("disabled",e.teamsCurrentPage===1),a(2),l("disabled",e.teamsCurrentPage===e.teamsLastPage)}}function ti(o,t){if(o&1&&(i(0,"div",16)(1,"div",17)(2,"div",18)(3,"h2",19),s(4,"User Information"),n()(),i(5,"div",0)(6,"div",20)(7,"div")(8,"label",21),s(9,"Name"),n(),i(10,"p",22),s(11),n()(),i(12,"div")(13,"label",21),s(14,"Email"),n(),i(15,"p",23),s(16),n()(),i(17,"div")(18,"label",21),s(19,"User Type"),n(),i(20,"p",23)(21,"span",24),s(22),n()()(),i(23,"div")(24,"label",21),s(25,"Status"),n(),i(26,"p",23)(27,"span"),s(28),n()()(),p(29,jt,4,1,"div",25)(30,Dt,5,1,"div",25),i(31,"div")(32,"label",21),s(33,"Created Date"),n(),i(34,"p",23),s(35),n()(),i(36,"div")(37,"label",21),s(38,"Last Updated"),n(),i(39,"p",23),s(40),n()(),p(41,Ot,5,1,"div",25),n()()(),p(42,Wt,20,10,"div",26)(43,Yt,7,1,"div",26),i(44,"div",17)(45,"div",18)(46,"h2",19),s(47,"Teams Created by User"),n()(),i(48,"div",0),p(49,Zt,2,0,"div",27)(50,Qt,16,1,"div",28)(51,Xt,2,0,"div",27)(52,ei,8,5,"div",29),n()()()),o&2){let e=m();a(11),L("",e.user.first_name," ",e.user.last_name,""),a(5),f(e.user.email),a(6),v(" ",e.user.user_type," "),a(5),U(e.user.active?"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800":"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800"),a(),v(" ",e.user.active?"Active":"Inactive"," "),a(),l("ngIf",e.user.avatar),a(),l("ngIf",e.user.hourly_rate),a(5),f(e.formatDate(e.user.created_at)),a(5),f(e.formatDate(e.user.updated_at)),a(),l("ngIf",e.user.created_by),a(),l("ngIf",e.user.company),a(),l("ngIf",e.user.roles&&e.user.roles.length>0),a(6),l("ngIf",e.teamsLoading),a(),l("ngIf",!e.teamsLoading&&e.teams.length>0),a(),l("ngIf",!e.teamsLoading&&e.teams.length===0),a(),l("ngIf",!e.teamsLoading&&e.teamsTotal>0)}}var xe=class o{constructor(t,e,r,d){this.route=t;this.router=e;this.adminUsersService=r;this.toastService=d}user=null;loading=!1;userId=null;teams=[];teamsLoading=!1;teamsCurrentPage=1;teamsPerPage=15;teamsTotal=0;teamsLastPage=1;showConfirmModal=!1;confirmModalLoading=!1;showChangePasswordModal=!1;changePasswordLoading=!1;ngOnInit(){this.route.params.subscribe(t=>{this.userId=+t.id,this.userId&&(this.loadUserDetails(),this.loadTeams())})}loadUserDetails(){this.userId&&(this.loading=!0,this.adminUsersService.getUser(this.userId).subscribe({next:t=>{t.success&&(this.user=t.data.user),this.loading=!1},error:t=>{this.loading=!1,this.toastService.error("Failed to load user details"),console.error(t)}}))}loadTeams(t=1){this.userId&&(this.teamsLoading=!0,this.teamsCurrentPage=t,this.adminUsersService.getCreatedTeams(this.userId,{page:this.teamsCurrentPage,per_page:this.teamsPerPage,sort_by:"created_at",sort_dir:"desc"}).subscribe({next:e=>{e.success&&(this.teams=e.data.teams,this.teamsTotal=e.data.pagination.total,this.teamsLastPage=e.data.pagination.last_page,this.teamsCurrentPage=e.data.pagination.current_page),this.teamsLoading=!1},error:()=>{this.teamsLoading=!1}}))}onTeamsPageChange(t){this.loadTeams(t)}formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}getRoleName(t){return t.roles&&t.roles.length>0?t.roles[0].name:"N/A"}toggleUserStatus(){this.user&&(this.showConfirmModal=!0)}onConfirmStatusChange(t){!this.user||!this.userId||(this.confirmModalLoading=!0,this.adminUsersService.updateUser(this.userId,{active:t}).subscribe({next:()=>{this.user&&(this.user.active=t),this.showConfirmModal=!1,this.confirmModalLoading=!1,this.toastService.success(`User ${t?"activated":"suspended"} successfully`)},error:e=>{this.confirmModalLoading=!1,this.toastService.error(`Failed to ${t?"activate":"suspend"} user`),console.error(e)}}))}onCloseConfirmModal(){this.showConfirmModal=!1}goBack(){this.router.navigate(["/admin/users"])}changePassword(){this.showChangePasswordModal=!0}onPasswordChanged(){this.showChangePasswordModal=!1}onCloseChangePasswordModal(){this.showChangePasswordModal=!1}Math=Math;static \u0275fac=function(e){return new(e||o)(b(Ge),b(M),b(T),b(F))};static \u0275cmp=C({type:o,selectors:[["app-user-details"]],decls:14,vars:10,consts:[[1,"p-6"],[1,"mb-6","flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],[1,"px-4","py-2","text-gray-600","hover:text-gray-800","flex","items-center","gap-2","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"text-2xl","font-bold","text-gray-900"],["class","flex gap-3",4,"ngIf"],["class","bg-white rounded-lg shadow p-6 text-center text-gray-500",4,"ngIf"],["class","space-y-6",4,"ngIf"],[3,"closeModal","confirmAction","isOpen","isActive","userName","isLoading"],[3,"closeModal","passwordChanged","isOpen","user","isLoading"],[1,"flex","gap-3"],[1,"px-4","py-2","bg-purple-600","text-white","rounded-lg","hover:bg-purple-700","cursor-pointer",3,"click"],[3,"click"],[1,"bg-white","rounded-lg","shadow","p-6","text-center","text-gray-500"],[1,"space-y-6"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"grid","grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-500","mb-1"],[1,"text-gray-900","font-medium"],[1,"text-gray-900"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full","bg-blue-100","text-blue-800","capitalize"],[4,"ngIf"],["class","bg-white rounded-lg shadow overflow-hidden",4,"ngIf"],["class","text-center py-8 text-gray-500",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],["class","mt-4 flex items-center justify-between",4,"ngIf"],["alt","User Avatar",1,"w-16","h-16","rounded-full","object-cover",3,"src"],["class","col-span-2",4,"ngIf"],[1,"col-span-2"],[1,"block","text-sm","font-medium","text-gray-500","mb-2"],[1,"inline-block"],["alt","Company Logo",1,"w-32","h-32","object-contain","border","border-gray-300","rounded-lg",3,"src"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full","bg-blue-100","text-blue-800"],[1,"flex","flex-wrap","gap-2"],["class","px-3 py-1 text-sm font-medium rounded-full bg-purple-100 text-purple-800",4,"ngFor","ngForOf"],[1,"px-3","py-1","text-sm","font-medium","rounded-full","bg-purple-100","text-purple-800"],[1,"text-center","py-8","text-gray-500"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-4","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngFor","ngForOf"],[1,"px-4","py-3","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-900"],[1,"mt-4","flex","items-center","justify-between"],[1,"text-sm","text-gray-700"],[1,"flex","gap-2"],[1,"px-4","py-2","border","border-gray-300","rounded-lg","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50","cursor-pointer",3,"click","disabled"]],template:function(e,r){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),u("click",function(){return r.goBack()}),y(),i(4,"svg",4),c(5,"path",5),n(),s(6," Back to Users "),n(),E(),i(7,"h1",6),s(8,"User Details"),n()(),p(9,Lt,5,3,"div",7),n(),p(10,Ft,2,0,"div",8)(11,ti,53,18,"div",9),i(12,"app-suspend-activate-confirmation-modal",10),u("closeModal",function(){return r.onCloseConfirmModal()})("confirmAction",function(g){return r.onConfirmStatusChange(g)}),n(),i(13,"app-change-password-modal",11),u("closeModal",function(){return r.onCloseChangePasswordModal()})("passwordChanged",function(){return r.onPasswordChanged()}),n()()),e&2){let d;a(9),l("ngIf",r.user),a(),l("ngIf",r.loading),a(),l("ngIf",!r.loading&&r.user),a(),l("isOpen",r.showConfirmModal)("isActive",(d=r.user==null?null:r.user.active)!==null&&d!==void 0?d:!0)("userName",r.user?r.user.first_name+" "+r.user.last_name:"")("isLoading",r.confirmModalLoading),a(),l("isOpen",r.showChangePasswordModal)("user",r.user)("isLoading",r.changePasswordLoading)}},dependencies:[S,me,I,Z,K],encapsulation:2})};function ii(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("first_name")," ")}}function ni(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("last_name")," ")}}function ri(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("email")," ")}}function oi(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("password")," ")}}function ai(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getPasswordConfirmationError()," ")}}function si(o,t){if(o&1){let e=A();i(0,"div",35),c(1,"img",36),i(2,"button",37),u("click",function(){x(e);let d=m();return h(d.removeLogo())}),y(),i(3,"svg",38),c(4,"path",39),n()()()}if(o&2){let e=m();a(),l("src",e.logoPreview,P)}}function li(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("company_name")," ")}}function di(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("industry")," ")}}function mi(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("business_type")," ")}}function pi(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("company_email")," ")}}function ci(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("company_phone")," ")}}function ui(o,t){if(o&1&&(i(0,"div",34),s(1),n()),o&2){let e=m();a(),v(" ",e.getFieldError("company_address")," ")}}function gi(o,t){if(o&1&&(i(0,"div",40)(1,"p",41),s(2),n()()),o&2){let e=m();a(2),f(e.errorMessage)}}function fi(o,t){o&1&&(i(0,"span"),s(1,"Create User"),n())}function vi(o,t){o&1&&(i(0,"span"),s(1,"Creating..."),n())}var he=class o{constructor(t,e,r,d,g){this.fb=t;this.router=e;this.adminUsersService=r;this.toastService=d;this.document=g;this.userForm=this.fb.group({first_name:["",[_.required,_.minLength(2),_.maxLength(100)]],last_name:["",[_.required,_.minLength(2),_.maxLength(100)]],email:["",[_.required,_.email]],password:["",[_.required,_.minLength(8),_.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/)]],password_confirmation:["",[_.required]],company_name:["",[_.required,_.maxLength(255)]],industry:["",[_.maxLength(255)]],business_type:["",[_.maxLength(255)]],company_email:["",[_.email,_.maxLength(255)]],company_phone:["",[_.maxLength(255)]],company_address:["",[_.maxLength(500)]],logo:[null]},{validators:this.passwordMatchValidator})}userForm;loading=!1;errorMessage="";selectedLogo=null;logoPreview=null;ngOnInit(){}passwordMatchValidator(t){let e=t.get("password"),r=t.get("password_confirmation");return!e||!r||e.value===r.value?null:{passwordMismatch:!0}}getFieldError(t){let e=this.userForm.get(t);if(!e||!e.errors||!e.touched)return"";if(e.errors.required)return`${this.getFieldLabel(t)} is required`;if(e.errors.email)return"Please enter a valid email address";if(e.errors.minlength){let r=e.errors.minlength.requiredLength;return`${this.getFieldLabel(t)} must be at least ${r} characters`}if(e.errors.maxlength){let r=e.errors.maxlength.requiredLength;return`${this.getFieldLabel(t)} must not exceed ${r} characters`}return e.errors.pattern&&t==="password"?"Password must contain at least one uppercase letter, one lowercase letter, and one number":""}getPasswordConfirmationError(){return this.userForm.errors&&this.userForm.errors.passwordMismatch&&this.userForm.get("password_confirmation")?.touched?"Password confirmation does not match":""}getFieldLabel(t){return{first_name:"First name",last_name:"Last name",email:"Email",password:"Password",password_confirmation:"Password confirmation",company_name:"Company name",industry:"Industry",business_type:"Business type",company_email:"Email address",company_phone:"Phone number",company_address:"Company address"}[t]||t}triggerLogoUpload(){let t=document.getElementById("logo");t&&t.click()}onLogoSelected(t){let e=t.target;if(e&&e.files&&e.files.length>0){let r=e.files[0];if(!r.type.match(/image\/(jpeg|png|webp)/)){this.toastService.error("Please select a valid image file (JPEG, PNG, or WebP)");return}if(r.size>5*1024*1024){this.toastService.error("Logo size must not exceed 5MB");return}this.selectedLogo=r,this.userForm.patchValue({logo:r});let d=new FileReader;d.onload=g=>{this.logoPreview=g.target.result},d.readAsDataURL(r)}}removeLogo(){this.selectedLogo=null,this.logoPreview=null,this.userForm.patchValue({logo:null});let t=document.getElementById("logo");t&&(t.value="")}onSubmit(){if(this.userForm.invalid){Object.keys(this.userForm.controls).forEach(r=>{this.userForm.get(r)?.markAsTouched()});return}this.loading=!0,this.errorMessage="";let t=this.userForm.value,e={first_name:t.first_name,last_name:t.last_name,email:t.email,password:t.password,password_confirmation:t.password_confirmation,company_name:t.company_name,industry:t.industry||void 0,business_type:t.business_type||void 0,company_email:t.company_email||void 0,company_phone:t.company_phone||void 0,company_address:t.company_address||void 0,logo:this.selectedLogo||void 0};this.adminUsersService.createUser(e).subscribe({next:r=>{r.success&&(this.toastService.success("User and company created successfully"),this.router.navigate(["/admin/users"])),this.loading=!1},error:r=>{if(this.loading=!1,this.errorMessage=r.error?.message||"Failed to create user. Please try again.",r.error?.errors){let d=r.error.errors;Object.keys(d).forEach(g=>{let V=this.userForm.get(g);V&&V.setErrors({serverError:d[g][0]})})}}})}onCancel(){this.router.navigate(["/admin/users"])}static \u0275fac=function(e){return new(e||o)(b(J),b(M),b(T),b(F),b(Ne))};static \u0275cmp=C({type:o,selectors:[["app-create-user"]],decls:102,vars:29,consts:[[1,"p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600","mt-1"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"bg-white","rounded-lg","shadow","p-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","text","formControlName","first_name",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["class","text-red-600 text-sm mt-1",4,"ngIf"],["type","text","formControlName","last_name",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","email","formControlName","email",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","password","formControlName","password",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],[1,"text-xs","text-gray-500","mt-1"],["type","password","formControlName","password_confirmation",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50","cursor-pointer","flex","items-center","gap-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],["type","file","id","logo","accept","image/jpeg,image/png,image/webp",1,"hidden",3,"change"],["class","mt-4 relative inline-block",4,"ngIf"],["type","text","formControlName","company_name",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","text","formControlName","industry",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","text","formControlName","business_type",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","email","formControlName","company_email",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["type","text","formControlName","company_phone",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],[1,"md:col-span-2"],["formControlName","company_address","rows","3",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500"],["class","bg-red-50 border border-red-200 rounded-lg p-4",4,"ngIf"],[1,"flex","justify-end","gap-4"],["type","button",1,"px-6","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50","cursor-pointer",3,"click"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],[4,"ngIf"],[1,"text-red-600","text-sm","mt-1"],[1,"mt-4","relative","inline-block"],["alt","Logo preview",1,"w-32","h-32","object-contain","border","border-gray-300","rounded-lg",3,"src"],["type","button",1,"absolute","top-0","right-0","bg-red-500","text-white","rounded-full","w-6","h-6","flex","items-center","justify-center","hover:bg-red-600","cursor-pointer",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4"],[1,"text-red-600","text-sm"]],template:function(e,r){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"Create New User"),n(),i(4,"p",3),s(5,"Create a new user and company account"),n()(),i(6,"form",4),u("ngSubmit",function(){return r.onSubmit()}),i(7,"div",5)(8,"h2",6),s(9,"Basic Information"),n(),i(10,"div",7)(11,"div")(12,"label",8),s(13," First Name "),i(14,"span",9),s(15,"*"),n()(),c(16,"input",10),p(17,ii,2,1,"div",11),n(),i(18,"div")(19,"label",8),s(20," Last Name "),i(21,"span",9),s(22,"*"),n()(),c(23,"input",12),p(24,ni,2,1,"div",11),n(),i(25,"div")(26,"label",8),s(27," Email Address "),i(28,"span",9),s(29,"*"),n()(),c(30,"input",13),p(31,ri,2,1,"div",11),n(),i(32,"div")(33,"label",8),s(34," Password "),i(35,"span",9),s(36,"*"),n()(),c(37,"input",14),p(38,oi,2,1,"div",11),i(39,"div",15),s(40," Must be at least 8 characters with uppercase, lowercase, and a number "),n()(),i(41,"div")(42,"label",8),s(43," Confirm Password "),i(44,"span",9),s(45,"*"),n()(),c(46,"input",16),p(47,ai,2,1,"div",11),n()()(),i(48,"div",5)(49,"h2",6),s(50,"Company Information"),n(),i(51,"div",1)(52,"label",8),s(53,"Company Logo"),n(),i(54,"button",17),u("click",function(){return r.triggerLogoUpload()}),y(),i(55,"svg",18),c(56,"path",19),n(),s(57," Upload Logo "),n(),E(),i(58,"input",20),u("change",function(g){return r.onLogoSelected(g)}),n(),i(59,"div",15),s(60,"PNG, JPG up to 5MB. Recommended: 200x200px"),n(),p(61,si,5,1,"div",21),n(),i(62,"div",7)(63,"div")(64,"label",8),s(65," Company Name "),i(66,"span",9),s(67,"*"),n()(),c(68,"input",22),p(69,li,2,1,"div",11),n(),i(70,"div")(71,"label",8),s(72,"Industry"),n(),c(73,"input",23),p(74,di,2,1,"div",11),n(),i(75,"div")(76,"label",8),s(77,"Business Type"),n(),c(78,"input",24),p(79,mi,2,1,"div",11),n(),i(80,"div")(81,"label",8),s(82,"Email Address"),n(),c(83,"input",25),p(84,pi,2,1,"div",11),n(),i(85,"div")(86,"label",8),s(87,"Phone Number"),n(),c(88,"input",26),p(89,ci,2,1,"div",11),n(),i(90,"div",27)(91,"label",8),s(92,"Company Address"),n(),c(93,"textarea",28),p(94,ui,2,1,"div",11),n()()(),p(95,gi,3,1,"div",29),i(96,"div",30)(97,"button",31),u("click",function(){return r.onCancel()}),s(98," Cancel "),n(),i(99,"button",32),p(100,fi,2,0,"span",33)(101,vi,2,0,"span",33),n()()()()),e&2){let d,g,V,ne,re;a(6),l("formGroup",r.userForm),a(10),w("border-red-300",((d=r.userForm.get("first_name"))==null?null:d.invalid)&&((d=r.userForm.get("first_name"))==null?null:d.touched)),a(),l("ngIf",r.getFieldError("first_name")),a(6),w("border-red-300",((g=r.userForm.get("last_name"))==null?null:g.invalid)&&((g=r.userForm.get("last_name"))==null?null:g.touched)),a(),l("ngIf",r.getFieldError("last_name")),a(6),w("border-red-300",((V=r.userForm.get("email"))==null?null:V.invalid)&&((V=r.userForm.get("email"))==null?null:V.touched)),a(),l("ngIf",r.getFieldError("email")),a(6),w("border-red-300",((ne=r.userForm.get("password"))==null?null:ne.invalid)&&((ne=r.userForm.get("password"))==null?null:ne.touched)),a(),l("ngIf",r.getFieldError("password")),a(8),w("border-red-300",r.getPasswordConfirmationError()),a(),l("ngIf",r.getPasswordConfirmationError()),a(14),l("ngIf",r.logoPreview),a(7),w("border-red-300",((re=r.userForm.get("company_name"))==null?null:re.invalid)&&((re=r.userForm.get("company_name"))==null?null:re.touched)),a(),l("ngIf",r.getFieldError("company_name")),a(5),l("ngIf",r.getFieldError("industry")),a(5),l("ngIf",r.getFieldError("business_type")),a(5),l("ngIf",r.getFieldError("company_email")),a(5),l("ngIf",r.getFieldError("company_phone")),a(5),l("ngIf",r.getFieldError("company_address")),a(),l("ngIf",r.errorMessage),a(4),l("disabled",r.loading),a(),l("ngIf",!r.loading),a(),l("ngIf",r.loading)}},dependencies:[S,I,Y,z,j,D,$,q,W],encapsulation:2})};var be=class o{constructor(t,e){this.router=t;this.adminAuthService=e}canActivate(){return this.adminAuthService.isAuthenticated()?!0:(this.router.navigate(["/admin/login"]),!1)}static \u0275fac=function(e){return new(e||o)(N(M),N(O))};static \u0275prov=G({token:o,factory:o.\u0275fac,providedIn:"root"})};var _i=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:ue},{path:"",component:ge,canActivate:[be],children:[{path:"dashboard",component:fe},{path:"users",component:_e},{path:"users/create",component:he},{path:"users/:id",component:xe},{path:"",redirectTo:"dashboard",pathMatch:"full"}]}],ye=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=le({type:o});static \u0275inj=se({imports:[Q.forChild(_i),Q]})};var Xe=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=le({type:o});static \u0275inj=se({imports:[S,ye]})};export{Xe as AdminModule};
