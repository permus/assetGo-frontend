import{a as m}from"./chunk-6WXWVH7L.js";import{E as u}from"./chunk-EZ3G6TVP.js";import{U as n,X as o,ba as i,g as s,r as p}from"./chunk-FQB2CJ4H.js";var a=class r{http=i(u);base=m.apiUrl;modulesEnabled$=new s({});getCompany(){return this.http.get(`${this.base}/company`)}updateCompany(e){return this.http.put(`${this.base}/company`,e)}updateCurrency(e){return this.http.put(`${this.base}/settings/currency`,{currency:e})}uploadCompanyLogo(e){let t=new FormData;return t.append("logo",e),this.http.post(`${this.base}/settings/company/logo`,t)}listModules(){return this.http.get(`${this.base}/settings/modules`).pipe(n(e=>this.pushModulesEnabled(e?.data?.modules||[])))}enableModule(e){return this.http.post(`${this.base}/settings/modules/${e}/enable`,{}).pipe(n(()=>this.refreshModulesEnabled().subscribe()))}disableModule(e){return this.http.post(`${this.base}/settings/modules/${e}/disable`,{}).pipe(n(()=>this.refreshModulesEnabled().subscribe()))}getPreferences(){return this.http.get(`${this.base}/settings/preferences`)}updatePreferences(e){return this.http.put(`${this.base}/settings/preferences`,e)}getModulesEnabled$(){return this.modulesEnabled$.asObservable()}refreshModulesEnabled(){return this.listModules()}pushModulesEnabled(e){let t={};for(let l of e)t[l.key]=!!l.is_enabled;this.modulesEnabled$.next(t)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var c=class r{settings=i(a);currency$=new s("USD");currencySymbols={USD:"$",AED:"\u062F.\u0625"};refreshFromServer(){return this.settings.getCompany().pipe(p(e=>e?.data?.company?.currency||"USD"),n(e=>this.currency$.next(e)))}get$(){return this.currency$.asObservable()}getCurrent(){return this.currency$.getValue()}getSymbol(){let e=this.getCurrent();return this.currencySymbols[e]||e}format(e){let t=Number(e??0);return isFinite(t)?`${this.getSymbol()}${t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:`${this.getSymbol()}0.00`}static \u0275fac=function(t){return new(t||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};export{a,c as b};
