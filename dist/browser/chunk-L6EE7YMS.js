import{a as y}from"./chunk-K66UBESR.js";import"./chunk-VPBFQCHB.js";import{k as S,l as x,v as b}from"./chunk-5VOM2S6M.js";import{Cb as s,Db as g,La as r,Qa as v,Qb as a,Rb as c,Sb as f,Tb as _,Za as h,cb as u,jb as m,lb as o,tb as n,ub as l}from"./chunk-ZGDM2LZY.js";import"./chunk-EQDQRRRY.js";function I(d,i){d&1&&(n(0,"div",9),a(1,"No items."),l())}function E(d,i){if(d&1&&(n(0,"div",12)(1,"div",13)(2,"div")(3,"div",14),a(4),l(),n(5,"div",15),a(6),l()(),n(7,"div",16),a(8),l()()()),d&2){let e=i.$implicit;r(4),f("Plan #",e.maintenance_plan_id,""),r(2),_("Status: ",e.status," \xB7 Due: ",e.due_date||"-",""),r(2),f("Priority: ",e.priority_id||"-","")}}function C(d,i){if(d&1&&(n(0,"div",10),u(1,E,9,4,"div",11),l()),d&2){let e=g();r(),m("ngForOf",e.filtered)}}var P=class d{constructor(i){this.api=i}all=[];filtered=[];filter="all";total=0;upcoming=0;inProgress=0;overdue=0;ngOnInit(){this.api.listSchedules({per_page:100}).subscribe(i=>{let e=Array.isArray(i?.data)?i.data:Array.isArray(i?.data?.schedules)?i.data.schedules:[];this.all=e,this.computeMetrics(),this.applyFilter()})}computeMetrics(){let i=new Date,e=new Date;e.setDate(i.getDate()+7),this.total=this.all.length,this.inProgress=this.all.filter(t=>t.status==="in_progress").length,this.overdue=this.all.filter(t=>t.due_date&&new Date(t.due_date)<i&&t.status!=="completed").length,this.upcoming=this.all.filter(t=>t.due_date&&new Date(t.due_date)>=i&&new Date(t.due_date)<=e).length}setFilter(i){this.filter=i,this.applyFilter()}applyFilter(){let i=new Date;this.filter==="all"?this.filtered=this.all:this.filter==="scheduled"?this.filtered=this.all.filter(e=>e.status==="scheduled"):this.filter==="in_progress"?this.filtered=this.all.filter(e=>e.status==="in_progress"):this.filter==="overdue"&&(this.filtered=this.all.filter(e=>e.due_date&&new Date(e.due_date)<i&&e.status!=="completed"))}static \u0275fac=function(e){return new(e||d)(v(y))};static \u0275cmp=h({type:d,selectors:[["app-scheduled-page"]],decls:34,vars:14,consts:[[1,"text-xl","font-semibold","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3","mb-4"],[1,"rounded-xl","border","p-4"],[1,"text-gray-500","text-sm"],[1,"text-2xl","font-semibold"],[1,"flex","gap-2","mb-3"],[1,"btn",3,"click"],["class","rounded-xl border p-8 text-center text-gray-500",4,"ngIf"],["class","space-y-2",4,"ngIf"],[1,"rounded-xl","border","p-8","text-center","text-gray-500"],[1,"space-y-2"],["class","rounded-xl border p-3",4,"ngFor","ngForOf"],[1,"rounded-xl","border","p-3"],[1,"flex","justify-between"],[1,"font-medium"],[1,"text-sm","text-gray-500"],[1,"text-sm"]],template:function(e,t){e&1&&(n(0,"h2",0),a(1,"Preventive Maintenance \u2014 Scheduled"),l(),n(2,"div",1)(3,"div",2)(4,"div",3),a(5,"Total Scheduled"),l(),n(6,"div",4),a(7),l()(),n(8,"div",2)(9,"div",3),a(10,"Upcoming (7d)"),l(),n(11,"div",4),a(12),l()(),n(13,"div",2)(14,"div",3),a(15,"In Progress"),l(),n(16,"div",4),a(17),l()(),n(18,"div",2)(19,"div",3),a(20,"Overdue"),l(),n(21,"div",4),a(22),l()()(),n(23,"div",5)(24,"button",6),s("click",function(){return t.setFilter("all")}),a(25,"All"),l(),n(26,"button",6),s("click",function(){return t.setFilter("scheduled")}),a(27,"Scheduled"),l(),n(28,"button",6),s("click",function(){return t.setFilter("in_progress")}),a(29,"In Progress"),l(),n(30,"button",6),s("click",function(){return t.setFilter("overdue")}),a(31,"Overdue"),l()(),u(32,I,2,0,"div",7)(33,C,2,1,"div",8)),e&2&&(r(7),c(t.total),r(5),c(t.upcoming),r(5),c(t.inProgress),r(5),c(t.overdue),r(2),o("btn-primary",t.filter==="all"),r(2),o("btn-primary",t.filter==="scheduled"),r(2),o("btn-primary",t.filter==="in_progress"),r(2),o("btn-primary",t.filter==="overdue"),r(2),m("ngIf",t.filtered.length===0),r(),m("ngIf",t.filtered.length>0))},dependencies:[b,S,x],encapsulation:2})};export{P as ScheduledPageComponent};
