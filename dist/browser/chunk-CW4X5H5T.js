import{a as f}from"./chunk-47ABMRM7.js";import{F as p}from"./chunk-CDW6MD7D.js";import{U as c,X as i,ba as l,c as a,g as o}from"./chunk-ZHYBNXXX.js";import{a as t,b as n}from"./chunk-EQDQRRRY.js";var u=class s{http=l(p);apiUrl=f.apiUrl;preferencesSubject=new o({email_notifications:!0,push_notifications:!0,maintenance_alerts:!0,work_order_updates:!0,dashboard_layout:"grid",items_per_page:20,auto_refresh:!1,compact_view:!1,show_avatars:!0,dark_mode:!1});preferences$=this.preferencesSubject.asObservable();constructor(){this.loadPreferences()}loadPreferences(){let e=localStorage.getItem("app.preferences");if(e)try{let r=JSON.parse(e);this.preferencesSubject.next(t(t({},this.preferencesSubject.value),r)),this.applyPreferences(r)}catch(r){console.error("Failed to load preferences:",r)}}getPreferences(){return this.preferencesSubject.value}updatePreferences(e){let r=t(t({},this.preferencesSubject.value),e);this.preferencesSubject.next(r),localStorage.setItem("app.preferences",JSON.stringify(r)),this.applyPreferences(r)}applyPreferences(e){e.dark_mode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),e.compact_view?document.documentElement.classList.add("compact-mode"):document.documentElement.classList.remove("compact-mode"),e.rtl?document.documentElement.setAttribute("dir","rtl"):document.documentElement.setAttribute("dir","ltr")}get(e){return this.preferencesSubject.value[e]}set(e,r){let d=n(t({},this.preferencesSubject.value),{[e]:r});this.updatePreferences(d)}syncing=!1;syncFromBackend(){return this.syncing?new a(e=>{e.next({success:!0,data:this.preferencesSubject.value}),e.complete()}):(this.syncing=!0,this.http.get(`${this.apiUrl}/settings/preferences`).pipe(c(()=>{this.syncing=!1})))}saveToBackend(e){return this.http.put(`${this.apiUrl}/settings/preferences`,e)}static \u0275fac=function(r){return new(r||s)};static \u0275prov=i({token:s,factory:s.\u0275fac,providedIn:"root"})};export{u as a};
