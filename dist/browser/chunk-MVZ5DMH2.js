import{a as h}from"./chunk-6WXWVH7L.js";import{F as u}from"./chunk-CDW6MD7D.js";import{X as g,aa as d}from"./chunk-ZHYBNXXX.js";import{a as p,f as c}from"./chunk-EQDQRRRY.js";var f=class m{constructor(e){this.http=e}MAX_SIZE=10*1024*1024;ALLOWED=["image/png","image/jpeg","image/jpg"];getAuthHeaders(){let e=localStorage.getItem("token");return{headers:p({"Content-Type":"application/json"},e?{Authorization:`Bearer ${e}`}:{})}}validate(e){return this.ALLOWED.includes(e.type)?e.size>this.MAX_SIZE?{ok:!1,reason:"File exceeds 10MB"}:{ok:!0}:{ok:!1,reason:"Only PNG/JPG allowed"}}toDataUrl(e){return c(this,null,function*(){let i=yield this.compressImage(e);return new Promise((r,n)=>{let o=new FileReader;o.onload=()=>r(o.result),o.onerror=s=>n(s),o.readAsDataURL(i)})})}compressImage(e,i=.8){return c(this,null,function*(){return new Promise(r=>{let n=document.createElement("canvas"),o=n.getContext("2d"),s=new Image;s.onload=()=>{let{width:t,height:a}=s;t>a?t>2048&&(a=a*2048/t,t=2048):a>2048&&(t=t*2048/a,a=2048),n.width=t,n.height=a,o.drawImage(s,0,0,t,a),n.toBlob(l=>{r(l?new File([l],e.name,{type:"image/jpeg"}):e)},"image/jpeg",i)},s.src=URL.createObjectURL(e)})})}analyze(e){let i=e.map(r=>r.replace(/^data:image\/\w+;base64,/,""));return this.http.post(`${h.apiUrl}/ai/image-recognition/analyze`,{images:i},this.getAuthHeaders())}static \u0275fac=function(i){return new(i||m)(d(u))};static \u0275prov=g({token:m,factory:m.\u0275fac,providedIn:"root"})};export{f as a};
