import{a as M,b as L}from"./chunk-7GLOR2ND.js";import"./chunk-PSU7LOXN.js";import{a as I}from"./chunk-RF5RBUBT.js";import{a as F}from"./chunk-2MFR7IWU.js";import{A as N,C as q,c as T,d as p,e as P,f as A,j,o as V,r as G,x as z}from"./chunk-E3TUIQ6F.js";import"./chunk-47ABMRM7.js";import{f as C}from"./chunk-GBVAJLSS.js";import{l as E}from"./chunk-SXJTW2OO.js";import{Gb as e,Hb as t,Ib as d,Pb as v,Qb as g,Ua as k,Xa as a,ab as w,ba as b,bc as s,cc as h,dc as y,jb as _,ka as c,la as f,ob as u,wb as l,yb as S}from"./chunk-XGV57TRJ.js";import"./chunk-EQDQRRRY.js";function B(r,i){if(r&1&&(e(0,"div",37)(1,"p",38),s(2),t()()),r&2){let o=g();a(2),h(o.sessionMessage)}}function D(r,i){if(r&1&&(e(0,"div",39)(1,"div",40),c(),e(2,"svg",41),d(3,"path",42),t(),f(),e(4,"div",43)(5,"p",44),s(6,"Account Temporarily Locked"),t(),e(7,"p",45),s(8),t(),e(9,"div",46)(10,"div",47),s(11),t(),e(12,"span",48),s(13,"minute(s) remaining"),t()()()()()),r&2){let o=g();a(8),h(o.errorMessage),a(3),h(o.getLockoutMinutes())}}function O(r,i){if(r&1&&(e(0,"div",49)(1,"p",50),s(2),t()()),r&2){let o=g();a(2),h(o.errorMessage)}}function R(r,i){if(r&1&&(e(0,"div",51),s(1),t()),r&2){let o=g();a(),y(" ",o.getEmailErrorMessage()," ")}}function U(r,i){r&1&&(c(),e(0,"svg",52),d(1,"path",53)(2,"path",54),t())}function W(r,i){r&1&&(c(),e(0,"svg",52),d(1,"path",55),t())}function Z(r,i){if(r&1&&(e(0,"div",51),s(1),t()),r&2){let o=g();a(),y(" ",o.getPasswordErrorMessage()," ")}}function $(r,i){r&1&&(e(0,"span"),s(1,"Sign In"),t())}function J(r,i){r&1&&(e(0,"span",56),c(),e(1,"svg",57),d(2,"circle",58)(3,"path",59),t(),s(4," Signing In... "),t())}var H=class r{constructor(i,o,n){this.fb=i;this.router=o;this.authService=n;this.loginForm=this.fb.group({email:["",[p.required,p.email]],password:["",[p.required,p.minLength(8),p.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/)]]});let m=localStorage.getItem("session_message");m&&(this.sessionMessage=m,localStorage.removeItem("session_message"),setTimeout(()=>{this.sessionMessage=""},5e3))}loginForm;isLoading=!1;errorMessage="";isLocked=!1;lockoutTime=0;lockoutCountdown=0;lockoutInterval;showPassword=!1;sessionMessage="";currencyService=b(L);preferencesService=b(I);settingsService=b(M);ngOnInit(){this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"])}toggleMode(){this.router.navigate(["/register"])}onSubmit(){if(this.loginForm.invalid){Object.keys(this.loginForm.controls).forEach(i=>{this.loginForm.get(i)?.markAsTouched()});return}this.loginForm.valid&&!this.isLoading&&(this.isLoading=!0,this.errorMessage="",this.authService.login(this.loginForm.value).subscribe({next:i=>{i.success?(this.authService.initializeAppServices(this.currencyService,this.preferencesService,this.settingsService),this.router.navigate(["/dashboard"])):this.errorMessage=i.message||"Login failed",this.isLoading=!1},error:i=>{let o=i.error;i.status===429?(this.isLocked=!0,this.errorMessage=o?.message||"Too many login attempts. Please try again later.",o?.retry_after&&(this.lockoutCountdown=o.retry_after,this.startLockoutTimer())):i.status===403?this.errorMessage=o?.message||"Access forbidden":this.errorMessage=o?.message||"An error occurred during login",this.isLoading=!1}}))}startLockoutTimer(){this.lockoutInterval&&clearInterval(this.lockoutInterval),this.lockoutInterval=setInterval(()=>{this.lockoutCountdown--,this.lockoutCountdown<=0&&(clearInterval(this.lockoutInterval),this.isLocked=!1,this.errorMessage="",this.lockoutCountdown=0)},1e3)}getLockoutMinutes(){return Math.ceil(this.lockoutCountdown/60)}togglePasswordVisibility(){this.showPassword=!this.showPassword}goToForgotPassword(){this.router.navigate(["/forgot-password"])}getEmailErrorMessage(){let i=this.loginForm.get("email");return i?.hasError("required")&&i?.touched?"Email is required":i?.hasError("email")&&i?.touched?"Please provide a valid email address":""}getPasswordErrorMessage(){let i=this.loginForm.get("password");return i?.hasError("required")&&i?.touched?"Password is required":i?.hasError("minlength")&&i?.touched?"Password must be at least 8 characters long":i?.hasError("pattern")&&i?.touched?"Password must contain at least one uppercase letter, one lowercase letter, and one number":""}ngOnDestroy(){this.lockoutInterval&&clearInterval(this.lockoutInterval)}static \u0275fac=function(o){return new(o||r)(w(N),w(C),w(F))};static \u0275cmp=_({type:r,selectors:[["app-login"]],decls:60,vars:17,consts:[[1,"min-h-screen","bg-gray-50","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"text-center"],[1,"flex","justify-center","mb-6"],[1,"flex","items-center","space-x-3"],["alt","AssetGo Logo",1,"h-20","w-auto",3,"src"],[1,"text-gray-600"],[1,"bg-white","rounded-2xl","shadow-lg","p-8","max-w-md","mx-auto"],[1,"text-center","mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],[1,"flex","mb-8","bg-gray-100","rounded-lg","p-1"],["type","button",1,"flex-1","py-2","px-4","text-center","font-medium","rounded-md","bg-blue-600","text-white","transition-all","cursor-pointer"],["type","button",1,"flex-1","py-2","px-4","text-center","font-medium","rounded-md","text-gray-600","hover:text-gray-800","transition-all","cursor-pointer",3,"click"],["class","mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",4,"ngIf"],["class","mb-4 p-4 bg-orange-50 border border-orange-200 rounded-lg",4,"ngIf"],["class","mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"space-y-6"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","email","type","email","formControlName","email","placeholder","Enter your email","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","placeholder-gray-400"],["class","text-red-500 text-xs mt-1",4,"ngIf"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["id","password","formControlName","password","placeholder","Enter your password","required","",1,"w-full","px-4","py-3","pr-10","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","placeholder-gray-400",3,"type"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","cursor-pointer","text-gray-400","hover:text-gray-600",3,"click"],["class","h-5 w-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-left"],["type","button",1,"text-blue-600","hover:text-blue-500","text-sm","font-medium","cursor-pointer",3,"click"],["type","submit",1,"w-full","bg-blue-600","text-white","py-3","px-4","rounded-lg","font-medium","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],[4,"ngIf"],["class","flex items-center justify-center",4,"ngIf"],[1,"flex","justify-center","space-x-12","text-sm","text-gray-500","mt-8"],[1,"flex","flex-col","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600","mb-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"],[1,"mb-4","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"text-blue-800","text-sm"],[1,"mb-4","p-4","bg-orange-50","border","border-orange-200","rounded-lg"],[1,"flex","items-start"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600","mt-0.5","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],[1,"flex-1"],[1,"text-orange-800","text-sm","font-medium"],[1,"text-orange-700","text-sm","mt-1"],[1,"mt-2","flex","items-center","space-x-2"],[1,"text-orange-900","font-bold","text-lg"],[1,"text-orange-700","text-sm"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-600","text-sm"],[1,"text-red-500","text-xs","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"],[1,"flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(o,n){if(o&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),d(5,"img",5),t()(),e(6,"p",6),s(7,"Enterprise Asset Management System"),t()(),e(8,"div",7)(9,"div",8)(10,"h2",9),s(11,"Welcome"),t(),e(12,"p",6),s(13,"Sign in to your account or create a new one"),t()(),e(14,"div",10)(15,"button",11),s(16," Sign In "),t(),e(17,"button",12),v("click",function(){return n.toggleMode()}),s(18," Sign Up "),t()(),u(19,B,3,1,"div",13)(20,D,14,2,"div",14)(21,O,3,1,"div",15),e(22,"form",16),v("ngSubmit",function(){return n.onSubmit()}),e(23,"div",17)(24,"div")(25,"label",18),s(26,"Email"),t(),d(27,"input",19),u(28,R,2,1,"div",20),t(),e(29,"div")(30,"label",21),s(31,"Password"),t(),e(32,"div",22),d(33,"input",23),e(34,"button",24),v("click",function(){return n.togglePasswordVisibility()}),u(35,U,3,0,"svg",25)(36,W,2,0,"svg",25),t()(),u(37,Z,2,1,"div",20),t(),e(38,"div",26)(39,"button",27),v("click",function(){return n.goToForgotPassword()}),s(40," Forgot password? "),t()(),e(41,"button",28),u(42,$,2,0,"span",29)(43,J,5,0,"span",30),t()()()(),e(44,"div",31)(45,"div",32),c(),e(46,"svg",33),d(47,"path",34),t(),f(),e(48,"span"),s(49,"Secure"),t()(),e(50,"div",32),c(),e(51,"svg",33),d(52,"path",35),t(),f(),e(53,"span"),s(54,"Enterprise"),t()(),e(55,"div",32),c(),e(56,"svg",33),d(57,"path",36),t(),f(),e(58,"span"),s(59,"Multi-tenant"),t()()()()()),o&2){let m,x;a(5),l("src","images/logo.png",k),a(14),l("ngIf",n.sessionMessage),a(),l("ngIf",n.isLocked&&n.lockoutCountdown>0),a(),l("ngIf",n.errorMessage&&!n.isLocked),a(),l("formGroup",n.loginForm),a(5),S("border-red-300",((m=n.loginForm.get("email"))==null?null:m.invalid)&&((m=n.loginForm.get("email"))==null?null:m.touched)),a(),l("ngIf",n.getEmailErrorMessage()),a(5),S("border-red-300",((x=n.loginForm.get("password"))==null?null:x.invalid)&&((x=n.loginForm.get("password"))==null?null:x.touched)),l("type",n.showPassword?"text":"password"),a(2),l("ngIf",!n.showPassword),a(),l("ngIf",n.showPassword),a(),l("ngIf",n.getPasswordErrorMessage()),a(4),l("disabled",n.loginForm.invalid||n.isLoading||n.isLocked),a(),l("ngIf",!n.isLoading),a(),l("ngIf",n.isLoading)}},dependencies:[E,q,j,T,P,A,z,V,G],encapsulation:2})};export{H as LoginComponent};
