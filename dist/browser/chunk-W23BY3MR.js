import{b as ne,c as j,d as ae,e as re,f as oe}from"./chunk-NDTQ3VTJ.js";import{a as ie}from"./chunk-L3DH7QEC.js";import{g as D}from"./chunk-F657IUEW.js";import"./chunk-J2L6YCTJ.js";import{a as te}from"./chunk-6WXWVH7L.js";import{F as ee,j as K,k as X,l as Y,x as Z}from"./chunk-46FGEGCL.js";import{Gb as e,Hb as i,Ib as s,Jb as W,Kb as F,Qb as U,R as N,S as E,Wb as B,X as O,Xa as o,Xb as P,Y as g,Yb as Q,aa as R,ab as L,ac as q,ba as V,bc as a,cc as c,dc as f,f as z,jb as G,ka as m,kb as b,la as v,ob as p,vc as J,wb as d,xb as $,z as H}from"./chunk-Z5DG7LDR.js";import"./chunk-EQDQRRRY.js";var _=class n{constructor(t){this.http=t}base=`${te.apiUrl}`;getDashboardData(){return this.http.get(`${this.base}/dashboard`)}static \u0275fac=function(r){return new(r||n)(R(ee))};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})};var me=["assetHealthChart"];function ce(n,t){n&1&&(e(0,"div",50)(1,"span",51),a(2,"No insights generated yet"),i(),e(3,"button",52),m(),e(4,"svg",53),s(5,"path",54),i(),v(),e(6,"span"),a(7,"Generate New Insights"),i()()())}function he(n,t){n&1&&(m(),s(0,"path",68))}function pe(n,t){n&1&&(m(),s(0,"path",69))}function ue(n,t){n&1&&(m(),s(0,"path",70))}function ve(n,t){n&1&&(m(),s(0,"path",71))}function fe(n,t){n&1&&(m(),s(0,"path",72))}function ge(n,t){n&1&&(m(),s(0,"path",73))}function be(n,t){n&1&&(m(),s(0,"path",74))}function _e(n,t){n&1&&(m(),s(0,"path",75))}function xe(n,t){if(n&1&&(e(0,"div",43)(1,"div",55)(2,"h3",56),a(3),i(),e(4,"div",57),m(),e(5,"svg",58),p(6,he,1,0,"path",59)(7,pe,1,0,"path",60)(8,ue,1,0,"path",61)(9,ve,1,0,"path",62)(10,fe,1,0,"path",63)(11,ge,1,0,"path",64)(12,be,1,0,"path",65)(13,_e,1,0,"path",66),i()()(),v(),e(14,"div",67),a(15),i(),e(16,"div",51),a(17),i()()),n&2){let r=t.$implicit;o(3),c(r.title),o(),d("ngClass","w-8 h-8 rounded-lg flex items-center justify-center bg-"+r.color+"-100"),o(),d("ngClass","text-"+r.color+"-600"),o(),d("ngIf",r.icon==="info"),o(),d("ngIf",r.icon==="check"),o(),d("ngIf",r.icon==="warning"),o(),d("ngIf",r.icon==="dollar"),o(),d("ngIf",r.icon==="trending"),o(),d("ngIf",r.icon==="clock"),o(),d("ngIf",r.icon==="clipboard"),o(),d("ngIf",r.icon==="shield"),o(2),c(r.value),o(2),c(r.subtitle)}}function ye(n,t){if(n&1&&(W(0),e(1,"p",76)(2,"span",77),a(3),i(),a(4," pending transfer approval(s)"),i(),F()),n&2){let r=U();o(3),c(r.data==null?null:r.data.transfer_approvals)}}function Se(n,t){n&1&&(e(0,"p",5),a(1,"No pending transfer approvals"),i())}function ke(n,t){n&1&&(e(0,"div",43)(1,"div",55)(2,"div",25),m(),e(3,"svg",78),s(4,"path",54),i(),v(),e(5,"h3",47),a(6,"AI Insights"),i()(),e(7,"span",79),a(8,"AI Active"),i()(),e(9,"p",80),a(10,"Smart recommendations"),i(),e(11,"button",81),m(),e(12,"svg",82),s(13,"path",83),i()()())}j.register(ae,oe,re,ne);var x=class n{constructor(t){this.dashboardApi=t}destroy$=new z;prefsService=V(ie);loading=!1;data=null;assetHealthChartRef;assetHealthChart=null;showAiInsights=!1;refreshInterval;archiveAnalytics={totalAssets:0,activeAssets:0,archivedAssets:0,archivedByMonth:[]};stats=[{title:"Total Assets",value:"24",subtitle:"Live data",icon:"info",color:"blue"},{title:"Active Assets",value:"23",subtitle:"95.8% operational",icon:"check",color:"green"},{title:"Critical Alerts",value:"1",subtitle:"1 require immediate attention",icon:"warning",color:"orange"},{title:"Monthly Investment",value:"$0",subtitle:"No data available",icon:"dollar",color:"purple"},{title:"Asset Utilization",value:"--",subtitle:"No data available",icon:"trending",color:"blue"},{title:"Scheduled Maintenance",value:"0",subtitle:"Next 30 days",icon:"clock",color:"teal"},{title:"Active Work Orders",value:"2",subtitle:"1 high priority",icon:"clipboard",color:"yellow"},{title:"Archived Assets",value:"0",subtitle:"In archive",icon:"shield",color:"gray"}];workOrders=[{title:"Total Work Orders",value:2},{title:"Scheduled This Week",value:0},{title:"Overdue",value:1}];ngOnInit(){this.fetch(),this.prefsService.get("auto_refresh")&&this.startAutoRefresh()}ngOnDestroy(){this.stopAutoRefresh(),this.destroy$.next(),this.destroy$.complete()}startAutoRefresh(){this.stopAutoRefresh(),this.refreshInterval=setInterval(()=>{this.fetch()},3e4)}stopAutoRefresh(){this.refreshInterval&&clearInterval(this.refreshInterval)}fetch(){this.loading=!0,this.dashboardApi.getDashboardData().pipe(E(this.destroy$)).subscribe({next:t=>{this.loading=!1,this.data=t?.data,this.hydrateStats(),setTimeout(()=>this.renderAssetHealthChart(),0)},error:()=>{this.loading=!1}})}autoRefresh(){H(6e4,6e4).pipe(E(this.destroy$),N(()=>this.dashboardApi.getDashboardData())).subscribe({next:t=>{this.data=t?.data,this.hydrateStats()}})}hydrateStats(){let t=this.data;this.stats=[{title:"Total Assets",value:String(t.total_assets??"--"),subtitle:t.total_assets!=null?"Live data":"-- No data available",icon:"info",color:"blue"},{title:"Active Assets",value:String(t.active_assets??"--"),subtitle:t.active_assets!=null?"Active assets":"-- No data available",icon:"check",color:"green"},{title:"Critical Alerts",value:String(t.critical_alerts??"--"),subtitle:t.critical_alerts!=null?"Require attention":"-- No data available",icon:"warning",color:"orange"},{title:"Monthly Investment",value:`$${t.monthly_investment??0}`,subtitle:"Monthly spend",icon:"dollar",color:"purple"},{title:"Asset Utilization",value:t.asset_utilization!=null?`${t.asset_utilization}%`:"--",subtitle:t.asset_utilization!=null?"Utilization":"-- No data available",icon:"trending",color:"blue"},{title:"Scheduled Maintenance",value:String(t.scheduled_maintenance??0),subtitle:"Next 30 days",icon:"clock",color:"teal"},{title:"Active Work Orders",value:String(t.active_work_orders??0),subtitle:"Open WOs",icon:"clipboard",color:"yellow"},{title:"Archived Assets",value:String(t.archived_assets??0),subtitle:`${t.archived_assets??0} assets in archive`,icon:"shield",color:"gray"}],this.workOrders=[{title:"Total Work Orders",value:t.maintenance_insights.total_work_orders},{title:"Scheduled This Week",value:t.maintenance_insights.scheduled_this_week},{title:"Overdue",value:t.maintenance_insights.overdue}]}renderAssetHealthChart(){if(!this.data||!this.assetHealthChartRef)return;let t=this.assetHealthChartRef.nativeElement.getContext("2d");if(!t)return;this.assetHealthChart&&(this.assetHealthChart.destroy(),this.assetHealthChart=null);let r=Math.max(0,Number(this.data.asset_health.total||0)),l=Math.min(r,Math.max(0,Number(this.data.asset_health.active||0))),h=Math.min(r,Math.max(0,Number(this.data.asset_health.uncategorized||0))),u=Math.max(0,r-l-h);this.assetHealthChart=new j(t,{type:"doughnut",data:{labels:["Active","Uncategorized","Others"],datasets:[{data:[l,h,u],backgroundColor:["#22c55e","#3b82f6","#e5e7eb"],borderWidth:0}]},options:{responsive:!0,cutout:"70%",rotation:-90,plugins:{legend:{display:!1},tooltip:{enabled:!0}}}})}get activeAssets(){return Number(this.data?.asset_health.active??0)}get totalAssets(){return Number(this.data?.asset_health.total??0)}get activePercent(){let t=this.totalAssets;return t?Math.round(this.activeAssets/t*100):0}static \u0275fac=function(r){return new(r||n)(L(_))};static \u0275cmp=G({type:n,selectors:[["app-dashboard"]],viewQuery:function(r,l){if(r&1&&B(me,5),r&2){let h;P(h=Q())&&(l.assetHealthChartRef=h.first)}},standalone:!1,decls:97,vars:17,consts:[["assetHealthChart",""],["noApprovals",""],[1,"p-6"],[1,"flex","items-center","justify-between","mb-8"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],["class","flex items-center space-x-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6","mb-8"],["class","bg-white rounded-lg p-6 shadow-sm border border-gray-200",4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","bg-white","rounded-lg","p-6","shadow-sm","border","border-gray-200"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-1"],[1,"text-sm","text-gray-600"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8"],[1,"text-sm","font-medium","text-gray-700","mb-4"],[1,"flex","items-center","justify-center","mb-4"],[1,"relative","w-40","h-40"],["width","160","height","160"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"text-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"space-y-2"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-2"],[1,"w-3","h-3","bg-green-500","rounded-full"],[1,"text-sm","text-gray-700"],[1,"text-sm","text-gray-900"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"bg-green-500","h-2","rounded-full"],[1,"text-right","text-xs","text-gray-500"],[1,"flex","items-center","justify-between","mt-4"],[1,"w-3","h-3","bg-blue-500","rounded-full"],[1,"text-center","mb-6"],[1,"text-4xl","font-bold","text-blue-600","mb-2"],[1,"space-y-4"],[1,"flex","justify-between","items-center"],[1,"text-sm","font-medium","text-green-600"],[1,"text-sm","font-medium","text-gray-900"],[1,"mt-6","space-y-3"],[1,"text-sm","font-medium","text-red-600"],[1,"space-y-6"],[1,"bg-white","rounded-lg","p-6","shadow-sm","border","border-gray-200"],[1,"flex","items-center","space-x-2","mb-4"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-green-600"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],[1,"text-lg","font-semibold","text-gray-900"],[4,"ngIf","ngIfElse"],["class","bg-white rounded-lg p-6 shadow-sm border border-gray-200",4,"ngIf"],[1,"flex","items-center","space-x-4"],[1,"text-sm","text-gray-500"],[1,"bg-blue-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-blue-700","flex","items-center","space-x-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-sm","font-medium","text-gray-600"],[3,"ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4",3,"ngClass"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z",4,"ngIf"],[1,"text-2xl","font-bold","text-gray-900","mb-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"],[1,"text-gray-700"],[1,"font-semibold"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-600"],[1,"text-xs","bg-green-100","text-green-800","px-2","py-1","rounded-full"],[1,"text-sm","text-gray-600","mb-4"],[1,"fixed","bottom-6","right-6","w-12","h-12","bg-blue-600","text-white","rounded-full","shadow-lg","hover:bg-blue-700","flex","items-center","justify-center","cursor-pointer"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"]],template:function(r,l){if(r&1&&(e(0,"div",2)(1,"div",3)(2,"div")(3,"h1",4),a(4,"Asset Intelligence Dashboard"),i(),e(5,"p",5),a(6,"Real-time insights and comprehensive asset management overview"),i()(),p(7,ce,8,0,"div",6),i(),e(8,"div",7),p(9,xe,18,13,"div",8),i(),e(10,"div",9)(11,"div",10)(12,"div",11)(13,"div")(14,"h3",12),a(15,"Asset & Maintenance Analytics"),i(),e(16,"p",13),a(17,"Comprehensive portfolio distribution and maintenance trends"),i()()(),e(18,"div",14)(19,"div")(20,"h4",15),a(21,"Asset Health Status"),i(),e(22,"div",16)(23,"div",17),s(24,"canvas",18,0),e(26,"div",19)(27,"div",20)(28,"div",21),a(29),i(),e(30,"div",22),a(31,"Total"),i()()()()(),e(32,"div",23)(33,"div",24)(34,"div",25),s(35,"div",26),e(36,"span",27),a(37,"Active"),i()(),e(38,"div",28),a(39),i()(),e(40,"div",29),s(41,"div",30),i(),e(42,"div",31),a(43),i(),e(44,"div",32)(45,"div",25),s(46,"div",33),e(47,"span",27),a(48,"Uncategorized"),i()(),e(49,"div",28),a(50),i()()()(),e(51,"div")(52,"h4",15),a(53,"Maintenance Insights"),i(),e(54,"div",34)(55,"div",35),a(56),i(),e(57,"div",13),a(58,"Average Health Score"),i()(),e(59,"div",36)(60,"div",37)(61,"span",13),a(62,"Completion Rate"),i(),e(63,"span",38),a(64),i()(),e(65,"div",37)(66,"span",13),a(67,"Avg Days to Complete"),i(),e(68,"span",39),a(69),i()()(),e(70,"div",40)(71,"div",24)(72,"span",13),a(73,"Total Work Orders"),i(),e(74,"span",39),a(75),i()(),e(76,"div",24)(77,"span",13),a(78,"Scheduled This Week"),i(),e(79,"span",39),a(80),i()(),e(81,"div",24)(82,"span",13),a(83,"Overdue"),i(),e(84,"span",41),a(85),i()()()()()(),e(86,"div",42)(87,"div",43)(88,"div",44),m(),e(89,"svg",45),s(90,"path",46),i(),v(),e(91,"h3",47),a(92,"Transfer Approvals"),i()(),p(93,ye,5,1,"ng-container",48)(94,Se,2,0,"ng-template",null,1,J),i(),p(96,ke,14,0,"div",49),i()()()),r&2){let h,u,S,k,w,I,C,M,A,se=q(95);o(7),d("ngIf",l.showAiInsights),o(2),d("ngForOf",l.stats),o(20),c((h=l.data==null?null:l.data.asset_health.total)!==null&&h!==void 0?h:0),o(10),f("",l.activeAssets," assets"),o(2),$("width",l.activePercent,"%"),o(2),f("",l.activePercent,"%"),o(7),c((u=l.data==null?null:l.data.asset_health.uncategorized)!==null&&u!==void 0?u:0),o(6),f("",(S=l.data==null?null:l.data.asset_health.average_health_score)!==null&&S!==void 0?S:0,"%"),o(8),f("",(k=l.data==null?null:l.data.maintenance_insights.completion_rate)!==null&&k!==void 0?k:0,"%"),o(5),c((w=l.data==null?null:l.data.maintenance_insights.avg_days_to_complete)!==null&&w!==void 0?w:0),o(6),c((I=l.data==null?null:l.data.maintenance_insights.total_work_orders)!==null&&I!==void 0?I:0),o(5),c((C=l.data==null?null:l.data.maintenance_insights.scheduled_this_week)!==null&&C!==void 0?C:0),o(5),c((M=l.data==null?null:l.data.maintenance_insights.overdue)!==null&&M!==void 0?M:0),o(8),d("ngIf",((A=l.data==null?null:l.data.transfer_approvals)!==null&&A!==void 0?A:0)>0)("ngIfElse",se),o(3),d("ngIf",l.showAiInsights)}},dependencies:[K,X,Y],encapsulation:2})};var we=[{path:"",component:x}],y=class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=b({type:n});static \u0275inj=g({imports:[D.forChild(we),D]})};var le=class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=b({type:n});static \u0275inj=g({imports:[Z,y]})};export{le as DashboardModule};
