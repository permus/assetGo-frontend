import{a as T}from"./chunk-7CRFZU2G.js";import{a as I}from"./chunk-GVXPQDBC.js";import"./chunk-MEXLA3FU.js";import{f as E}from"./chunk-4LZAODCJ.js";import"./chunk-YGU4T3V7.js";import{k as S,l as w,x as A}from"./chunk-HV2J6S7U.js";import{Gb as n,Hb as a,Ib as d,Mb as O,Pb as f,Qb as u,Ya as o,bb as h,bc as s,cc as v,dc as p,ec as k,ja as M,ka as C,kb as P,la as c,ma as g,pb as m,wb as l,xb as y,yb as x,zb as _}from"./chunk-RHVXZUNF.js";import"./chunk-EQDQRRRY.js";function F(r,e){r&1&&(n(0,"div",9),d(1,"div",10),n(2,"p"),s(3,"Loading your assignments..."),a()())}function V(r,e){r&1&&(n(0,"div",11),c(),n(1,"svg",12),d(2,"path",13),a(),g(),n(3,"h3"),s(4,"No Assignments Found"),a(),n(5,"p"),s(6,"You don't have any maintenance tasks assigned at the moment."),a()())}function j(r,e){if(r&1&&(n(0,"div",22),c(),n(1,"svg",23),d(2,"path",40),a(),g(),n(3,"span",25),s(4,"Estimated:"),a(),n(5,"span",26),s(6),a()()),r&2){let t=u().$implicit;o(6),p("",t.plan.estimeted_duration," minutes")}}function L(r,e){r&1&&(n(0,"div",41),c(),n(1,"svg",42),d(2,"path",43),a(),g(),n(3,"span",44),s(4,"Safety notes available"),a()())}function H(r,e){if(r&1){let t=O();n(0,"div",16)(1,"div",17)(2,"div",18)(3,"h3",19),s(4),a(),n(5,"span",20),s(6),a()()(),n(7,"div",21)(8,"div",22),c(),n(9,"svg",23),d(10,"path",24),a(),g(),n(11,"span",25),s(12,"Due Date:"),a(),n(13,"span",26),s(14),a()(),m(15,j,7,1,"div",27),n(16,"div",28)(17,"div",29)(18,"span",30),s(19,"Progress"),a(),n(20,"span",31),s(21),a()(),n(22,"div",32),d(23,"div",33),a(),n(24,"div",34)(25,"span"),s(26),a()()(),m(27,L,5,0,"div",35),a(),n(28,"div",36)(29,"button",37),f("click",function(){let b=M(t).$implicit,z=u(2);return C(z.startMaintenance(b))}),c(),n(30,"svg",38),d(31,"path",39),a(),s(32),a()()()}if(r&2){let t=e.$implicit,i=u(2);_(i.getStatusClass(t)),o(4),v((t.plan==null?null:t.plan.name)||"Maintenance Task"),o(),_(i.getStatusClass(t)),o(),p(" ",i.getStatusLabel(t)," "),o(8),v(i.formatDate(t.schedule==null?null:t.schedule.due_date)),o(),l("ngIf",t.plan==null?null:t.plan.estimeted_duration),o(6),p("",i.getCompletionPercentage(t),"%"),o(2),y("width",i.getCompletionPercentage(t),"%"),o(3),k("",(t.responses==null?null:t.responses.length)||0," / ",(t.checklist_items==null?null:t.checklist_items.length)||0," items completed"),o(),l("ngIf",t.plan==null?null:t.plan.safety_notes),o(2),l("disabled",i.isCompleted(t)),o(3),p(" ",i.isCompleted(t)?"Completed":i.getCompletionPercentage(t)>0?"Continue":"Start"," ")}}function N(r,e){if(r&1&&(n(0,"div",14),m(1,H,33,16,"div",15),a()),r&2){let t=u();o(),l("ngForOf",t.filteredAssignments)}}var D=class r{constructor(e,t,i){this.service=e;this.router=t;this.toastService=i}loading=!1;assignments=[];filteredAssignments=[];filter="all";ngOnInit(){this.loadAssignments()}loadAssignments(){this.loading=!0,this.service.getMyAssignments().subscribe({next:e=>{this.assignments=e.data,this.applyFilter(),this.loading=!1},error:e=>{console.error("Error loading assignments:",e),this.toastService.error("Failed to load assignments. Please try again."),this.loading=!1}})}applyFilter(){this.filter==="all"?this.filteredAssignments=this.assignments:this.filter==="pending"?this.filteredAssignments=this.assignments.filter(e=>!this.isCompleted(e)):this.filter==="completed"&&(this.filteredAssignments=this.assignments.filter(e=>this.isCompleted(e)))}setFilter(e){this.filter=e,this.applyFilter()}isCompleted(e){let t=e.checklist_items?.length||0,i=e.responses?.length||0;return t>0&&i===t}getCompletionPercentage(e){let t=e.checklist_items?.length||0;if(t===0)return 0;let i=e.responses?.length||0;return Math.round(i/t*100)}getStatusClass(e){return this.isCompleted(e)?"status-completed":this.isDueToday(e)?"status-due-today":this.isOverdue(e)?"status-overdue":"status-pending"}getStatusLabel(e){return this.isCompleted(e)?"Completed":this.isOverdue(e)?"Overdue":this.isDueToday(e)?"Due Today":"Pending"}isDueToday(e){if(!e.schedule?.due_date)return!1;let t=new Date().toDateString(),i=new Date(e.schedule.due_date).toDateString();return t===i}isOverdue(e){if(!e.schedule?.due_date)return!1;let t=new Date;return new Date(e.schedule.due_date)<t&&!this.isCompleted(e)}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}startMaintenance(e){this.router.navigate(["/maintenance/complete",e.id])}static \u0275fac=function(t){return new(t||r)(h(T),h(E),h(I))};static \u0275cmp=P({type:r,selectors:[["app-my-assignments-page"]],decls:16,vars:10,consts:[[1,"my-assignments-page"],[1,"page-header"],[1,"page-title"],[1,"page-subtitle"],[1,"filter-tabs"],[1,"filter-tab",3,"click"],["class","loading-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","assignments-grid",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"empty-state"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"empty-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"],[1,"assignments-grid"],["class","assignment-card",3,"class",4,"ngFor","ngForOf"],[1,"assignment-card"],[1,"card-header"],[1,"plan-info"],[1,"plan-name"],[1,"status-badge"],[1,"card-body"],[1,"info-row"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"info-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"info-label"],[1,"info-value"],["class","info-row",4,"ngIf"],[1,"progress-section"],[1,"progress-header"],[1,"progress-label"],[1,"progress-percentage"],[1,"progress-bar"],[1,"progress-fill"],[1,"checklist-count"],["class","safety-notes",4,"ngIf"],[1,"card-footer"],[1,"btn-start",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"btn-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"safety-notes"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"safety-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"safety-text"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"My Assigned Maintenance"),a(),n(4,"p",3),s(5,"Complete your assigned maintenance tasks and checklists"),a()(),n(6,"div",4)(7,"button",5),f("click",function(){return i.setFilter("all")}),s(8),a(),n(9,"button",5),f("click",function(){return i.setFilter("pending")}),s(10," Pending "),a(),n(11,"button",5),f("click",function(){return i.setFilter("completed")}),s(12," Completed "),a()(),m(13,F,4,0,"div",6)(14,V,7,0,"div",7)(15,N,2,1,"div",8),a()),t&2&&(o(7),x("active",i.filter==="all"),o(),p(" All (",i.assignments.length,") "),o(),x("active",i.filter==="pending"),o(2),x("active",i.filter==="completed"),o(2),l("ngIf",i.loading),o(),l("ngIf",!i.loading&&i.filteredAssignments.length===0),o(),l("ngIf",!i.loading&&i.filteredAssignments.length>0))},dependencies:[A,S,w],styles:[".my-assignments-page[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:32px}.page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1f2937;margin:0 0 8px}.page-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin:0}.filter-tabs[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:24px;border-bottom:2px solid #e5e7eb}.filter-tab[_ngcontent-%COMP%]{padding:12px 24px;background:none;border:none;border-bottom:3px solid transparent;color:#6b7280;font-weight:500;cursor:pointer;transition:all .2s;margin-bottom:-2px}.filter-tab[_ngcontent-%COMP%]:hover{color:#3b82f6}.filter-tab.active[_ngcontent-%COMP%]{color:#3b82f6;border-bottom-color:#3b82f6}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:64px 24px;color:#6b7280}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #e5e7eb;border-top-color:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin:0 auto 16px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:64px 24px;color:#6b7280}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{width:64px;height:64px;color:#d1d5db;margin:0 auto 16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#374151;margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:0}.assignments-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px}.assignment-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:2px solid #e5e7eb;overflow:hidden;transition:all .2s}.assignment-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.assignment-card.status-completed[_ngcontent-%COMP%]{border-color:#10b981;background:#f0fdf4}.assignment-card.status-overdue[_ngcontent-%COMP%]{border-color:#ef4444;background:#fef2f2}.assignment-card.status-due-today[_ngcontent-%COMP%]{border-color:#f59e0b;background:#fffbeb}.card-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #e5e7eb}.plan-info[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}.plan-name[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1f2937;margin:0;flex:1}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600;white-space:nowrap}.status-badge.status-completed[_ngcontent-%COMP%]{background:#10b981;color:#fff}.status-badge.status-pending[_ngcontent-%COMP%]{background:#6b7280;color:#fff}.status-badge.status-overdue[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.status-badge.status-due-today[_ngcontent-%COMP%]{background:#f59e0b;color:#fff}.card-body[_ngcontent-%COMP%]{padding:20px}.info-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-size:14px}.info-icon[_ngcontent-%COMP%]{width:18px;height:18px;color:#6b7280;flex-shrink:0}.info-label[_ngcontent-%COMP%]{font-weight:500;color:#6b7280}.info-value[_ngcontent-%COMP%]{color:#1f2937}.progress-section[_ngcontent-%COMP%]{margin:20px 0}.progress-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.progress-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#6b7280}.progress-percentage[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#3b82f6}.progress-bar[_ngcontent-%COMP%]{height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#3b82f6,#2563eb);transition:width .3s ease}.checklist-count[_ngcontent-%COMP%]{margin-top:8px;font-size:13px;color:#6b7280}.safety-notes[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;background:#fef3c7;border-radius:8px;margin-top:16px}.safety-icon[_ngcontent-%COMP%]{width:20px;height:20px;color:#f59e0b;flex-shrink:0}.safety-text[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#92400e}.card-footer[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #e5e7eb}.btn-start[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:12px 24px;background:#3b82f6;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s}.btn-start[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-1px)}.btn-start[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-start[_ngcontent-%COMP%]:disabled{background:#10b981;cursor:not-allowed;opacity:.8}.btn-start[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{width:20px;height:20px}@media (max-width: 768px){.assignments-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:24px}}"]})};export{D as MyAssignmentsPageComponent};
