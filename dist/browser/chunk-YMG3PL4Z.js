import{a as E}from"./chunk-UMFPZBKS.js";import{x as O}from"./chunk-2HMAJ7TT.js";import"./chunk-VUTA7ABU.js";import{k as P,v as k}from"./chunk-FMXY27HN.js";import{Db as w,La as l,Qa as _,Qb as i,Rb as u,Za as M,cb as v,ia as c,ib as x,ja as g,jb as f,kb as h,tb as e,ub as t,vb as s,wb as C,xb as y}from"./chunk-EBK772Q5.js";import"./chunk-EQDQRRRY.js";function T(r,a){if(r&1&&(C(0),s(1,"div",39),y()),r&2){let n=a.$implicit,o=a.index,d=w();l(),h("height",(n||0)*12,"%"),x("title",d.trendLabels[o]+": "+n)}}function L(r,a){if(r&1&&(e(0,"span"),i(1),t()),r&2){let n=a.$implicit;l(),u(n)}}function F(r,a){if(r&1&&(e(0,"div",40),s(1,"div",41),e(2,"div",42),i(3),t()()),r&2){let n=a.$implicit;l(),h("height",(n.value||0)*10,"%"),x("title",n.name+": "+n.value),l(2),u(n.name)}}function j(r,a){if(r&1&&(C(0),s(1,"div",43),y()),r&2){let n=a.$implicit,o=a.index,d=w();l(),h("height",n||0,"%"),x("title",d.monthlyCostsLabels[o]+": $"+n)}}function D(r,a){if(r&1&&(e(0,"span"),i(1),t()),r&2){let n=a.$implicit;l(),u(n)}}var A=class r{constructor(a){this.api=a}loading=!1;error=null;trendLabels=[];trendData=[];typeBreakdown=[];monthlyCostsLabels=[];monthlyCostsData=[];ngOnInit(){this.fetch()}fetch(){this.loading=!0,this.api.listSchedules({per_page:500}).subscribe({next:a=>{let n=Array.isArray(a?.data)?a.data:Array.isArray(a?.data?.schedules)?a.data.schedules:[],o={},d={};for(let m of n){let p=m.due_date?new Date(m.due_date):null,b=p&&!isNaN(p.getTime())?`${p.getFullYear()}-${String(p.getMonth()+1).padStart(2,"0")}`:"unknown";o[b]=(o[b]||0)+1,d[b]=(d[b]||0)+(m.cost||0)}this.trendLabels=Object.keys(o).sort(),this.trendData=this.trendLabels.map(m=>o[m]),this.monthlyCostsLabels=Object.keys(d).sort(),this.monthlyCostsData=this.monthlyCostsLabels.map(m=>d[m]);let S={preventive:0,corrective:0,emergency:0};for(let m of n)S.preventive++;this.typeBreakdown=Object.entries(S).map(([m,p])=>({name:m,value:p})),this.loading=!1},error:()=>{this.loading=!1,this.error="Failed to load analytics"}})}get totalCount(){let a=0;for(let n of this.trendData)a+=Number(n)||0;return a}static \u0275fac=function(n){return new(n||r)(_(E))};static \u0275cmp=M({type:r,selectors:[["app-analytics-page"]],decls:87,vars:6,consts:[[1,"min-h-screen","bg-gray-50","text-gray-900","p-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-xl","font-semibold"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-4","metrics-grid"],[1,"metric-card","info"],[1,"metric-header"],[1,"title"],[1,"badge"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","d","M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"],["stroke-linecap","round","stroke-linejoin","round","d","M4.867 19.125h.008v.008h-.008v-.008Z"],[1,"value"],[1,"hint"],[1,"metric-card","success"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","d","M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"],[1,"value","text-green-600"],[1,"metric-card","warning"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","d","M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],[1,"metric-card","danger"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","d","M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"panel"],[1,"panel-title"],[1,"grid","grid-cols-12","gap-1","text-xs","text-gray-400"],[1,"col-span-12","flex","items-end","h-48","space-x-2"],[4,"ngFor","ngForOf"],[1,"col-span-12","flex","justify-between","mt-2"],[1,"flex","items-end","h-48","space-x-3"],["class","w-12",4,"ngFor","ngForOf"],[1,"panel","mt-4"],[1,"panel-title","!mb-0"],[1,"text-sm","text-gray-500","mb-3"],[1,"list-none","text-sm","text-lg"],[1,"flex","items-center","gap-2","text-md","text-yellow-400","mb-2"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5"],[1,"flex","items-center","gap-2","text-md","text-gray-500"],[1,"bar"],[1,"w-12"],[1,"bar","bg-purple-500"],[1,"text-xs","text-center","mt-1"],[1,"bar","bg-emerald-500"]],template:function(n,o){n&1&&(e(0,"div",0)(1,"div",1)(2,"h1",2),i(3,"Preventive Maintenance Analytics"),t()(),e(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6),i(8,"Total Maintenance"),t(),e(9,"div",7),c(),e(10,"svg",8),s(11,"path",9)(12,"path",10),t()()(),g(),e(13,"div",11),i(14),t(),e(15,"div",12),i(16,"0 upcoming"),t()(),e(17,"div",13)(18,"div",5)(19,"div",6),i(20,"Preventive Ratio"),t(),e(21,"div",7),c(),e(22,"svg",14),s(23,"path",15),t()()(),g(),e(24,"div",16),i(25,"0.0%"),t(),e(26,"div",12),i(27,"Target: 80%"),t()(),e(28,"div",17)(29,"div",5)(30,"div",6),i(31,"Avg Cost"),t(),e(32,"div",7),c(),e(33,"svg",18),s(34,"path",19),t()()(),g(),e(35,"div",11),i(36,"$0"),t(),e(37,"div",12),i(38,"Per maintenance activity"),t()(),e(39,"div",20)(40,"div",5)(41,"div",6),i(42,"Avg Duration"),t(),e(43,"div",7),c(),e(44,"svg",21),s(45,"path",22),t()()(),g(),e(46,"div",11),i(47,"0.0h"),t(),e(48,"div",12),i(49,"Per maintenance activity"),t()()(),e(50,"div",23)(51,"div",24)(52,"div",25),i(53,"Maintenance Trend"),t(),e(54,"div",26)(55,"div",27),v(56,T,2,3,"ng-container",28),t(),e(57,"div",29),v(58,L,2,1,"span",28),t()()(),e(59,"div",24)(60,"div",25),i(61,"Maintenance Types"),t(),e(62,"div",30),v(63,F,4,4,"div",31),t()()(),e(64,"div",32)(65,"div",25),i(66,"Maintenance Costs"),t(),e(67,"div",26)(68,"div",27),v(69,j,2,3,"ng-container",28),t(),e(70,"div",29),v(71,D,2,1,"span",28),t()()(),e(72,"div",32)(73,"div",33),i(74,"Key Insights"),t(),e(75,"p",34),i(76,"Automated analysis of your maintenance performance"),t(),e(77,"ul",35)(78,"li",36),c(),e(79,"svg",37),s(80,"path",15),t(),i(81," Consider increasing preventive maintenance to reduce corrective work."),t(),g(),e(82,"li",38),c(),e(83,"svg",37),s(84,"path",9)(85,"path",10),t(),i(86," No maintenance history found. Start by completing some maintenance activities."),t()()()()),n&2&&(l(14),u(o.totalCount),l(42),f("ngForOf",o.trendData),l(2),f("ngForOf",o.trendLabels),l(5),f("ngForOf",o.typeBreakdown),l(6),f("ngForOf",o.monthlyCostsData),l(2),f("ngForOf",o.monthlyCostsLabels))},dependencies:[k,P,O],styles:[".card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:1rem}.label[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.sublabel[_ngcontent-%COMP%]{font-size:.7rem;color:#9ca3af}.value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#111827}.panel[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:.75rem;padding:1rem}.panel-title[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.5rem;color:#111827}.bar[_ngcontent-%COMP%]{width:20px;background:#3b82f6;border-radius:.25rem}.shadow-sm[_ngcontent-%COMP%]{box-shadow:0 1px 2px #0000000d}.metrics-grid[_ngcontent-%COMP%]{align-items:stretch}.metric-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:1rem;box-shadow:0 1px 2px #0000000a}.metric-card[_ngcontent-%COMP%]   .metric-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:.5rem}.metric-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:600;color:#111827}.metric-card[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#e5f0ff;color:#2563eb;border-radius:10px;padding:.35rem .5rem;font-size:.75rem}.metric-card.info[_ngcontent-%COMP%]{background:#f2f8ff;border-color:#dbeafe}.metric-card.success[_ngcontent-%COMP%]{background:#f2fffa;border-color:#d1fae5}.metric-card.warning[_ngcontent-%COMP%]{background:#fff8ed;border-color:#fde68a}.metric-card.danger[_ngcontent-%COMP%]{background:#fff5f5;border-color:#fecaca}.metric-card[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#0f172a}.metric-card[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{margin-top:.5rem;font-size:.875rem;color:#6b7280}"]})};export{A as AnalyticsPageComponent};
