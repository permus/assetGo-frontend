import{a as M}from"./chunk-E7W5FHY5.js";import{A as j,C as P,c as C,d as f,e as L,f as I,j as E,o as T,r as F,x as V}from"./chunk-BV4EONZX.js";import"./chunk-47ABMRM7.js";import{c as _}from"./chunk-SSTOZ5OJ.js";import"./chunk-J7FUFURU.js";import{l as S}from"./chunk-CDW6MD7D.js";import{Gb as e,Hb as t,Ib as d,Pb as p,Qb as x,Ua as y,Xa as s,ab as h,bc as n,cc as g,jb as k,ka as u,la as c,ob as b,wb as l,yb as w}from"./chunk-ZHYBNXXX.js";import"./chunk-EQDQRRRY.js";function G(o,a){if(o&1&&(e(0,"div",36)(1,"p",37),n(2),t()()),o&2){let r=x();s(2),g(r.sessionMessage)}}function N(o,a){if(o&1&&(e(0,"div",38)(1,"div",39),u(),e(2,"svg",40),d(3,"path",41),t(),c(),e(4,"div",42)(5,"p",43),n(6,"Account Temporarily Locked"),t(),e(7,"p",44),n(8),t(),e(9,"div",45)(10,"div",46),n(11),t(),e(12,"span",47),n(13,"minute(s) remaining"),t()()()()()),o&2){let r=x();s(8),g(r.errorMessage),s(3),g(r.getLockoutMinutes())}}function z(o,a){if(o&1&&(e(0,"div",48)(1,"p",49),n(2),t()()),o&2){let r=x();s(2),g(r.errorMessage)}}function H(o,a){o&1&&(u(),e(0,"svg",50),d(1,"path",51)(2,"path",52),t())}function B(o,a){o&1&&(u(),e(0,"svg",50),d(1,"path",53),t())}function D(o,a){o&1&&(e(0,"span"),n(1,"Sign In"),t())}function R(o,a){o&1&&(e(0,"span",54),u(),e(1,"svg",55),d(2,"circle",56)(3,"path",57),t(),n(4," Signing In... "),t())}var A=class o{constructor(a,r,i){this.fb=a;this.router=r;this.authService=i;this.loginForm=this.fb.group({email:["",[f.required,f.email]],password:["",[f.required,f.minLength(6)]]});let m=localStorage.getItem("session_message");m&&(this.sessionMessage=m,localStorage.removeItem("session_message"),setTimeout(()=>{this.sessionMessage=""},5e3))}loginForm;isLoading=!1;errorMessage="";isLocked=!1;lockoutTime=0;lockoutCountdown=0;lockoutInterval;showPassword=!1;sessionMessage="";toggleMode(){this.router.navigate(["/register"])}onSubmit(){this.loginForm.valid&&!this.isLoading&&(this.isLoading=!0,this.errorMessage="",this.authService.login(this.loginForm.value).subscribe({next:a=>{a.success?this.router.navigate(["/dashboard"]):this.errorMessage=a.message||"Login failed",this.isLoading=!1},error:a=>{let r=a.error;a.status===429?(this.isLocked=!0,this.errorMessage=r?.message||"Too many login attempts. Please try again later.",r?.retry_after&&(this.lockoutCountdown=r.retry_after,this.startLockoutTimer())):a.status===403?this.errorMessage=r?.message||"Access forbidden":this.errorMessage=r?.message||"An error occurred during login",this.isLoading=!1}}))}startLockoutTimer(){this.lockoutInterval&&clearInterval(this.lockoutInterval),this.lockoutInterval=setInterval(()=>{this.lockoutCountdown--,this.lockoutCountdown<=0&&(clearInterval(this.lockoutInterval),this.isLocked=!1,this.errorMessage="",this.lockoutCountdown=0)},1e3)}getLockoutMinutes(){return Math.ceil(this.lockoutCountdown/60)}togglePasswordVisibility(){this.showPassword=!this.showPassword}goToForgotPassword(){this.router.navigate(["/auth/forgot-password"])}ngOnDestroy(){this.lockoutInterval&&clearInterval(this.lockoutInterval)}static \u0275fac=function(r){return new(r||o)(h(j),h(_),h(M))};static \u0275cmp=k({type:o,selectors:[["app-login"]],decls:58,vars:15,consts:[[1,"min-h-screen","bg-gray-50","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"text-center"],[1,"flex","justify-center","mb-6"],[1,"flex","items-center","space-x-3"],["alt","AssetGo Logo",1,"h-20","w-auto",3,"src"],[1,"text-gray-600"],[1,"bg-white","rounded-2xl","shadow-lg","p-8","max-w-md","mx-auto"],[1,"text-center","mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],[1,"flex","mb-8","bg-gray-100","rounded-lg","p-1"],["type","button",1,"flex-1","py-2","px-4","text-center","font-medium","rounded-md","bg-blue-600","text-white","transition-all","cursor-pointer"],["type","button",1,"flex-1","py-2","px-4","text-center","font-medium","rounded-md","text-gray-600","hover:text-gray-800","transition-all","cursor-pointer",3,"click"],["class","mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",4,"ngIf"],["class","mb-4 p-4 bg-orange-50 border border-orange-200 rounded-lg",4,"ngIf"],["class","mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"space-y-6"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","email","type","email","formControlName","email","placeholder","Enter your email","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","placeholder-gray-400"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],["id","password","formControlName","password","placeholder","Enter your password","required","",1,"w-full","px-4","py-3","pr-10","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","placeholder-gray-400",3,"type"],["type","button",1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","cursor-pointer","text-gray-400","hover:text-gray-600",3,"click"],["class","h-5 w-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"text-left"],["type","button",1,"text-blue-600","hover:text-blue-500","text-sm","font-medium","cursor-pointer",3,"click"],["type","submit",1,"w-full","bg-blue-600","text-white","py-3","px-4","rounded-lg","font-medium","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-all","disabled:opacity-50","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],[4,"ngIf"],["class","flex items-center justify-center",4,"ngIf"],[1,"flex","justify-center","space-x-12","text-sm","text-gray-500","mt-8"],[1,"flex","flex-col","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600","mb-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"],[1,"mb-4","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"text-blue-800","text-sm"],[1,"mb-4","p-4","bg-orange-50","border","border-orange-200","rounded-lg"],[1,"flex","items-start"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600","mt-0.5","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],[1,"flex-1"],[1,"text-orange-800","text-sm","font-medium"],[1,"text-orange-700","text-sm","mt-1"],[1,"mt-2","flex","items-center","space-x-2"],[1,"text-orange-900","font-bold","text-lg"],[1,"text-orange-700","text-sm"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"text-red-600","text-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"],[1,"flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(r,i){if(r&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),d(5,"img",5),t()(),e(6,"p",6),n(7,"Enterprise Asset Management System"),t()(),e(8,"div",7)(9,"div",8)(10,"h2",9),n(11,"Welcome"),t(),e(12,"p",6),n(13,"Sign in to your account or create a new one"),t()(),e(14,"div",10)(15,"button",11),n(16," Sign In "),t(),e(17,"button",12),p("click",function(){return i.toggleMode()}),n(18," Sign Up "),t()(),b(19,G,3,1,"div",13)(20,N,14,2,"div",14)(21,z,3,1,"div",15),e(22,"form",16),p("ngSubmit",function(){return i.onSubmit()}),e(23,"div",17)(24,"div")(25,"label",18),n(26,"Email"),t(),d(27,"input",19),t(),e(28,"div")(29,"label",20),n(30,"Password"),t(),e(31,"div",21),d(32,"input",22),e(33,"button",23),p("click",function(){return i.togglePasswordVisibility()}),b(34,H,3,0,"svg",24)(35,B,2,0,"svg",24),t()()(),e(36,"div",25)(37,"button",26),p("click",function(){return i.goToForgotPassword()}),n(38," Forgot password? "),t()(),e(39,"button",27),b(40,D,2,0,"span",28)(41,R,5,0,"span",29),t()()()(),e(42,"div",30)(43,"div",31),u(),e(44,"svg",32),d(45,"path",33),t(),c(),e(46,"span"),n(47,"Secure"),t()(),e(48,"div",31),u(),e(49,"svg",32),d(50,"path",34),t(),c(),e(51,"span"),n(52,"Enterprise"),t()(),e(53,"div",31),u(),e(54,"svg",32),d(55,"path",35),t(),c(),e(56,"span"),n(57,"Multi-tenant"),t()()()()()),r&2){let m,v;s(5),l("src","images/logo.png",y),s(14),l("ngIf",i.sessionMessage),s(),l("ngIf",i.isLocked&&i.lockoutCountdown>0),s(),l("ngIf",i.errorMessage&&!i.isLocked),s(),l("formGroup",i.loginForm),s(5),w("border-red-300",((m=i.loginForm.get("email"))==null?null:m.invalid)&&((m=i.loginForm.get("email"))==null?null:m.touched)),s(5),w("border-red-300",((v=i.loginForm.get("password"))==null?null:v.invalid)&&((v=i.loginForm.get("password"))==null?null:v.touched)),l("type",i.showPassword?"text":"password"),s(2),l("ngIf",!i.showPassword),s(),l("ngIf",i.showPassword),s(4),l("disabled",i.loginForm.invalid||i.isLoading||i.isLocked),s(),l("ngIf",!i.isLoading),s(),l("ngIf",i.isLoading)}},dependencies:[S,P,E,C,L,I,V,T,F],encapsulation:2})};export{A as LoginComponent};
